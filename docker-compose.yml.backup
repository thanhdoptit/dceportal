version: "3.9"
services:
  nginx:
    image: nginx:stable
    container_name: nginx
    network_mode: host
    volumes:
      - ./config:/etc/nginx/conf.d
      - ./ssl:/etc/nginx/ssl
      - ../app/frontend/dist:/usr/share/nginx/html
      - ../app/uploads:/var/www/uploads
      - /tmp/nginx_uploads:/tmp/nginx_uploads  # Upload temp directory
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
