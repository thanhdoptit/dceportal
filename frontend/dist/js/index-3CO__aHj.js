const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/IntroductionSection-CV6Zfowm.js","js/antd-vendor-BrIK-aFn.js","js/react-vendor-BvgFUv0u.js","js/utils-vendor-BJ1c23x6.js","js/router-vendor-qaD8IqrR.js","js/document-vendor-BdOrpqz7.js","js/DeviceGuideSection-Mo29vtQe.js","js/LocationSection-PLcYMTOU.js","js/ApplicationSection-Bzv8YyNq.js","js/PasswordField-DChhPO7K.js","js/ContactSection-DyJm2yT1.js","js/DocumentationSection-DvP2zZeJ.js","js/IntroductionSection-DYbmWYeZ.js","js/DeviceGuideSection-DGg3WCBZ.js","js/LocationSection-DN3Lxmmc.js","js/ApplicationSection-DVElrqRQ.js","js/ContactSection-D9KhdNcp.js","js/DocumentationSection-yphxmiRi.js"])))=>i.map(i=>d[i]);
import{r as e,S as t,T as n,a as r,F as a,s as i,b as s,A as l,I as o,R as c,c as d,D as u,d as h,e as m,B as p,C as f,L as g,f as x,g as y,h as v,i as b,M as j,j as k,k as w,l as C,m as S,n as N,o as T,p as I,q as _,t as D,u as E,v as L,w as A,x as z,y as F,z as P,E as M,G as O,H as R,_ as B,J as V,K as U,N as $,O as H,P as W,Q as q,U as K,V as Y,W as Q,X,Y as G,Z as J,$ as Z,a0 as ee,a1 as te,a2 as ne,a3 as re,a4 as ae,a5 as ie,a6 as se,a7 as le,a8 as oe,a9 as ce,aa as de,ab as ue,ac as he,ad as me,ae as pe,af as fe,ag as ge,ah as xe,ai as ye,aj as ve,ak as be,al as je,am as ke,an as we,ao as Ce,ap as Se,aq as Ne,ar as Te,as as Ie,at as _e,au as De,av as Ee,aw as Le,ax as Ae,ay as ze,az as Fe,aA as Pe,aB as Me,aC as Oe,aD as Re,aE as Be,aF as Ve,aG as Ue,aH as $e,aI as He,aJ as We,aK as qe,aL as Ke,aM as Ye,aN as Qe,aO as Xe,aP as Ge,aQ as Je,aR as Ze,aS as et,aT as tt}from"./antd-vendor-BrIK-aFn.js";import{r as nt,a as rt,g as at}from"./react-vendor-BvgFUv0u.js";import{a as it,h as st,b as lt,c as ot,d as ct,e as dt,f as ut,p as ht}from"./utils-vendor-BJ1c23x6.js";import{u as mt,a as pt,O as ft,b as gt,B as xt,R as yt,c as vt,N as bt}from"./router-vendor-qaD8IqrR.js";import{u as jt,w as kt}from"./document-vendor-BdOrpqz7.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var wt,Ct,St,Nt,Tt,It,_t={exports:{}},Dt={},Et=(Ct||(Ct=1,_t.exports=function(){if(wt)return Dt;wt=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(t,n,r){var a=null;if(void 0!==r&&(a=""+r),void 0!==n.key&&(a=""+n.key),"key"in n)for(var i in r={},n)"key"!==i&&(r[i]=n[i]);else r=n;return n=r.ref,{$$typeof:e,type:t,key:a,ref:void 0!==n?n:null,props:r}}return Dt.Fragment=t,Dt.jsx=n,Dt.jsxs=n,Dt}()),_t.exports),Lt={exports:{}},At={},zt={exports:{}},Ft={},Pt=(It||(It=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){}}(),Lt.exports=function(){if(Tt)return At;Tt=1;var e=(Nt||(Nt=1,zt.exports=(St||(St=1,function(e){function t(e,t){var n=e.length;e.push(t);e:for(;n>0;){var r=n-1>>>1,i=e[r];if(0>=a(i,t))break e;e[r]=t,e[n]=i,n=r}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;s>r;){var l=2*(r+1)-1,o=e[l],c=l+1,d=e[c];if(0>a(o,n))i>c&&0>a(d,o)?(e[r]=d,e[c]=n,r=c):(e[r]=o,e[l]=n,r=l);else{if(c>=i||a(d,n)>=0)break e;e[r]=d,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var o=[],c=[],d=1,u=null,h=3,m=!1,p=!1,f=!1,g=!1,x="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,v="undefined"!=typeof setImmediate?setImmediate:null;function b(e){for(var a=n(c);null!==a;){if(null===a.callback)r(c);else{if(a.startTime>e)break;r(c),a.sortIndex=a.expirationTime,t(o,a)}a=n(c)}}function j(e){if(f=!1,b(e),!p)if(null!==n(o))p=!0,w||(w=!0,k());else{var t=n(c);null!==t&&E(j,t.startTime-e)}}var k,w=!1,C=-1,S=5,N=-1;function T(){return!!g||e.unstable_now()-N>=S}function I(){if(g=!1,w){var t=e.unstable_now();N=t;var a=!0;try{e:{p=!1,f&&(f=!1,y(C),C=-1),m=!0;var i=h;try{t:{for(b(t),u=n(o);!(null===u||u.expirationTime>t&&T());){var s=u.callback;if("function"==typeof s){u.callback=null,h=u.priorityLevel;var l=s(u.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof l){u.callback=l,b(t),a=!0;break t}u===n(o)&&r(o),b(t)}else r(o);u=n(o)}if(null!==u)a=!0;else{var d=n(c);null!==d&&E(j,d.startTime-t),a=!1}}break e}finally{u=null,h=i,m=!1}a=void 0}}finally{a?k():w=!1}}}if("function"==typeof v)k=function(){v(I)};else if("undefined"!=typeof MessageChannel){var _=new MessageChannel,D=_.port2;_.port1.onmessage=I,k=function(){D.postMessage(null)}}else k=function(){x(I,0)};function E(t,n){C=x(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||e>125||(S=e>0?Math.floor(1e3/e):5)},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},e.unstable_requestPaint=function(){g=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},e.unstable_scheduleCallback=function(r,a,i){var s=e.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&i>0?s+i:s,r){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return r={id:d++,callback:a,priorityLevel:r,startTime:i,expirationTime:l=i+l,sortIndex:-1},i>s?(r.sortIndex=i,t(c,r),null===n(o)&&r===n(c)&&(f?(y(C),C=-1):f=!0,E(j,i-s))):(r.sortIndex=l,t(o,r),p||m||(p=!0,w||(w=!0,k()))),r},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}}(Ft)),Ft)),zt.exports),t=nt(),n=rt();function r(e){var t="https://react.dev/errors/"+e;if(arguments.length>1){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;arguments.length>n;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function i(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function s(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function l(e){if(i(e)!==e)throw Error(r(188))}function o(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=o(e)))return t;e=e.sibling}return null}var c=Object.assign,d=Symbol.for("react.element"),u=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),x=Symbol.for("react.consumer"),y=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),S=Symbol.for("react.memo_cache_sentinel"),N=Symbol.iterator;function T(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=N&&e[N]||e["@@iterator"])?e:null}var I=Symbol.for("react.client.reference");function _(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===I?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case m:return"Fragment";case f:return"Profiler";case p:return"StrictMode";case b:return"Suspense";case j:return"SuspenseList";case C:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case h:return"Portal";case y:return(e.displayName||"Context")+".Provider";case x:return(e._context.displayName||"Context")+".Consumer";case v:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case k:return null!==(t=e.displayName||null)?t:_(e.type)||"Memo";case w:t=e._payload,e=e._init;try{return _(e(t))}catch(n){}}return null}var D=Array.isArray,E=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,A={pending:!1,data:null,method:null,action:null},z=[],F=-1;function P(e){return{current:e}}function M(e){0>F||(e.current=z[F],z[F]=null,F--)}function O(e,t){F++,z[F]=e.current,e.current=t}var R=P(null),B=P(null),V=P(null),U=P(null);function $(e,t){switch(O(V,t),O(B,e),O(R,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?du(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=uu(t=du(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}M(R),O(R,e)}function H(){M(R),M(B),M(V)}function W(e){null!==e.memoizedState&&O(U,e);var t=R.current,n=uu(t,e.type);t!==n&&(O(B,e),O(R,n))}function q(e){B.current===e&&(M(R),M(B)),U.current===e&&(M(U),eh._currentValue=A)}var K=Object.prototype.hasOwnProperty,Y=e.unstable_scheduleCallback,Q=e.unstable_cancelCallback,X=e.unstable_shouldYield,G=e.unstable_requestPaint,J=e.unstable_now,Z=e.unstable_getCurrentPriorityLevel,ee=e.unstable_ImmediatePriority,te=e.unstable_UserBlockingPriority,ne=e.unstable_NormalPriority,re=e.unstable_LowPriority,ae=e.unstable_IdlePriority,ie=e.log,se=e.unstable_setDisableYieldValue,le=null,oe=null;function ce(e){if("function"==typeof ie&&se(e),oe&&"function"==typeof oe.setStrictMode)try{oe.setStrictMode(le,e)}catch(t){}}var de=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(ue(e)/he|0)|0},ue=Math.log,he=Math.LN2,me=256,pe=4194304;function fe(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ge(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var a=0,i=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var l=134217727&r;return 0!==l?0!==(r=l&~i)?a=fe(r):0!==(s&=l)?a=fe(s):n||0!==(n=l&~e)&&(a=fe(n)):0!==(l=r&~i)?a=fe(l):0!==s?a=fe(s):n||0!==(n=r&~e)&&(a=fe(n)),0===a?0:0!==t&&t!==a&&0===(t&i)&&((i=a&-a)>=(n=t&-t)||32===i&&4194048&n)?t:a}function xe(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function ye(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ve(){var e=me;return!(4194048&(me<<=1))&&(me=256),e}function be(){var e=pe;return!(62914560&(pe<<=1))&&(pe=4194304),e}function je(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ke(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function we(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-de(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194090&n}function Ce(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-de(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}function Se(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ne(e){return(e&=-e)>2?e>8?134217727&e?32:268435456:8:2}function Te(){var e=L.p;return 0!==e?e:void 0===(e=window.event)?32:fh(e.type)}var Ie=Math.random().toString(36).slice(2),_e="__reactFiber$"+Ie,De="__reactProps$"+Ie,Ee="__reactContainer$"+Ie,Le="__reactEvents$"+Ie,Ae="__reactListeners$"+Ie,ze="__reactHandles$"+Ie,Fe="__reactResources$"+Ie,Pe="__reactMarker$"+Ie;function Me(e){delete e[_e],delete e[De],delete e[Le],delete e[Ae],delete e[ze]}function Oe(e){var t=e[_e];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ee]||n[_e]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Su(e);null!==e;){if(n=e[_e])return n;e=Su(e)}return t}n=(e=n).parentNode}return null}function Re(e){if(e=e[_e]||e[Ee]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Be(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(r(33))}function Ve(e){var t=e[Fe];return t||(t=e[Fe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ue(e){e[Pe]=!0}var $e=new Set,He={};function We(e,t){qe(e,t),qe(e+"Capture",t)}function qe(e,t){for(He[e]=t,e=0;e<t.length;e++)$e.add(t[e])}var Ke,Ye,Qe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Xe={},Ge={};function Je(e,t,n){if(a=t,K.call(Ge,a)||!K.call(Xe,a)&&(Qe.test(a)?Ge[a]=!0:(Xe[a]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var a}function Ze(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function et(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function tt(e){if(void 0===Ke)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ke=t&&t[1]||"",Ye=n.stack.indexOf("\n    at")>-1?" (<anonymous>)":n.stack.indexOf("@")>-1?"@unknown:0:0":""}return"\n"+Ke+e+Ye}var at=!1;function it(e,t){if(!e||at)return"";at=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(a){var r=a}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(s){r=s}(n=e())&&"function"==typeof n.catch&&n.catch(function(){})}}catch(l){if(l&&r&&"string"==typeof l.stack)return[l.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=r.DetermineComponentFrameRoot(),s=i[0],l=i[1];if(s&&l){var o=s.split("\n"),c=l.split("\n");for(a=r=0;r<o.length&&!o[r].includes("DetermineComponentFrameRoot");)r++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(r===o.length||a===c.length)for(r=o.length-1,a=c.length-1;r>=1&&a>=0&&o[r]!==c[a];)a--;for(;r>=1&&a>=0;r--,a--)if(o[r]!==c[a]){if(1!==r||1!==a)do{if(r--,0>--a||o[r]!==c[a]){var d="\n"+o[r].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(r>=1&&a>=0);break}}}finally{at=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?tt(n):""}function st(e){switch(e.tag){case 26:case 27:case 5:return tt(e.type);case 16:return tt("Lazy");case 13:return tt("Suspense");case 19:return tt("SuspenseList");case 0:case 15:return it(e.type,!1);case 11:return it(e.type.render,!1);case 1:return it(e.type,!0);case 31:return tt("Activity");default:return""}}function lt(e){try{var t="";do{t+=st(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function ot(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ct(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function dt(e){e._valueTracker||(e._valueTracker=function(e){var t=ct(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ut(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ct(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ht(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(In){return e.body}}var mt=/[\n"\\]/g;function pt(e){return e.replace(mt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function ft(e,t,n,r,a,i,s,l){e.name="",null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ot(t)):e.value!==""+ot(t)&&(e.value=""+ot(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?xt(e,s,ot(t)):null!=n?xt(e,s,ot(n)):null!=r&&e.removeAttribute("value"),null==a&&null!=i&&(e.defaultChecked=!!i),null!=a&&(e.checked=a&&"function"!=typeof a&&"symbol"!=typeof a),null!=l&&"function"!=typeof l&&"symbol"!=typeof l&&"boolean"!=typeof l?e.name=""+ot(l):e.removeAttribute("name")}function gt(e,t,n,r,a,i,s,l){if(null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&"boolean"!=typeof i&&(e.type=i),null!=t||null!=n){if(("submit"===i||"reset"===i)&&null==t)return;n=null!=n?""+ot(n):"",t=null!=t?""+ot(t):n,l||t===e.value||(e.value=t),e.defaultValue=t}r="function"!=typeof(r=null!=r?r:a)&&"symbol"!=typeof r&&!!r,e.checked=l?e.checked:!!r,e.defaultChecked=!!r,null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s&&(e.name=s)}function xt(e,t,n){"number"===t&&ht(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function yt(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ot(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function vt(e,t,n){null==t||((t=""+ot(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ot(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function bt(e,t,n,a){if(null==t){if(null!=a){if(null!=n)throw Error(r(92));if(D(a)){if(a.length>1)throw Error(r(93));a=a[0]}n=a}null==n&&(n=""),t=n}n=ot(t),e.defaultValue=n,(a=e.textContent)===n&&""!==a&&null!==a&&(e.value=a)}function jt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var kt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function wt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"==typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!=typeof n||0===n||kt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Ct(e,t,n){if(null!=t&&"object"!=typeof t)throw Error(r(62));if(e=e.style,null!=n){for(var a in n)!n.hasOwnProperty(a)||null!=t&&t.hasOwnProperty(a)||(0===a.indexOf("--")?e.setProperty(a,""):"float"===a?e.cssFloat="":e[a]="");for(var i in t)a=t[i],t.hasOwnProperty(i)&&n[i]!==a&&wt(e,i,a)}else for(var s in t)t.hasOwnProperty(s)&&wt(e,s,t[s])}function It(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _t=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Dt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Et(e){return Dt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Lt=null;function Pt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Mt=null,Ot=null;function Rt(e){var t=Re(e);if(t&&(e=t.stateNode)){var n=e[De]||null;e:switch(e=t.stateNode,t.type){case"input":if(ft(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+pt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var i=a[De]||null;if(!i)throw Error(r(90));ft(a,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(a=n[t]).form===e.form&&ut(a)}break e;case"textarea":vt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&yt(e,!!n.multiple,t,!1)}}}var Bt=!1;function Vt(e,t,n){if(Bt)return e(t,n);Bt=!0;try{return e(t)}finally{if(Bt=!1,(null!==Mt||null!==Ot)&&(Kc(),Mt&&(t=Mt,e=Ot,Ot=Mt=null,Rt(t),e)))for(t=0;t<e.length;t++)Rt(e[t])}}function Ut(e,t){var n=e.stateNode;if(null===n)return null;var a=n[De]||null;if(null===a)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(r(231,t,typeof n));return n}var $t=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Ht=!1;if($t)try{var Wt={};Object.defineProperty(Wt,"passive",{get:function(){Ht=!0}}),window.addEventListener("test",Wt,Wt),window.removeEventListener("test",Wt,Wt)}catch(In){Ht=!1}var qt=null,Kt=null,Yt=null;function Qt(){if(Yt)return Yt;var e,t,n=Kt,r=n.length,a="value"in qt?qt.value:qt.textContent,i=a.length;for(e=0;r>e&&n[e]===a[e];e++);var s=r-e;for(t=1;s>=t&&n[r-t]===a[i-t];t++);return Yt=a.slice(e,t>1?1-t:void 0)}function Xt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32>e&&13!==e?0:e}function Gt(){return!0}function Jt(){return!1}function Zt(e){function t(t,n,r,a,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?Gt:Jt,this.isPropagationStopped=Jt,this}return c(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Gt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Gt)},persist:function(){},isPersistent:Gt}),t}var en,tn,nn,rn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},an=Zt(rn),sn=c({},rn,{view:0,detail:0}),ln=Zt(sn),on=c({},sn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==nn&&(nn&&"mousemove"===e.type?(en=e.screenX-nn.screenX,tn=e.screenY-nn.screenY):tn=en=0,nn=e),en)},movementY:function(e){return"movementY"in e?e.movementY:tn}}),cn=Zt(on),dn=Zt(c({},on,{dataTransfer:0})),un=Zt(c({},sn,{relatedTarget:0})),hn=Zt(c({},rn,{animationName:0,elapsedTime:0,pseudoElement:0})),mn=Zt(c({},rn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),pn=Zt(c({},rn,{data:0})),fn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function vn(){return yn}var bn=Zt(c({},sn,{key:function(e){if(e.key){var t=fn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Xt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?gn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vn,charCode:function(e){return"keypress"===e.type?Xt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Xt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),jn=Zt(c({},on,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kn=Zt(c({},sn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vn})),wn=Zt(c({},rn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Cn=Zt(c({},on,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Sn=Zt(c({},rn,{newState:0,oldState:0})),Nn=[9,13,27,32],Tn=$t&&"CompositionEvent"in window,_n=null;$t&&"documentMode"in document&&(_n=document.documentMode);var Dn=$t&&"TextEvent"in window&&!_n,En=$t&&(!Tn||_n&&_n>8&&11>=_n),Ln=" ",An=!1;function zn(e,t){switch(e){case"keyup":return-1!==Nn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Pn=!1,Mn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function On(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Mn[e.type]:"textarea"===t}function Rn(e,t,n,r){Mt?Ot?Ot.push(r):Ot=[r]:Mt=r,(t=Xd(t,"onChange")).length>0&&(n=new an("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Bn=null,Vn=null;function Un(e){Ud(e,0)}function $n(e){if(ut(Be(e)))return e}function Hn(e,t){if("change"===e)return t}var Wn=!1;if($t){var qn;if($t){var Kn="oninput"in document;if(!Kn){var Yn=document.createElement("div");Yn.setAttribute("oninput","return;"),Kn="function"==typeof Yn.oninput}qn=Kn}else qn=!1;Wn=qn&&(!document.documentMode||document.documentMode>9)}function Qn(){Bn&&(Bn.detachEvent("onpropertychange",Xn),Vn=Bn=null)}function Xn(e){if("value"===e.propertyName&&$n(Vn)){var t=[];Rn(t,Vn,e,Pt(e)),Vt(Un,t)}}function Gn(e,t,n){"focusin"===e?(Qn(),Vn=n,(Bn=t).attachEvent("onpropertychange",Xn)):"focusout"===e&&Qn()}function Jn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $n(Vn)}function Zn(e,t){if("click"===e)return $n(t)}function er(e,t){if("input"===e||"change"===e)return $n(t)}var tr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function nr(e,t){if(tr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!K.call(t,a)||!tr(e[a],t[a]))return!1}return!0}function rr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ar(e,t){var n,r=rr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,t>=e&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=rr(r)}}function ir(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ir(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function sr(e){for(var t=ht((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=ht((e=t.contentWindow).document)}return t}function lr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var or=$t&&"documentMode"in document&&11>=document.documentMode,cr=null,dr=null,ur=null,hr=!1;function mr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;hr||null==cr||cr!==ht(r)||(r="selectionStart"in(r=cr)&&lr(r)?{start:r.selectionStart,end:r.selectionEnd}:{anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},ur&&nr(ur,r)||(ur=r,(r=Xd(dr,"onSelect")).length>0&&(t=new an("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=cr)))}function pr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var fr={animationend:pr("Animation","AnimationEnd"),animationiteration:pr("Animation","AnimationIteration"),animationstart:pr("Animation","AnimationStart"),transitionrun:pr("Transition","TransitionRun"),transitionstart:pr("Transition","TransitionStart"),transitioncancel:pr("Transition","TransitionCancel"),transitionend:pr("Transition","TransitionEnd")},gr={},xr={};function yr(e){if(gr[e])return gr[e];if(!fr[e])return e;var t,n=fr[e];for(t in n)if(n.hasOwnProperty(t)&&t in xr)return gr[e]=n[t];return e}$t&&(xr=document.createElement("div").style,"AnimationEvent"in window||(delete fr.animationend.animation,delete fr.animationiteration.animation,delete fr.animationstart.animation),"TransitionEvent"in window||delete fr.transitionend.transition);var vr=yr("animationend"),br=yr("animationiteration"),jr=yr("animationstart"),kr=yr("transitionrun"),wr=yr("transitionstart"),Cr=yr("transitioncancel"),Sr=yr("transitionend"),Nr=new Map,Tr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ir(e,t){Nr.set(e,t),We(t,[e])}Tr.push("scrollEnd");var _r=new WeakMap;function Dr(e,t){if("object"==typeof e&&null!==e){var n=_r.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},_r.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var Er=[],Lr=0,Ar=0;function zr(){for(var e=Lr,t=Ar=Lr=0;e>t;){var n=Er[t];Er[t++]=null;var r=Er[t];Er[t++]=null;var a=Er[t];Er[t++]=null;var i=Er[t];if(Er[t++]=null,null!==r&&null!==a){var s=r.pending;null===s?a.next=a:(a.next=s.next,s.next=a),r.pending=a}0!==i&&Or(n,a,i)}}function Fr(e,t,n,r){Er[Lr++]=e,Er[Lr++]=t,Er[Lr++]=n,Er[Lr++]=r,Ar|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Pr(e,t,n,r){return Fr(e,t,n,r),Rr(e)}function Mr(e,t){return Fr(e,null,null,t),Rr(e)}function Or(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var a=!1,i=e.return;null!==i;)i.childLanes|=n,null!==(r=i.alternate)&&(r.childLanes|=n),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(a=!0)),e=i,i=i.return;return 3===e.tag?(i=e.stateNode,a&&null!==t&&(a=31-de(n),null===(r=(e=i.hiddenUpdates)[a])?e[a]=[t]:r.push(t),t.lane=536870912|n),i):null}function Rr(e){if(Oc>50)throw Oc=0,Rc=null,Error(r(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Br={};function Vr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ur(e,t,n,r){return new Vr(e,t,n,r)}function $r(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Hr(e,t){var n=e.alternate;return null===n?((n=Ur(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Wr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function qr(e,t,n,a,i,s){var l=0;if(a=e,"function"==typeof e)$r(e)&&(l=1);else if("string"==typeof e)l=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,n,R.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case C:return(e=Ur(31,n,t,i)).elementType=C,e.lanes=s,e;case m:return Kr(n.children,i,s,t);case p:l=8,i|=24;break;case f:return(e=Ur(12,n,t,2|i)).elementType=f,e.lanes=s,e;case b:return(e=Ur(13,n,t,i)).elementType=b,e.lanes=s,e;case j:return(e=Ur(19,n,t,i)).elementType=j,e.lanes=s,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case g:case y:l=10;break e;case x:l=9;break e;case v:l=11;break e;case k:l=14;break e;case w:l=16,a=null;break e}l=29,n=Error(r(130,null===e?"null":typeof e,"")),a=null}return(t=Ur(l,n,t,i)).elementType=e,t.type=a,t.lanes=s,t}function Kr(e,t,n,r){return(e=Ur(7,e,r,t)).lanes=n,e}function Yr(e,t,n){return(e=Ur(6,e,null,t)).lanes=n,e}function Qr(e,t,n){return(t=Ur(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Xr=[],Gr=0,Jr=null,Zr=0,ea=[],ta=0,na=null,ra=1,aa="";function ia(e,t){Xr[Gr++]=Zr,Xr[Gr++]=Jr,Jr=e,Zr=t}function sa(e,t,n){ea[ta++]=ra,ea[ta++]=aa,ea[ta++]=na,na=e;var r=ra;e=aa;var a=32-de(r)-1;r&=~(1<<a),n+=1;var i=32-de(t)+a;if(i>30){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,ra=1<<32-de(t)+a|n<<a|r,aa=i+e}else ra=1<<i|n<<a|r,aa=e}function la(e){null!==e.return&&(ia(e,1),sa(e,1,0))}function oa(e){for(;e===Jr;)Jr=Xr[--Gr],Xr[Gr]=null,Zr=Xr[--Gr],Xr[Gr]=null;for(;e===na;)na=ea[--ta],ea[ta]=null,aa=ea[--ta],ea[ta]=null,ra=ea[--ta],ea[ta]=null}var ca=null,da=null,ua=!1,ha=null,ma=!1,pa=Error(r(519));function fa(e){throw ja(Dr(Error(r(418,"")),e)),pa}function ga(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[_e]=e,t[De]=r,n){case"dialog":$d("cancel",t),$d("close",t);break;case"iframe":case"object":case"embed":$d("load",t);break;case"video":case"audio":for(n=0;n<Bd.length;n++)$d(Bd[n],t);break;case"source":$d("error",t);break;case"img":case"image":case"link":$d("error",t),$d("load",t);break;case"details":$d("toggle",t);break;case"input":$d("invalid",t),gt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),dt(t);break;case"select":$d("invalid",t);break;case"textarea":$d("invalid",t),bt(t,r.value,r.defaultValue,r.children),dt(t)}"string"!=typeof(n=r.children)&&"number"!=typeof n&&"bigint"!=typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||nu(t.textContent,n)?(null!=r.popover&&($d("beforetoggle",t),$d("toggle",t)),null!=r.onScroll&&$d("scroll",t),null!=r.onScrollEnd&&$d("scrollend",t),null!=r.onClick&&(t.onclick=ru),t=!0):t=!1,t||fa(e)}function xa(e){for(ca=e.return;ca;)switch(ca.tag){case 5:case 13:return void(ma=!1);case 27:case 3:return void(ma=!0);default:ca=ca.return}}function ya(e){if(e!==ca)return!1;if(!ua)return xa(e),ua=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||hu(e.type,e.memoizedProps)),t=!t),t&&da&&fa(e),xa(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){da=wu(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}da=null}}else 27===n?(n=da,vu(e.type)?(e=Cu,Cu=null,da=e):da=n):da=ca?wu(e.stateNode.nextSibling):null;return!0}function va(){da=ca=null,ua=!1}function ba(){var e=ha;return null!==e&&(null===Sc?Sc=e:Sc.push.apply(Sc,e),ha=null),e}function ja(e){null===ha?ha=[e]:ha.push(e)}var ka=P(null),wa=null,Ca=null;function Sa(e,t,n){O(ka,t._currentValue),t._currentValue=n}function Na(e){e._currentValue=ka.current,M(ka)}function Ta(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ia(e,t,n,a){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var s=i.dependencies;if(null!==s){var l=i.child;s=s.firstContext;e:for(;null!==s;){var o=s;s=i;for(var c=0;c<t.length;c++)if(o.context===t[c]){s.lanes|=n,null!==(o=s.alternate)&&(o.lanes|=n),Ta(s.return,n,e),a||(l=null);break e}s=o.next}}else if(18===i.tag){if(null===(l=i.return))throw Error(r(341));l.lanes|=n,null!==(s=l.alternate)&&(s.lanes|=n),Ta(l,n,e),l=null}else l=i.child;if(null!==l)l.return=i;else for(l=i;null!==l;){if(l===e){l=null;break}if(null!==(i=l.sibling)){i.return=l.return,l=i;break}l=l.return}i=l}}function _a(e,t,n,a){e=null;for(var i=t,s=!1;null!==i;){if(!s)if(524288&i.flags)s=!0;else if(262144&i.flags)break;if(10===i.tag){var l=i.alternate;if(null===l)throw Error(r(387));if(null!==(l=l.memoizedProps)){var o=i.type;tr(i.pendingProps.value,l.value)||(null!==e?e.push(o):e=[o])}}else if(i===U.current){if(null===(l=i.alternate))throw Error(r(387));l.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(eh):e=[eh])}i=i.return}null!==e&&Ia(t,e,n,a),t.flags|=262144}function Da(e){for(e=e.firstContext;null!==e;){if(!tr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ea(e){wa=e,Ca=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function La(e){return za(wa,e)}function Aa(e,t){return null===wa&&Ea(e),za(e,t)}function za(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Ca){if(null===e)throw Error(r(308));Ca=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ca=Ca.next=t;return n}var Fa="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Pa=e.unstable_scheduleCallback,Ma=e.unstable_NormalPriority,Oa={$$typeof:y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ra(){return{controller:new Fa,data:new Map,refCount:0}}function Ba(e){e.refCount--,0===e.refCount&&Pa(Ma,function(){e.controller.abort()})}var Va=null,Ua=0,$a=0,Ha=null;function Wa(){if(0===--Ua&&null!==Va){null!==Ha&&(Ha.status="fulfilled");var e=Va;Va=null,$a=0,Ha=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var qa=E.S;E.S=function(e,t){"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===Va){var n=Va=[];Ua=0,$a=Fd(),Ha={status:"pending",value:void 0,then:function(e){n.push(e)}}}Ua++,t.then(Wa,Wa)}(0,t),null!==qa&&qa(e,t)};var Ka=P(null);function Ya(){var e=Ka.current;return null!==e?e:cc.pooledCache}function Qa(e,t){O(Ka,null===t?Ka.current:t.pool)}function Xa(){var e=Ya();return null===e?null:{parent:Oa._currentValue,pool:e}}var Ga=Error(r(460)),Ja=Error(r(474)),Za=Error(r(542)),ei={then:function(){}};function ti(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ni(){}function ri(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(ni,ni),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw si(e=t.reason),e;default:if("string"==typeof t.status)t.then(ni,ni);else{if(null!==(e=cc)&&e.shellSuspendCounter>100)throw Error(r(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw si(e=t.reason),e}throw ai=t,Ga}}var ai=null;function ii(){if(null===ai)throw Error(r(459));var e=ai;return ai=null,e}function si(e){if(e===Ga||e===Za)throw Error(r(483))}var li=!1;function oi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ci(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function di(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ui(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&oc){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,t=Rr(e),Or(e,null,n),t}return Fr(e,r,t,n),Rr(e)}function hi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ce(e,n)}}function mi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===i?a=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var pi=!1;function fi(){if(pi&&null!==Ha)throw Ha}function gi(e,t,n,r){pi=!1;var a=e.updateQueue;li=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,l=a.shared.pending;if(null!==l){a.shared.pending=null;var o=l,d=o.next;o.next=null,null===s?i=d:s.next=d,s=o;var u=e.alternate;null!==u&&(l=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===l?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=o)}if(null!==i){var h=a.baseState;for(s=0,u=d=o=null,l=i;;){var m=-536870913&l.lane,p=m!==l.lane;if(p?(uc&m)===m:(r&m)===m){0!==m&&m===$a&&(pi=!0),null!==u&&(u=u.next={lane:0,tag:l.tag,payload:l.payload,callback:null,next:null});e:{var f=e,g=l;m=t;var x=n;switch(g.tag){case 1:if("function"==typeof(f=g.payload)){h=f.call(x,h,m);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(m="function"==typeof(f=g.payload)?f.call(x,h,m):f))break e;h=c({},h,m);break e;case 2:li=!0}}null!==(m=l.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=a.callbacks)?a.callbacks=[m]:p.push(m))}else p={lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===u?(d=u=p,o=h):u=u.next=p,s|=m;if(null===(l=l.next)){if(null===(l=a.shared.pending))break;l=(p=l).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}null===u&&(o=h),a.baseState=o,a.firstBaseUpdate=d,a.lastBaseUpdate=u,null===i&&(a.shared.lanes=0),vc|=s,e.lanes=s,e.memoizedState=h}}function xi(e,t){if("function"!=typeof e)throw Error(r(191,e));e.call(t)}function yi(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)xi(n[e],t)}var vi=P(null),bi=P(0);function ji(e,t){O(bi,e=xc),O(vi,t),xc=e|t.baseLanes}function ki(){O(bi,xc),O(vi,vi.current)}function wi(){xc=bi.current,M(vi),M(bi)}var Ci=0,Si=null,Ni=null,Ti=null,Ii=!1,_i=!1,Di=!1,Ei=0,Li=0,Ai=null,zi=0;function Fi(){throw Error(r(321))}function Pi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!tr(e[n],t[n]))return!1;return!0}function Mi(e,t,n,r,a,i){return Ci=i,Si=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,E.H=null===e||null===e.memoizedState?Gs:Js,Di=!1,i=n(r,a),Di=!1,_i&&(i=Ri(t,n,r,a)),Oi(e),i}function Oi(e){E.H=Xs;var t=null!==Ni&&null!==Ni.next;if(Ci=0,Ti=Ni=Si=null,Ii=!1,Li=0,Ai=null,t)throw Error(r(300));null===e||Ll||null!==(e=e.dependencies)&&Da(e)&&(Ll=!0)}function Ri(e,t,n,a){Si=e;var i=0;do{if(_i&&(Ai=null),Li=0,_i=!1,i>=25)throw Error(r(301));if(i+=1,Ti=Ni=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}E.H=Zs,s=t(n,a)}while(_i);return s}function Bi(){var e=E.H,t=e.useState()[0];return t="function"==typeof t.then?qi(t):t,e=e.useState()[0],(null!==Ni?Ni.memoizedState:null)!==e&&(Si.flags|=1024),t}function Vi(){var e=0!==Ei;return Ei=0,e}function Ui(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function $i(e){if(Ii){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Ii=!1}Ci=0,Ti=Ni=Si=null,_i=!1,Li=Ei=0,Ai=null}function Hi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ti?Si.memoizedState=Ti=e:Ti=Ti.next=e,Ti}function Wi(){if(null===Ni){var e=Si.alternate;e=null!==e?e.memoizedState:null}else e=Ni.next;var t=null===Ti?Si.memoizedState:Ti.next;if(null!==t)Ti=t,Ni=e;else{if(null===e){if(null===Si.alternate)throw Error(r(467));throw Error(r(310))}e={memoizedState:(Ni=e).memoizedState,baseState:Ni.baseState,baseQueue:Ni.baseQueue,queue:Ni.queue,next:null},null===Ti?Si.memoizedState=Ti=e:Ti=Ti.next=e}return Ti}function qi(e){var t=Li;return Li+=1,null===Ai&&(Ai=[]),e=ri(Ai,e,t),t=Si,null===(null===Ti?t.memoizedState:Ti.next)&&(t=t.alternate,E.H=null===t||null===t.memoizedState?Gs:Js),e}function Ki(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return qi(e);if(e.$$typeof===y)return La(e)}throw Error(r(438,e+""))}function Yi(e){var t=null,n=Si.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Si.alternate;null!==r&&null!==(r=r.updateQueue)&&null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Si.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;e>r;r++)n[r]=S;return t.index++,n}function Qi(e,t){return"function"==typeof t?t(e):t}function Xi(e){return Gi(Wi(),Ni,e)}function Gi(e,t,n){var a=e.queue;if(null===a)throw Error(r(311));a.lastRenderedReducer=n;var i=e.baseQueue,s=a.pending;if(null!==s){if(null!==i){var l=i.next;i.next=s.next,s.next=l}t.baseQueue=i=s,a.pending=null}if(s=e.baseState,null===i)e.memoizedState=s;else{var o=l=null,c=null,d=t=i.next,u=!1;do{var h=-536870913&d.lane;if(h!==d.lane?(uc&h)===h:(Ci&h)===h){var m=d.revertLane;if(0===m)null!==c&&(c=c.next={lane:0,revertLane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),h===$a&&(u=!0);else{if((Ci&m)===m){d=d.next,m===$a&&(u=!0);continue}h={lane:0,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(o=c=h,l=s):c=c.next=h,Si.lanes|=m,vc|=m}h=d.action,Di&&n(s,h),s=d.hasEagerState?d.eagerState:n(s,h)}else m={lane:h,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(o=c=m,l=s):c=c.next=m,Si.lanes|=h,vc|=h;d=d.next}while(null!==d&&d!==t);if(null===c?l=s:c.next=o,!tr(s,e.memoizedState)&&(Ll=!0,u&&null!==(n=Ha)))throw n;e.memoizedState=s,e.baseState=l,e.baseQueue=c,a.lastRenderedState=s}return null===i&&(a.lanes=0),[e.memoizedState,a.dispatch]}function Ji(e){var t=Wi(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var a=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var l=i=i.next;do{s=e(s,l.action),l=l.next}while(l!==i);tr(s,t.memoizedState)||(Ll=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,a]}function Zi(e,t,n){var a=Si,i=Wi(),s=ua;if(s){if(void 0===n)throw Error(r(407));n=n()}else n=t();var l=!tr((Ni||i).memoizedState,n);if(l&&(i.memoizedState=n,Ll=!0),i=i.queue,ks(2048,8,ns.bind(null,a,i,e),[e]),i.getSnapshot!==t||l||null!==Ti&&1&Ti.memoizedState.tag){if(a.flags|=2048,vs(9,{destroy:void 0,resource:void 0},ts.bind(null,a,i,n,t),null),null===cc)throw Error(r(349));s||124&Ci||es(a,t,n)}return n}function es(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Si.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Si.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ts(e,t,n,r){t.value=n,t.getSnapshot=r,rs(t)&&as(e)}function ns(e,t,n){return n(function(){rs(t)&&as(e)})}function rs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!tr(e,n)}catch(r){return!0}}function as(e){var t=Mr(e,2);null!==t&&Uc(t,0,2)}function is(e){var t=Hi();if("function"==typeof e){var n=e;if(e=n(),Di){ce(!0);try{n()}finally{ce(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:e},t}function ss(e,t,n,r){return e.baseState=n,Gi(e,Ni,"function"==typeof r?r:Qi)}function ls(e,t,n,a,i){if(Ks(e))throw Error(r(485));if(null!==(e=t.action)){var s={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==E.T?n(!0):s.isTransition=!1,a(s),null===(n=t.pending)?(s.next=t.pending=s,os(t,s)):(s.next=n.next,t.pending=n.next=s)}}function os(e,t){var n=t.action,r=t.payload,a=e.state;if(t.isTransition){var i=E.T,s={};E.T=s;try{var l=n(a,r),o=E.S;null!==o&&o(s,l),cs(e,t,l)}catch(c){us(e,t,c)}finally{E.T=i}}else try{cs(e,t,i=n(a,r))}catch(d){us(e,t,d)}}function cs(e,t,n){null!==n&&"object"==typeof n&&"function"==typeof n.then?n.then(function(n){ds(e,t,n)},function(n){return us(e,t,n)}):ds(e,t,n)}function ds(e,t,n){t.status="fulfilled",t.value=n,hs(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,os(e,n)))}function us(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,hs(t),t=t.next}while(t!==r)}e.action=null}function hs(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function ms(e,t){return t}function ps(e,t){if(ua){var n=cc.formState;if(null!==n){e:{var r=Si;if(ua){if(da){t:{for(var a=da,i=ma;8!==a.nodeType;){if(!i){a=null;break t}if(null===(a=wu(a.nextSibling))){a=null;break t}}a="F!"===(i=a.data)||"F"===i?a:null}if(a){da=wu(a.nextSibling),r="F!"===a.data;break e}}fa(r)}r=!1}r&&(t=n[0])}}return(n=Hi()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ms,lastRenderedState:t},n.queue=r,n=Hs.bind(null,Si,r),r.dispatch=n,r=is(!1),i=qs.bind(null,Si,!1,r.queue),a={state:t,dispatch:null,action:e,pending:null},(r=Hi()).queue=a,n=ls.bind(null,Si,a,i,n),a.dispatch=n,r.memoizedState=e,[t,n,!1]}function fs(e){return gs(Wi(),Ni,e)}function gs(e,t,n){if(t=Gi(e,t,ms)[0],e=Xi(Qi)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var r=qi(t)}catch(s){if(s===Ga)throw Za;throw s}else r=t;var a=(t=Wi()).queue,i=a.dispatch;return n!==t.memoizedState&&(Si.flags|=2048,vs(9,{destroy:void 0,resource:void 0},xs.bind(null,a,n),null)),[r,i,e]}function xs(e,t){e.action=t}function ys(e){var t=Wi(),n=Ni;if(null!==n)return gs(t,n,e);Wi(),t=t.memoizedState;var r=(n=Wi()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function vs(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=Si.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Si.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function bs(){return Wi().memoizedState}function js(e,t,n,r){var a=Hi();r=void 0===r?null:r,Si.flags|=e,a.memoizedState=vs(1|t,{destroy:void 0,resource:void 0},n,r)}function ks(e,t,n,r){var a=Wi();r=void 0===r?null:r;var i=a.memoizedState.inst;null!==Ni&&null!==r&&Pi(r,Ni.memoizedState.deps)?a.memoizedState=vs(t,i,n,r):(Si.flags|=e,a.memoizedState=vs(1|t,i,n,r))}function ws(e,t){js(8390656,8,e,t)}function Cs(e,t){ks(2048,8,e,t)}function Ss(e,t){return ks(4,2,e,t)}function Ns(e,t){return ks(4,4,e,t)}function Ts(e,t){if("function"==typeof t){e=e();var n=t(e);return function(){"function"==typeof n?n():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function Is(e,t,n){n=null!=n?n.concat([e]):null,ks(4,4,Ts.bind(null,t,e),n)}function _s(){}function Ds(e,t){var n=Wi();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Pi(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Es(e,t){var n=Wi();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Pi(t,r[1]))return r[0];if(r=e(),Di){ce(!0);try{e()}finally{ce(!1)}}return n.memoizedState=[r,t],r}function Ls(e,t,n){return void 0===n||1073741824&Ci?e.memoizedState=t:(e.memoizedState=n,e=Vc(),Si.lanes|=e,vc|=e,n)}function As(e,t,n,r){return tr(n,t)?n:null!==vi.current?(e=Ls(e,n,r),tr(e,t)||(Ll=!0),e):42&Ci?(e=Vc(),Si.lanes|=e,vc|=e,t):(Ll=!0,e.memoizedState=n)}function zs(e,t,n,r,a){var i=L.p;L.p=0!==i&&8>i?i:8;var s,l,o,c=E.T,d={};E.T=d,qs(e,!1,t,n);try{var u=a(),h=E.S;null!==h&&h(d,u),null!==u&&"object"==typeof u&&"function"==typeof u.then?Ws(e,t,(s=r,l=[],o={status:"pending",value:null,reason:null,then:function(e){l.push(e)}},u.then(function(){o.status="fulfilled",o.value=s;for(var e=0;e<l.length;e++)(0,l[e])(s)},function(e){for(o.status="rejected",o.reason=e,e=0;e<l.length;e++)(0,l[e])(void 0)}),o),Bc()):Ws(e,t,r,Bc())}catch(m){Ws(e,t,{then:function(){},status:"rejected",reason:m},Bc())}finally{L.p=i,E.T=c}}function Fs(){}function Ps(e,t,n,a){if(5!==e.tag)throw Error(r(476));var i=Ms(e).queue;zs(e,i,t,A,null===n?Fs:function(){return Os(e),n(a)})}function Ms(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:A,baseState:A,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:A},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Os(e){Ws(e,Ms(e).next.queue,{},Bc())}function Rs(){return La(eh)}function Bs(){return Wi().memoizedState}function Vs(){return Wi().memoizedState}function Us(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Bc(),r=ui(t,e=di(n),n);return null!==r&&(Uc(r,0,n),hi(r,t,n)),t={cache:Ra()},void(e.payload=t)}t=t.return}}function $s(e,t,n){var r=Bc();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Ks(e)?Ys(t,n):null!==(n=Pr(e,t,n,r))&&(Uc(n,0,r),Qs(n,t,r))}function Hs(e,t,n){Ws(e,t,n,Bc())}function Ws(e,t,n,r){var a={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ks(e))Ys(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,l=i(s,n);if(a.hasEagerState=!0,a.eagerState=l,tr(l,s))return Fr(e,t,a,0),null===cc&&zr(),!1}catch(o){}if(null!==(n=Pr(e,t,a,r)))return Uc(n,0,r),Qs(n,t,r),!0}return!1}function qs(e,t,n,a){if(a={lane:2,revertLane:Fd(),action:a,hasEagerState:!1,eagerState:null,next:null},Ks(e)){if(t)throw Error(r(479))}else null!==(t=Pr(e,n,a,2))&&Uc(t,0,2)}function Ks(e){var t=e.alternate;return e===Si||null!==t&&t===Si}function Ys(e,t){_i=Ii=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Qs(e,t,n){if(4194048&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ce(e,n)}}var Xs={readContext:La,use:Ki,useCallback:Fi,useContext:Fi,useEffect:Fi,useImperativeHandle:Fi,useLayoutEffect:Fi,useInsertionEffect:Fi,useMemo:Fi,useReducer:Fi,useRef:Fi,useState:Fi,useDebugValue:Fi,useDeferredValue:Fi,useTransition:Fi,useSyncExternalStore:Fi,useId:Fi,useHostTransitionStatus:Fi,useFormState:Fi,useActionState:Fi,useOptimistic:Fi,useMemoCache:Fi,useCacheRefresh:Fi},Gs={readContext:La,use:Ki,useCallback:function(e,t){return Hi().memoizedState=[e,void 0===t?null:t],e},useContext:La,useEffect:ws,useImperativeHandle:function(e,t,n){n=null!=n?n.concat([e]):null,js(4194308,4,Ts.bind(null,t,e),n)},useLayoutEffect:function(e,t){return js(4194308,4,e,t)},useInsertionEffect:function(e,t){js(4,2,e,t)},useMemo:function(e,t){var n=Hi();t=void 0===t?null:t;var r=e();if(Di){ce(!0);try{e()}finally{ce(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Hi();if(void 0!==n){var a=n(t);if(Di){ce(!0);try{n(t)}finally{ce(!1)}}}else a=t;return r.memoizedState=r.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},r.queue=e,e=e.dispatch=$s.bind(null,Si,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Hi().memoizedState=e},useState:function(e){var t=(e=is(e)).queue,n=Hs.bind(null,Si,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:_s,useDeferredValue:function(e,t){return Ls(Hi(),e,t)},useTransition:function(){var e=is(!1);return e=zs.bind(null,Si,e.queue,!0,!1),Hi().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var a=Si,i=Hi();if(ua){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===cc)throw Error(r(349));124&uc||es(a,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,ws(ns.bind(null,a,s,e),[e]),a.flags|=2048,vs(9,{destroy:void 0,resource:void 0},ts.bind(null,a,s,n,t),null),n},useId:function(){var e=Hi(),t=cc.identifierPrefix;if(ua){var n=aa;t="«"+t+"R"+(n=(ra&~(1<<32-de(ra)-1)).toString(32)+n),(n=Ei++)>0&&(t+="H"+n.toString(32)),t+="»"}else t="«"+t+"r"+(n=zi++).toString(32)+"»";return e.memoizedState=t},useHostTransitionStatus:Rs,useFormState:ps,useActionState:ps,useOptimistic:function(e){var t=Hi();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=qs.bind(null,Si,!0,n),n.dispatch=t,[e,t]},useMemoCache:Yi,useCacheRefresh:function(){return Hi().memoizedState=Us.bind(null,Si)}},Js={readContext:La,use:Ki,useCallback:Ds,useContext:La,useEffect:Cs,useImperativeHandle:Is,useInsertionEffect:Ss,useLayoutEffect:Ns,useMemo:Es,useReducer:Xi,useRef:bs,useState:function(){return Xi(Qi)},useDebugValue:_s,useDeferredValue:function(e,t){return As(Wi(),Ni.memoizedState,e,t)},useTransition:function(){var e=Xi(Qi)[0],t=Wi().memoizedState;return["boolean"==typeof e?e:qi(e),t]},useSyncExternalStore:Zi,useId:Bs,useHostTransitionStatus:Rs,useFormState:fs,useActionState:fs,useOptimistic:function(e,t){return ss(Wi(),0,e,t)},useMemoCache:Yi,useCacheRefresh:Vs},Zs={readContext:La,use:Ki,useCallback:Ds,useContext:La,useEffect:Cs,useImperativeHandle:Is,useInsertionEffect:Ss,useLayoutEffect:Ns,useMemo:Es,useReducer:Ji,useRef:bs,useState:function(){return Ji(Qi)},useDebugValue:_s,useDeferredValue:function(e,t){var n=Wi();return null===Ni?Ls(n,e,t):As(n,Ni.memoizedState,e,t)},useTransition:function(){var e=Ji(Qi)[0],t=Wi().memoizedState;return["boolean"==typeof e?e:qi(e),t]},useSyncExternalStore:Zi,useId:Bs,useHostTransitionStatus:Rs,useFormState:ys,useActionState:ys,useOptimistic:function(e,t){var n=Wi();return null!==Ni?ss(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Yi,useCacheRefresh:Vs},el=null,tl=0;function nl(e){var t=tl;return tl+=1,null===el&&(el=[]),ri(el,e,t)}function rl(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function al(e,t){if(t.$$typeof===d)throw Error(r(525));throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function il(e){return(0,e._init)(e._payload)}function sl(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function a(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Hr(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?n>(r=r.index)?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function l(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function o(e,t,n,r){return null===t||6!==t.tag?((t=Yr(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===m?p(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===w&&il(a)===t.type)?(rl(t=i(t,n.props),n),t.return=e,t):(rl(t=qr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Qr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function p(e,t,n,r,a){return null===t||7!==t.tag?((t=Kr(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=Yr(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case u:return rl(n=qr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case h:return(t=Qr(t,e.mode,n)).return=e,t;case w:return f(e,t=(0,t._init)(t._payload),n)}if(D(t)||T(t))return(t=Kr(t,e.mode,n,null)).return=e,t;if("function"==typeof t.then)return f(e,nl(t),n);if(t.$$typeof===y)return f(e,Aa(e,t),n);al(e,t)}return null}function g(e,t,n,r){var a=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return null!==a?null:o(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case u:return n.key===a?c(e,t,n,r):null;case h:return n.key===a?d(e,t,n,r):null;case w:return g(e,t,n=(a=n._init)(n._payload),r)}if(D(n)||T(n))return null!==a?null:p(e,t,n,r,null);if("function"==typeof n.then)return g(e,t,nl(n),r);if(n.$$typeof===y)return g(e,t,Aa(e,n),r);al(e,n)}return null}function x(e,t,n,r,a){if("string"==typeof r&&""!==r||"number"==typeof r||"bigint"==typeof r)return o(t,e=e.get(n)||null,""+r,a);if("object"==typeof r&&null!==r){switch(r.$$typeof){case u:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case h:return d(t,e=e.get(null===r.key?n:r.key)||null,r,a);case w:return x(e,t,n,r=(0,r._init)(r._payload),a)}if(D(r)||T(r))return p(t,e=e.get(n)||null,r,a,null);if("function"==typeof r.then)return x(e,t,n,nl(r),a);if(r.$$typeof===y)return x(e,t,n,Aa(t,r),a);al(t,r)}return null}function v(o,c,d,p){if("object"==typeof d&&null!==d&&d.type===m&&null===d.key&&(d=d.props.children),"object"==typeof d&&null!==d){switch(d.$$typeof){case u:e:{for(var b=d.key;null!==c;){if(c.key===b){if((b=d.type)===m){if(7===c.tag){n(o,c.sibling),(p=i(c,d.props.children)).return=o,o=p;break e}}else if(c.elementType===b||"object"==typeof b&&null!==b&&b.$$typeof===w&&il(b)===c.type){n(o,c.sibling),rl(p=i(c,d.props),d),p.return=o,o=p;break e}n(o,c);break}t(o,c),c=c.sibling}d.type===m?((p=Kr(d.props.children,o.mode,p,d.key)).return=o,o=p):(rl(p=qr(d.type,d.key,d.props,null,o.mode,p),d),p.return=o,o=p)}return l(o);case h:e:{for(b=d.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){n(o,c.sibling),(p=i(c,d.children||[])).return=o,o=p;break e}n(o,c);break}t(o,c),c=c.sibling}(p=Qr(d,o.mode,p)).return=o,o=p}return l(o);case w:return v(o,c,d=(b=d._init)(d._payload),p)}if(D(d))return function(r,i,l,o){for(var c=null,d=null,u=i,h=i=0,m=null;null!==u&&h<l.length;h++){u.index>h?(m=u,u=null):m=u.sibling;var p=g(r,u,l[h],o);if(null===p){null===u&&(u=m);break}e&&u&&null===p.alternate&&t(r,u),i=s(p,i,h),null===d?c=p:d.sibling=p,d=p,u=m}if(h===l.length)return n(r,u),ua&&ia(r,h),c;if(null===u){for(;h<l.length;h++)null!==(u=f(r,l[h],o))&&(i=s(u,i,h),null===d?c=u:d.sibling=u,d=u);return ua&&ia(r,h),c}for(u=a(u);h<l.length;h++)null!==(m=x(u,r,h,l[h],o))&&(e&&null!==m.alternate&&u.delete(null===m.key?h:m.key),i=s(m,i,h),null===d?c=m:d.sibling=m,d=m);return e&&u.forEach(function(e){return t(r,e)}),ua&&ia(r,h),c}(o,c,d,p);if(T(d)){if("function"!=typeof(b=T(d)))throw Error(r(150));return function(i,l,o,c){if(null==o)throw Error(r(151));for(var d=null,u=null,h=l,m=l=0,p=null,y=o.next();null!==h&&!y.done;m++,y=o.next()){h.index>m?(p=h,h=null):p=h.sibling;var v=g(i,h,y.value,c);if(null===v){null===h&&(h=p);break}e&&h&&null===v.alternate&&t(i,h),l=s(v,l,m),null===u?d=v:u.sibling=v,u=v,h=p}if(y.done)return n(i,h),ua&&ia(i,m),d;if(null===h){for(;!y.done;m++,y=o.next())null!==(y=f(i,y.value,c))&&(l=s(y,l,m),null===u?d=y:u.sibling=y,u=y);return ua&&ia(i,m),d}for(h=a(h);!y.done;m++,y=o.next())null!==(y=x(h,i,m,y.value,c))&&(e&&null!==y.alternate&&h.delete(null===y.key?m:y.key),l=s(y,l,m),null===u?d=y:u.sibling=y,u=y);return e&&h.forEach(function(e){return t(i,e)}),ua&&ia(i,m),d}(o,c,d=b.call(d),p)}if("function"==typeof d.then)return v(o,c,nl(d),p);if(d.$$typeof===y)return v(o,c,Aa(o,d),p);al(o,d)}return"string"==typeof d&&""!==d||"number"==typeof d||"bigint"==typeof d?(d=""+d,null!==c&&6===c.tag?(n(o,c.sibling),(p=i(c,d)).return=o,o=p):(n(o,c),(p=Yr(d,o.mode,p)).return=o,o=p),l(o)):n(o,c)}return function(e,t,n,r){try{tl=0;var a=v(e,t,n,r);return el=null,a}catch(s){if(s===Ga||s===Za)throw s;var i=Ur(29,s,null,e.mode);return i.lanes=r,i.return=e,i}}}var ll=sl(!0),ol=sl(!1),cl=P(null),dl=null;function ul(e){var t=e.alternate;O(fl,1&fl.current),O(cl,e),null===dl&&(null===t||null!==vi.current||null!==t.memoizedState)&&(dl=e)}function hl(e){if(22===e.tag){if(O(fl,fl.current),O(cl,e),null===dl){var t=e.alternate;null!==t&&null!==t.memoizedState&&(dl=e)}}else ml()}function ml(){O(fl,fl.current),O(cl,cl.current)}function pl(e){M(cl),dl===e&&(dl=null),M(fl)}var fl=P(0);function gl(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||ku(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function xl(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:c({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var yl={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Bc(),a=di(r);a.payload=t,null!=n&&(a.callback=n),null!==(t=ui(e,a,r))&&(Uc(t,0,r),hi(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Bc(),a=di(r);a.tag=1,a.payload=t,null!=n&&(a.callback=n),null!==(t=ui(e,a,r))&&(Uc(t,0,r),hi(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Bc(),r=di(n);r.tag=2,null!=t&&(r.callback=t),null!==(t=ui(e,r,n))&&(Uc(t,0,n),hi(t,e,n))}};function vl(e,t,n,r,a,i,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!(t.prototype&&t.prototype.isPureReactComponent&&nr(n,r)&&nr(a,i))}function bl(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&yl.enqueueReplaceState(t,t.state,null)}function jl(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var a in n===t&&(n=c({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}var kl="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?e.message+"":e+"",error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e)};function wl(e){kl(e)}function Cl(e){}function Sl(e){kl(e)}function Nl(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Tl(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Il(e,t,n){return(n=di(n)).tag=3,n.payload={element:null},n.callback=function(){Nl(e,t)},n}function _l(e){return(e=di(e)).tag=3,e}function Dl(e,t,n,r){var a=n.type.getDerivedStateFromError;if("function"==typeof a){var i=r.value;e.payload=function(){return a(i)},e.callback=function(){Tl(t,n,r)}}var s=n.stateNode;null!==s&&"function"==typeof s.componentDidCatch&&(e.callback=function(){Tl(t,n,r),"function"!=typeof a&&(null===Dc?Dc=new Set([this]):Dc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var El=Error(r(461)),Ll=!1;function Al(e,t,n,r){t.child=null===e?ol(t,null,n,r):ll(t,e.child,n,r)}function zl(e,t,n,r,a){n=n.render;var i=t.ref;if("ref"in r){var s={};for(var l in r)"ref"!==l&&(s[l]=r[l])}else s=r;return Ea(t),r=Mi(e,t,n,s,i,a),l=Vi(),null===e||Ll?(ua&&l&&la(t),t.flags|=1,Al(e,t,r,a),t.child):(Ui(e,t,a),eo(e,t,a))}function Fl(e,t,n,r,a){if(null===e){var i=n.type;return"function"!=typeof i||$r(i)||void 0!==i.defaultProps||null!==n.compare?((e=qr(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Pl(e,t,i,r,a))}if(i=e.child,!to(e,a)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:nr)(s,r)&&e.ref===t.ref)return eo(e,t,a)}return t.flags|=1,(e=Hr(i,r)).ref=t.ref,e.return=t,t.child=e}function Pl(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(nr(i,r)&&e.ref===t.ref){if(Ll=!1,t.pendingProps=r=i,!to(e,a))return t.lanes=e.lanes,eo(e,t,a);131072&e.flags&&(Ll=!0)}}return Bl(e,t,n,r,a)}function Ml(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode){if(128&t.flags){if(r=null!==i?i.baseLanes|n:n,null!==e){for(a=t.child=e.child,i=0;null!==a;)i=i|a.lanes|a.childLanes,a=a.sibling;t.childLanes=i&~r}else t.childLanes=0,t.child=null;return Ol(e,t,r,n)}if(!(536870912&n))return t.lanes=t.childLanes=536870912,Ol(e,t,null!==i?i.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Qa(0,null!==i?i.cachePool:null),null!==i?ji(t,i):ki(),hl(t)}else null!==i?(Qa(0,i.cachePool),ji(t,i),ml(),t.memoizedState=null):(null!==e&&Qa(0,null),ki(),ml());return Al(e,t,a,n),t.child}function Ol(e,t,n,r){var a=Ya();return a=null===a?null:{parent:Oa._currentValue,pool:a},t.memoizedState={baseLanes:n,cachePool:a},null!==e&&Qa(0,null),ki(),hl(t),null!==e&&_a(e,t,r,!0),null}function Rl(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof n&&"object"!=typeof n)throw Error(r(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Bl(e,t,n,r,a){return Ea(t),n=Mi(e,t,n,r,void 0,a),r=Vi(),null===e||Ll?(ua&&r&&la(t),t.flags|=1,Al(e,t,n,a),t.child):(Ui(e,t,a),eo(e,t,a))}function Vl(e,t,n,r,a,i){return Ea(t),t.updateQueue=null,n=Ri(t,r,n,a),Oi(e),r=Vi(),null===e||Ll?(ua&&r&&la(t),t.flags|=1,Al(e,t,n,i),t.child):(Ui(e,t,i),eo(e,t,i))}function Ul(e,t,n,r,a){if(Ea(t),null===t.stateNode){var i=Br,s=n.contextType;"object"==typeof s&&null!==s&&(i=La(s)),i=new n(r,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=yl,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=r,i.state=t.memoizedState,i.refs={},oi(t),s=n.contextType,i.context="object"==typeof s&&null!==s?La(s):Br,i.state=t.memoizedState,"function"==typeof(s=n.getDerivedStateFromProps)&&(xl(t,n,s,r),i.state=t.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(s=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),s!==i.state&&yl.enqueueReplaceState(i,i.state,null),gi(t,r,i,a),fi(),i.state=t.memoizedState),"function"==typeof i.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){i=t.stateNode;var l=t.memoizedProps,o=jl(n,l);i.props=o;var c=i.context,d=n.contextType;s=Br,"object"==typeof d&&null!==d&&(s=La(d));var u=n.getDerivedStateFromProps;d="function"==typeof u||"function"==typeof i.getSnapshotBeforeUpdate,l=t.pendingProps!==l,d||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(l||c!==s)&&bl(t,i,r,s),li=!1;var h=t.memoizedState;i.state=h,gi(t,r,i,a),fi(),c=t.memoizedState,l||h!==c||li?("function"==typeof u&&(xl(t,n,u,r),c=t.memoizedState),(o=li||vl(t,n,o,r,h,c,s))?(d||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=s,r=o):("function"==typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,ci(e,t),d=jl(n,s=t.memoizedProps),i.props=d,u=t.pendingProps,h=i.context,c=n.contextType,o=Br,"object"==typeof c&&null!==c&&(o=La(c)),(c="function"==typeof(l=n.getDerivedStateFromProps)||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(s!==u||h!==o)&&bl(t,i,r,o),li=!1,h=t.memoizedState,i.state=h,gi(t,r,i,a),fi();var m=t.memoizedState;s!==u||h!==m||li||null!==e&&null!==e.dependencies&&Da(e.dependencies)?("function"==typeof l&&(xl(t,n,l,r),m=t.memoizedState),(d=li||vl(t,n,d,r,h,m,o)||null!==e&&null!==e.dependencies&&Da(e.dependencies))?(c||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(r,m,o),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,m,o)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),i.props=r,i.state=m,i.context=o,r=d):("function"!=typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return i=r,Rl(e,t),r=!!(128&t.flags),i||r?(i=t.stateNode,n=r&&"function"!=typeof n.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&r?(t.child=ll(t,e.child,null,a),t.child=ll(t,null,n,a)):Al(e,t,n,a),t.memoizedState=i.state,e=t.child):e=eo(e,t,a),e}function $l(e,t,n,r){return va(),t.flags|=256,Al(e,t,n,r),t.child}var Hl={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Wl(e){return{baseLanes:e,cachePool:Xa()}}function ql(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=kc),e}function Kl(e,t,n){var a,i=t.pendingProps,s=!1,l=!!(128&t.flags);if((a=l)||(a=(null===e||null!==e.memoizedState)&&!!(2&fl.current)),a&&(s=!0,t.flags&=-129),a=!!(32&t.flags),t.flags&=-33,null===e){if(ua){if(s?ul(t):ml(),ua){var o,c=da;if(o=c){e:{for(o=c,c=ma;8!==o.nodeType;){if(!c){c=null;break e}if(null===(o=wu(o.nextSibling))){c=null;break e}}c=o}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==na?{id:ra,overflow:aa}:null,retryLane:536870912,hydrationErrors:null},(o=Ur(18,null,null,0)).stateNode=c,o.return=t,t.child=o,ca=t,da=null,o=!0):o=!1}o||fa(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return ku(c)?t.lanes=32:t.lanes=536870912,null;pl(t)}return c=i.children,i=i.fallback,s?(ml(),c=Ql({mode:"hidden",children:c},s=t.mode),i=Kr(i,s,n,null),c.return=t,i.return=t,c.sibling=i,t.child=c,(s=t.child).memoizedState=Wl(n),s.childLanes=ql(e,a,n),t.memoizedState=Hl,i):(ul(t),Yl(t,c))}if(null!==(o=e.memoizedState)&&null!==(c=o.dehydrated)){if(l)256&t.flags?(ul(t),t.flags&=-257,t=Xl(e,t,n)):null!==t.memoizedState?(ml(),t.child=e.child,t.flags|=128,t=null):(ml(),s=i.fallback,c=t.mode,i=Ql({mode:"visible",children:i.children},c),(s=Kr(s,c,n,null)).flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,ll(t,e.child,null,n),(i=t.child).memoizedState=Wl(n),i.childLanes=ql(e,a,n),t.memoizedState=Hl,t=s);else if(ul(t),ku(c)){if(a=c.nextSibling&&c.nextSibling.dataset)var d=a.dgst;a=d,(i=Error(r(419))).stack="",i.digest=a,ja({value:i,source:null,stack:null}),t=Xl(e,t,n)}else if(Ll||_a(e,t,n,!1),a=0!==(n&e.childLanes),Ll||a){if(null!==(a=cc)&&0!==(i=0!==((i=42&(i=n&-n)?1:Se(i))&(a.suspendedLanes|n))?0:i)&&i!==o.retryLane)throw o.retryLane=i,Mr(e,i),Uc(a,0,i),El;"$?"===c.data||Zc(),t=Xl(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=o.treeContext,da=wu(c.nextSibling),ca=t,ua=!0,ha=null,ma=!1,null!==e&&(ea[ta++]=ra,ea[ta++]=aa,ea[ta++]=na,ra=e.id,aa=e.overflow,na=t),(t=Yl(t,i.children)).flags|=4096);return t}return s?(ml(),s=i.fallback,c=t.mode,d=(o=e.child).sibling,(i=Hr(o,{mode:"hidden",children:i.children})).subtreeFlags=65011712&o.subtreeFlags,null!==d?s=Hr(d,s):(s=Kr(s,c,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,null===(c=e.child.memoizedState)?c=Wl(n):(null!==(o=c.cachePool)?(d=Oa._currentValue,o=o.parent!==d?{parent:d,pool:d}:o):o=Xa(),c={baseLanes:c.baseLanes|n,cachePool:o}),s.memoizedState=c,s.childLanes=ql(e,a,n),t.memoizedState=Hl,i):(ul(t),e=(n=e.child).sibling,(n=Hr(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(a=t.deletions)?(t.deletions=[e],t.flags|=16):a.push(e)),t.child=n,t.memoizedState=null,n)}function Yl(e,t){return(t=Ql({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Ql(e,t){return(e=Ur(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Xl(e,t,n){return ll(t,e.child,null,n),(e=Yl(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Gl(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ta(e.return,t,n)}function Jl(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Zl(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(Al(e,t,r.children,n),2&(r=fl.current))r=1&r|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Gl(e,n,t);else if(19===e.tag)Gl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(O(fl,r),a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===gl(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Jl(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===gl(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Jl(t,!0,n,null,i);break;case"together":Jl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function eo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),vc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(_a(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=Hr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Hr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function to(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Da(e))}function no(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ll=!0;else{if(!(to(e,n)||128&t.flags))return Ll=!1,function(e,t,n){switch(t.tag){case 3:$(t,t.stateNode.containerInfo),Sa(0,Oa,e.memoizedState.cache),va();break;case 27:case 5:W(t);break;case 4:$(t,t.stateNode.containerInfo);break;case 10:Sa(0,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(ul(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Kl(e,t,n):(ul(t),null!==(e=eo(e,t,n))?e.sibling:null);ul(t);break;case 19:var a=!!(128&e.flags);if((r=0!==(n&t.childLanes))||(_a(e,t,n,!1),r=0!==(n&t.childLanes)),a){if(r)return Zl(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),O(fl,fl.current),r)break;return null;case 22:case 23:return t.lanes=0,Ml(e,t,n);case 24:Sa(0,Oa,e.memoizedState.cache)}return eo(e,t,n)}(e,t,n);Ll=!!(131072&e.flags)}else Ll=!1,ua&&1048576&t.flags&&sa(t,Zr,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var a=t.elementType,i=a._init;if(a=i(a._payload),t.type=a,"function"!=typeof a){if(null!=a){if((i=a.$$typeof)===v){t.tag=11,t=zl(null,t,a,e,n);break e}if(i===k){t.tag=14,t=Fl(null,t,a,e,n);break e}}throw t=_(a)||a,Error(r(306,t,""))}$r(a)?(e=jl(a,e),t.tag=1,t=Ul(null,t,a,e,n)):(t.tag=0,t=Bl(null,t,a,e,n))}return t;case 0:return Bl(e,t,t.type,t.pendingProps,n);case 1:return Ul(e,t,a=t.type,i=jl(a,t.pendingProps),n);case 3:e:{if($(t,t.stateNode.containerInfo),null===e)throw Error(r(387));a=t.pendingProps;var s=t.memoizedState;i=s.element,ci(e,t),gi(t,a,null,n);var l=t.memoizedState;if(a=l.cache,Sa(0,Oa,a),a!==s.cache&&Ia(t,[Oa],n,!0),fi(),a=l.element,s.isDehydrated){if(s={element:a,isDehydrated:!1,cache:l.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=$l(e,t,a,n);break e}if(a!==i){ja(i=Dr(Error(r(424)),t)),t=$l(e,t,a,n);break e}for(e=9===(e=t.stateNode.containerInfo).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,da=wu(e.firstChild),ca=t,ua=!0,ha=null,ma=!0,n=ol(t,null,a,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(va(),a===i){t=eo(e,t,n);break e}Al(e,t,a,n)}t=t.child}return t;case 26:return Rl(e,t),null===e?(n=zu(t.type,null,t.pendingProps,null))?t.memoizedState=n:ua||(n=t.type,e=t.pendingProps,(a=cu(V.current).createElement(n))[_e]=t,a[De]=e,su(a,n,e),Ue(a),t.stateNode=a):t.memoizedState=zu(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return W(t),null===e&&ua&&(a=t.stateNode=Nu(t.type,t.pendingProps,V.current),ca=t,ma=!0,i=da,vu(t.type)?(Cu=i,da=wu(a.firstChild)):da=i),Al(e,t,t.pendingProps.children,n),Rl(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ua&&((i=a=da)&&(null!==(a=function(e,t,n,r){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Pe])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===i)return e}if(null===(e=wu(e.nextSibling)))break}return null}(a,t.type,t.pendingProps,ma))?(t.stateNode=a,ca=t,da=wu(a.firstChild),ma=!1,i=!0):i=!1),i||fa(t)),W(t),i=t.type,s=t.pendingProps,l=null!==e?e.memoizedProps:null,a=s.children,hu(i,s)?a=null:null!==l&&hu(i,l)&&(t.flags|=32),null!==t.memoizedState&&(i=Mi(e,t,Bi,null,null,n),eh._currentValue=i),Rl(e,t),Al(e,t,a,n),t.child;case 6:return null===e&&ua&&((e=n=da)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=wu(e.nextSibling)))return null}return e}(n,t.pendingProps,ma))?(t.stateNode=n,ca=t,da=null,e=!0):e=!1),e||fa(t)),null;case 13:return Kl(e,t,n);case 4:return $(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=ll(t,null,a,n):Al(e,t,a,n),t.child;case 11:return zl(e,t,t.type,t.pendingProps,n);case 7:return Al(e,t,t.pendingProps,n),t.child;case 8:case 12:return Al(e,t,t.pendingProps.children,n),t.child;case 10:return a=t.pendingProps,Sa(0,t.type,a.value),Al(e,t,a.children,n),t.child;case 9:return i=t.type._context,a=t.pendingProps.children,Ea(t),a=a(i=La(i)),t.flags|=1,Al(e,t,a,n),t.child;case 14:return Fl(e,t,t.type,t.pendingProps,n);case 15:return Pl(e,t,t.type,t.pendingProps,n);case 19:return Zl(e,t,n);case 31:return a=t.pendingProps,n=t.mode,a={mode:a.mode,children:a.children},null===e?((n=Ql(a,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=Hr(e.child,a)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Ml(e,t,n);case 24:return Ea(t),a=La(Oa),null===e?(null===(i=Ya())&&(i=cc,s=Ra(),i.pooledCache=s,s.refCount++,null!==s&&(i.pooledCacheLanes|=n),i=s),t.memoizedState={parent:a,cache:i},oi(t),Sa(0,Oa,i)):(0!==(e.lanes&n)&&(ci(e,t),gi(t,null,null,n),fi()),i=e.memoizedState,s=t.memoizedState,i.parent!==a?(i={parent:a,cache:a},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),Sa(0,Oa,a)):(a=s.cache,Sa(0,Oa,a),a!==i.cache&&Ia(t,[Oa],n,!0))),Al(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(r(156,t.tag))}function ro(e){e.flags|=4}function ao(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!Ku(t)){if(null!==(t=cl.current)&&((4194048&uc)===uc?null!==dl:(62914560&uc)!==uc&&!(536870912&uc)||t!==dl))throw ai=ei,Ja;e.flags|=8192}}function io(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?be():536870912,e.lanes|=t,wc|=t)}function so(e,t){if(!ua)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function lo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=65011712&a.subtreeFlags,r|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function oo(e,t,n){var a=t.pendingProps;switch(oa(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return lo(t),null;case 3:return n=t.stateNode,a=null,null!==e&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),Na(Oa),H(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ya(t)?ro(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,ba())),lo(t),null;case 26:return n=t.memoizedState,null===e?(ro(t),null!==n?(lo(t),ao(t,n)):(lo(t),t.flags&=-16777217)):n?n!==e.memoizedState?(ro(t),lo(t),ao(t,n)):(lo(t),t.flags&=-16777217):(e.memoizedProps!==a&&ro(t),lo(t),t.flags&=-16777217),null;case 27:q(t),n=V.current;var i=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==a&&ro(t);else{if(!a){if(null===t.stateNode)throw Error(r(166));return lo(t),null}e=R.current,ya(t)?ga(t):(e=Nu(i,a,n),t.stateNode=e,ro(t))}return lo(t),null;case 5:if(q(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==a&&ro(t);else{if(!a){if(null===t.stateNode)throw Error(r(166));return lo(t),null}if(e=R.current,ya(t))ga(t);else{switch(i=cu(V.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"==typeof a.is?i.createElement("select",{is:a.is}):i.createElement("select"),a.multiple?e.multiple=!0:a.size&&(e.size=a.size);break;default:e="string"==typeof a.is?i.createElement(n,{is:a.is}):i.createElement(n)}}e[_e]=t,e[De]=a;e:for(i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;null===i.sibling;){if(null===i.return||i.return===t)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}t.stateNode=e;e:switch(su(e,n,a),n){case"button":case"input":case"select":case"textarea":e=!!a.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&ro(t)}}return lo(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==a&&ro(t);else{if("string"!=typeof a&&null===t.stateNode)throw Error(r(166));if(e=V.current,ya(t)){if(e=t.stateNode,n=t.memoizedProps,a=null,null!==(i=ca))switch(i.tag){case 27:case 5:a=i.memoizedProps}e[_e]=t,(e=!!(e.nodeValue===n||null!==a&&!0===a.suppressHydrationWarning||nu(e.nodeValue,n)))||fa(t)}else(e=cu(e).createTextNode(a))[_e]=t,t.stateNode=e}return lo(t),null;case 13:if(a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=ya(t),null!==a&&null!==a.dehydrated){if(null===e){if(!i)throw Error(r(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(r(317));i[_e]=t}else va(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;lo(t),i=!1}else i=ba(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(pl(t),t):(pl(t),null)}if(pl(t),128&t.flags)return t.lanes=n,t;if(n=null!==a,e=null!==e&&null!==e.memoizedState,n){i=null,null!==(a=t.child).alternate&&null!==a.alternate.memoizedState&&null!==a.alternate.memoizedState.cachePool&&(i=a.alternate.memoizedState.cachePool.pool);var s=null;null!==a.memoizedState&&null!==a.memoizedState.cachePool&&(s=a.memoizedState.cachePool.pool),s!==i&&(a.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),io(t,t.updateQueue),lo(t),null;case 4:return H(),null===e&&qd(t.stateNode.containerInfo),lo(t),null;case 10:return Na(t.type),lo(t),null;case 19:if(M(fl),null===(i=t.memoizedState))return lo(t),null;if(a=!!(128&t.flags),null===(s=i.rendering))if(a)so(i,!1);else{if(0!==yc||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(s=gl(e))){for(t.flags|=128,so(i,!1),e=s.updateQueue,t.updateQueue=e,io(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Wr(n,e),n=n.sibling;return O(fl,1&fl.current|2),t.child}e=e.sibling}null!==i.tail&&J()>Ic&&(t.flags|=128,a=!0,so(i,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=gl(s))){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,io(t,e),so(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate&&!ua)return lo(t),null}else 2*J()-i.renderingStartTime>Ic&&536870912!==n&&(t.flags|=128,a=!0,so(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=i.last)?e.sibling=s:t.child=s,i.last=s)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=J(),t.sibling=null,e=fl.current,O(fl,a?1&e|2:1&e),t):(lo(t),null);case 22:case 23:return pl(t),wi(),a=null!==t.memoizedState,null!==e?null!==e.memoizedState!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?!!(536870912&n)&&!(128&t.flags)&&(lo(t),6&t.subtreeFlags&&(t.flags|=8192)):lo(t),null!==(n=t.updateQueue)&&io(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),a=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(a=t.memoizedState.cachePool.pool),a!==n&&(t.flags|=2048),null!==e&&M(Ka),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Na(Oa),lo(t),null;case 25:case 30:return null}throw Error(r(156,t.tag))}function co(e,t){switch(oa(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Na(Oa),H(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return q(t),null;case 13:if(pl(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));va()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return M(fl),null;case 4:return H(),null;case 10:return Na(t.type),null;case 22:case 23:return pl(t),wi(),null!==e&&M(Ka),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Na(Oa),null;default:return null}}function uo(e,t){switch(oa(t),t.tag){case 3:Na(Oa),H();break;case 26:case 27:case 5:q(t);break;case 4:H();break;case 13:pl(t);break;case 19:M(fl);break;case 10:Na(t.type);break;case 22:case 23:pl(t),wi(),null!==e&&M(Ka);break;case 24:Na(Oa)}}function ho(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var a=r.next;n=a;do{if((n.tag&e)===e){r=void 0;var i=n.create,s=n.inst;r=i(),s.destroy=r}n=n.next}while(n!==a)}}catch(l){gd(t,t.return,l)}}function mo(e,t,n){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var i=a.next;r=i;do{if((r.tag&e)===e){var s=r.inst,l=s.destroy;if(void 0!==l){s.destroy=void 0,a=t;var o=n,c=l;try{c()}catch(d){gd(a,o,d)}}}r=r.next}while(r!==i)}}catch(d){gd(t,t.return,d)}}function po(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{yi(t,n)}catch(r){gd(e,e.return,r)}}}function fo(e,t,n){n.props=jl(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){gd(e,t,r)}}function go(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"==typeof n?e.refCleanup=n(r):n.current=r}}catch(a){gd(e,t,a)}}function xo(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"==typeof r)try{r()}catch(a){gd(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof n)try{n(null)}catch(i){gd(e,t,i)}else n.current=null}function yo(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(a){gd(e,e.return,a)}}function vo(e,t,n){try{var a=e.stateNode;!function(e,t,n,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,s=null,l=null,o=null,c=null,d=null,u=null;for(p in n){var h=n[p];if(n.hasOwnProperty(p)&&null!=h)switch(p){case"checked":case"value":break;case"defaultValue":c=h;default:a.hasOwnProperty(p)||au(e,t,p,null,a,h)}}for(var m in a){var p=a[m];if(h=n[m],a.hasOwnProperty(m)&&(null!=p||null!=h))switch(m){case"type":s=p;break;case"name":i=p;break;case"checked":d=p;break;case"defaultChecked":u=p;break;case"value":l=p;break;case"defaultValue":o=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(r(137,t));break;default:p!==h&&au(e,t,m,p,a,h)}}return void ft(e,l,o,c,d,u,s,i);case"select":for(s in p=l=o=m=null,n)if(c=n[s],n.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":p=c;default:a.hasOwnProperty(s)||au(e,t,s,null,a,c)}for(i in a)if(s=a[i],c=n[i],a.hasOwnProperty(i)&&(null!=s||null!=c))switch(i){case"value":m=s;break;case"defaultValue":o=s;break;case"multiple":l=s;default:s!==c&&au(e,t,i,s,a,c)}return t=o,n=l,a=p,void(null!=m?yt(e,!!n,m,!1):!!a!=!!n&&(null!=t?yt(e,!!n,t,!0):yt(e,!!n,n?[]:"",!1)));case"textarea":for(o in p=m=null,n)if(i=n[o],n.hasOwnProperty(o)&&null!=i&&!a.hasOwnProperty(o))switch(o){case"value":case"children":break;default:au(e,t,o,null,a,i)}for(l in a)if(i=a[l],s=n[l],a.hasOwnProperty(l)&&(null!=i||null!=s))switch(l){case"value":m=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(r(91));break;default:i!==s&&au(e,t,l,i,a,s)}return void vt(e,m,p);case"option":for(var f in n)m=n[f],n.hasOwnProperty(f)&&null!=m&&!a.hasOwnProperty(f)&&("selected"===f?e.selected=!1:au(e,t,f,null,a,m));for(c in a)m=a[c],p=n[c],!a.hasOwnProperty(c)||m===p||null==m&&null==p||("selected"===c?e.selected=m&&"function"!=typeof m&&"symbol"!=typeof m:au(e,t,c,m,a,p));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)m=n[g],n.hasOwnProperty(g)&&null!=m&&!a.hasOwnProperty(g)&&au(e,t,g,null,a,m);for(d in a)if(m=a[d],p=n[d],a.hasOwnProperty(d)&&m!==p&&(null!=m||null!=p))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(r(137,t));break;default:au(e,t,d,m,a,p)}return;default:if(It(t)){for(var x in n)m=n[x],n.hasOwnProperty(x)&&void 0!==m&&!a.hasOwnProperty(x)&&iu(e,t,x,void 0,a,m);for(u in a)m=a[u],p=n[u],!a.hasOwnProperty(u)||m===p||void 0===m&&void 0===p||iu(e,t,u,m,a,p);return}}for(var y in n)m=n[y],n.hasOwnProperty(y)&&null!=m&&!a.hasOwnProperty(y)&&au(e,t,y,null,a,m);for(h in a)m=a[h],p=n[h],!a.hasOwnProperty(h)||m===p||null==m&&null==p||au(e,t,h,m,a,p)}(a,e.type,n,t),a[De]=t}catch(i){gd(e,e.return,i)}}function bo(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&vu(e.type)||4===e.tag}function jo(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||bo(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&vu(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ko(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=ru));else if(4!==r&&(27===r&&vu(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(ko(e,t,n),e=e.sibling;null!==e;)ko(e,t,n),e=e.sibling}function wo(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&vu(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(wo(e,t,n),e=e.sibling;null!==e;)wo(e,t,n),e=e.sibling}function Co(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);su(t,r,n),t[_e]=e,t[De]=n}catch(i){gd(e,e.return,i)}}var So=!1,No=!1,To=!1,Io="function"==typeof WeakSet?WeakSet:Set,_o=null;function Do(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:$o(e,n),4&r&&ho(5,n);break;case 1:if($o(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){gd(n,n.return,s)}else{var a=jl(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(l){gd(n,n.return,l)}}64&r&&po(n),512&r&&go(n,n.return);break;case 3:if($o(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{yi(e,t)}catch(s){gd(n,n.return,s)}}break;case 27:null===t&&4&r&&Co(n);case 26:case 5:$o(e,n),null===t&&4&r&&yo(n),512&r&&go(n,n.return);break;case 12:$o(e,n);break;case 13:$o(e,n),4&r&&Po(e,n),64&r&&null!==(e=n.memoizedState)&&null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=bd.bind(null,n));break;case 22:if(!(r=null!==n.memoizedState||So)){t=null!==t&&null!==t.memoizedState||No,a=So;var i=No;So=r,(No=t)&&!i?Wo(e,n,!!(8772&n.subtreeFlags)):$o(e,n),So=a,No=i}break;case 30:break;default:$o(e,n)}}function Eo(e){var t=e.alternate;null!==t&&(e.alternate=null,Eo(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&Me(t),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Lo=null,Ao=!1;function zo(e,t,n){for(n=n.child;null!==n;)Fo(e,t,n),n=n.sibling}function Fo(e,t,n){if(oe&&"function"==typeof oe.onCommitFiberUnmount)try{oe.onCommitFiberUnmount(le,n)}catch(i){}switch(n.tag){case 26:No||xo(n,t),zo(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:No||xo(n,t);var r=Lo,a=Ao;vu(n.type)&&(Lo=n.stateNode,Ao=!1),zo(e,t,n),Tu(n.stateNode),Lo=r,Ao=a;break;case 5:No||xo(n,t);case 6:if(r=Lo,a=Ao,Lo=null,zo(e,t,n),Ao=a,null!==(Lo=r))if(Ao)try{(9===Lo.nodeType?Lo.body:"HTML"===Lo.nodeName?Lo.ownerDocument.body:Lo).removeChild(n.stateNode)}catch(s){gd(n,t,s)}else try{Lo.removeChild(n.stateNode)}catch(s){gd(n,t,s)}break;case 18:null!==Lo&&(Ao?(bu(9===(e=Lo).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Ah(e)):bu(Lo,n.stateNode));break;case 4:r=Lo,a=Ao,Lo=n.stateNode.containerInfo,Ao=!0,zo(e,t,n),Lo=r,Ao=a;break;case 0:case 11:case 14:case 15:No||mo(2,n,t),No||mo(4,n,t),zo(e,t,n);break;case 1:No||(xo(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount&&fo(n,t,r)),zo(e,t,n);break;case 21:zo(e,t,n);break;case 22:No=(r=No)||null!==n.memoizedState,zo(e,t,n),No=r;break;default:zo(e,t,n)}}function Po(e,t){if(null===t.memoizedState&&null!==(e=t.alternate)&&null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))try{Ah(e)}catch(n){gd(t,t.return,n)}}function Mo(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Io),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Io),t;default:throw Error(r(435,e.tag))}}(e);t.forEach(function(t){var r=jd.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}function Oo(e,t){var n=t.deletions;if(null!==n)for(var a=0;a<n.length;a++){var i=n[a],s=e,l=t,o=l;e:for(;null!==o;){switch(o.tag){case 27:if(vu(o.type)){Lo=o.stateNode,Ao=!1;break e}break;case 5:Lo=o.stateNode,Ao=!1;break e;case 3:case 4:Lo=o.stateNode.containerInfo,Ao=!0;break e}o=o.return}if(null===Lo)throw Error(r(160));Fo(s,l,i),Lo=null,Ao=!1,null!==(s=i.alternate)&&(s.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Bo(t,e),t=t.sibling}var Ro=null;function Bo(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Oo(t,e),Vo(e),4&a&&(mo(3,e,e.return),ho(3,e),mo(5,e,e.return));break;case 1:Oo(t,e),Vo(e),512&a&&(No||null===n||xo(n,n.return)),64&a&&So&&null!==(e=e.updateQueue)&&null!==(a=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?a:n.concat(a));break;case 26:var i=Ro;if(Oo(t,e),Vo(e),512&a&&(No||null===n||xo(n,n.return)),4&a){var s=null!==n?n.memoizedState:null;if(a=e.memoizedState,null===n)if(null===a)if(null===e.stateNode){e:{a=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(a){case"title":(!(s=i.getElementsByTagName("title")[0])||s[Pe]||s[_e]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=i.createElement(a),i.head.insertBefore(s,i.querySelector("head > title"))),su(s,a,n),s[_e]=e,Ue(s),a=s;break e;case"link":var l=Wu("link","href",i).get(a+(n.href||""));if(l)for(var o=0;o<l.length;o++)if((s=l[o]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&s.getAttribute("rel")===(null==n.rel?null:n.rel)&&s.getAttribute("title")===(null==n.title?null:n.title)&&s.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){l.splice(o,1);break t}su(s=i.createElement(a),a,n),i.head.appendChild(s);break;case"meta":if(l=Wu("meta","content",i).get(a+(n.content||"")))for(o=0;o<l.length;o++)if((s=l[o]).getAttribute("content")===(null==n.content?null:""+n.content)&&s.getAttribute("name")===(null==n.name?null:n.name)&&s.getAttribute("property")===(null==n.property?null:n.property)&&s.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&s.getAttribute("charset")===(null==n.charSet?null:n.charSet)){l.splice(o,1);break t}su(s=i.createElement(a),a,n),i.head.appendChild(s);break;default:throw Error(r(468,a))}s[_e]=e,Ue(s),a=s}e.stateNode=a}else qu(i,e.type,e.stateNode);else e.stateNode=Bu(i,a,e.memoizedProps);else s!==a?(null===s?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):s.count--,null===a?qu(i,e.type,e.stateNode):Bu(i,a,e.memoizedProps)):null===a&&null!==e.stateNode&&vo(e,e.memoizedProps,n.memoizedProps)}break;case 27:Oo(t,e),Vo(e),512&a&&(No||null===n||xo(n,n.return)),null!==n&&4&a&&vo(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Oo(t,e),Vo(e),512&a&&(No||null===n||xo(n,n.return)),32&e.flags){i=e.stateNode;try{jt(i,"")}catch(p){gd(e,e.return,p)}}4&a&&null!=e.stateNode&&vo(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&a&&(To=!0);break;case 6:if(Oo(t,e),Vo(e),4&a){if(null===e.stateNode)throw Error(r(162));a=e.memoizedProps,n=e.stateNode;try{n.nodeValue=a}catch(p){gd(e,e.return,p)}}break;case 3:if(Hu=null,i=Ro,Ro=Du(t.containerInfo),Oo(t,e),Ro=i,Vo(e),4&a&&null!==n&&n.memoizedState.isDehydrated)try{Ah(t.containerInfo)}catch(p){gd(e,e.return,p)}To&&(To=!1,Uo(e));break;case 4:a=Ro,Ro=Du(e.stateNode.containerInfo),Oo(t,e),Vo(e),Ro=a;break;case 12:default:Oo(t,e),Vo(e);break;case 13:Oo(t,e),Vo(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==n&&null!==n.memoizedState)&&(Tc=J()),4&a&&null!==(a=e.updateQueue)&&(e.updateQueue=null,Mo(e,a));break;case 22:i=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,d=So,u=No;if(So=d||i,No=u||c,Oo(t,e),No=u,So=d,Vo(e),8192&a)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||c||So||No||Ho(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(s=c.stateNode,i)"function"==typeof(l=s.style).setProperty?l.setProperty("display","none","important"):l.display="none";else{o=c.stateNode;var h=c.memoizedProps.style,m=null!=h&&h.hasOwnProperty("display")?h.display:null;o.style.display=null==m||"boolean"==typeof m?"":(""+m).trim()}}catch(p){gd(c,c.return,p)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(p){gd(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&a&&null!==(a=e.updateQueue)&&null!==(n=a.retryQueue)&&(a.retryQueue=null,Mo(e,n));break;case 19:Oo(t,e),Vo(e),4&a&&null!==(a=e.updateQueue)&&(e.updateQueue=null,Mo(e,a));case 30:case 21:}}function Vo(e){var t=e.flags;if(2&t){try{for(var n,a=e.return;null!==a;){if(bo(a)){n=a;break}a=a.return}if(null==n)throw Error(r(160));switch(n.tag){case 27:var i=n.stateNode;wo(e,jo(e),i);break;case 5:var s=n.stateNode;32&n.flags&&(jt(s,""),n.flags&=-33),wo(e,jo(e),s);break;case 3:case 4:var l=n.stateNode.containerInfo;ko(e,jo(e),l);break;default:throw Error(r(161))}}catch(o){gd(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Uo(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Uo(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function $o(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Do(e,t.alternate,t),t=t.sibling}function Ho(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:mo(4,t,t.return),Ho(t);break;case 1:xo(t,t.return);var n=t.stateNode;"function"==typeof n.componentWillUnmount&&fo(t,t.return,n),Ho(t);break;case 27:Tu(t.stateNode);case 26:case 5:xo(t,t.return),Ho(t);break;case 22:null===t.memoizedState&&Ho(t);break;default:Ho(t)}e=e.sibling}}function Wo(e,t,n){for(n=n&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,a=e,i=t,s=i.flags;switch(i.tag){case 0:case 11:case 15:Wo(a,i,n),ho(4,i);break;case 1:if(Wo(a,i,n),"function"==typeof(a=(r=i).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){gd(r,r.return,c)}if(null!==(a=(r=i).updateQueue)){var l=r.stateNode;try{var o=a.shared.hiddenCallbacks;if(null!==o)for(a.shared.hiddenCallbacks=null,a=0;a<o.length;a++)xi(o[a],l)}catch(c){gd(r,r.return,c)}}n&&64&s&&po(i),go(i,i.return);break;case 27:Co(i);case 26:case 5:Wo(a,i,n),n&&null===r&&4&s&&yo(i),go(i,i.return);break;case 12:Wo(a,i,n);break;case 13:Wo(a,i,n),n&&4&s&&Po(a,i);break;case 22:null===i.memoizedState&&Wo(a,i,n),go(i,i.return);break;case 30:break;default:Wo(a,i,n)}t=t.sibling}}function qo(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Ba(n))}function Ko(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ba(e))}function Yo(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Qo(e,t,n,r),t=t.sibling}function Qo(e,t,n,r){var a=t.flags;switch(t.tag){case 0:case 11:case 15:Yo(e,t,n,r),2048&a&&ho(9,t);break;case 1:case 13:default:Yo(e,t,n,r);break;case 3:Yo(e,t,n,r),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ba(e)));break;case 12:if(2048&a){Yo(e,t,n,r),e=t.stateNode;try{var i=t.memoizedProps,s=i.id,l=i.onPostCommit;"function"==typeof l&&l(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(o){gd(t,t.return,o)}}else Yo(e,t,n,r);break;case 23:break;case 22:i=t.stateNode,s=t.alternate,null!==t.memoizedState?2&i._visibility?Yo(e,t,n,r):Go(e,t):2&i._visibility?Yo(e,t,n,r):(i._visibility|=2,Xo(e,t,n,r,!!(10256&t.subtreeFlags))),2048&a&&qo(s,t);break;case 24:Yo(e,t,n,r),2048&a&&Ko(t.alternate,t)}}function Xo(e,t,n,r,a){for(a=a&&!!(10256&t.subtreeFlags),t=t.child;null!==t;){var i=e,s=t,l=n,o=r,c=s.flags;switch(s.tag){case 0:case 11:case 15:Xo(i,s,l,o,a),ho(8,s);break;case 23:break;case 22:var d=s.stateNode;null!==s.memoizedState?2&d._visibility?Xo(i,s,l,o,a):Go(i,s):(d._visibility|=2,Xo(i,s,l,o,a)),a&&2048&c&&qo(s.alternate,s);break;case 24:Xo(i,s,l,o,a),a&&2048&c&&Ko(s.alternate,s);break;default:Xo(i,s,l,o,a)}t=t.sibling}}function Go(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,a=r.flags;switch(r.tag){case 22:Go(n,r),2048&a&&qo(r.alternate,r);break;case 24:Go(n,r),2048&a&&Ko(r.alternate,r);break;default:Go(n,r)}t=t.sibling}}var Jo=8192;function Zo(e){if(e.subtreeFlags&Jo)for(e=e.child;null!==e;)ec(e),e=e.sibling}function ec(e){switch(e.tag){case 26:Zo(e),e.flags&Jo&&null!==e.memoizedState&&function(e,t,n){if(null===Yu)throw Error(r(475));var a=Yu;if(!("stylesheet"!==t.type||"string"==typeof n.media&&!1===matchMedia(n.media).matches||4&t.state.loading)){if(null===t.instance){var i=Fu(n.href),s=e.querySelector(Pu(i));if(s)return null!==(e=s._p)&&"object"==typeof e&&"function"==typeof e.then&&(a.count++,a=Xu.bind(a),e.then(a,a)),t.state.loading|=4,t.instance=s,void Ue(s);s=e.ownerDocument||e,n=Mu(n),(i=Iu.get(i))&&Uu(n,i),Ue(s=s.createElement("link"));var l=s;l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),su(s,"link",n),t.instance=s}null===a.stylesheets&&(a.stylesheets=new Map),a.stylesheets.set(t,e),(e=t.state.preload)&&!(3&t.state.loading)&&(a.count++,t=Xu.bind(a),e.addEventListener("load",t),e.addEventListener("error",t))}}(Ro,e.memoizedState,e.memoizedProps);break;case 5:default:Zo(e);break;case 3:case 4:var t=Ro;Ro=Du(e.stateNode.containerInfo),Zo(e),Ro=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Jo,Jo=16777216,Zo(e),Jo=t):Zo(e))}}function tc(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function nc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];_o=r,ic(r,e)}tc(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)rc(e),e=e.sibling}function rc(e){switch(e.tag){case 0:case 11:case 15:nc(e),2048&e.flags&&mo(9,e,e.return);break;case 3:case 12:default:nc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,ac(e)):nc(e)}}function ac(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];_o=r,ic(r,e)}tc(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:mo(8,t,t.return),ac(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,ac(t));break;default:ac(t)}e=e.sibling}}function ic(e,t){for(;null!==_o;){var n=_o;switch(n.tag){case 0:case 11:case 15:mo(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Ba(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,_o=r;else e:for(n=e;null!==_o;){var a=(r=_o).sibling,i=r.return;if(Eo(r),r===n){_o=null;break e}if(null!==a){a.return=i,_o=a;break e}_o=i}}}var sc={getCacheForType:function(e){var t=La(Oa),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},lc="function"==typeof WeakMap?WeakMap:Map,oc=0,cc=null,dc=null,uc=0,hc=0,mc=null,pc=!1,fc=!1,gc=!1,xc=0,yc=0,vc=0,bc=0,jc=0,kc=0,wc=0,Cc=null,Sc=null,Nc=!1,Tc=0,Ic=1/0,_c=null,Dc=null,Ec=0,Lc=null,Ac=null,zc=0,Fc=0,Pc=null,Mc=null,Oc=0,Rc=null;function Bc(){return 2&oc&&0!==uc?uc&-uc:null!==E.T?0!==$a?$a:Fd():Te()}function Vc(){0===kc&&(kc=536870912&uc&&!ua?536870912:ve());var e=cl.current;return null!==e&&(e.flags|=32),kc}function Uc(e,t,n){(e!==cc||2!==hc&&9!==hc)&&null===e.cancelPendingCommit||(Qc(e,0),qc(e,uc,kc,!1)),ke(e,n),2&oc&&e===cc||(e===cc&&(!(2&oc)&&(bc|=n),4===yc&&qc(e,uc,kc,!1)),Id(e))}function $c(e,t,n){if(6&oc)throw Error(r(327));for(var a=!n&&!(124&t)&&0===(t&e.expiredLanes)||xe(e,t),i=a?function(e,t){var n=oc;oc|=2;var a=Gc(),i=Jc();cc!==e||uc!==t?(_c=null,Ic=J()+500,Qc(e,t)):fc=xe(e,t);e:for(;;)try{if(0!==hc&&null!==dc){t=dc;var s=mc;t:switch(hc){case 1:hc=0,mc=null,id(e,t,s,1);break;case 2:case 9:if(ti(s)){hc=0,mc=null,ad(t);break}t=function(){2!==hc&&9!==hc||cc!==e||(hc=7),Id(e)},s.then(t,t);break e;case 3:hc=7;break e;case 4:hc=5;break e;case 7:ti(s)?(hc=0,mc=null,ad(t)):(hc=0,mc=null,id(e,t,s,7));break;case 5:var l=null;switch(dc.tag){case 26:l=dc.memoizedState;case 5:case 27:var o=dc;if(!l||Ku(l)){hc=0,mc=null;var c=o.sibling;if(null!==c)dc=c;else{var d=o.return;null!==d?(dc=d,sd(d)):dc=null}break t}}hc=0,mc=null,id(e,t,s,5);break;case 6:hc=0,mc=null,id(e,t,s,6);break;case 8:Yc(),yc=6;break e;default:throw Error(r(462))}}nd();break}catch(u){Xc(e,u)}return Ca=wa=null,E.H=a,E.A=i,oc=n,null!==dc?0:(cc=null,uc=0,zr(),yc)}(e,t):ed(e,t,!0),s=a;;){if(0===i){fc&&!a&&qc(e,t,0,!1);break}if(n=e.current.alternate,!s||Wc(n)){if(2===i){if(s=t,e.errorRecoveryDisabledLanes&s)var l=0;else l=0!=(l=-536870913&e.pendingLanes)?l:536870912&l?536870912:0;if(0!==l){t=l;e:{var o=e;i=Cc;var c=o.current.memoizedState.isDehydrated;if(c&&(Qc(o,l).flags|=256),2!==(l=ed(o,l,!1))){if(gc&&!c){o.errorRecoveryDisabledLanes|=s,bc|=s,i=4;break e}s=Sc,Sc=i,null!==s&&(null===Sc?Sc=s:Sc.push.apply(Sc,s))}i=l}if(s=!1,2!==i)continue}}if(1===i){Qc(e,0),qc(e,t,0,!0);break}e:{switch(a=e,s=i){case 0:case 1:throw Error(r(345));case 4:if((4194048&t)!==t)break;case 6:qc(a,t,kc,!pc);break e;case 2:Sc=null;break;case 3:case 5:break;default:throw Error(r(329))}if((62914560&t)===t&&(i=Tc+300-J())>10){if(qc(a,t,kc,!pc),0!==ge(a,0,!0))break e;a.timeoutHandle=pu(Hc.bind(null,a,n,Sc,_c,Nc,t,kc,bc,wc,pc,s,2,-0,0),i)}else Hc(a,n,Sc,_c,Nc,t,kc,bc,wc,pc,s,0,-0,0)}break}i=ed(e,t,!1),s=!1}Id(e)}function Hc(e,t,n,a,i,s,l,o,c,d,u,h,m,p){if(e.timeoutHandle=-1,(8192&(h=t.subtreeFlags)||!(16785408&~h))&&(Yu={stylesheets:null,count:0,unsuspend:Qu},ec(t),null!==(h=function(){if(null===Yu)throw Error(r(475));var e=Yu;return e.stylesheets&&0===e.count&&Ju(e,e.stylesheets),e.count>0?function(t){var n=setTimeout(function(){if(e.stylesheets&&Ju(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=h(od.bind(null,e,t,s,n,a,i,l,o,c,u,1,m,p)),void qc(e,s,l,!d);od(e,t,s,n,a,i,l,o,c)}function Wc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&null!==(n=t.updateQueue)&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!tr(i(),a))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function qc(e,t,n,r){t&=~jc,t&=~bc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var a=t;a>0;){var i=31-de(a),s=1<<i;r[i]=-1,a&=~s}0!==n&&we(e,n,t)}function Kc(){return!!(6&oc)||(_d(0),!1)}function Yc(){if(null!==dc){if(0===hc)var e=dc.return;else Ca=wa=null,$i(e=dc),el=null,tl=0,e=dc;for(;null!==e;)uo(e.alternate,e),e=e.return;dc=null}}function Qc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,fu(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Yc(),cc=e,dc=n=Hr(e.current,null),uc=t,hc=0,mc=null,pc=!1,fc=xe(e,t),gc=!1,wc=kc=jc=bc=vc=yc=0,Sc=Cc=null,Nc=!1,8&t&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;r>0;){var a=31-de(r),i=1<<a;t|=e[a],r&=~i}return xc=t,zr(),n}function Xc(e,t){Si=null,E.H=Xs,t===Ga||t===Za?(t=ii(),hc=3):t===Ja?(t=ii(),hc=4):hc=t===El?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,mc=t,null===dc&&(yc=1,Nl(e,Dr(t,e.current)))}function Gc(){var e=E.H;return E.H=Xs,null===e?Xs:e}function Jc(){var e=E.A;return E.A=sc,e}function Zc(){yc=4,pc||(4194048&uc)!==uc&&null!==cl.current||(fc=!0),!(134217727&vc)&&!(134217727&bc)||null===cc||qc(cc,uc,kc,!1)}function ed(e,t,n){var r=oc;oc|=2;var a=Gc(),i=Jc();cc===e&&uc===t||(_c=null,Qc(e,t)),t=!1;var s=yc;e:for(;;)try{if(0!==hc&&null!==dc){var l=dc,o=mc;switch(hc){case 8:Yc(),s=6;break e;case 3:case 2:case 9:case 6:null===cl.current&&(t=!0);var c=hc;if(hc=0,mc=null,id(e,l,o,c),n&&fc){s=0;break e}break;default:c=hc,hc=0,mc=null,id(e,l,o,c)}}td(),s=yc;break}catch(d){Xc(e,d)}return t&&e.shellSuspendCounter++,Ca=wa=null,oc=r,E.H=a,E.A=i,null===dc&&(cc=null,uc=0,zr()),s}function td(){for(;null!==dc;)rd(dc)}function nd(){for(;null!==dc&&!X();)rd(dc)}function rd(e){var t=no(e.alternate,e,xc);e.memoizedProps=e.pendingProps,null===t?sd(e):dc=t}function ad(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Vl(n,t,t.pendingProps,t.type,void 0,uc);break;case 11:t=Vl(n,t,t.pendingProps,t.type.render,t.ref,uc);break;case 5:$i(t);default:uo(n,t),t=no(n,t=dc=Wr(t,xc),xc)}e.memoizedProps=e.pendingProps,null===t?sd(e):dc=t}function id(e,t,n,a){Ca=wa=null,$i(t),el=null,tl=0;var i=t.return;try{if(function(e,t,n,a,i){if(n.flags|=32768,null!==a&&"object"==typeof a&&"function"==typeof a.then){if(null!==(t=n.alternate)&&_a(t,n,i,!0),null!==(n=cl.current)){switch(n.tag){case 13:return null===dl?Zc():null===n.alternate&&0===yc&&(yc=3),n.flags&=-257,n.flags|=65536,n.lanes=i,a===ei?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([a]):t.add(a),xd(e,a,i)),!1;case 22:return n.flags|=65536,a===ei?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([a]):n.add(a),xd(e,a,i)),!1}throw Error(r(435,n.tag))}return xd(e,a,i),Zc(),!1}if(ua)return null!==(t=cl.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,a!==pa&&ja(Dr(e=Error(r(422),{cause:a}),n))):(a!==pa&&ja(Dr(t=Error(r(423),{cause:a}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,a=Dr(a,n),mi(e,i=Il(e.stateNode,a,i)),4!==yc&&(yc=2)),!1;var s=Error(r(520),{cause:a});if(s=Dr(s,n),null===Cc?Cc=[s]:Cc.push(s),4!==yc&&(yc=2),null===t)return!0;a=Dr(a,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,mi(n,e=Il(n.stateNode,a,e)),!1;case 1:if(t=n.type,s=n.stateNode,!(128&n.flags||"function"!=typeof t.getDerivedStateFromError&&(null===s||"function"!=typeof s.componentDidCatch||null!==Dc&&Dc.has(s))))return n.flags|=65536,i&=-i,n.lanes|=i,Dl(i=_l(i),e,n,a),mi(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,uc))return yc=1,Nl(e,Dr(n,e.current)),void(dc=null)}catch(s){if(null!==i)throw dc=i,s;return yc=1,Nl(e,Dr(n,e.current)),void(dc=null)}32768&t.flags?(ua||1===a?e=!0:fc||536870912&uc?e=!1:(pc=e=!0,(2===a||9===a||3===a||6===a)&&null!==(a=cl.current)&&13===a.tag&&(a.flags|=16384)),ld(t,e)):sd(t)}function sd(e){var t=e;do{if(32768&t.flags)return void ld(t,pc);e=t.return;var n=oo(t.alternate,t,xc);if(null!==n)return void(dc=n);if(null!==(t=t.sibling))return void(dc=t);dc=t=e}while(null!==t);0===yc&&(yc=5)}function ld(e,t){do{var n=co(e.alternate,e);if(null!==n)return n.flags&=32767,void(dc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(dc=e);dc=e=n}while(null!==e);yc=6,dc=null}function od(e,t,n,a,i,s,l,o,c){e.cancelPendingCommit=null;do{md()}while(0!==Ec);if(6&oc)throw Error(r(327));if(null!==t){if(t===e.current)throw Error(r(177));if(s=t.lanes|t.childLanes,function(e,t,n,r,a,i){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var l=e.entanglements,o=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;n>0;){var d=31-de(n),u=1<<d;l[d]=0,o[d]=-1;var h=c[d];if(null!==h)for(c[d]=null,d=0;d<h.length;d++){var m=h[d];null!==m&&(m.lane&=-536870913)}n&=~u}0!==r&&we(e,r,0),0!==i&&0===a&&0!==e.tag&&(e.suspendedLanes|=i&~(s&~t))}(e,n,s|=Ar,l,o,c),e===cc&&(dc=cc=null,uc=0),Ac=t,Lc=e,zc=n,Fc=s,Pc=i,Mc=a,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,Y(ne,function(){return pd(),null})):(e.callbackNode=null,e.callbackPriority=0),a=!!(13878&t.flags),13878&t.subtreeFlags||a){a=E.T,E.T=null,i=L.p,L.p=2,l=oc,oc|=4;try{!function(e,t){if(e=e.containerInfo,lu=oh,lr(e=sr(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(a&&0!==a.rangeCount){n=a.anchorNode;var i=a.anchorOffset,s=a.focusNode;a=a.focusOffset;try{n.nodeType,s.nodeType}catch(g){n=null;break e}var l=0,o=-1,c=-1,d=0,u=0,h=e,m=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(o=l+i),h!==s||0!==a&&3!==h.nodeType||(c=l+a),3===h.nodeType&&(l+=h.nodeValue.length),null!==(p=h.firstChild);)m=h,h=p;for(;;){if(h===e)break t;if(m===n&&++d===i&&(o=l),m===s&&++u===a&&(c=l),null!==(p=h.nextSibling))break;m=(h=m).parentNode}h=p}n=-1===o||-1===c?null:{start:o,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ou={focusedElem:e,selectionRange:n},oh=!1,_o=t;null!==_o;)if(e=(t=_o).child,1024&t.subtreeFlags&&null!==e)e.return=t,_o=e;else for(;null!==_o;){switch(s=(t=_o).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==s){e=void 0,n=t,i=s.memoizedProps,s=s.memoizedState,a=n.stateNode;try{var f=jl(n.type,i,(n.elementType,n.type));e=a.getSnapshotBeforeUpdate(f,s),a.__reactInternalSnapshotBeforeUpdate=e}catch(x){gd(n,n.return,x)}}break;case 3:if(1024&e)if(9===(n=(e=t.stateNode.containerInfo).nodeType))ju(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":ju(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(r(163))}if(null!==(e=t.sibling)){e.return=t.return,_o=e;break}_o=t.return}}(e,t)}finally{oc=l,L.p=i,E.T=a}}Ec=1,cd(),dd(),ud()}}function cd(){if(1===Ec){Ec=0;var e=Lc,t=Ac,n=!!(13878&t.flags);if(13878&t.subtreeFlags||n){n=E.T,E.T=null;var r=L.p;L.p=2;var a=oc;oc|=4;try{Bo(t,e);var i=ou,s=sr(e.containerInfo),l=i.focusedElem,o=i.selectionRange;if(s!==l&&l&&l.ownerDocument&&ir(l.ownerDocument.documentElement,l)){if(null!==o&&lr(l)){var c=o.start,d=o.end;if(void 0===d&&(d=c),"selectionStart"in l)l.selectionStart=c,l.selectionEnd=Math.min(d,l.value.length);else{var u=l.ownerDocument||document,h=u&&u.defaultView||window;if(h.getSelection){var m=h.getSelection(),p=l.textContent.length,f=Math.min(o.start,p),g=void 0===o.end?f:Math.min(o.end,p);!m.extend&&f>g&&(s=g,g=f,f=s);var x=ar(l,f),y=ar(l,g);if(x&&y&&(1!==m.rangeCount||m.anchorNode!==x.node||m.anchorOffset!==x.offset||m.focusNode!==y.node||m.focusOffset!==y.offset)){var v=u.createRange();v.setStart(x.node,x.offset),m.removeAllRanges(),f>g?(m.addRange(v),m.extend(y.node,y.offset)):(v.setEnd(y.node,y.offset),m.addRange(v))}}}}for(u=[],m=l;m=m.parentNode;)1===m.nodeType&&u.push({element:m,left:m.scrollLeft,top:m.scrollTop});for("function"==typeof l.focus&&l.focus(),l=0;l<u.length;l++){var b=u[l];b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}oh=!!lu,ou=lu=null}finally{oc=a,L.p=r,E.T=n}}e.current=t,Ec=2}}function dd(){if(2===Ec){Ec=0;var e=Lc,t=Ac,n=!!(8772&t.flags);if(8772&t.subtreeFlags||n){n=E.T,E.T=null;var r=L.p;L.p=2;var a=oc;oc|=4;try{Do(e,t.alternate,t)}finally{oc=a,L.p=r,E.T=n}}Ec=3}}function ud(){if(4===Ec||3===Ec){Ec=0,G();var e=Lc,t=Ac,n=zc,r=Mc;10256&t.subtreeFlags||10256&t.flags?Ec=5:(Ec=0,Ac=Lc=null,hd(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(Dc=null),Ne(n),t=t.stateNode,oe&&"function"==typeof oe.onCommitFiberRoot)try{oe.onCommitFiberRoot(le,t,void 0,!(128&~t.current.flags))}catch(o){}if(null!==r){t=E.T,a=L.p,L.p=2,E.T=null;try{for(var i=e.onRecoverableError,s=0;s<r.length;s++){var l=r[s];i(l.value,{componentStack:l.stack})}}finally{E.T=t,L.p=a}}3&zc&&md(),Id(e),a=e.pendingLanes,4194090&n&&42&a?e===Rc?Oc++:(Oc=0,Rc=e):Oc=0,_d(0)}}function hd(e,t){0===(e.pooledCacheLanes&=t)&&null!=(t=e.pooledCache)&&(e.pooledCache=null,Ba(t))}function md(e){return cd(),dd(),ud(),pd()}function pd(){if(5!==Ec)return!1;var e=Lc,t=Fc;Fc=0;var n=Ne(zc),a=E.T,i=L.p;try{L.p=32>n?32:n,E.T=null,n=Pc,Pc=null;var s=Lc,l=zc;if(Ec=0,Ac=Lc=null,zc=0,6&oc)throw Error(r(331));var o=oc;if(oc|=4,rc(s.current),Qo(s,s.current,l,n),oc=o,_d(0),oe&&"function"==typeof oe.onPostCommitFiberRoot)try{oe.onPostCommitFiberRoot(le,s)}catch(c){}return!0}finally{L.p=i,E.T=a,hd(e,t)}}function fd(e,t,n){t=Dr(n,t),null!==(e=ui(e,t=Il(e.stateNode,t,2),2))&&(ke(e,2),Id(e))}function gd(e,t,n){if(3===e.tag)fd(e,e,n);else for(;null!==t;){if(3===t.tag){fd(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Dc||!Dc.has(r))){e=Dr(n,e),null!==(r=ui(t,n=_l(2),2))&&(Dl(n,r,t,e),ke(r,2),Id(r));break}}t=t.return}}function xd(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new lc;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(gc=!0,a.add(n),e=yd.bind(null,e,t,n),t.then(e,e))}function yd(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,cc===e&&(uc&n)===n&&(4===yc||3===yc&&(62914560&uc)===uc&&300>J()-Tc?!(2&oc)&&Qc(e,0):jc|=n,wc===uc&&(wc=0)),Id(e)}function vd(e,t){0===t&&(t=be()),null!==(e=Mr(e,t))&&(ke(e,t),Id(e))}function bd(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),vd(e,n)}function jd(e,t){var n=0;switch(e.tag){case 13:var a=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(r(314))}null!==a&&a.delete(t),vd(e,n)}var kd=null,wd=null,Cd=!1,Sd=!1,Nd=!1,Td=0;function Id(e){e!==wd&&null===e.next&&(null===wd?kd=wd=e:wd=wd.next=e),Sd=!0,Cd||(Cd=!0,xu(function(){6&oc?Y(ee,Dd):Ed()}))}function _d(e,t){if(!Nd&&Sd){Nd=!0;do{for(var n=!1,r=kd;null!==r;){if(0!==e){var a=r.pendingLanes;if(0===a)var i=0;else{var s=r.suspendedLanes,l=r.pingedLanes;i=(1<<31-de(42|e)+1)-1,i=201326741&(i&=a&~(s&~l))?201326741&i|1:i?2|i:0}0!==i&&(n=!0,zd(r,i))}else i=uc,!(3&(i=ge(r,r===cc?i:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||xe(r,i)||(n=!0,zd(r,i));r=r.next}}while(n);Nd=!1}}function Dd(){Ed()}function Ed(){Sd=Cd=!1;var e,t=0;0!==Td&&(((e=window.event)&&"popstate"===e.type?e!==mu&&(mu=e,!0):(mu=null,!1))&&(t=Td),Td=0);for(var n=J(),r=null,a=kd;null!==a;){var i=a.next,s=Ld(a,n);0===s?(a.next=null,null===r?kd=i:r.next=i,null===i&&(wd=r)):(r=a,(0!==t||3&s)&&(Sd=!0)),a=i}_d(t)}function Ld(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=-62914561&e.pendingLanes;i>0;){var s=31-de(i),l=1<<s,o=a[s];-1===o?0!==(l&n)&&0===(l&r)||(a[s]=ye(l,t)):t>=o&&(e.expiredLanes|=l),i&=~l}if(n=uc,n=ge(e,e===(t=cc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===hc||9===hc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&Q(r),e.callbackNode=null,e.callbackPriority=0;if(!(3&n)||xe(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&Q(r),Ne(n)){case 2:case 8:n=te;break;case 32:default:n=ne;break;case 268435456:n=ae}return r=Ad.bind(null,e),n=Y(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&Q(r),e.callbackPriority=2,e.callbackNode=null,2}function Ad(e,t){if(0!==Ec&&5!==Ec)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(md()&&e.callbackNode!==n)return null;var r=uc;return 0===(r=ge(e,e===cc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:($c(e,r,t),Ld(e,J()),null!=e.callbackNode&&e.callbackNode===n?Ad.bind(null,e):null)}function zd(e,t){if(md())return null;$c(e,t,!0)}function Fd(){return 0===Td&&(Td=ve()),Td}function Pd(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:Et(""+e)}function Md(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Od=0;Od<Tr.length;Od++){var Rd=Tr[Od];Ir(Rd.toLowerCase(),"on"+(Rd[0].toUpperCase()+Rd.slice(1)))}Ir(vr,"onAnimationEnd"),Ir(br,"onAnimationIteration"),Ir(jr,"onAnimationStart"),Ir("dblclick","onDoubleClick"),Ir("focusin","onFocus"),Ir("focusout","onBlur"),Ir(kr,"onTransitionRun"),Ir(wr,"onTransitionStart"),Ir(Cr,"onTransitionCancel"),Ir(Sr,"onTransitionEnd"),qe("onMouseEnter",["mouseout","mouseover"]),qe("onMouseLeave",["mouseout","mouseover"]),qe("onPointerEnter",["pointerout","pointerover"]),qe("onPointerLeave",["pointerout","pointerover"]),We("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),We("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),We("onBeforeInput",["compositionend","keypress","textInput","paste"]),We("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),We("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),We("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bd));function Ud(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;s>=0;s--){var l=r[s],o=l.instance,c=l.currentTarget;if(l=l.listener,o!==i&&a.isPropagationStopped())break e;i=l,a.currentTarget=c;try{i(a)}catch(d){kl(d)}a.currentTarget=null,i=o}else for(s=0;s<r.length;s++){if(o=(l=r[s]).instance,c=l.currentTarget,l=l.listener,o!==i&&a.isPropagationStopped())break e;i=l,a.currentTarget=c;try{i(a)}catch(d){kl(d)}a.currentTarget=null,i=o}}}}function $d(e,t){var n=t[Le];void 0===n&&(n=t[Le]=new Set);var r=e+"__bubble";n.has(r)||(Kd(t,e,2,!1),n.add(r))}function Hd(e,t,n){var r=0;t&&(r|=4),Kd(n,e,r,t)}var Wd="_reactListening"+Math.random().toString(36).slice(2);function qd(e){if(!e[Wd]){e[Wd]=!0,$e.forEach(function(t){"selectionchange"!==t&&(Vd.has(t)||Hd(t,!1,e),Hd(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Wd]||(t[Wd]=!0,Hd("selectionchange",!1,t))}}function Kd(e,t,n,r){switch(fh(t)){case 2:var a=ch;break;case 8:a=dh;break;default:a=uh}n=a.bind(null,t,n,e),a=void 0,!Ht||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Yd(e,t,n,r,a){var s=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var l=r.tag;if(3===l||4===l){var o=r.stateNode.containerInfo;if(o===a)break;if(4===l)for(l=r.return;null!==l;){var c=l.tag;if((3===c||4===c)&&l.stateNode.containerInfo===a)return;l=l.return}for(;null!==o;){if(null===(l=Oe(o)))return;if(5===(c=l.tag)||6===c||26===c||27===c){r=s=l;continue e}o=o.parentNode}}r=r.return}Vt(function(){var r=s,a=Pt(n),l=[];e:{var o=Nr.get(e);if(void 0!==o){var c=an,d=e;switch(e){case"keypress":if(0===Xt(n))break e;case"keydown":case"keyup":c=bn;break;case"focusin":d="focus",c=un;break;case"focusout":d="blur",c=un;break;case"beforeblur":case"afterblur":c=un;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=cn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=dn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=kn;break;case vr:case br:case jr:c=hn;break;case Sr:c=wn;break;case"scroll":case"scrollend":c=ln;break;case"wheel":c=Cn;break;case"copy":case"cut":case"paste":c=mn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=jn;break;case"toggle":case"beforetoggle":c=Sn}var u=!!(4&t),h=!u&&("scroll"===e||"scrollend"===e),m=u?null!==o?o+"Capture":null:o;u=[];for(var p,f=r;null!==f;){var g=f;if(p=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===p||null===m||null!=(g=Ut(f,m))&&u.push(Qd(f,g,p)),h)break;f=f.return}u.length>0&&(o=new c(o,d,null,n,a),l.push({event:o,listeners:u}))}}if(!(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===Lt||!(d=n.relatedTarget||n.fromElement)||!Oe(d)&&!d[Ee])&&(c||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=r,null!==(d=(d=n.relatedTarget||n.toElement)?Oe(d):null)&&(h=i(d),u=d.tag,d!==h||5!==u&&27!==u&&6!==u)&&(d=null)):(c=null,d=r),c!==d)){if(u=cn,g="onMouseLeave",m="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=jn,g="onPointerLeave",m="onPointerEnter",f="pointer"),h=null==c?o:Be(c),p=null==d?o:Be(d),(o=new u(g,f+"leave",c,n,a)).target=h,o.relatedTarget=p,g=null,Oe(a)===r&&((u=new u(m,f+"enter",d,n,a)).target=p,u.relatedTarget=h,g=u),h=g,c&&d)e:{for(m=d,f=0,p=u=c;p;p=Gd(p))f++;for(p=0,g=m;g;g=Gd(g))p++;for(;f-p>0;)u=Gd(u),f--;for(;p-f>0;)m=Gd(m),p--;for(;f--;){if(u===m||null!==m&&u===m.alternate)break e;u=Gd(u),m=Gd(m)}u=null}else u=null;null!==c&&Jd(l,o,c,u,!1),null!==d&&null!==h&&Jd(l,h,d,u,!0)}if("select"===(c=(o=r?Be(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var x=Hn;else if(On(o))if(Wn)x=er;else{x=Jn;var y=Gn}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?r&&It(r.elementType)&&(x=Hn):x=Zn;switch(x&&(x=x(e,r))?Rn(l,x,n,a):(y&&y(e,o,r),"focusout"===e&&r&&"number"===o.type&&null!=r.memoizedProps.value&&xt(o,"number",o.value)),y=r?Be(r):window,e){case"focusin":(On(y)||"true"===y.contentEditable)&&(cr=y,dr=r,ur=null);break;case"focusout":ur=dr=cr=null;break;case"mousedown":hr=!0;break;case"contextmenu":case"mouseup":case"dragend":hr=!1,mr(l,n,a);break;case"selectionchange":if(or)break;case"keydown":case"keyup":mr(l,n,a)}var v;if(Tn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Pn?zn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(En&&"ko"!==n.locale&&(Pn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Pn&&(v=Qt()):(Kt="value"in(qt=a)?qt.value:qt.textContent,Pn=!0)),(y=Xd(r,b)).length>0&&(b=new pn(b,e,null,n,a),l.push({event:b,listeners:y}),(v||null!==(v=Fn(n)))&&(b.data=v))),(v=Dn?function(e,t){switch(e){case"compositionend":return Fn(t);case"keypress":return 32!==t.which?null:(An=!0,Ln);case"textInput":return(e=t.data)===Ln&&An?null:e;default:return null}}(e,n):function(e,t){if(Pn)return"compositionend"===e||!Tn&&zn(e,t)?(e=Qt(),Yt=Kt=qt=null,Pn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&t.char.length>1)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return En&&"ko"!==t.locale?null:t.data}}(e,n))&&(b=Xd(r,"onBeforeInput")).length>0&&(y=new pn("onBeforeInput","beforeinput",null,n,a),l.push({event:y,listeners:b}),y.data=v),function(e,t,n,r,a){if("submit"===t&&n&&n.stateNode===a){var i=Pd((a[De]||null).action),s=r.submitter;s&&null!==(t=(t=s[De]||null)?Pd(t.formAction):s.getAttribute("formAction"))&&(i=t,s=null);var l=new an("action","action",null,r,a);e.push({event:l,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Td){var e=s?Md(a,s):new FormData(a);Ps(n,{pending:!0,data:e,method:a.method,action:i},null,e)}}else"function"==typeof i&&(l.preventDefault(),e=s?Md(a,s):new FormData(a),Ps(n,{pending:!0,data:e,method:a.method,action:i},i,e))},currentTarget:a}]})}}(l,e,r,n,a)}Ud(l,t)})}function Qd(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Xd(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===i||(null!=(a=Ut(e,n))&&r.unshift(Qd(e,a,i)),null!=(a=Ut(e,t))&&r.push(Qd(e,a,i))),3===e.tag)return r;e=e.return}return[]}function Gd(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Jd(e,t,n,r,a){for(var i=t._reactName,s=[];null!==n&&n!==r;){var l=n,o=l.alternate,c=l.stateNode;if(l=l.tag,null!==o&&o===r)break;5!==l&&26!==l&&27!==l||null===c||(o=c,a?null!=(c=Ut(n,i))&&s.unshift(Qd(n,c,o)):a||null!=(c=Ut(n,i))&&s.push(Qd(n,c,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Zd=/\r\n?/g,eu=/\u0000|\uFFFD/g;function tu(e){return("string"==typeof e?e:""+e).replace(Zd,"\n").replace(eu,"")}function nu(e,t){return t=tu(t),tu(e)===t}function ru(){}function au(e,t,n,a,i,s){switch(n){case"children":"string"==typeof a?"body"===t||"textarea"===t&&""===a||jt(e,a):("number"==typeof a||"bigint"==typeof a)&&"body"!==t&&jt(e,""+a);break;case"className":Ze(e,"class",a);break;case"tabIndex":Ze(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":Ze(e,n,a);break;case"style":Ct(e,a,s);break;case"data":if("object"!==t){Ze(e,"data",a);break}case"src":case"href":if(""===a&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==a||"function"==typeof a||"symbol"==typeof a||"boolean"==typeof a){e.removeAttribute(n);break}a=Et(""+a),e.setAttribute(n,a);break;case"action":case"formAction":if("function"==typeof a){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof s&&("formAction"===n?("input"!==t&&au(e,t,"name",i.name,i,null),au(e,t,"formEncType",i.formEncType,i,null),au(e,t,"formMethod",i.formMethod,i,null),au(e,t,"formTarget",i.formTarget,i,null)):(au(e,t,"encType",i.encType,i,null),au(e,t,"method",i.method,i,null),au(e,t,"target",i.target,i,null))),null==a||"symbol"==typeof a||"boolean"==typeof a){e.removeAttribute(n);break}a=Et(""+a),e.setAttribute(n,a);break;case"onClick":null!=a&&(e.onclick=ru);break;case"onScroll":null!=a&&$d("scroll",e);break;case"onScrollEnd":null!=a&&$d("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!=typeof a||!("__html"in a))throw Error(r(61));if(null!=(n=a.__html)){if(null!=i.children)throw Error(r(60));e.innerHTML=n}}break;case"multiple":e.multiple=a&&"function"!=typeof a&&"symbol"!=typeof a;break;case"muted":e.muted=a&&"function"!=typeof a&&"symbol"!=typeof a;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==a||"function"==typeof a||"boolean"==typeof a||"symbol"==typeof a){e.removeAttribute("xlink:href");break}n=Et(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=a&&"function"!=typeof a&&"symbol"!=typeof a?e.setAttribute(n,""+a):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&"function"!=typeof a&&"symbol"!=typeof a?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===a?e.setAttribute(n,""):!1!==a&&null!=a&&"function"!=typeof a&&"symbol"!=typeof a?e.setAttribute(n,a):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null==a||"function"==typeof a||"symbol"==typeof a||isNaN(a)||1>a?e.removeAttribute(n):e.setAttribute(n,a);break;case"rowSpan":case"start":null==a||"function"==typeof a||"symbol"==typeof a||isNaN(a)?e.removeAttribute(n):e.setAttribute(n,a);break;case"popover":$d("beforetoggle",e),$d("toggle",e),Je(e,"popover",a);break;case"xlinkActuate":et(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":et(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":et(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":et(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":et(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":et(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":et(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":et(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":et(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":Je(e,"is",a);break;case"innerText":case"textContent":break;default:(2>=n.length||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&Je(e,n=_t.get(n)||n,a)}}function iu(e,t,n,a,i,s){switch(n){case"style":Ct(e,a,s);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!=typeof a||!("__html"in a))throw Error(r(61));if(null!=(n=a.__html)){if(null!=i.children)throw Error(r(60));e.innerHTML=n}}break;case"children":"string"==typeof a?jt(e,a):("number"==typeof a||"bigint"==typeof a)&&jt(e,""+a);break;case"onScroll":null!=a&&$d("scroll",e);break;case"onScrollEnd":null!=a&&$d("scrollend",e);break;case"onClick":null!=a&&(e.onclick=ru);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:He.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"==typeof(s=null!=(s=e[De]||null)?s[n]:null)&&e.removeEventListener(t,s,i),"function"!=typeof a)?n in e?e[n]=a:!0===a?e.setAttribute(n,""):Je(e,n,a):("function"!=typeof s&&null!==s&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,a,i)))}}function su(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$d("error",e),$d("load",e);var a,i=!1,s=!1;for(a in n)if(n.hasOwnProperty(a)){var l=n[a];if(null!=l)switch(a){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,t));default:au(e,t,a,l,n,null)}}return s&&au(e,t,"srcSet",n.srcSet,n,null),void(i&&au(e,t,"src",n.src,n,null));case"input":$d("invalid",e);var o=a=l=s=null,c=null,d=null;for(i in n)if(n.hasOwnProperty(i)){var u=n[i];if(null!=u)switch(i){case"name":s=u;break;case"type":l=u;break;case"checked":c=u;break;case"defaultChecked":d=u;break;case"value":a=u;break;case"defaultValue":o=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(r(137,t));break;default:au(e,t,i,u,n,null)}}return gt(e,a,o,c,d,l,s,!1),void dt(e);case"select":for(s in $d("invalid",e),i=l=a=null,n)if(n.hasOwnProperty(s)&&null!=(o=n[s]))switch(s){case"value":a=o;break;case"defaultValue":l=o;break;case"multiple":i=o;default:au(e,t,s,o,n,null)}return t=a,n=l,e.multiple=!!i,void(null!=t?yt(e,!!i,t,!1):null!=n&&yt(e,!!i,n,!0));case"textarea":for(l in $d("invalid",e),a=s=i=null,n)if(n.hasOwnProperty(l)&&null!=(o=n[l]))switch(l){case"value":i=o;break;case"defaultValue":s=o;break;case"children":a=o;break;case"dangerouslySetInnerHTML":if(null!=o)throw Error(r(91));break;default:au(e,t,l,o,n,null)}return bt(e,i,s,a),void dt(e);case"option":for(c in n)n.hasOwnProperty(c)&&null!=(i=n[c])&&("selected"===c?e.selected=i&&"function"!=typeof i&&"symbol"!=typeof i:au(e,t,c,i,n,null));return;case"dialog":$d("beforetoggle",e),$d("toggle",e),$d("cancel",e),$d("close",e);break;case"iframe":case"object":$d("load",e);break;case"video":case"audio":for(i=0;i<Bd.length;i++)$d(Bd[i],e);break;case"image":$d("error",e),$d("load",e);break;case"details":$d("toggle",e);break;case"embed":case"source":case"link":$d("error",e),$d("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in n)if(n.hasOwnProperty(d)&&null!=(i=n[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,t));default:au(e,t,d,i,n,null)}return;default:if(It(t)){for(u in n)n.hasOwnProperty(u)&&void 0!==(i=n[u])&&iu(e,t,u,i,n,void 0);return}}for(o in n)n.hasOwnProperty(o)&&null!=(i=n[o])&&au(e,t,o,i,n,null)}var lu=null,ou=null;function cu(e){return 9===e.nodeType?e:e.ownerDocument}function du(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function uu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function hu(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var mu=null,pu="function"==typeof setTimeout?setTimeout:void 0,fu="function"==typeof clearTimeout?clearTimeout:void 0,gu="function"==typeof Promise?Promise:void 0,xu="function"==typeof queueMicrotask?queueMicrotask:void 0!==gu?function(e){return gu.resolve(null).then(e).catch(yu)}:pu;function yu(e){setTimeout(function(){throw e})}function vu(e){return"head"===e}function bu(e,t){var n=t,r=0,a=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(r>0&&8>r){n=r;var s=e.ownerDocument;if(1&n&&Tu(s.documentElement),2&n&&Tu(s.body),4&n)for(Tu(n=s.head),s=n.firstChild;s;){var l=s.nextSibling,o=s.nodeName;s[Pe]||"SCRIPT"===o||"STYLE"===o||"LINK"===o&&"stylesheet"===s.rel.toLowerCase()||n.removeChild(s),s=l}}if(0===a)return e.removeChild(i),void Ah(t);a--}else"$"===n||"$?"===n||"$!"===n?a++:r=n.charCodeAt(0)-48;else r=0;n=i}while(n);Ah(t)}function ju(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":ju(n),Me(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function ku(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function wu(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var Cu=null;function Su(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function Nu(e,t,n){switch(t=cu(n),e){case"html":if(!(e=t.documentElement))throw Error(r(452));return e;case"head":if(!(e=t.head))throw Error(r(453));return e;case"body":if(!(e=t.body))throw Error(r(454));return e;default:throw Error(r(451))}}function Tu(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Me(e)}var Iu=new Map,_u=new Set;function Du(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Eu=L.d;L.d={f:function(){var e=Eu.f(),t=Kc();return e||t},r:function(e){var t=Re(e);null!==t&&5===t.tag&&"form"===t.type?Os(t):Eu.r(e)},D:function(e){Eu.D(e),Au("dns-prefetch",e,null)},C:function(e,t){Eu.C(e,t),Au("preconnect",e,t)},L:function(e,t,n){Eu.L(e,t,n);var r=Lu;if(r&&e&&t){var a='link[rel="preload"][as="'+pt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+pt(n.imageSrcSet)+'"]',"string"==typeof n.imageSizes&&(a+='[imagesizes="'+pt(n.imageSizes)+'"]')):a+='[href="'+pt(e)+'"]';var i=a;switch(t){case"style":i=Fu(e);break;case"script":i=Ou(e)}Iu.has(i)||(e=c({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Iu.set(i,e),null!==r.querySelector(a)||"style"===t&&r.querySelector(Pu(i))||"script"===t&&r.querySelector(Ru(i))||(su(t=r.createElement("link"),"link",e),Ue(t),r.head.appendChild(t)))}},m:function(e,t){Eu.m(e,t);var n=Lu;if(n&&e){var r=t&&"string"==typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+pt(r)+'"][href="'+pt(e)+'"]',i=a;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=Ou(e)}if(!Iu.has(i)&&(e=c({rel:"modulepreload",href:e},t),Iu.set(i,e),null===n.querySelector(a))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Ru(i)))return}su(r=n.createElement("link"),"link",e),Ue(r),n.head.appendChild(r)}}},X:function(e,t){Eu.X(e,t);var n=Lu;if(n&&e){var r=Ve(n).hoistableScripts,a=Ou(e),i=r.get(a);i||((i=n.querySelector(Ru(a)))||(e=c({src:e,async:!0},t),(t=Iu.get(a))&&$u(e,t),Ue(i=n.createElement("script")),su(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}},S:function(e,t,n){Eu.S(e,t,n);var r=Lu;if(r&&e){var a=Ve(r).hoistableStyles,i=Fu(e);t=t||"default";var s=a.get(i);if(!s){var l={loading:0,preload:null};if(s=r.querySelector(Pu(i)))l.loading=5;else{e=c({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Iu.get(i))&&Uu(e,n);var o=s=r.createElement("link");Ue(o),su(o,"link",e),o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),o.addEventListener("load",function(){l.loading|=1}),o.addEventListener("error",function(){l.loading|=2}),l.loading|=4,Vu(s,t,r)}s={type:"stylesheet",instance:s,count:1,state:l},a.set(i,s)}}},M:function(e,t){Eu.M(e,t);var n=Lu;if(n&&e){var r=Ve(n).hoistableScripts,a=Ou(e),i=r.get(a);i||((i=n.querySelector(Ru(a)))||(e=c({src:e,async:!0,type:"module"},t),(t=Iu.get(a))&&$u(e,t),Ue(i=n.createElement("script")),su(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}}};var Lu="undefined"==typeof document?null:document;function Au(e,t,n){var r=Lu;if(r&&"string"==typeof t&&t){var a=pt(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"==typeof n&&(a+='[crossorigin="'+n+'"]'),_u.has(a)||(_u.add(a),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(a)&&(su(t=r.createElement("link"),"link",e),Ue(t),r.head.appendChild(t)))}}function zu(e,t,n,a){var i,s,l,o,c=(c=V.current)?Du(c):null;if(!c)throw Error(r(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof n.precedence&&"string"==typeof n.href?(t=Fu(n.href),(a=(n=Ve(c).hoistableStyles).get(t))||(a={type:"style",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"==typeof n.href&&"string"==typeof n.precedence){e=Fu(n.href);var d=Ve(c).hoistableStyles,u=d.get(e);if(u||(c=c.ownerDocument||c,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,u),(d=c.querySelector(Pu(e)))&&!d._p&&(u.instance=d,u.state.loading=5),Iu.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Iu.set(e,n),d||(i=c,s=e,l=n,o=u.state,i.querySelector('link[rel="preload"][as="style"]['+s+"]")?o.loading=1:(s=i.createElement("link"),o.preload=s,s.addEventListener("load",function(){return o.loading|=1}),s.addEventListener("error",function(){return o.loading|=2}),su(s,"link",l),Ue(s),i.head.appendChild(s))))),t&&null===a)throw Error(r(528,""));return u}if(t&&null!==a)throw Error(r(529,""));return null;case"script":return t=n.async,"string"==typeof(n=n.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=Ou(n),(a=(n=Ve(c).hoistableScripts).get(t))||(a={type:"script",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,e))}}function Fu(e){return'href="'+pt(e)+'"'}function Pu(e){return'link[rel="stylesheet"]['+e+"]"}function Mu(e){return c({},e,{"data-precedence":e.precedence,precedence:null})}function Ou(e){return'[src="'+pt(e)+'"]'}function Ru(e){return"script[async]"+e}function Bu(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+pt(n.href)+'"]');if(a)return t.instance=a,Ue(a),a;var i=c({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return Ue(a=(e.ownerDocument||e).createElement("style")),su(a,"style",i),Vu(a,n.precedence,e),t.instance=a;case"stylesheet":i=Fu(n.href);var s=e.querySelector(Pu(i));if(s)return t.state.loading|=4,t.instance=s,Ue(s),s;a=Mu(n),(i=Iu.get(i))&&Uu(a,i),Ue(s=(e.ownerDocument||e).createElement("link"));var l=s;return l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),su(s,"link",a),t.state.loading|=4,Vu(s,n.precedence,e),t.instance=s;case"script":return s=Ou(n.src),(i=e.querySelector(Ru(s)))?(t.instance=i,Ue(i),i):(a=n,(i=Iu.get(s))&&$u(a=c({},n),i),Ue(i=(e=e.ownerDocument||e).createElement("script")),su(i,"link",a),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(r(443,t.type))}else"stylesheet"===t.type&&!(4&t.state.loading)&&(a=t.instance,t.state.loading|=4,Vu(a,n.precedence,e));return t.instance}function Vu(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=r.length?r[r.length-1]:null,i=a,s=0;s<r.length;s++){var l=r[s];if(l.dataset.precedence===t)i=l;else if(i!==a)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Uu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function $u(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Hu=null;function Wu(e,t,n){if(null===Hu){var r=new Map,a=Hu=new Map;a.set(n,r)}else(r=(a=Hu).get(n))||(r=new Map,a.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var i=n[a];if(!(i[Pe]||i[_e]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var s=i.getAttribute(t)||"";s=e+s;var l=r.get(s);l?l.push(i):r.set(s,[i])}}return r}function qu(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function Ku(e){return!!("stylesheet"!==e.type||3&e.state.loading)}var Yu=null;function Qu(){}function Xu(){if(this.count--,0===this.count)if(this.stylesheets)Ju(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Gu=null;function Ju(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Gu=new Map,t.forEach(Zu,e),Gu=null,Xu.call(e))}function Zu(e,t){if(!(4&t.state.loading)){var n=Gu.get(e);if(n)var r=n.get(null);else{n=new Map,Gu.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<a.length;i++){var s=a[i];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),r=s)}r&&n.set(null,r)}s=(a=t.instance).getAttribute("data-precedence"),(i=n.get(s)||r)===r&&n.set(null,a),n.set(s,a),this.count++,r=Xu.bind(this),a.addEventListener("load",r),a.addEventListener("error",r),i?i.parentNode.insertBefore(a,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var eh={$$typeof:y,Provider:null,Consumer:null,_currentValue:A,_currentValue2:A,_threadCount:0};function th(e,t,n,r,a,i,s,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=je(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=je(0),this.hiddenUpdates=je(null),this.identifierPrefix=r,this.onUncaughtError=a,this.onCaughtError=i,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function nh(e,t,n,r,a,i,s,l,o,c,d,u){return e=new th(e,t,n,s,l,o,c,u),t=1,!0===i&&(t|=24),i=Ur(3,null,null,t),e.current=i,i.stateNode=e,(t=Ra()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:r,isDehydrated:n,cache:t},oi(i),e}function rh(e){return e?e=Br:Br}function ah(e,t,n,r,a,i){a=rh(a),null===r.context?r.context=a:r.pendingContext=a,(r=di(t)).payload={element:n},null!==(i=void 0===i?null:i)&&(r.callback=i),null!==(n=ui(e,r,t))&&(Uc(n,0,t),hi(n,e,t))}function ih(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&t>n?n:t}}function sh(e,t){ih(e,t),(e=e.alternate)&&ih(e,t)}function lh(e){if(13===e.tag){var t=Mr(e,67108864);null!==t&&Uc(t,0,67108864),sh(e,67108864)}}var oh=!0;function ch(e,t,n,r){var a=E.T;E.T=null;var i=L.p;try{L.p=2,uh(e,t,n,r)}finally{L.p=i,E.T=a}}function dh(e,t,n,r){var a=E.T;E.T=null;var i=L.p;try{L.p=8,uh(e,t,n,r)}finally{L.p=i,E.T=a}}function uh(e,t,n,r){if(oh){var a=hh(r);if(null===a)Yd(e,t,r,mh,n),Ch(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return xh=Sh(xh,e,t,n,r,a),!0;case"dragenter":return yh=Sh(yh,e,t,n,r,a),!0;case"mouseover":return vh=Sh(vh,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return bh.set(i,Sh(bh.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,jh.set(i,Sh(jh.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Ch(e,r),4&t&&wh.indexOf(e)>-1){for(;null!==a;){var i=Re(a);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var s=fe(i.pendingLanes);if(0!==s){var l=i;for(l.pendingLanes|=2,l.entangledLanes|=2;s;){var o=1<<31-de(s);l.entanglements[1]|=o,s&=~o}Id(i),!(6&oc)&&(Ic=J()+500,_d(0))}}break;case 13:null!==(l=Mr(i,2))&&Uc(l,0,2),Kc(),sh(i,2)}if(null===(i=hh(r))&&Yd(e,t,r,mh,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Yd(e,t,r,null,n)}}function hh(e){return ph(e=Pt(e))}var mh=null;function ph(e){if(mh=null,null!==(e=Oe(e))){var t=i(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=s(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return mh=e,null}function fh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Z()){case ee:return 2;case te:return 8;case ne:case re:return 32;case ae:return 268435456;default:return 32}default:return 32}}var gh=!1,xh=null,yh=null,vh=null,bh=new Map,jh=new Map,kh=[],wh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ch(e,t){switch(e){case"focusin":case"focusout":xh=null;break;case"dragenter":case"dragleave":yh=null;break;case"mouseover":case"mouseout":vh=null;break;case"pointerover":case"pointerout":bh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":jh.delete(t.pointerId)}}function Sh(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&null!==(t=Re(t))&&lh(t),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Nh(e){var t=Oe(e.target);if(null!==t){var n=i(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=s(n)))return e.blockedOn=t,void function(e){var t=L.p;try{return L.p=e,function(){if(13===n.tag){var e=Bc();e=Se(e);var t=Mr(n,e);null!==t&&Uc(t,0,e),sh(n,e)}}()}finally{L.p=t}}(e.priority)}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Th(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;t.length>0;){var n=hh(e.nativeEvent);if(null!==n)return null!==(t=Re(n))&&lh(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Lt=r,n.target.dispatchEvent(r),Lt=null,t.shift()}return!0}function Ih(e,t,n){Th(e)&&n.delete(t)}function _h(){gh=!1,null!==xh&&Th(xh)&&(xh=null),null!==yh&&Th(yh)&&(yh=null),null!==vh&&Th(vh)&&(vh=null),bh.forEach(Ih),jh.forEach(Ih)}function Dh(t,n){t.blockedOn===n&&(t.blockedOn=null,gh||(gh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,_h)))}var Eh=null;function Lh(t){Eh!==t&&(Eh=t,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Eh===t&&(Eh=null);for(var e=0;e<t.length;e+=3){var n=t[e],r=t[e+1],a=t[e+2];if("function"!=typeof r){if(null===ph(r||n))continue;break}var i=Re(n);null!==i&&(t.splice(e,3),e-=3,Ps(i,{pending:!0,data:a,method:n.method,action:r},r,a))}}))}function Ah(e){function t(t){return Dh(t,e)}null!==xh&&Dh(xh,e),null!==yh&&Dh(yh,e),null!==vh&&Dh(vh,e),bh.forEach(t),jh.forEach(t);for(var n=0;n<kh.length;n++){var r=kh[n];r.blockedOn===e&&(r.blockedOn=null)}for(;kh.length>0&&null===(n=kh[0]).blockedOn;)Nh(n),null===n.blockedOn&&kh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var a=n[r],i=n[r+1],s=a[De]||null;if("function"==typeof i)s||Lh(n);else if(s){var l=null;if(i&&i.hasAttribute("formAction")){if(a=i,s=i[De]||null)l=s.formAction;else if(null!==ph(a))continue}else l=s.action;"function"==typeof l?n[r+1]=l:(n.splice(r,3),r-=3),Lh(n)}}}function zh(e){this._internalRoot=e}function Fh(e){this._internalRoot=e}Fh.prototype.render=zh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));ah(t.current,Bc(),e,t,null,null)},Fh.prototype.unmount=zh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ah(e.current,2,null,e,null,null),Kc(),t[Ee]=null}},Fh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Te();e={blockedOn:null,target:e,priority:t};for(var n=0;n<kh.length&&0!==t&&t<kh[n].priority;n++);kh.splice(n,0,e),0===n&&Nh(e)}};var Ph=t.version;if("19.1.1"!==Ph)throw Error(r(527,Ph,"19.1.1"));L.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=i(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,a=t;;){var s=n.return;if(null===s)break;var o=s.alternate;if(null===o){if(null!==(a=s.return)){n=a;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return l(s),e;if(o===a)return l(s),t;o=o.sibling}throw Error(r(188))}if(n.return!==a.return)n=s,a=o;else{for(var c=!1,d=s.child;d;){if(d===n){c=!0,n=s,a=o;break}if(d===a){c=!0,a=s,n=o;break}d=d.sibling}if(!c){for(d=o.child;d;){if(d===n){c=!0,n=o,a=s;break}if(d===a){c=!0,a=o,n=s;break}d=d.sibling}if(!c)throw Error(r(189))}}if(n.alternate!==a)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}(t),null===(e=null!==e?o(e):null)?null:e.stateNode};var Mh={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:E,reconcilerVersion:"19.1.1"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Oh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oh.isDisabled&&Oh.supportsFiber)try{le=Oh.inject(Mh),oe=Oh}catch(Rh){}}return At.createRoot=function(e,t){if(!a(e))throw Error(r(299));var n=!1,i="",s=wl,l=Cl,o=Sl;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onUncaughtError&&(s=t.onUncaughtError),void 0!==t.onCaughtError&&(l=t.onCaughtError),void 0!==t.onRecoverableError&&(o=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=nh(e,1,!1,null,0,n,i,s,l,o,0,null),e[Ee]=t.current,qd(e),new zh(t)},At.hydrateRoot=function(e,t,n){if(!a(e))throw Error(r(299));var i=!1,s="",l=wl,o=Cl,c=Sl,d=null;return null!=n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onUncaughtError&&(l=n.onUncaughtError),void 0!==n.onCaughtError&&(o=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(d=n.formState)),(t=nh(e,1,!0,t,0,i,s,l,o,c,0,d)).context=rh(null),n=t.current,(s=di(i=Se(i=Bc()))).callback=null,ui(n,s,i),n=i,t.current.lanes=n,ke(t,n),Id(t),e[Ee]=t.current,qd(e),new Fh(t)},At.version="19.1.1",At}()),Lt.exports);it.defaults.baseURL="https://192.168.1.7",it.defaults.timeout=6e4,it.defaults.withCredentials=!0,it.defaults.headers["Content-Type"]="application/json";const Mt=it.create({baseURL:"https://192.168.1.7",timeout:6e4,withCredentials:!0,headers:{"Content-Type":"application/json"}});let Ot=localStorage.getItem("token");const Rt=e=>{Ot=e,e?localStorage.setItem("token",e):localStorage.removeItem("token")};let Bt=!1,Vt=[];const Ut=e=>{Vt.forEach(t=>t(e)),Vt=[]},$t=e=>e.interceptors.request.use(e=>{const t=Ot||localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer "+t),e.data instanceof FormData&&delete e.headers["Content-Type"],e},e=>Promise.reject(e)),Ht=e=>e.interceptors.response.use(e=>e,async t=>{const n=t.config,r=t.response?.status,a=n?.url?.includes("/api/auth/refresh");if(401===r&&!n?._retry&&!a){if(Bt){const r=await new Promise(e=>Vt.push(e));return r?(n.headers.Authorization="Bearer "+r,n._retry=!0,e(n)):Promise.reject(t)}n._retry=!0,Bt=!0;try{const t=await(async()=>(await Mt.post("/api/auth/refresh")).data.token)();return Rt(t),Ut(t),n.headers.Authorization="Bearer "+t,e(n)}catch(In){return Ut(null),Rt(null),window.location.href="/login",Promise.reject(In)}finally{Bt=!1}}return Promise.reject(t)});$t(Mt),Ht(Mt),$t(it),Ht(it);const Wt=e.createContext(null),qt=({children:t})=>{const[n,r]=e.useState(null),[a,i]=e.useState(!0),[s,l]=e.useState(0),o=e.useRef(!1),c=async e=>{const t=Date.now();if(3e5>t-s&&n)return n;if(o.current)return n;o.current=!0;try{const n=await it.get("https://192.168.1.7/api/auth/me",{headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}});return r(n.data.user),l(t),localStorage.setItem("user",JSON.stringify(n.data.user)),localStorage.setItem("userFetchTime",t.toString()),n.data.user}catch(a){const e=localStorage.getItem("user"),n=localStorage.getItem("userFetchTime");if(e&&n)try{const a=JSON.parse(e),i=parseInt(n);if(18e5>t-i)return r(a),l(i),a}catch(i){}return localStorage.clear(),null}finally{o.current=!1}},d=e.useCallback(async()=>{const e=localStorage.getItem("token");return e?await c(e):null},[]);e.useEffect(()=>{const e=localStorage.getItem("token"),t=localStorage.getItem("user"),n=localStorage.getItem("userFetchTime");if(e){if(t&&n)try{const a=JSON.parse(t),s=parseInt(n),o=Date.now();if(18e5>o-s)return r(a),l(s),i(!1),void(o-s>3e5&&c(e))}catch(a){}(async()=>{try{await c(e)}finally{i(!1)}})()}else i(!1)},[]);const u={currentUser:n,setCurrentUser:r,loading:a,logout:async()=>{localStorage.clear(),sessionStorage.clear(),document.cookie.split(";").forEach(function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()+";path=/")}),"caches"in window&&caches.keys().then(function(e){for(let t of e)caches.delete(t)}),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(e){for(let t of e)t.unregister()}),r(null)},updateUserData:c,reloadUserInfo:d};return Et.jsx(Wt.Provider,{value:u,children:!a&&t})},Kt=()=>{const t=e.useContext(Wt);if(!t)throw Error("useAuth must be used within an AuthProvider");return t},Yt=[{value:"ad",label:"AD"},{value:"local",label:"Nội bộ"}],Qt={datacenter:"/dc/shifts",manager:"/manager/overview",be:"/be/shifts"},Xt="Đăng nhập thất bại!",Gt=({error:e})=>e?Et.jsx("div",{className:"mb-6 p-4 rounded-lg bg-red-500/20 border border-red-500/30 text-white animate-fade-in",children:Et.jsxs("div",{className:"flex items-center",children:[Et.jsx("svg",{className:"w-5 h-5 mr-2 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Et.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Et.jsx("span",{children:e})]})}):null,Jt=({type:e,value:t,onChange:n,placeholder:r,icon:a,autoComplete:i,onKeyPress:s})=>Et.jsxs("div",{className:"relative",children:[Et.jsx("input",{type:e,required:!0,value:t,onChange:n,onKeyPress:s,className:"w-full px-4 py-3 pl-11 rounded-lg bg-black/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-white/30",placeholder:r,autoComplete:i}),Et.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50",children:a})]});function Zt(){const[t,n]=e.useState(""),[r,a]=e.useState(""),[i,s]=e.useState("ad"),[l,o]=e.useState(!1),c=mt(),{setCurrentUser:d}=Kt(),{error:u,handleError:h,clearError:m}=(()=>{const[t,n]=e.useState("");return{error:t,handleError:e.useCallback(e=>{let t=Xt;if(e.response)switch(e.response.status){case 401:t="Tên đăng nhập hoặc mật khẩu không đúng!";break;case 403:t="Tài khoản của bạn đã bị khóa!";break;case 404:t="Tài khoản không tồn tại!";break;case 500:t="Lỗi máy chủ, vui lòng thử lại sau!";break;default:t=e.response.data?.message||Xt}else e.message&&(t=e.message);n(t)},[]),clearError:e.useCallback(()=>n(""),[])}})(),{checkRateLimit:p,resetRateLimit:f,isBlocked:g,remainingAttempts:x}=((t=5,n=6e4)=>{const[r,a]=e.useState(0),[i,s]=e.useState(!1),l=e.useRef(0),o=e.useRef(null);return{checkRateLimit:e.useCallback(()=>{const e=Date.now();if(e-l.current>n&&(a(0),s(!1),o.current&&(clearTimeout(o.current),o.current=null)),i)return!1;const c=r+1;return a(c),l.current=e,t>c||(s(!0),o.current=setTimeout(()=>{a(0),s(!1),o.current=null},n),!1)},[r,i,t,n]),resetRateLimit:e.useCallback(()=>{a(0),s(!1),l.current=0,o.current&&(clearTimeout(o.current),o.current=null)},[]),getRemainingTime:e.useCallback(()=>{if(!i)return 0;const e=Date.now()-l.current;return Math.max(0,n-e)},[i,n]),attempts:r,isBlocked:i,remainingAttempts:Math.max(0,t-r)}})(5,6e4),y=e.useCallback(async e=>{e.preventDefault();const n=((e,t)=>{const n=(e=>e?3>e.length?"Tên đăng nhập phải có ít nhất 3 ký tự!":null:"Vui lòng nhập tên đăng nhập!")(e),r=(e=>e?6>e.length?"Mật khẩu phải có ít nhất 6 ký tự!":null:"Vui lòng nhập mật khẩu!")(t);return{isValid:!n&&!r,errors:{username:n,password:r}}})(t,r);if(!n.isValid){const e=Object.values(n.errors).find(e=>e);return void(e&&h({message:e}))}if(p()){o(!0),m();try{const e=await(async(e,t,n)=>{try{const r=(await Mt.post("/api/auth/login",{username:e,password:t,loginType:n})).data;return r.token&&Rt(r.token),r}catch(u){throw Error(u.response?.data?.message||"Đăng nhập thất bại")}})(t,r,i);f();const n={...e.user,role:e.user.role.toLowerCase()};localStorage.setItem("user",JSON.stringify(n)),localStorage.setItem("token",e.token),d(n);const a=Qt[n.role];a?c(a):h({message:"Không có quyền truy cập!"})}catch(a){h(a)}finally{o(!1)}}},[t,r,i,c,d,m,h,p,f]),v=e.useCallback(e=>{s(e),m(),n(""),a("")},[m]),b=e.useCallback(e=>{n(e.target.value),m()},[m]),j=e.useCallback(e=>{a(e.target.value),m()},[m]),k=e.useCallback(e=>{"Enter"===e.key&&y(e)},[y]),w=e.useMemo(()=>Et.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:Et.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.121 17.804A4.5 4.5 0 0112 15.5a4.5 4.5 0 016.879 2.304M15 11a3 3 0 11-6 0 3 3 0 016 0z"})}),[]),C=e.useMemo(()=>Et.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:Et.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 11c1.657 0 3-1.343 3-3S13.657 5 12 5s-3 1.343-3 3 1.343 3 3 3zm0 2c-3.314 0-6 2.686-6 6h12c0-3.314-2.686-6-6-6z"})}),[]);return Et.jsxs("div",{className:"min-h-screen flex items-center justify-center px-4",style:{backgroundImage:"url('/vietinbank-building.jpg')",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[Et.jsx("div",{className:"absolute top-0 left-0 right-0 h-16 bg-white/5 backdrop-blur-sm flex items-center px-4"}),Et.jsxs("div",{className:"w-full max-w-md bg-black/40 backdrop-blur-lg rounded-2xl p-8 shadow-2xl border border-white/20 ml-auto mr-4",children:[Et.jsxs("div",{className:"text-center mb-8",children:[Et.jsx("h1",{className:"text-2xl font-bold text-white",children:"DCE Portal"}),Et.jsx("p",{className:"text-white/70 text-sm mt-2",children:"Đăng nhập hệ thống quản lý"})]}),Et.jsx("div",{className:"flex mb-6 bg-black/20 rounded-lg overflow-hidden",children:Yt.map(e=>Et.jsx("button",{onClick:()=>v(e.value),className:"w-1/2 py-3 font-medium transition "+(i===e.value?"bg-blue-600 text-white shadow-inner":"text-white/60 hover:text-white hover:bg-blue-500/20"),children:e.label},e.value))}),Et.jsx(Gt,{error:u}),g&&Et.jsx("div",{className:"mb-6 p-4 rounded-lg bg-orange-500/20 border border-orange-500/30 text-white",children:Et.jsxs("div",{className:"flex items-center",children:[Et.jsx("svg",{className:"w-5 h-5 mr-2 text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Et.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),Et.jsx("span",{children:"Tài khoản tạm thời bị khóa do quá nhiều lần thử đăng nhập. Vui lòng thử lại sau 1 phút."})]})}),Et.jsxs("form",{onSubmit:y,className:"space-y-5",children:[Et.jsxs("div",{children:[Et.jsx("label",{className:"text-white text-sm mb-1 block",children:"ad"===i?"Tài khoản AD":"Tên đăng nhập"}),Et.jsx(Jt,{type:"text",value:t,onChange:b,placeholder:"ad"===i?"Tài khoản AD":"Tên đăng nhập",icon:w,autoComplete:"username",onKeyPress:k})]}),Et.jsxs("div",{children:[Et.jsx("label",{className:"text-white text-sm mb-1 block",children:"Mật khẩu"}),Et.jsx(Jt,{type:"password",value:r,onChange:j,placeholder:"Nhập mật khẩu",icon:C,autoComplete:"current-password",onKeyPress:k})]}),Et.jsx("button",{type:"submit",disabled:l||g,className:"w-full py-3 rounded-lg font-semibold text-white transition "+(l||g?"bg-blue-600/40 cursor-not-allowed":"bg-blue-600/80 hover:bg-blue-600/80"),children:l?"Đang xử lý...":g?"Tạm khóa":"Đăng nhập"}),5>x&&!g&&Et.jsxs("div",{className:"text-center text-sm text-white/60",children:["Còn ",x," lần thử đăng nhập"]})]}),Et.jsxs("div",{className:"text-center text-sm text-white/60 mt-6",children:["© ",(new Date).getFullYear()," - DataCenter"]})]}),Et.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-16 bg-white/10 backdrop-blur-sm"}),Et.jsx("style",{children:"\n          @keyframes fade-in {\n            from {\n              opacity: 0;\n              transform: translateY(-10px);\n            }\n            to {\n              opacity: 1;\n              transform: translateY(0);\n            }\n          }\n          .animate-fade-in {\n            animation: fade-in 0.3s ease-out;\n          }\n        "})]})}const{Option:en}=t,{TabPane:tn}=n,{Text:nn,Title:rn}=r;function an(){const[r,g]=e.useState(!1),[x,y]=e.useState(!0),v=mt(),{currentUser:b,updateUserData:j}=Kt(),[k]=a.useForm(),w=e.useRef(!1),C=()=>Et.jsx(f,{className:"mb-6",children:Et.jsxs("div",{className:"flex items-center space-x-4",children:[Et.jsx("div",{className:"w-16 h-16 bg-[#003c71] rounded-full flex items-center justify-center",children:Et.jsx(c,{className:"text-white text-2xl"})}),Et.jsx("div",{className:"flex-1 items-center",children:Et.jsx(rn,{level:3,className:"mb-1",children:b.fullname})}),Et.jsx("div",{className:"text-right",children:Et.jsx("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:b.isADUser?"AD User":"Local User"})})]})}),S=e.useCallback(async()=>{const e=localStorage.getItem("token");if(e)try{y(!0);const t=await it.get("https://192.168.1.7/api/auth/me",{headers:{Authorization:"Bearer "+e}}),n=t.data.user||t.data;if(n&&n.id){"function"==typeof j&&await j(e);const t={username:n.username,fullname:n.fullname,email:n.email,dob:n.dob?st(n.dob):null,gender:n.gender||void 0,role:n.role};setTimeout(()=>{k.setFieldsValue(t)},100)}}catch(t){if(401===t.response?.status)return localStorage.clear(),void v("/login");i.error("Không thể tải thông tin người dùng")}finally{y(!1)}else v("/login")},[v,j,k]);return e.useEffect(()=>{w.current||(w.current=!0,S())},[S]),e.useEffect(()=>{if(b&&!x){const e={username:b.username,fullname:b.fullname,email:b.email,dob:b.dob?st(b.dob):null,gender:b.gender||void 0,role:b.role};k.setFieldsValue(e)}},[b,x,k]),x?Et.jsx("div",{className:"flex justify-center items-center min-h-screen bg-gray-50",children:Et.jsxs("div",{className:"text-center",children:[Et.jsx(s,{size:"large"}),Et.jsx("div",{className:"mt-4 text-gray-600",children:"Đang tải thông tin người dùng..."})]})}):b?Et.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:Et.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[Et.jsxs("div",{className:"mb-6",children:[Et.jsx(rn,{level:2,className:"text-gray-900 mb-2",children:"Quản lý tài khoản cá nhân"}),Et.jsx(nn,{type:"secondary",children:"Cập nhật thông tin cá nhân và quản lý phiên đăng nhập"})]}),Et.jsx(C,{}),b.isADUser&&Et.jsx(l,{message:"Tài khoản Active Directory",description:"Bạn đang sử dụng tài khoản AD. Thông tin đăng nhập được quản lý bởi hệ thống Active Directory.",type:"info",showIcon:!0,className:"mb-6"}),Et.jsx(n,{defaultActiveKey:"profile",className:"bg-white rounded-lg shadow-sm p-2",children:Et.jsx(tn,{tab:Et.jsxs("span",{children:[Et.jsx(c,{})," Thông tin cá nhân"]}),children:Et.jsx("div",{className:"p-2",children:Et.jsxs(a,{form:k,layout:"vertical",onFinish:async e=>{try{g(!0);const t=localStorage.getItem("token");if(!t)return i.error("Phiên đăng nhập đã hết hạn"),void v("/login");const n=i.loading("Đang cập nhật thông tin...",0),r=await it.put("https://192.168.1.7/api/users/me",{fullname:e.fullname,gender:e.gender,dob:e.dob?e.dob.format("YYYY-MM-DD"):null},{headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"}});if(n(),r.data.success){await j(t);const e=r.data.user||r.data;k.setFieldsValue({username:e.username,fullname:e.fullname,email:e.email,dob:e.dob?st(e.dob):null,gender:e.gender||void 0,role:e.role}),i.success({content:r.data.message||"Cập nhật thông tin thành công!",duration:2})}else i.error({content:r.data.message||"Không thể cập nhật thông tin",duration:3})}catch(t){const e=t.response?.data?.message||t.response?.data?.error||"Không thể cập nhật thông tin";i.error({content:e,duration:3})}finally{g(!1)}},className:"space-y-6",children:[Et.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Et.jsx(a.Item,{name:"username",label:Et.jsx("span",{className:"text-gray-700 font-medium",children:"Tên đăng nhập"}),children:Et.jsx(o,{readOnly:!0,className:"bg-gray-50",prefix:Et.jsx(c,{className:"text-gray-400"})})}),Et.jsx(a.Item,{name:"email",label:Et.jsx("span",{className:"text-gray-700 font-medium",children:"Email"}),children:Et.jsx(o,{readOnly:!0,className:"bg-gray-50",prefix:Et.jsx(d,{className:"text-gray-400"})})}),Et.jsx(a.Item,{name:"fullname",label:Et.jsx("span",{className:"text-gray-700 font-medium",children:"Họ và tên"}),rules:[{min:2,message:"Họ tên phải có ít nhất 2 ký tự"},{max:100,message:"Họ tên không được quá 100 ký tự"}],children:Et.jsx(o,{className:"bg-gray-50",readOnly:!0})}),Et.jsx(a.Item,{name:"role",label:Et.jsx("span",{className:"text-gray-700 font-medium",children:"Nhóm"}),children:Et.jsx(o,{readOnly:!0,className:"bg-gray-50",value:(N=b.role,{manager:{color:"blue",text:"Quản lý"},datacenter:{color:"green",text:"DataCenter"},be:{color:"orange",text:"Batch Engineer"},admin:{color:"red",text:"Admin"},user:{color:"default",text:"Người dùng"}}[N]||{color:"default",text:N}).text})}),Et.jsx(a.Item,{name:"dob",label:Et.jsx("span",{className:"text-gray-700 font-medium",children:"Ngày sinh"}),rules:[{validator:(e,t)=>t&&t.isAfter(st())?Promise.reject("Ngày sinh không thể là tương lai"):Promise.resolve()}],children:Et.jsx(u,{format:"DD/MM/YYYY",style:{width:"100%"},className:"hover:border-[#003c71] focus:border-[#003c71]",placeholder:"Chọn ngày sinh",disabledDate:e=>e&&e>st().endOf("day")})}),Et.jsx(a.Item,{name:"gender",label:Et.jsx("span",{className:"text-gray-700 font-medium",children:"Giới tính"}),children:Et.jsxs(t,{className:"hover:border-[#003c71] focus:border-[#003c71]",placeholder:"Chọn giới tính",children:[Et.jsx(en,{value:"male",children:"Nam"}),Et.jsx(en,{value:"female",children:"Nữ"}),Et.jsx(en,{value:"other",children:"Khác"})]})})]}),Et.jsx(h,{}),Et.jsx(a.Item,{className:"flex justify-end mb-0",children:Et.jsxs(m,{children:[Et.jsx(p,{onClick:()=>v(-1),className:"h-10 px-6",children:"Quay lại"}),Et.jsx(p,{type:"primary",htmlType:"submit",loading:r,className:"bg-[#003c71] hover:bg-[#002d54] h-10 px-6",children:"Cập nhật thông tin"})]})})]})})},"profile")})]})}):Et.jsx("div",{className:"flex justify-center items-center min-h-screen bg-gray-50",children:Et.jsx("div",{className:"text-center",children:Et.jsx(l,{message:"Không thể tải thông tin người dùng",description:"Vui lòng thử lại hoặc đăng nhập lại",type:"error",showIcon:!0,className:"max-w-md"})})});var N}const sn={"/manager/overview":{autoCollapse:!1,defaultCollapsed:!1},"/manager/shifts":{autoCollapse:!1,defaultCollapsed:!1},"/manager/handovers":{autoCollapse:!1,defaultCollapsed:!1},"/manager/tasks":{autoCollapse:!1,defaultCollapsed:!1},"/manager/devices":{autoCollapse:!1,defaultCollapsed:!1},"/manager/tape":{autoCollapse:!1,defaultCollapsed:!1},"/manager/backup-management":{autoCollapse:!1,defaultCollapsed:!1},"/manager/partners":{autoCollapse:!1,defaultCollapsed:!1},"/manager/users":{autoCollapse:!1,defaultCollapsed:!1},"/manager/settings":{autoCollapse:!1,defaultCollapsed:!1},"/dc/shifts":{autoCollapse:!1,defaultCollapsed:!1},"/dc/tasks":{autoCollapse:!1,defaultCollapsed:!1},"/dc/handovers":{autoCollapse:!1,defaultCollapsed:!1},"/dc/faq":{autoCollapse:!1,defaultCollapsed:!1},"/dc/cooling-system":{autoCollapse:!0,defaultCollapsed:!0},"/dc/cooling-system-vancanh":{autoCollapse:!0,defaultCollapsed:!0},"/dc/ups-system":{autoCollapse:!0,defaultCollapsed:!0},"/dc/fire-system":{autoCollapse:!0,defaultCollapsed:!0},"/dc/security-system":{autoCollapse:!0,defaultCollapsed:!0},"/be/overview":{autoCollapse:!1,defaultCollapsed:!1},"/be/shifts":{autoCollapse:!1,defaultCollapsed:!1},"/be/handovers":{autoCollapse:!1,defaultCollapsed:!1},"/be/tasks":{autoCollapse:!1,defaultCollapsed:!1},"/be/devices":{autoCollapse:!1,defaultCollapsed:!1},"/be/tape":{autoCollapse:!1,defaultCollapsed:!1},"/be/backup-management":{autoCollapse:!1,defaultCollapsed:!1},"/be/partners":{autoCollapse:!1,defaultCollapsed:!1},"/be/users":{autoCollapse:!1,defaultCollapsed:!1},"/be/settings":{autoCollapse:!1,defaultCollapsed:!1},"/profile":{autoCollapse:!1,defaultCollapsed:!1},default:{autoCollapse:!1,defaultCollapsed:!1}},ln=e.createContext(),on=()=>{const t=e.useContext(ln);if(!t)throw Error("useSidebar must be used within a SidebarProvider");return t},cn=({children:t})=>{const[n,r]=e.useState(!1),[a,i]=e.useState(!1),[s,l]=e.useState(!0),o=pt(),c=()=>sn[o?.pathname||"/"]||sn.default,d=e=>{i(!0),r(e),setTimeout(()=>{i(!1),l(!0)},300)};e.useEffect(()=>{const e=c();l(!1),i(!0);const t=setTimeout(()=>{e.autoCollapse?d(!0):d(e.defaultCollapsed)},150);return()=>clearTimeout(t)},[o.pathname]);const u={collapsed:n,isAnimating:a,sidebarReady:s,setCollapsed:d,getCurrentConfig:c};return Et.jsx(ln.Provider,{value:u,children:t})},{Header:dn}=g,un=({currentUser:e,USER_MENU_ITEMS:t,handleMenuClick:n})=>Et.jsxs(dn,{style:{position:"fixed",top:0,left:0,right:0,marginLeft:1,marginRight:1,height:70,zIndex:100,borderRadius:6,padding:"0 25px",background:"linear-gradient(90deg, #0072BC  0%, #ED1C24 110%)",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 4px 20px rgba(0,0,0,0.06)",transition:"all 0.2s",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)"},children:[Et.jsx("div",{className:"flex items-center",children:Et.jsx("span",{className:"text-xl  text-white tracking-wide select-none",style:{letterSpacing:1},children:"DataCenter & Equipment Management"})}),Et.jsx(x,{menu:{items:t,onClick:n},trigger:["click"],placement:"bottomRight",children:Et.jsxs("div",{className:"flex items-center cursor-pointer px-4 py-2 rounded-xl hover:bg-white/10 hover:shadow-md transition-all duration-200 border border-transparent hover:border-gray-200",children:[Et.jsx(y,{style:{backgroundColor:"#fff",color:"#003c71",marginRight:12,boxShadow:"0 2px 8px rgba(0,60,113,0.3)"},icon:Et.jsx(c,{})}),Et.jsxs("div",{className:"flex flex-col",children:[Et.jsx("span",{className:"text-sm font-semibold text-white",children:e?.fullname}),Et.jsx("span",{className:"text-xs text-blue-100",children:"admin"===e?.role?"Quản trị viên":"datacenter"===e?.role?"DataCenter":"manager"===e?.role?"Quản lý":"be"===e?.role?"Batch Engineer":"Nhân viên"})]}),Et.jsx(v,{className:"text-white ml-3"})]})})]}),{Sider:hn}=g,mn=({menuItemsWithFAQ:t,currentPath:n,currentConfig:r})=>{const{collapsed:a,setCollapsed:i,isAnimating:s}=on(),[l,o]=e.useState(!1);return b.useEffect(()=>{r.autoCollapse&&o(!1)},[n,r.autoCollapsed]),Et.jsxs(hn,{width:a?70:200,collapsible:!0,collapsed:a,onCollapse:e=>{i(e),o(!0)},style:{position:"fixed",top:71,left:1,bottom:1,zIndex:6,background:"#003c71",borderRadius:6,overflow:"hidden",paddingTop:0,minHeight:"calc(100vh - 83px)",backdropFilter:"blur(6px)",WebkitBackdropFilter:"blur(6px)",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"},trigger:Et.jsx(k,{title:a?"Mở rộng menu":"Thu gọn menu",placement:"right",children:Et.jsx("div",{className:"flex justify-center items-center h-12 cursor-pointer hover:bg-[#005fa3]/80 transition-all duration-300",children:a?Et.jsx(w,{className:"text-white text-lg"}):Et.jsx(C,{className:"text-white text-lg"})})}),children:[Et.jsx(j,{mode:"inline",selectedKeys:[n],defaultOpenKeys:["shift-manager","shift-management"],style:{background:"transparent",marginTop:2,padding:"0 6px 0 2px"},className:"custom-menu",items:t,theme:"dark"}),Et.jsx("style",{children:"\n        /* ========================================\n         * EXPANDED SIDEBAR STYLES (200px width)\n         * ======================================== */\n\n        /* Menu container - Expanded */\n        .custom-menu {\n          background: transparent !important;\n          margin-top: 6px !important;\n\n        }\n\n        /* Menu items - Expanded */\n        .custom-menu .ant-menu-item,\n        .custom-menu .ant-menu-submenu-title {\n          height: 42px !important;\n          line-height: 42px !important;\n          border-radius: 8px !important;\n          color: rgba(255,255,255,0.85) !important;\n          font-size: 14px !important;\n          font-weight: 400 !important;\n          margin-left: 6px !important;\n          padding: 0 1px 0 1px !important;\n          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;\n          display: flex !important;\n          align-items: center !important;\n          position: relative !important;\n          overflow: hidden !important;\n        }\n\n        /* Selected state - Expanded */\n        .custom-menu .ant-menu-item-selected {\n          background: linear-gradient(135deg, #0072bc 0%, #005fa3 50%, #004d8a 100%) !important;\n          color: #fff !important;\n          font-weight: 600 !important;\n          box-shadow: 4px 4px 12px rgba(0, 114, 188, 0.3) !important;\n          border-radius: 8px !important;\n          transform: translateY(-1px) !important;\n        }\n\n        /* Hover effects - Expanded */\n        .custom-menu .ant-menu-item:hover,\n        .custom-menu .ant-menu-submenu-title:hover {\n          background: linear-gradient(135deg, #005fa3 0%, #004d8a 100%) !important;\n          color: #fff !important;\n        }\n\n        /* Icons - Expanded */\n        .custom-menu .ant-menu-item .anticon,\n        .custom-menu .ant-menu-submenu-title .anticon {\n          font-size: 20px !important;\n          margin-right: 6px !important;\n          margin-left: 10px !important;\n          opacity: 0.9 !important;\n          flex-shrink: 0 !important;\n          transition: all 0.3s ease !important;\n          filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1)) !important;\n        }\n\n        /* Icon hover - Expanded */\n        .custom-menu .ant-menu-item:hover .anticon,\n        .custom-menu .ant-menu-submenu-title:hover .anticon {\n          filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2)) !important;\n        }\n\n        /* ========================================\n         * COLLAPSED SIDEBAR STYLES (70px width)\n         * ======================================== */\n\n        /* Menu container - Collapsed */\n        .ant-layout-sider-collapsed .custom-menu {\n          padding: 0 1px !important;\n          margin-left: 5px !important;\n          margin-right: 13px !important;\n          margin-top: 6px !important;\n          margin-bottom: 6px !important;\n        }\n\n        /* Menu items - Collapsed */\n        .ant-layout-sider-collapsed .custom-menu .ant-menu-item,\n        .ant-layout-sider-collapsed .custom-menu .ant-menu-submenu-title {\n          height: 42px !important;\n          line-height: 42px !important;\n\n          border-radius: 8px !important;\n          justify-content: center !important;\n          text-align: center !important;\n          width: calc(100% - 4px) !important;\n          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;\n        }\n\n        /* Hover effects - Collapsed */\n        .ant-layout-sider-collapsed .custom-menu .ant-menu-item:hover,\n        .ant-layout-sider-collapsed .custom-menu .ant-menu-submenu-title:hover {\n          background: linear-gradient(135deg, #005fa3 0%, #004d8a 100%) !important;\n          box-shadow: 0 2px 8px rgba(0, 95, 163, 0.3) !important;\n        }\n\n        /* Icons - Collapsed */\n        .ant-layout-sider-collapsed .custom-menu .ant-menu-item .anticon,\n        .ant-layout-sider-collapsed .custom-menu .ant-menu-submenu-title .anticon {\n          margin: 0 !important;\n          font-size: 20px !important;\n          display: flex !important;\n          align-items: center !important;\n          justify-content: center !important;\n          width: 100% !important;\n          height: 100% !important;\n          transition: all 0.3s ease !important;\n          filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1)) !important;\n        }\n\n        /* Hide text when collapsed */\n        .ant-layout-sider-collapsed .custom-menu .ant-menu-item span:not(.anticon),\n        .ant-layout-sider-collapsed .custom-menu .ant-menu-submenu-title span:not(.anticon) {\n          display: none !important;\n        }\n\n        /* ========================================\n         * SUBMENU STYLES (Both states)\n         * ======================================== */\n\n        /* Submenu container */\n        .custom-menu .ant-menu-sub {\n          background: transparent !important;\n          padding-left: 12px !important;\n        }\n\n        /* Submenu items */\n        .custom-menu .ant-menu-sub .ant-menu-item {\n          height: 36px !important;\n          line-height: 36px !important;\n          margin: 1px 0 !important;\n          padding: 0 10px !important;\n          font-size: 12px !important;\n          border-radius: 6px !important;\n          transition: all 0.3s ease !important;\n        }\n\n        /* Submenu hover */\n        .custom-menu .ant-menu-sub .ant-menu-item:hover {\n          background: linear-gradient(135deg, #005fa3 0%, #004d8a 100%) !important;\n          box-shadow: 0 2px 6px rgba(0, 95, 163, 0.2) !important;\n        }\n\n        /* Submenu icons */\n        .custom-menu .ant-menu-sub .ant-menu-item .anticon {\n          font-size: 20px !important;\n          margin-right: 6px !important;\n          transition: all 0.3s ease !important;\n        }\n\n        /* Submenu icon hover */\n        .custom-menu .ant-menu-sub .ant-menu-item:hover .anticon {\n          transform: scale(1.05) !important;\n        }\n\n        /* Selected submenu */\n        .custom-menu .ant-menu-sub .ant-menu-item-selected {\n          background: linear-gradient(135deg, #0072bc 0%, #005fa3 100%) !important;\n          box-shadow: 0 2px 8px rgba(0, 114, 188, 0.25) !important;\n        }\n      "})]})},pn=[{key:"profile",icon:Et.jsx(c,{}),label:"Thông tin cá nhân"},{key:"logout",icon:Et.jsx(S,{}),label:"Đăng xuất",danger:!0}],{Header:fn,Content:gn,Sider:xn}=g,yn=()=>{const t=mt(),n=pt(),{currentUser:r,reloadUserInfo:a}=Kt(),{collapsed:i,setCollapsed:s,getCurrentConfig:l}=on(),o=l(),c=e.useMemo(()=>((e,t)=>{switch(e){case"manager":case"admin":return(e=>[{key:"overview",icon:Et.jsx(L,{className:"text-xl"}),label:"Tổng quan",onClick:()=>e("/manager/overview")},{key:"shift-management",icon:Et.jsx(A,{className:"text-xl"}),label:"Quản lý ca",children:[{key:"shift-list",icon:Et.jsx(N,{className:"text-lg"}),label:"Danh sách ca",onClick:()=>e("/manager/shifts")},{key:"handover-list",icon:Et.jsx(T,{className:"text-lg"}),label:"Biên bản bàn giao",onClick:()=>e("/manager/handovers")}]},{key:"task-management",icon:Et.jsx(I,{className:"text-xl"}),label:"Quản lý vào ra",onClick:()=>e("/manager/tasks")},{key:"device-management",icon:Et.jsx(_,{className:"text-xl"}),label:"Quản lý sự cố",onClick:()=>e("/manager/devices")},{key:"tape-management",icon:Et.jsx(D,{className:"text-xl"}),label:"Quản lý tape",onClick:()=>e("/manager/tape")},{key:"backup-management",icon:Et.jsx(z,{className:"text-xl"}),label:"Quản lý Backup",onClick:()=>e("/manager/backup-management")},{key:"partner-management",icon:Et.jsx(F,{className:"text-xl"}),label:"Quản lý đối tác",onClick:()=>e("/manager/partners")},{key:"user-management",icon:Et.jsx(P,{className:"text-xl"}),label:"Quản lý nhân viên",onClick:()=>e("/manager/users")},{key:"system-info",icon:Et.jsx(E,{className:"text-xl"}),label:"Thông tin hệ thống",onClick:()=>e("/manager/system-info")},{key:"system-info-manager",icon:Et.jsx(M,{className:"text-xl"}),label:"Quản lý thông tin hệ thống",onClick:()=>e("/manager/system-info-manager")},{key:"cooling-system",icon:Et.jsx(O,{className:"text-xl"}),label:"Hệ thống làm mát TTDL",onClick:()=>e("/manager/cooling-system")},{key:"settings",icon:Et.jsx(R,{className:"text-xl"}),label:"Cài đặt hệ thống",onClick:()=>e("/manager/settings")},{key:"datacenter-menu",icon:Et.jsx(z,{className:"text-xl"}),label:"Quản lý hệ thống TTDL",onClick:()=>e("/manager/datacenter-menu")}])(t);case"be":return(e=>[{key:"overview",icon:Et.jsx(L,{className:"text-xl"}),label:"Tổng quan",onClick:()=>e("/be/overview")},{key:"shift-management",icon:Et.jsx(A,{className:"text-xl"}),label:"Quản lý ca",children:[{key:"shift-list",icon:Et.jsx(N,{className:"text-lg"}),label:"Danh sách ca",onClick:()=>e("/be/shifts")},{key:"handover-list",icon:Et.jsx(T,{className:"text-lg"}),label:"Biên bản bàn giao",onClick:()=>e("/be/handovers")}]},{key:"task-management",icon:Et.jsx(I,{className:"text-xl"}),label:"Quản lý vào ra",onClick:()=>e("/be/tasks")},{key:"device-management",icon:Et.jsx(_,{className:"text-xl"}),label:"Quản lý sự cố",onClick:()=>e("/be/devices")},{key:"tape-management",icon:Et.jsx(D,{className:"text-xl"}),label:"Quản lý tape",onClick:()=>e("/be/tape")},{key:"backup-management",icon:Et.jsx(z,{className:"text-xl"}),label:"Quản lý Backup",onClick:()=>e("/be/backup-management")},{key:"partner-management",icon:Et.jsx(F,{className:"text-xl"}),label:"Quản lý đối tác",onClick:()=>e("/be/partners")},{key:"user-management",icon:Et.jsx(P,{className:"text-xl"}),label:"Quản lý nhân viên",onClick:()=>e("/be/users")},{key:"system-info",icon:Et.jsx(E,{className:"text-xl"}),label:"Thông tin hệ thống",onClick:()=>e("/be/system-info")},{key:"system-info-manager",icon:Et.jsx(M,{className:"text-xl"}),label:"Quản lý thông tin hệ thống",onClick:()=>e("/be/system-info-manager")},{key:"cooling-system",icon:Et.jsx(O,{className:"text-xl"}),label:"Hệ thống làm mát TTDL",onClick:()=>e("/be/cooling-system")},{key:"settings",icon:Et.jsx(R,{className:"text-xl"}),label:"Cài đặt hệ thống",onClick:()=>e("/be/settings")},{key:"datacenter-menu",icon:Et.jsx(z,{className:"text-xl"}),label:"Quản lý hệ thống TTDL",onClick:()=>e("/be/datacenter-menu")}])(t);case"datacenter":return(e=>[{key:"dc-shifts",icon:Et.jsx(N,{className:"text-xl"}),label:"Quản lý công việc",onClick:()=>e("/dc/shifts")},{key:"dc-work",icon:Et.jsx(T,{className:"text-xl"}),label:"Quản lý bàn giao ca",onClick:()=>e("/dc/handover")},{key:"dc-tasks",icon:Et.jsx(I,{className:"text-xl"}),label:"Quản lý vào ra TTDL",onClick:()=>e("/dc/tasks")},{key:"dc-devices",icon:Et.jsx(_,{className:"text-xl"}),label:"Quản lý sự cố TTDL",onClick:()=>e("/dc/devices")},{key:"dc-tape",icon:Et.jsx(D,{className:"text-xl"}),label:"Quản lý tape",onClick:()=>e("/dc/tape")},{key:"dc-datacenter-menu",icon:Et.jsx(E,{className:"text-xl"}),label:"Tài liệu hệ thống",onClick:()=>e("/dc/datacenter-menu")}])(t);default:return[]}})(r?.role?.toLowerCase(),t),[r?.role,t]),d=e.useMemo(()=>"datacenter"===r?.role?.toLowerCase()?[...c]:c,[c,t,r?.role]);e.useEffect(()=>{const e=localStorage.getItem("token"),r=JSON.parse(localStorage.getItem("user")||"{}");if(!e||!r?.role)return void t("/login");const a=n.pathname,i=r.role.toLowerCase();(a.startsWith("/manager")&&"manager"!==i&&"admin"!==i||a.startsWith("/dc")&&"datacenter"!==i||a.startsWith("/be")&&"be"!==i)&&t("/login")},[n.pathname,t]),e.useEffect(()=>{"/profile"!==n.pathname&&"/profile"===sessionStorage.getItem("lastPath")&&a(),sessionStorage.setItem("lastPath",n.pathname)},[n.pathname,a]);const u=n.pathname.split("/")[2];return Et.jsxs(g,{style:{minHeight:"100vh",background:"#f0f2f5"},children:[Et.jsx(un,{currentUser:r,USER_MENU_ITEMS:pn,handleMenuClick:({key:e})=>{"logout"===e?(async()=>{const e=localStorage.getItem("token");try{e&&await fetch("/api/auth/logout",{method:"POST",headers:{Authorization:"Bearer "+e}})}catch(n){}localStorage.clear(),t("/login")})():"profile"===e&&t("/profile")}}),Et.jsxs(g,{style:{marginTop:69,minHeight:"calc(100vh - 70px)"},children:[Et.jsx(mn,{menuItemsWithFAQ:d,currentPath:u,currentConfig:o}),Et.jsx(gn,{style:{margin:"1px 1px 0px "+(i?"82px":"202px"),padding:"0px",background:"#ffffff",borderRadius:6,minHeight:"calc(100vh - 71px)",height:"calc(100vh - 71px)",overflow:"auto",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",border:"1px solid #f1f5f9"},children:Et.jsx(ft,{})})]})]})},vn={lessThanXSeconds:{one:"dưới 1 giây",other:"dưới {{count}} giây"},xSeconds:{one:"1 giây",other:"{{count}} giây"},halfAMinute:"nửa phút",lessThanXMinutes:{one:"dưới 1 phút",other:"dưới {{count}} phút"},xMinutes:{one:"1 phút",other:"{{count}} phút"},aboutXHours:{one:"khoảng 1 giờ",other:"khoảng {{count}} giờ"},xHours:{one:"1 giờ",other:"{{count}} giờ"},xDays:{one:"1 ngày",other:"{{count}} ngày"},aboutXWeeks:{one:"khoảng 1 tuần",other:"khoảng {{count}} tuần"},xWeeks:{one:"1 tuần",other:"{{count}} tuần"},aboutXMonths:{one:"khoảng 1 tháng",other:"khoảng {{count}} tháng"},xMonths:{one:"1 tháng",other:"{{count}} tháng"},aboutXYears:{one:"khoảng 1 năm",other:"khoảng {{count}} năm"},xYears:{one:"1 năm",other:"{{count}} năm"},overXYears:{one:"hơn 1 năm",other:"hơn {{count}} năm"},almostXYears:{one:"gần 1 năm",other:"gần {{count}} năm"}},bn={date:lt({formats:{full:"EEEE, 'ngày' d MMMM 'năm' y",long:"'ngày' d MMMM 'năm' y",medium:"d MMM 'năm' y",short:"dd/MM/y"},defaultWidth:"full"}),time:lt({formats:{full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},defaultWidth:"full"}),dateTime:lt({formats:{full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},defaultWidth:"full"})},jn={lastWeek:"eeee 'tuần trước vào lúc' p",yesterday:"'hôm qua vào lúc' p",today:"'hôm nay vào lúc' p",tomorrow:"'ngày mai vào lúc' p",nextWeek:"eeee 'tới vào lúc' p",other:"P"},kn={code:"vi",formatDistance:(e,t,n)=>{let r;const a=vn[e];return r="string"==typeof a?a:1===t?a.one:a.other.replace("{{count}}",t+""),n?.addSuffix?n.comparison&&n.comparison>0?r+" nữa":r+" trước":r},formatLong:bn,formatRelative:(e,t,n,r)=>jn[e],localize:{ordinalNumber:(e,t)=>{const n=Number(e),r=t?.unit;if("quarter"===r)switch(n){case 1:return"I";case 2:return"II";case 3:return"III";case 4:return"IV"}else if("day"===r)switch(n){case 1:return"thứ 2";case 2:return"thứ 3";case 3:return"thứ 4";case 4:return"thứ 5";case 5:return"thứ 6";case 6:return"thứ 7";case 7:return"chủ nhật"}else{if("week"===r)return 1===n?"thứ nhất":"thứ "+n;if("dayOfYear"===r)return 1===n?"đầu tiên":"thứ "+n}return n+""},era:ot({values:{narrow:["TCN","SCN"],abbreviated:["trước CN","sau CN"],wide:["trước Công Nguyên","sau Công Nguyên"]},defaultWidth:"wide"}),quarter:ot({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["Quý 1","Quý 2","Quý 3","Quý 4"]},defaultWidth:"wide",formattingValues:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["quý I","quý II","quý III","quý IV"]},defaultFormattingWidth:"wide",argumentCallback:e=>e-1}),month:ot({values:{narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["Thg 1","Thg 2","Thg 3","Thg 4","Thg 5","Thg 6","Thg 7","Thg 8","Thg 9","Thg 10","Thg 11","Thg 12"],wide:["Tháng Một","Tháng Hai","Tháng Ba","Tháng Tư","Tháng Năm","Tháng Sáu","Tháng Bảy","Tháng Tám","Tháng Chín","Tháng Mười","Tháng Mười Một","Tháng Mười Hai"]},defaultWidth:"wide",formattingValues:{narrow:["01","02","03","04","05","06","07","08","09","10","11","12"],abbreviated:["thg 1","thg 2","thg 3","thg 4","thg 5","thg 6","thg 7","thg 8","thg 9","thg 10","thg 11","thg 12"],wide:["tháng 01","tháng 02","tháng 03","tháng 04","tháng 05","tháng 06","tháng 07","tháng 08","tháng 09","tháng 10","tháng 11","tháng 12"]},defaultFormattingWidth:"wide"}),day:ot({values:{narrow:["CN","T2","T3","T4","T5","T6","T7"],short:["CN","Th 2","Th 3","Th 4","Th 5","Th 6","Th 7"],abbreviated:["CN","Thứ 2","Thứ 3","Thứ 4","Thứ 5","Thứ 6","Thứ 7"],wide:["Chủ Nhật","Thứ Hai","Thứ Ba","Thứ Tư","Thứ Năm","Thứ Sáu","Thứ Bảy"]},defaultWidth:"wide"}),dayPeriod:ot({values:{narrow:{am:"am",pm:"pm",midnight:"nửa đêm",noon:"tr",morning:"sg",afternoon:"ch",evening:"tối",night:"đêm"},abbreviated:{am:"AM",pm:"PM",midnight:"nửa đêm",noon:"trưa",morning:"sáng",afternoon:"chiều",evening:"tối",night:"đêm"},wide:{am:"SA",pm:"CH",midnight:"nửa đêm",noon:"trưa",morning:"sáng",afternoon:"chiều",evening:"tối",night:"đêm"}},defaultWidth:"wide",formattingValues:{narrow:{am:"am",pm:"pm",midnight:"nửa đêm",noon:"tr",morning:"sg",afternoon:"ch",evening:"tối",night:"đêm"},abbreviated:{am:"AM",pm:"PM",midnight:"nửa đêm",noon:"trưa",morning:"sáng",afternoon:"chiều",evening:"tối",night:"đêm"},wide:{am:"SA",pm:"CH",midnight:"nửa đêm",noon:"giữa trưa",morning:"vào buổi sáng",afternoon:"vào buổi chiều",evening:"vào buổi tối",night:"vào ban đêm"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:dt({matchPattern:/^(\d+)/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:ct({matchPatterns:{narrow:/^(tcn|scn)/i,abbreviated:/^(trước CN|sau CN)/i,wide:/^(trước Công Nguyên|sau Công Nguyên)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^t/i,/^s/i]},defaultParseWidth:"any"}),quarter:ct({matchPatterns:{narrow:/^([1234]|i{1,3}v?)/i,abbreviated:/^q([1234]|i{1,3}v?)/i,wide:/^quý ([1234]|i{1,3}v?)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/(1|i)$/i,/(2|ii)$/i,/(3|iii)$/i,/(4|iv)$/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:ct({matchPatterns:{narrow:/^(0?[2-9]|10|11|12|0?1)/i,abbreviated:/^thg[ _]?(0?[1-9](?!\d)|10|11|12)/i,wide:/^tháng ?(Một|Hai|Ba|Tư|Năm|Sáu|Bảy|Tám|Chín|Mười|Mười ?Một|Mười ?Hai|0?[1-9](?!\d)|10|11|12)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/0?1$/i,/0?2/i,/3/,/4/,/5/,/6/,/7/,/8/,/9/,/10/,/11/,/12/],abbreviated:[/^thg[ _]?0?1(?!\d)/i,/^thg[ _]?0?2/i,/^thg[ _]?0?3/i,/^thg[ _]?0?4/i,/^thg[ _]?0?5/i,/^thg[ _]?0?6/i,/^thg[ _]?0?7/i,/^thg[ _]?0?8/i,/^thg[ _]?0?9/i,/^thg[ _]?10/i,/^thg[ _]?11/i,/^thg[ _]?12/i],wide:[/^tháng ?(Một|0?1(?!\d))/i,/^tháng ?(Hai|0?2)/i,/^tháng ?(Ba|0?3)/i,/^tháng ?(Tư|0?4)/i,/^tháng ?(Năm|0?5)/i,/^tháng ?(Sáu|0?6)/i,/^tháng ?(Bảy|0?7)/i,/^tháng ?(Tám|0?8)/i,/^tháng ?(Chín|0?9)/i,/^tháng ?(Mười|10)/i,/^tháng ?(Mười ?Một|11)/i,/^tháng ?(Mười ?Hai|12)/i]},defaultParseWidth:"wide"}),day:ct({matchPatterns:{narrow:/^(CN|T2|T3|T4|T5|T6|T7)/i,short:/^(CN|Th ?2|Th ?3|Th ?4|Th ?5|Th ?6|Th ?7)/i,abbreviated:/^(CN|Th ?2|Th ?3|Th ?4|Th ?5|Th ?6|Th ?7)/i,wide:/^(Chủ ?Nhật|Chúa ?Nhật|thứ ?Hai|thứ ?Ba|thứ ?Tư|thứ ?Năm|thứ ?Sáu|thứ ?Bảy)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/CN/i,/2/i,/3/i,/4/i,/5/i,/6/i,/7/i],short:[/CN/i,/2/i,/3/i,/4/i,/5/i,/6/i,/7/i],abbreviated:[/CN/i,/2/i,/3/i,/4/i,/5/i,/6/i,/7/i],wide:[/(Chủ|Chúa) ?Nhật/i,/Hai/i,/Ba/i,/Tư/i,/Năm/i,/Sáu/i,/Bảy/i]},defaultParseWidth:"wide"}),dayPeriod:ct({matchPatterns:{narrow:/^(a|p|nửa đêm|trưa|(giờ) (sáng|chiều|tối|đêm))/i,abbreviated:/^(am|pm|nửa đêm|trưa|(giờ) (sáng|chiều|tối|đêm))/i,wide:/^(ch[^i]*|sa|nửa đêm|trưa|(giờ) (sáng|chiều|tối|đêm))/i},defaultMatchWidth:"wide",parsePatterns:{any:{am:/^(a|sa)/i,pm:/^(p|ch[^i]*)/i,midnight:/nửa đêm/i,noon:/trưa/i,morning:/sáng/i,afternoon:/chiều/i,evening:/tối/i,night:/^đêm/i}},defaultParseWidth:"any"})},options:{weekStartsOn:1,firstWeekContainsDate:1}};var wn=B(B({},V),{},{locale:"vi_VN",today:"Hôm nay",now:"Bây giờ",backToToday:"Trở về hôm nay",ok:"OK",clear:"Xóa",week:"Tuần",month:"Tháng",year:"Năm",timeSelect:"Chọn thời gian",dateSelect:"Chọn ngày",weekSelect:"Chọn tuần",monthSelect:"Chọn tháng",yearSelect:"Chọn năm",decadeSelect:"Chọn thập kỷ",dateFormat:"D/M/YYYY",dateTimeFormat:"D/M/YYYY HH:mm:ss",previousMonth:"Tháng trước (PageUp)",nextMonth:"Tháng sau (PageDown)",previousYear:"Năm trước (Control + left)",nextYear:"Năm sau (Control + right)",previousDecade:"Thập kỷ trước",nextDecade:"Thập kỷ sau",previousCentury:"Thế kỷ trước",nextCentury:"Thế kỷ sau"});const Cn={lang:Object.assign({placeholder:"Chọn thời điểm",yearPlaceholder:"Chọn năm",quarterPlaceholder:"Chọn quý",monthPlaceholder:"Chọn tháng",weekPlaceholder:"Chọn tuần",rangePlaceholder:["Ngày bắt đầu","Ngày kết thúc"],rangeYearPlaceholder:["Năm bắt đầu","Năm kết thúc"],rangeQuarterPlaceholder:["Quý bắt đầu","Quý kết thúc"],rangeMonthPlaceholder:["Tháng bắt đầu","Tháng kết thúc"],rangeWeekPlaceholder:["Tuần bắt đầu","Tuần kết thúc"],shortMonths:["Th 01","Th 02","Th 03","Th 04","Th 05","Th 06","Th 07","Th 08","Th 09","Th 10","Th 11","Th 12"],shortWeekDays:["CN","T2","T3","T4","T5","T6","T7"]},wn),timePickerLocale:Object.assign({},{placeholder:"Chọn thời gian",rangePlaceholder:["Bắt đầu","Kết thúc"]})};var Sn,Nn,Tn,In,_n={exports:{}};const Dn=at((Sn||(Sn=1,_n.exports=(Nn="minute",Tn=/[+-]\d\d(?::?\d\d)?/g,In=/([+-]|\d\d)/g,function(e,t,n){var r=t.prototype;n.utc=function(e){return new t({date:e,utc:!0,args:arguments})},r.utc=function(e){var t=n(this.toDate(),{locale:this.$L,utc:!0});return e?t.add(this.utcOffset(),Nn):t},r.local=function(){return n(this.toDate(),{locale:this.$L,utc:!1})};var a=r.parse;r.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),a.call(this,e)};var i=r.init;r.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else i.call(this)};var s=r.utcOffset;r.utcOffset=function(e,t){var n=this.$utils().u;if(n(e))return this.$u?0:n(this.$offset)?s.call(this):this.$offset;if("string"==typeof e&&null===(e=function(e){void 0===e&&(e="");var t=e.match(Tn);if(!t)return null;var n=(""+t[0]).match(In)||["-",0,0],r=n[0],a=60*+n[1]+ +n[2];return 0===a?0:"+"===r?a:-a}(e)))return this;var r=Math.abs(e)>16?e:60*e,a=this;if(t)return a.$offset=r,a.$u=0===e,a;if(0!==e){var i=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(a=this.local().add(r+i,Nn)).$offset=r,a.$x.$localOffset=i}else a=this.utc();return a};var l=r.format;r.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,t)},r.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},r.isUTC=function(){return!!this.$u},r.toISOString=function(){return this.toDate().toISOString()},r.toString=function(){return this.toDate().toUTCString()};var o=r.toDate;r.toDate=function(e){return"s"===e&&this.$offset?n(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():o.call(this)};var c=r.diff;r.diff=function(e,t,r){if(e&&this.$u===e.$u)return c.call(this,e,t,r);var a=this.local(),i=n(e).local();return c.call(a,i,t,r)}})),_n.exports));var En,Ln={exports:{}},An=(En||(En=1,Ln.exports=function(){var e={year:0,month:1,day:2,hour:3,minute:4,second:5},t={};return function(n,r,a){var i,s=function(e,n,r){void 0===r&&(r={});var a=new Date(e);return function(e,n){void 0===n&&(n={});var r=n.timeZoneName||"short",a=e+"|"+r,i=t[a];return i||(i=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:r}),t[a]=i),i}(n,r).formatToParts(a)},l=function(t,n){for(var r=s(t,n),i=[],l=0;l<r.length;l+=1){var o=r[l],c=o.type,d=o.value,u=e[c];u>=0&&(i[u]=parseInt(d,10))}var h=i[3],m=24===h?0:h,p=i[0]+"-"+i[1]+"-"+i[2]+" "+m+":"+i[4]+":"+i[5]+":000",f=+t;return(a.utc(p).valueOf()-(f-=f%1e3))/6e4},o=r.prototype;o.tz=function(e,t){void 0===e&&(e=i);var n,r=this.utcOffset(),s=this.toDate(),l=s.toLocaleString("en-US",{timeZone:e}),o=Math.round((s-new Date(l))/1e3/60),c=15*-Math.round(s.getTimezoneOffset()/15)-o;if(Number(c)){if(n=a(l,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(c,!0),t){var d=n.utcOffset();n=n.add(r-d,"minute")}}else n=this.utcOffset(0,t);return n.$x.$timezone=e,n},o.offsetName=function(e){var t=this.$x.$timezone||a.tz.guess(),n=s(this.valueOf(),t,{timeZoneName:e}).find(function(e){return"timezonename"===e.type.toLowerCase()});return n&&n.value};var c=o.startOf;o.startOf=function(e,t){if(!this.$x||!this.$x.$timezone)return c.call(this,e,t);var n=a(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return c.call(n,e,t).tz(this.$x.$timezone,!0)},a.tz=function(e,t,n){var r=n&&t,s=n||t||i,o=l(+a(),s);if("string"!=typeof e)return a(e).tz(s);var c=function(e,t,n){var r=e-60*t*1e3,a=l(r,n);if(t===a)return[r,t];var i=l(r-=60*(a-t)*1e3,n);return a===i?[r,a]:[e-60*Math.min(a,i)*1e3,Math.max(a,i)]}(a.utc(e,r).valueOf(),o,s),d=c[0],u=c[1],h=a(d).utcOffset(u);return h.$x.$timezone=s,h},a.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},a.tz.setDefault=function(e){i=e}}}()),Ln.exports);const zn=at(An);class Fn extends b.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}render(){return this.state.hasError?Et.jsx(U,{status:"error",title:"Đã xảy ra lỗi",subTitle:this.state.error?.message||"Vui lòng thử lại sau",extra:[Et.jsx(p,{type:"primary",onClick:()=>window.location.reload(),children:"Tải lại trang"},"reload"),Et.jsx(p,{onClick:()=>window.history.back(),children:"Quay lại"},"back")]}):this.props.children}}const Pn=(e,t)=>Mt.get(e,{params:t}),Mn=(e,t)=>Mt.post(e,t),On=(e,t)=>Mt.put(e,t),Rn=e=>Mt.delete(e),{Title:Bn,Text:Vn}=r,Un={},$n=({visible:t,onCancel:n})=>{const{currentUser:r}=Kt(),[a,l]=e.useState([]),[o,c]=e.useState(!1),[d,u]=e.useState({}),[h,m]=e.useState(null),[f,g]=e.useState(!1),[x,y]=e.useState(null),v=e.useMemo(()=>t?new Date:null,[t]),b=e.useCallback(async()=>{if(t&&!f){c(!0),y(null);try{const e=v;m(e),u({}),await Promise.all([T(),S(e)]),g(!0)}catch(e){y("Không thể tải dữ liệu lịch trực. Vui lòng thử lại.")}finally{c(!1)}}},[t,f,v]);e.useEffect(()=>{t?b():(g(!1),y(null))},[t,b]);const j=e=>"week"+e,k=e=>"Tuần "+e,w=e=>{const t=e.getDay(),n=0===t?-6:1-t,r=new Date(e);return r.setDate(e.getDate()+n),r},C=(e,t,n)=>{const r={},a=new Date(e);a.setDate(e.getDate()+7*(t-1));const i=(e=>{const t=new Date(e.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);const n=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-n.getTime())/864e5-3+(n.getDay()+6)%7)/7)})(a),s=a.getFullYear();return r.weekInfo={weekNumber:i,year:s,startDate:a,endDate:new Date(a.getTime()+5184e5)},["2","3","4","5","6","7","CN"].forEach((e,t)=>{const i=new Date(a);i.setDate(a.getDate()+t),r[e]={date:i.getDate(),month:i.getMonth()+1,fullDate:i},i.getDate()===n.getDate()&&i.getMonth()===n.getMonth()&&(i.getFullYear(),n.getFullYear())}),r},S=e=>{const t=(e=>{const t=w(new Date(2025,7,4)),n=w(e),r=(Math.floor((n.getTime()-t.getTime())/6048e5)+3)%4+1,a=new Date(n);return a.setDate(n.getDate()-7*(r-1)),{currentCycleWeek:r,cycleStartMonday:a,cycleEndDate:new Date(a.getTime()+23328e5)}})(e),n={};for(let r=1;4>=r;r++){const a=j(r),i=C(t.cycleStartMonday,r,e);n[a]=i,n[a].weekInfo}u(n)},T=async()=>{try{const e=await(async()=>{try{return(await Pn("/api/shift-schedule/schedule")).data}catch(x){throw x}})();if(!e.success)throw Error("Không thể tải dữ liệu lịch trực");l(e.data)}catch(e){throw e}},I=e.useCallback(()=>{if(!h||0===Object.keys(d).length)return[];const e=h,t=[{title:"STT",dataIndex:"stt",key:"stt",width:15,align:"center",render:e=>Et.jsx(Vn,{style:{fontSize:"14px",fontWeight:"600",letterSpacing:"0.025em"},children:e})},{title:"Họ đệm",dataIndex:"hoDem",key:"hoDem",width:40,align:"right",render:e=>Et.jsx(Vn,{style:{fontSize:"14px",alignItems:"center"},children:e})},{title:"Tên",dataIndex:"ten",key:"ten",width:20,render:e=>Et.jsx(Vn,{style:{fontSize:"14px"},children:e})}];return[{key:j(1),title:k(1)},{key:j(2),title:k(2)},{key:j(3),title:k(3)},{key:j(4),title:k(4)}].forEach(n=>{["2","3","4","5","6","7","CN"].forEach(r=>{const a=d[n.key]?.[r],i=a&&a.date===e.getDate()&&a.month===e.getMonth()+1;t.push({title:Et.jsxs("div",{style:{textAlign:"center"},children:[Et.jsx("div",{style:{color:i?"#ff4d4f":"inherit",fontWeight:i?"bold":"500",fontSize:"14px"},children:r}),Et.jsx("div",{style:{fontSize:"12px",color:i?"#ff4d4f":"#666666",fontWeight:i?"bold":"normal"},children:a?`${a.date}/${a.month}`:"N/A"})]}),key:`${n.key}_${r}`,width:12,align:"center",className:"",onCell:()=>({style:{backgroundColor:"",fontWeight:"normal"}}),render:(e,t)=>{const a=t[n.key]?.[r];return a?Et.jsx(Vn,{style:{fontWeight:"bold",textAlign:"center",color:i?"#ff4d4f":Un[a]||"#000000",fontSize:"12px"},children:a}):null}})})}),t},[h,d]),_=e.useMemo(()=>a.filter(e=>e&&e.stt),[a]),D=e.useCallback(e=>!(!r||!e.adName)&&e.adName.toLowerCase()===r.username?.toLowerCase(),[r]),E=Et.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",flexDirection:"column",gap:"16px"},children:[Et.jsx(s,{indicator:Et.jsx(q,{style:{fontSize:24},spin:!0}),size:"large"}),Et.jsx(Vn,{type:"secondary",children:"Đang tải dữ liệu lịch trực..."})]}),L=x&&Et.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",flexDirection:"column",gap:"16px"},children:[Et.jsx(Vn,{type:"danger",children:x}),Et.jsx(p,{type:"primary",onClick:b,children:"Thử lại"})]});return Et.jsxs($,{open:t,onCancel:n,width:"1650px",style:{maxHeight:"95vh"},footer:null,centered:!0,destroyOnHidden:!0,className:"shift-schedule-modal",children:[Et.jsxs("div",{style:{marginBottom:5,padding:"0 20px"},children:[Et.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[Et.jsx(Vn,{style:{fontSize:"16px",fontWeight:"600",color:"#2D3958"},children:"KHỐI CÔNG NGHỆ THÔNG TIN"}),Et.jsx("div",{children:Et.jsx(Vn,{style:{fontSize:"16px",fontWeight:"600",color:"#2D3958"},children:"LỊCH LÀM VIỆC DATACENTER"})})]}),Et.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Et.jsx(Vn,{style:{fontSize:"18px",fontWeight:"600",color:"#0F60FF"},children:"PHÒNG VẬN HÀNH VÀ TRANG THIẾT BỊ"}),Et.jsx("div",{style:{textAlign:"right"},children:h&&Et.jsxs("div",{style:{fontSize:"14px",color:"#ff4d4f",fontWeight:"600",marginTop:"2px"},children:[Et.jsx(N,{style:{marginRight:"2px"}}),"Hôm nay: ",["Chủ nhật","Thứ 2","Thứ 3","Thứ 4","Thứ 5","Thứ 6","Thứ 7"][h.getDay()]," ngày ",h.getDate(),"/",h.getMonth()+1,"/",h.getFullYear(),Et.jsx(p,{type:"primary",size:"small",onClick:async()=>{c(!0),y(null);try{const e=await(async()=>{try{return(await Mn("/api/shift-schedule/reload")).data}catch(x){throw x}})();if(!e.success)throw Error(e.message);i.success(e.message),await T()}catch(e){y("Lỗi khi cập nhật dữ liệu Excel lịch trực")}finally{c(!1)}},loading:o,className:"bg-[#0F60FF] hover:bg-[#0040FF] border-[#0F60FF] text-white ml-2",children:"Cập nhật"})]})})]})]}),o&&!f?E:x?L:Et.jsxs(Et.Fragment,{children:[Et.jsx(H,{columns:I(),dataSource:_,rowKey:"id",loading:o,pagination:!1,scroll:{x:800,y:460},size:"small",bordered:!1,showHeader:!0,className:"shift-schedule-table",rowClassName:(e,t)=>{const n=t%2==0?"even-row":"odd-row";return D(e)?n+" current-user-row":n}}),Et.jsxs("div",{style:{marginTop:12,padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[Et.jsx("div",{style:{marginBottom:12},children:Et.jsx(Vn,{strong:!0,style:{fontSize:"14px",color:"#2D3958"},children:"Ký hiệu ca trực:"})}),Et.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",fontSize:"12px"},children:[Et.jsxs("div",{children:[Et.jsxs("div",{style:{marginBottom:8},children:[Et.jsx(W,{color:Un.T,style:{marginRight:8,fontWeight:"bold"},children:"T"}),Et.jsx("span",{children:"Làm việc từ 8h - 17h tại Tầng 3 -108 THĐ"})]}),Et.jsxs("div",{style:{marginBottom:8},children:[Et.jsx(W,{color:Un.T1,style:{marginRight:8,fontWeight:"bold"},children:"T1"}),Et.jsx("span",{children:"Làm việc từ 6h - 14h tại Tầng 3 -108 THĐ"})]}),Et.jsxs("div",{style:{marginBottom:8},children:[Et.jsx(W,{color:Un.T2,style:{marginRight:8,fontWeight:"bold"},children:"T2"}),Et.jsx("span",{children:"Làm việc từ 14h - 22h tại Tầng 3 -108 THĐ"})]}),Et.jsxs("div",{style:{marginBottom:8},children:[Et.jsx(W,{color:Un.T3,style:{marginRight:8,fontWeight:"bold"},children:"T3"}),Et.jsx("span",{children:"Làm việc từ 22h - 06h tại Tầng 3 -108 THĐ"})]}),Et.jsxs("div",{style:{marginBottom:8},children:[Et.jsx(W,{color:Un.N,style:{marginRight:8,fontWeight:"bold"},children:"N"}),Et.jsx("span",{children:"Làm việc từ 8h - 17h Nguyễn Lương Bằng"})]})]}),Et.jsxs("div",{children:[Et.jsxs("div",{style:{marginBottom:8},children:[Et.jsx(W,{color:Un.H1,style:{marginRight:8,fontWeight:"bold"},children:"H1"}),Et.jsx("span",{children:"Làm việc từ 7h30 - 18h30 tại LHL"})]}),Et.jsxs("div",{style:{marginBottom:8},children:[Et.jsx(W,{color:Un.H2,style:{marginRight:8,fontWeight:"bold"},children:"H2"}),Et.jsx("span",{children:"Làm việc từ 18h30 - 7h30 tại LHL"})]}),Et.jsxs("div",{style:{marginBottom:8},children:[Et.jsx(W,{color:Un.V1,style:{marginRight:8,fontWeight:"bold"},children:"V1"}),Et.jsx("span",{children:"Làm việc từ 7h30 - 18h30 tại VC"})]}),Et.jsxs("div",{style:{marginBottom:8},children:[Et.jsx(W,{color:Un.V2,style:{marginRight:8,fontWeight:"bold"},children:"V2"}),Et.jsx("span",{children:"Làm việc từ 18h30 - 7h30 tại VC"})]}),Et.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center"},children:[Et.jsx("span",{style:{display:"inline-block",width:32,height:22,background:"#fff",border:"2px solid #fff",marginRight:8}}),Et.jsx("span",{style:{fontStyle:"italic",color:"#666"},children:"Nghỉ giãn ca "})]})]})]})]})]})]})};K.extend(Dn),K.extend(zn),K.tz.setDefault("Asia/Bangkok");const Hn={vertical:{gridTemplateColumns:e=>1===e?"md:grid-cols-1 md:max-w-md md:mx-auto":2===e?"md:grid-cols-2":3===e?"md:grid-cols-3":4===e?"md:grid-cols-4":5===e?"md:grid-cols-5":6===e?"md:grid-cols-6":"md:grid-cols-auto-fit",containerClass:e=>`grid grid-cols-1 ${Hn.vertical.gridTemplateColumns(e)} gap-6`}},Wn=b.memo(({color:e,children:t})=>Et.jsx("span",{className:"px-2 py-1 rounded-full text-sm font-medium "+e,children:t})),qn=e=>{switch(e){case"doing":return"bg-green-100 text-green-800";case"handover":return"bg-yellow-100 text-yellow-800";case"done":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Kn=e=>{switch(e){case"doing":return"Đang làm việc";case"handover":return"Đang bàn giao";case"done":return"Đã kết thúc";case"waiting":return"Đang chờ";default:return"Chưa bắt đầu"}},Yn=e=>e.startsWith("T")?"Trần Hưng Đạo":e.startsWith("H")?"Hòa Lạc":e.startsWith("V")?"Vân Canh":"",Qn=(e,t)=>!!e.message&&(t(e.message),setTimeout(()=>{t(null)},1e4),!0),Xn=(e,t)=>!!e.response?.data?.message&&(t(e.response.data.message),setTimeout(()=>{t(null)},15e3),!0),Gn=b.memo(({data:t,loading:n,dateFilter:r,onDateFilterChange:a,pagination:i,onPaginationChange:s,searchText:l,onSearchChange:o,onOpenShiftSchedule:c})=>{const d=e.useId(),h=[{title:"Ca làm việc",dataIndex:"code",key:"code",className:"custom-header border-gray-200",width:120,render:e=>Et.jsxs("span",{className:"text-sm font-medium",children:["Ca ",e]})},{title:"Địa điểm",dataIndex:"code",key:"location",className:"custom-header border-gray-200",width:120,render:e=>Et.jsx("span",{children:Yn(e)})},{title:"Ngày",dataIndex:"date",key:"date",className:"custom-header border-gray-200",width:120,render:e=>ut(new Date(e),"dd/MM/yyyy",{locale:kn})},{title:"Thành viên",dataIndex:"Users",key:"users",className:"custom-header border-gray-200",render:(e,t)=>Et.jsx("span",{children:"done"===t.status?t.Users?.map(e=>e.fullname).join(", ")||"Chưa có thành viên":e?.map(e=>e.fullname).join(", ")||"Chưa có thành viên"})},{title:"Trạng thái",dataIndex:"status",key:"status",className:"custom-header border-gray-200",width:120,defaultSortOrder:"ascend",sorter:(e,t)=>{const n={doing:2,handover:1,waiting:3,done:4};return n[e.status]-n[t.status]},render:e=>Et.jsx(Wn,{color:qn(e),children:Et.jsx("span",{className:"text-xs",children:Kn(e)})})}];return Et.jsxs("div",{className:"p-6 bg-[#F8F9FD]",children:[Et.jsxs("div",{className:"flex justify-between items-center mb-6",children:[Et.jsx("h3",{className:"text-base font-medium text-[#2D3958]",children:"Danh sách ca làm việc"}),Et.jsxs(m,{children:[Et.jsx(p,{type:"primary",icon:Et.jsx(N,{}),onClick:c,className:"bg-[#0F60FF] hover:bg-[#0040FF] border-[#0F60FF]",children:"Lịch làm việc"}),Et.jsx("input",{type:"text",placeholder:"Tìm kiếm ...",value:l,onChange:o,className:"px-3 py-1 border border-[#E5E9F2] rounded-lg focus:border-[#0F60FF] focus:outline-none",style:{minWidth:"150px"},id:d+"-search","aria-label":"Tìm kiếm ca làm việc"}),Et.jsx(u,{value:r,placeholder:"Chọn ngày ... ",onChange:a,locale:Cn,allowClear:!0,className:"border-[#E5E9F2] hover:border-[#0F60FF] rounded-lg"})]})]}),Et.jsx(H,{dataSource:t,columns:h,bordered:!0,rowKey:e=>`shift-${e.code}-${e.date}`,size:"small",id:d,pagination:{current:i.page,pageSize:i.limit,total:i.total,onChange:s,showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:["15","20","50","100"],defaultPageSize:15,locale:{items_per_page:"/ Trang"},showTotal:e=>`Tổng số ${e} ca`},loading:n,className:"custom-table",locale:{emptyText:r?"Không có ca làm việc nào trong ngày đã chọn":"Không có dữ liệu ca làm việc"}})]})}),Jn=b.memo(({shift:t,onSelect:n,currentShift:r})=>{const a=e.useId(),{currentUser:i}=Kt(),s="manager"===i?.role?.toLowerCase(),l=e.useMemo(()=>t.Users?.map(e=>e.fullname).join(", ")||"Chưa có thành viên",[t.Users]),o=e.useMemo(()=>!s&&!r&&"done"!==t.status&&"handover"!==t.status&&["waiting","doing","not-started"].includes(t.status),[r,t.status,s]);return Et.jsxs("div",{className:"flex flex-col bg-white rounded-xl border border-solid border-[#E5E9F2] p-4 hover:border-[#0F60FF] transition-colors shadow-sm",id:a,"data-shift-id":t.id,children:[Et.jsxs("div",{className:"flex justify-between items-start mb-3",children:[Et.jsxs("h3",{className:"font-medium text-[#2D3958] ",children:["Ca ",t.code]}),Et.jsx(Wn,{color:qn(t.status),children:Kn(t.status)})]}),Et.jsx("div",{className:"text-sm text-[#8F95B2] mb-3 line-clamp-2",children:"doing"!==t.status?Et.jsx("div",{className:"flex flex-col gap-1",children:Et.jsxs("div",{className:"flex items-center gap-1",children:[Et.jsx("span",{className:"text-[#8F95B2]"}),Et.jsx("span",{className:"text-[#8F95B2]",children:l})]})}):Et.jsxs("div",{className:"flex items-center gap-1",children:[Et.jsx("span",{className:"text-[#8F95B2]"}),Et.jsx("span",{className:"font-medium text-blue-600 ",children:l})]})}),Et.jsx("div",{className:"mt-auto",children:o&&Et.jsx("button",{onClick:()=>n(t),className:"w-full px-4 py-2 text-sm font-medium text-white bg-[#0F60FF] rounded-lg hover:bg-[#0040FF] disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Chọn ca"})})]})}),Zn=b.memo(({shifts:t,title:n,currentShift:r,onSelect:a,locations:i,shiftLayout:s})=>{const l=e.useId();if(!(t&&i&&s&&s.length>0))return Et.jsxs("div",{className:"space-y-6",id:l,children:[Et.jsx("h3",{className:"font-medium text-[#2D3958] mb-3",children:n}),Et.jsx("div",{className:"flex justify-center py-8",children:Et.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})]});const o=Array.from(new Set(t.map(e=>e.code[0]))),c=s.filter(e=>o.includes(e.code)).map(e=>({code:e.code,name:e.name,hasData:!0})),d=["T","H","V"],u=[...c].sort((e,t)=>d.indexOf(e.code)-d.indexOf(t.code)),h=s.length;return Et.jsxs("div",{className:"space-y-4",children:[Et.jsx("h3",{className:"font-medium text-[#2D3958] mb-3",children:n}),Et.jsx("div",{className:Hn.vertical.containerClass(h),style:{gridTemplateColumns:h>6?"repeat(auto-fit, minmax(300px, 1fr))":void 0},children:u.map(e=>{const s=((e,t)=>{const n=Yn(e);return t.find(e=>e.name===n)})(e.code+"1",i),l=e.name||s?.name||("T"===e.code?"Trần Hưng Đạo":"H"===e.code?"Hòa Lạc":"V"===e.code?"Vân Canh":e.code);return Et.jsxs("div",{children:[Et.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[Et.jsx("h3",{className:"font-medium text-[#2D3958]",children:l}),s&&Et.jsx(k,{title:Et.jsxs("div",{children:[s.description&&Et.jsxs("div",{children:[Et.jsx("strong",{children:"Địa chỉ:"})," ",s.description]}),s.hotline&&Et.jsxs("div",{children:[Et.jsx("strong",{children:"Hotline:"})," ",s.hotline]})]}),placement:"right",children:Et.jsx(Y,{className:"text-blue-500 cursor-pointer"})})]}),Et.jsx("div",{className:"space-y-4",children:t.filter(t=>t.code.startsWith(e.code)).map(e=>Et.jsx(Jn,{shift:e,currentShift:r,onSelect:a},`shift-${e.code}-${e.date}`))})]},`location-${e.code}-${n}`)})})]})});function er(){const[t,r]=e.useTransition(),[a,i]=e.useState(""),l=e.useDeferredValue(a),o=e.useId(),[c,d]=e.useState(null),[u,h]=e.useState([]),[m,p]=e.useState([]),[f,g]=e.useState(!1),[x,y]=e.useState(null),[v,b]=e.useState(!1),[j,w]=e.useState(!1),[C,S]=e.useState(null),[N,T]=e.useState(null),[I,_]=e.useState(null),[D,E]=e.useState([]),[L,A]=e.useState(null),[z,F]=e.useState(null),[P,M]=e.useState(!1),[O,R]=e.useState(!1),[B,V]=e.useState(null),[U,$]=e.useState({page:1,limit:15,total:0,totalPages:0}),H=e.useRef(null),W=e.useRef(!1),q=e.useRef(!1),Y=mt(),{currentUser:X}=Kt(),G="manager"===X?.role?.toLowerCase(),J=e.useMemo(()=>{if(!m||!Array.isArray(m))return[];if(!l.trim())return m;const e=l.toLowerCase();return m.filter(t=>!!t.code.toLowerCase().includes(e)||!!Yn(t.code).toLowerCase().includes(e)||t.Users?.some(t=>t.fullname.toLowerCase().includes(e))||!1)},[m,l]),Z=e.useCallback(()=>{localStorage.clear(),Y("/login")},[Y]),ee=e.useCallback(async e=>{if(!e)return A(null),void V(null);try{const{data:t}=await Mt.get("/api/shifts/handover/by-status/all",{params:{toShiftId:e}}),n=t.handovers?.find(e=>"pending"===e.status||"completed"===e.status);n?(A(n.id),V(n.status)):(A(null),V(null))}catch(t){401===t.response?.status&&Z(),A(null),V(null)}},[Z]),te=e.useCallback(async()=>{try{const{data:e}=await Mt.get("/api/shifts/layout"),t=e.data||[];F(t)}catch(e){401===e.response?.status&&Z(),F([])}},[Z]),ne=e.useCallback(async()=>{try{const{data:e}=await Mt.get("/api/locations");E(e)}catch(e){401===e.response?.status&&Z()}},[Z]),re=e.useCallback(async()=>{try{const{data:e}=await Mt.get("/api/shifts/current");e.shift?.id?(d(e.shift),setTimeout(()=>{ee(e.shift.id)},0)):(d(null),A(null),V(null)),e.message&&_(e.message)}catch(e){401===e.response?.status&&Z(),e.response?.data?.message&&_(e.response.data.message)}},[Z]),ae=e.useCallback(async()=>{try{const{data:e}=await Mt.get("/api/shifts/today-available");h(e),e.message&&_(e.message)}catch(e){401===e.response?.status&&Z(),e.response?.data?.message&&_(e.response.data.message)}},[]),ie=e.useCallback(async()=>{try{g(!0);const e={page:U.page,limit:U.limit};x&&(e.date=x.format("YYYY-MM-DD"));const{data:t}=await Mt.get("/api/shifts/all",{params:e});p(t.shifts),$(e=>({...e,total:t.total,totalPages:t.totalPages})),t.message&&_(t.message)}catch(e){401===e.response?.status&&Z(),e.response?.data?.message&&_(e.response.data.message)}finally{g(!1)}},[U.page,U.limit,x]),se=e.useCallback(async()=>{H.current&&H.current.abort(),H.current=new AbortController;try{await re(),await Promise.all([ae(),ie(),ne(),te()]),r(()=>{g(!1)})}catch(e){if("AbortError"===e.name)return;401===e.response?.status&&Z()}},[re,ae,ie,ne,te,Z]),le=e.useCallback(e=>{_(null),r(()=>{S(e.code),T(e.date),b(!0)})},[r]),oe=e.useCallback(async()=>{try{const{data:e}=await Mt.put("/api/shifts/select",{shiftCode:C,shiftDate:N});Qn(e,_);const t=(await Mt.get("/api/shifts/current")).data.shift;d(t),t?.id&&setTimeout(()=>{ee(t.id)},0),await Promise.all([ae(),ie(),ne(),te()])}catch(e){Xn(e,_)}finally{b(!1),S(null),T(null)}},[C,N,ee,ae,ie,ne,te]),ce=e.useCallback(()=>{_(null),w(!0)},[]),de=e.useCallback(async()=>{try{const{data:e}=await Mt.put(`/api/shifts/${c.id}/exit`);Qn(e,_),se()}catch(e){Xn(e,_)}finally{w(!1)}},[c,se]),ue=e.useCallback(()=>{se()},[se]),he=e.useCallback((e,t)=>{$(n=>({...n,page:e,limit:t}))},[]),me=e.useCallback(e=>{y(e),$(e=>({...e,page:1}))},[]),pe=e.useCallback(()=>{y(null),$(e=>({...e,page:1}))},[]),fe=e.useCallback(()=>{R(!0)},[]),ge=e.useCallback(()=>{R(!1)},[]),xe=[{key:"tab-current-shift",label:"Ca làm việc",children:e.useCallback(()=>{if(!P||!z)return Et.jsx("div",{className:"flex justify-center items-center py-16",children:Et.jsxs("div",{className:"text-center",children:[Et.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),Et.jsx("p",{className:"text-gray-600",children:"Đang tải dữ liệu ca làm việc..."})]})});const e=u.filter(e=>{const t=new Date(e.date),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()}),t=u.filter(e=>{const t=new Date(e.date),n=new Date;return n.setDate(n.getDate()-1),t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()&&("handover"===e.status||"doing"===e.status||"waiting"===e.status||"not-started"===e.status)});return Et.jsxs("div",{className:"space-y-6 p-6 bg-[#F8F9FD]",children:[I&&Et.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 mb-4",children:Et.jsxs("div",{className:"flex justify-between items-start",children:[Et.jsxs("div",{className:"flex",children:[Et.jsx("div",{className:"flex-shrink-0",children:Et.jsx("svg",{className:"h-5 w-5 text-blue-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:Et.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),Et.jsx("div",{className:"ml-3",children:Et.jsx("p",{className:"text-sm text-blue-700",children:I})})]}),Et.jsx("button",{onClick:()=>_(null),className:"text-blue-400 hover:text-blue-600 transition-colors","aria-label":"Đóng thông báo",children:Et.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Et.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),!G&&Et.jsx("div",{className:"bg-white rounded-xl border border-[#E5E9F2] p-4 shadow-sm",children:Et.jsxs("div",{className:"flex justify-between items-center",children:[Et.jsxs("div",{className:"flex items-center gap-2",children:[Et.jsx("span",{className:"text-[#2D3958] font-medium",children:"Bạn đang làm:"}),c?Et.jsxs("div",{className:"flex items-center gap-2",children:[Et.jsxs("span",{className:"text-[#2D3958]",children:["Ca ",c.code," (",ut(new Date(c.date),"dd/MM/yyyy",{locale:kn}),")"]}),Et.jsx(Wn,{color:qn(c.status),children:Kn(c.status)})]}):Et.jsx("span",{className:"text-[#8F95B2]",children:"Bạn chưa vào ca nào"})]}),Et.jsxs("div",{className:"flex items-center gap-2",children:[c&&"completed"===B&&Et.jsx(k,{title:"Vào trang quản lý công việc của ca hiện tại",placement:"top",children:Et.jsx("button",{onClick:()=>Y("/dc/my-shifts"),className:"px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors",children:"Vào ca làm việc"})}),c&&L&&"completed"!==B&&Et.jsx(k,{title:"Xác nhận biên bản bàn giao ca",placement:"top",children:Et.jsx("button",{onClick:()=>Y("/dc/handover/"+L),className:"px-4 py-2 text-sm font-medium text-green-600 bg-green-50 rounded-lg hover:bg-green-100 transition-colors",children:"Nhận bàn giao"})}),c&&Et.jsx(k,{title:"Thoát khỏi ca làm việc hiện tại",placement:"top",children:Et.jsx("button",{onClick:ce,className:"px-4 py-2 text-sm font-medium text-red-600 bg-red-50 rounded-lg hover:bg-red-100 transition-colors",children:"Thoát ca"})}),!c&&Et.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 px-3 py-2 rounded-lg",children:[Et.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Et.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Et.jsx("span",{children:"Vui lòng chọn ca làm việc để sử dụng các tính năng quản lý công việc"})]})]})]})}),Et.jsx("h2",{className:"text-xxl font-semibold text-[#2D3958] text-center mb-6",children:"Ca làm việc tại các Trung Tâm Dữ Liệu"}),Et.jsx(Zn,{shifts:e,title:ut(new Date,"dd/MM/yyyy",{locale:kn}),currentShift:c,onSelect:le,locations:D,shiftLayout:z}),t.length>0&&Et.jsx(Zn,{shifts:t,title:ut(K().subtract(1,"day").toDate(),"dd/MM/yyyy",{locale:kn}),currentShift:c,onSelect:le,locations:D,shiftLayout:z})]})},[u,c,ce,ue,le,I,G,D,z,P,B,L,Y])()},{key:"tab-all-shifts",label:"Danh sách ca làm việc",children:f?Et.jsx("div",{className:"flex justify-center py-8",children:Et.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):Et.jsxs(Et.Fragment,{children:[t&&Et.jsxs("div",{className:"flex justify-center items-center py-4",children:[Et.jsx(s,{size:"large"}),Et.jsx("span",{className:"ml-2 text-gray-600",children:"Đang cập nhật dữ liệu..."})]}),Et.jsx(Gn,{data:J,loading:f||t,dateFilter:x,onDateFilterChange:me,onClearDateFilter:pe,pagination:U,onPaginationChange:he,searchText:a,onSearchChange:e=>i(e.target.value),onOpenShiftSchedule:fe})]})}];return e.useEffect(()=>{let e=null,t=0,n=null,a=!0,i=null,s=Date.now(),l=1e3,o=!1,u=!1;const m=()=>{try{if(u)return;if(o)return;if(e&&e.readyState===WebSocket.OPEN)return;e&&(e.close(),e=null),o=!0,u=!0,e=new WebSocket("wss://192.168.1.7/ws"),e.onopen=()=>{a&&(o=!1,t=0,l=1e3,n&&(clearTimeout(n),n=null),i=setInterval(()=>{e.readyState===WebSocket.OPEN&&(e.send(JSON.stringify({type:"heartbeat"})),s=Date.now())},15e3))},e.onmessage=e=>{if(a)try{const t=JSON.parse(e.data);"shift_update"===t.type&&(r(()=>{h(e=>{const n=e.findIndex(e=>e.id===t.shift.id);if(-1===n)return"select"===t.changeType?[t.shift,...e]:e;const r=[...e],a=r[n],i=a?.version||0,s=t.shift?.version||0;if(i>s)return e;if(s===i&&new Date(a.updatedAt||0).getTime()>=new Date(t.shift.updatedAt||0).getTime())return e;const l={...a,...t.shift,status:t.shift.status||a.status,version:s,updatedAt:t.shift.updatedAt||(new Date).toISOString()};return r[n]=l,r})}),t.shift.id===c?.id&&r(()=>{d(e=>{if(!e)return t.shift;const n=e?.version||0,r=t.shift?.version||0;if(n>r)return e;if(r===n&&new Date(e.updatedAt||0).getTime()>=new Date(t.shift.updatedAt||0).getTime())return e;const a={...e,...t.shift,version:r,updatedAt:t.shift.updatedAt||(new Date).toISOString()};return"select"!==t.changeType&&"handover"!==t.changeType||setTimeout(()=>{ee(a.id)},100),a})}),r(()=>{p(e=>{const n=e.findIndex(e=>e.id===t.shift.id);if(-1===n)return e;const r=[...e],a=r[n],i=a?.version||0,s=t.shift?.version||0;if(i>s)return e;if(s===i&&new Date(a.updatedAt||0).getTime()>=new Date(t.shift.updatedAt||0).getTime())return e;const l={...a,...t.shift,version:s,updatedAt:t.shift.updatedAt||(new Date).toISOString()};return r[n]=l,r})}))}catch(t){}},e.onerror=t=>{a&&Date.now()-s>5e3&&e.close()},e.onclose=e=>{a&&(o=!1,i&&(clearInterval(i),i=null),1e3!==e.code&&10>t&&(t++,l=Math.min(2*l,3e4),n=setTimeout(m,l)))}}catch(f){10>t&&a&&(t++,l=Math.min(2*l,3e4),n=setTimeout(m,l))}};return m(),()=>{a=!1,u=!1,e&&(e.close(1e3,"Component unmounting"),e=null),n&&(clearTimeout(n),n=null),i&&(clearInterval(i),i=null)}},[]),e.useEffect(()=>{if(W.current)return;let e;return W.current=!0,(async()=>{try{await re(),await ne(),await te(),await Promise.all([ae(),ie()]),M(!0)}catch(t){M(!0)}e=setInterval(()=>{document.querySelector('[data-ws-status="connected"]')||se()},9e5)})(),()=>{W.current=!1,e&&clearInterval(e),H.current&&H.current.abort()}},[]),e.useEffect(()=>{q.current?ie():q.current=!0},[U.page,U.limit,x]),e.useEffect(()=>{c?.id?setTimeout(()=>{ee(c.id)},50):(A(null),V(null))},[c?.id,ee]),Et.jsx(Fn,{children:Et.jsxs("div",{className:"bg-[#F8F9FD] rounded-lg shadow-sm",id:o,children:[Et.jsx(n,{defaultActiveKey:"tab-current-shift",items:xe,className:"custom-tabs",tabBarStyle:{marginBottom:0,paddingLeft:"24px",borderBottom:"1px solid #E5E9F2"}}),Et.jsx("style",{children:"\n        .ant-tabs-nav {\n          margin: 0 !important;\n        }\n        .ant-tabs-tab {\n          padding: 12px 0 !important;\n          margin: 0 24px 0 0 !important;\n        }\n        .ant-tabs-tab-btn {\n          color: #8F95B2 !important;\n          font-weight: 500 !important;\n        }\n        .ant-tabs-tab-active .ant-tabs-tab-btn {\n          color: #0F60FF !important;\n        }\n        .ant-tabs-ink-bar {\n          background: #0F60FF !important;\n          height: 2px !important;\n        }\n        \n        /* Responsive grid cho nhiều nhóm ca */\n        @media (min-width: 768px) {\n          .md\\:grid-cols-3 {\n            grid-template-columns: repeat(3, 1fr);\n          }\n          .md\\:grid-cols-4 {\n            grid-template-columns: repeat(4, 1fr);\n          }\n          .md\\:grid-cols-5 {\n            grid-template-columns: repeat(5, 1fr);\n          }\n          .md\\:grid-cols-6 {\n            grid-template-columns: repeat(6, 1fr);\n          }\n        }\n        \n        /* Responsive cho màn hình lớn */\n        @media (min-width: 1024px) {\n          .md\\:grid-cols-4 {\n            grid-template-columns: repeat(4, 1fr);\n          }\n          .md\\:grid-cols-5 {\n            grid-template-columns: repeat(5, 1fr);\n          }\n          .md\\:grid-cols-6 {\n            grid-template-columns: repeat(6, 1fr);\n          }\n        }\n        \n        /* Responsive cho màn hình rất lớn */\n        @media (min-width: 1280px) {\n          .md\\:grid-cols-5 {\n            grid-template-columns: repeat(5, 1fr);\n          }\n          .md\\:grid-cols-6 {\n            grid-template-columns: repeat(6, 1fr);\n          }\n        }\n      "}),Et.jsx(Q,{title:"Xác nhận chọn ca",open:v,onOk:oe,onCancel:()=>{b(!1),S(null)},okText:"Xác nhận",cancelText:"Hủy",okButtonProps:{className:"bg-[#003c71]"},children:Et.jsxs("p",{children:["Bạn có chắc chắn muốn chọn ca ",C," không?"]})}),Et.jsx(Q,{title:"Xác nhận thoát ca",open:j,onOk:de,onCancel:()=>w(!1),okText:"Xác nhận",cancelText:"Hủy",okButtonProps:{className:"bg-[#003c71]"},children:Et.jsx("p",{children:"Bạn có chắc chắn muốn thoát ca hiện tại không?"})}),Et.jsx($n,{visible:O,onCancel:ge,locationId:"all"})]})})}var tr,nr,rr,ar={exports:{}},ir=(tr||(tr=1,nr=ar,rr=ar.exports,function(){var e,t="Expected a function",n="__lodash_hash_undefined__",r="__lodash_placeholder__",a=32,i=128,s=1/0,l=9007199254740991,o=NaN,c=4294967295,d=[["ary",i],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",a],["partialRight",64],["rearg",256]],u="[object Arguments]",h="[object Array]",m="[object Boolean]",p="[object Date]",f="[object Error]",g="[object Function]",x="[object GeneratorFunction]",y="[object Map]",v="[object Number]",b="[object Object]",j="[object Promise]",k="[object RegExp]",w="[object Set]",C="[object String]",S="[object Symbol]",N="[object WeakMap]",T="[object ArrayBuffer]",I="[object DataView]",_="[object Float32Array]",D="[object Float64Array]",E="[object Int8Array]",L="[object Int16Array]",A="[object Int32Array]",z="[object Uint8Array]",F="[object Uint8ClampedArray]",P="[object Uint16Array]",M="[object Uint32Array]",O=/\b__p \+= '';/g,R=/\b(__p \+=) '' \+/g,B=/(__e\(.*?\)|\b__t\)) \+\n'';/g,V=/&(?:amp|lt|gt|quot|#39);/g,U=/[&<>"']/g,$=RegExp(V.source),H=RegExp(U.source),W=/<%-([\s\S]+?)%>/g,q=/<%([\s\S]+?)%>/g,K=/<%=([\s\S]+?)%>/g,Y=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q=/^\w*$/,X=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,G=/[\\^$.*+?()[\]{}|]/g,J=RegExp(G.source),Z=/^\s+/,ee=/\s/,te=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ne=/\{\n\/\* \[wrapped with (.+)\] \*/,re=/,? & /,ae=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ie=/[()=,{}\[\]\/\s]/,se=/\\(\\)?/g,le=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,oe=/\w*$/,ce=/^[-+]0x[0-9a-f]+$/i,de=/^0b[01]+$/i,ue=/^\[object .+?Constructor\]$/,he=/^0o[0-7]+$/i,me=/^(?:0|[1-9]\d*)$/,pe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,fe=/($^)/,ge=/['\n\r\u2028\u2029\\]/g,xe="\\ud800-\\udfff",ye="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ve="\\u2700-\\u27bf",be="a-z\\xdf-\\xf6\\xf8-\\xff",je="A-Z\\xc0-\\xd6\\xd8-\\xde",ke="\\ufe0e\\ufe0f",we="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ce="["+xe+"]",Se="["+we+"]",Ne="["+ye+"]",Te="\\d+",Ie="["+ve+"]",_e="["+be+"]",De="[^"+xe+we+Te+ve+be+je+"]",Ee="\\ud83c[\\udffb-\\udfff]",Le="[^"+xe+"]",Ae="(?:\\ud83c[\\udde6-\\uddff]){2}",ze="[\\ud800-\\udbff][\\udc00-\\udfff]",Fe="["+je+"]",Pe="\\u200d",Me="(?:"+_e+"|"+De+")",Oe="(?:"+Fe+"|"+De+")",Re="(?:['’](?:d|ll|m|re|s|t|ve))?",Be="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ve="(?:"+Ne+"|"+Ee+")?",Ue="["+ke+"]?",$e=Ue+Ve+"(?:"+Pe+"(?:"+[Le,Ae,ze].join("|")+")"+Ue+Ve+")*",He="(?:"+[Ie,Ae,ze].join("|")+")"+$e,We="(?:"+[Le+Ne+"?",Ne,Ae,ze,Ce].join("|")+")",qe=RegExp("['’]","g"),Ke=RegExp(Ne,"g"),Ye=RegExp(Ee+"(?="+Ee+")|"+We+$e,"g"),Qe=RegExp([Fe+"?"+_e+"+"+Re+"(?="+[Se,Fe,"$"].join("|")+")",Oe+"+"+Be+"(?="+[Se,Fe+Me,"$"].join("|")+")",Fe+"?"+Me+"+"+Re,Fe+"+"+Be,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])|\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Te,He].join("|"),"g"),Xe=RegExp("["+Pe+xe+ye+ke+"]"),Ge=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Je=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ze=-1,et={};et[_]=et[D]=et[E]=et[L]=et[A]=et[z]=et[F]=et[P]=et[M]=!0,et[u]=et[h]=et[T]=et[m]=et[I]=et[p]=et[f]=et[g]=et[y]=et[v]=et[b]=et[k]=et[w]=et[C]=et[N]=!1;var tt={};tt[u]=tt[h]=tt[T]=tt[I]=tt[m]=tt[p]=tt[_]=tt[D]=tt[E]=tt[L]=tt[A]=tt[y]=tt[v]=tt[b]=tt[k]=tt[w]=tt[C]=tt[S]=tt[z]=tt[F]=tt[P]=tt[M]=!0,tt[f]=tt[g]=tt[N]=!1;var nt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},rt=parseFloat,at=parseInt,it="object"==typeof globalThis&&globalThis&&globalThis.Object===Object&&globalThis,st="object"==typeof self&&self&&self.Object===Object&&self,lt=it||st||Function("return this")(),ot=rr&&!rr.nodeType&&rr,ct=ot&&nr&&!nr.nodeType&&nr,dt=ct&&ct.exports===ot,ut=dt&&it.process,ht=function(){try{return ct&&ct.require&&ct.require("util").types||ut&&ut.binding&&ut.binding("util")}catch(In){}}(),mt=ht&&ht.isArrayBuffer,pt=ht&&ht.isDate,ft=ht&&ht.isMap,gt=ht&&ht.isRegExp,xt=ht&&ht.isSet,yt=ht&&ht.isTypedArray;function vt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function bt(e,t,n,r){for(var a=-1,i=null==e?0:e.length;++a<i;){var s=e[a];t(r,s,n(s),e)}return r}function jt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function kt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function wt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Ct(e,t){for(var n=-1,r=null==e?0:e.length,a=0,i=[];++n<r;){var s=e[n];t(s,n,e)&&(i[a++]=s)}return i}function St(e,t){return!(null==e||!e.length)&&Ft(e,t,0)>-1}function Nt(e,t,n){for(var r=-1,a=null==e?0:e.length;++r<a;)if(n(t,e[r]))return!0;return!1}function Tt(e,t){for(var n=-1,r=null==e?0:e.length,a=Array(r);++n<r;)a[n]=t(e[n],n,e);return a}function It(e,t){for(var n=-1,r=t.length,a=e.length;++n<r;)e[a+n]=t[n];return e}function _t(e,t,n,r){var a=-1,i=null==e?0:e.length;for(r&&i&&(n=e[++a]);++a<i;)n=t(n,e[a],a,e);return n}function Dt(e,t,n,r){var a=null==e?0:e.length;for(r&&a&&(n=e[--a]);a--;)n=t(n,e[a],a,e);return n}function Et(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Lt=Rt("length");function At(e,t,n){var r;return n(e,function(e,n,a){if(t(e,n,a))return r=n,!1}),r}function zt(e,t,n,r){for(var a=e.length,i=n+(r?1:-1);r?i--:++i<a;)if(t(e[i],i,e))return i;return-1}function Ft(e,t,n){return t==t?function(e,t,n){for(var r=n-1,a=e.length;++r<a;)if(e[r]===t)return r;return-1}(e,t,n):zt(e,Mt,n)}function Pt(e,t,n,r){for(var a=n-1,i=e.length;++a<i;)if(r(e[a],t))return a;return-1}function Mt(e){return e!=e}function Ot(e,t){var n=null==e?0:e.length;return n?Ut(e,t)/n:o}function Rt(t){return function(n){return null==n?e:n[t]}}function Bt(t){return function(n){return null==t?e:t[n]}}function Vt(e,t,n,r,a){return a(e,function(e,a,i){n=r?(r=!1,e):t(n,e,a,i)}),n}function Ut(t,n){for(var r,a=-1,i=t.length;++a<i;){var s=n(t[a]);s!==e&&(r=r===e?s:r+s)}return r}function $t(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Ht(e){return e?e.slice(0,ln(e)+1).replace(Z,""):e}function Wt(e){return function(t){return e(t)}}function qt(e,t){return Tt(t,function(t){return e[t]})}function Kt(e,t){return e.has(t)}function Yt(e,t){for(var n=-1,r=e.length;++n<r&&Ft(t,e[n],0)>-1;);return n}function Qt(e,t){for(var n=e.length;n--&&Ft(t,e[n],0)>-1;);return n}var Xt=Bt({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Gt=Bt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Jt(e){return"\\"+nt[e]}function Zt(e){return Xe.test(e)}function en(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function tn(e,t){return function(n){return e(t(n))}}function nn(e,t){for(var n=-1,a=e.length,i=0,s=[];++n<a;){var l=e[n];l!==t&&l!==r||(e[n]=r,s[i++]=n)}return s}function rn(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function an(e){return Zt(e)?function(e){for(var t=Ye.lastIndex=0;Ye.test(e);)++t;return t}(e):Lt(e)}function sn(e){return Zt(e)?function(e){return e.match(Ye)||[]}(e):function(e){return e.split("")}(e)}function ln(e){for(var t=e.length;t--&&ee.test(e.charAt(t)););return t}var on=Bt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),cn=function ee(xe){var ye,ve=(xe=null==xe?lt:cn.defaults(lt.Object(),xe,cn.pick(lt,Je))).Array,be=xe.Date,je=xe.Error,ke=xe.Function,we=xe.Math,Ce=xe.Object,Se=xe.RegExp,Ne=xe.String,Te=xe.TypeError,Ie=ve.prototype,_e=ke.prototype,De=Ce.prototype,Ee=xe["__core-js_shared__"],Le=_e.toString,Ae=De.hasOwnProperty,ze=0,Fe=(ye=/[^.]+$/.exec(Ee&&Ee.keys&&Ee.keys.IE_PROTO||""))?"Symbol(src)_1."+ye:"",Pe=De.toString,Me=Le.call(Ce),Oe=lt._,Re=Se("^"+Le.call(Ae).replace(G,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Be=dt?xe.Buffer:e,Ve=xe.Symbol,Ue=xe.Uint8Array,$e=Be?Be.allocUnsafe:e,He=tn(Ce.getPrototypeOf,Ce),We=Ce.create,Ye=De.propertyIsEnumerable,Xe=Ie.splice,nt=Ve?Ve.isConcatSpreadable:e,it=Ve?Ve.iterator:e,st=Ve?Ve.toStringTag:e,ot=function(){try{var e=oi(Ce,"defineProperty");return e({},"",{}),e}catch(In){}}(),ct=xe.clearTimeout!==lt.clearTimeout&&xe.clearTimeout,ut=be&&be.now!==lt.Date.now&&be.now,ht=xe.setTimeout!==lt.setTimeout&&xe.setTimeout,Lt=we.ceil,Bt=we.floor,dn=Ce.getOwnPropertySymbols,un=Be?Be.isBuffer:e,hn=xe.isFinite,mn=Ie.join,pn=tn(Ce.keys,Ce),fn=we.max,gn=we.min,xn=be.now,yn=xe.parseInt,vn=we.random,bn=Ie.reverse,jn=oi(xe,"DataView"),kn=oi(xe,"Map"),wn=oi(xe,"Promise"),Cn=oi(xe,"Set"),Sn=oi(xe,"WeakMap"),Nn=oi(Ce,"create"),Tn=Sn&&new Sn,_n={},Dn=Mi(jn),En=Mi(kn),Ln=Mi(wn),An=Mi(Cn),zn=Mi(Sn),Fn=Ve?Ve.prototype:e,Pn=Fn?Fn.valueOf:e,Mn=Fn?Fn.toString:e;function On(e){if(el(e)&&!$s(e)&&!(e instanceof Un)){if(e instanceof Vn)return e;if(Ae.call(e,"__wrapped__"))return Oi(e)}return new Vn(e)}var Rn=function(){function t(){}return function(n){if(!Zs(n))return{};if(We)return We(n);t.prototype=n;var r=new t;return t.prototype=e,r}}();function Bn(){}function Vn(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=e}function Un(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=c,this.__views__=[]}function $n(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Hn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Wn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function qn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Wn;++t<n;)this.add(e[t])}function Kn(e){var t=this.__data__=new Hn(e);this.size=t.size}function Yn(e,t){var n=$s(e),r=!n&&Us(e),a=!n&&!r&&Ks(e),i=!n&&!r&&!a&&ol(e),s=n||r||a||i,l=s?$t(e.length,Ne):[],o=l.length;for(var c in e)!t&&!Ae.call(e,c)||s&&("length"==c||a&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||fi(c,o))||l.push(c);return l}function Qn(t){var n=t.length;return n?t[Wr(0,n-1)]:e}function Xn(e,t){return Ei(Na(e),ir(t,0,e.length))}function Gn(e){return Ei(Na(e))}function Jn(t,n,r){(r!==e&&!Rs(t[n],r)||r===e&&!(n in t))&&rr(t,n,r)}function Zn(t,n,r){var a=t[n];Ae.call(t,n)&&Rs(a,r)&&(r!==e||n in t)||rr(t,n,r)}function er(e,t){for(var n=e.length;n--;)if(Rs(e[n][0],t))return n;return-1}function tr(e,t,n,r){return dr(e,function(e,a,i){t(r,e,n(e),i)}),r}function nr(e,t){return e&&Ta(t,Dl(t),e)}function rr(e,t,n){"__proto__"==t&&ot?ot(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ar(t,n){for(var r=-1,a=n.length,i=ve(a),s=null==t;++r<a;)i[r]=s?e:Sl(t,n[r]);return i}function ir(t,n,r){return t==t&&(r!==e&&(t=t>r?r:t),n!==e&&(t=n>t?n:t)),t}function sr(t,n,r,a,i,s){var l,o=1&n,c=2&n,d=4&n;if(r&&(l=i?r(t,a,i,s):r(t)),l!==e)return l;if(!Zs(t))return t;var h=$s(t);if(h){if(l=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Ae.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(t),!o)return Na(t,l)}else{var f=ui(t),j=f==g||f==x;if(Ks(t))return ba(t,o);if(f==b||f==u||j&&!i){if(l=c||j?{}:mi(t),!o)return c?function(e,t){return Ta(e,di(e),t)}(t,function(e,t){return e&&Ta(t,El(t),e)}(l,t)):function(e,t){return Ta(e,ci(e),t)}(t,nr(l,t))}else{if(!tt[f])return i?t:{};l=function(e,t,n){var r,a=e.constructor;switch(t){case T:return ja(e);case m:case p:return new a(+e);case I:return function(e,t){var n=t?ja(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case _:case D:case E:case L:case A:case z:case F:case P:case M:return ka(e,n);case y:return new a;case v:case C:return new a(e);case k:return function(e){var t=new e.constructor(e.source,oe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case w:return new a;case S:return r=e,Pn?Ce(Pn.call(r)):{}}}(t,f,o)}}s||(s=new Kn);var N=s.get(t);if(N)return N;s.set(t,l),il(t)?t.forEach(function(e){l.add(sr(e,n,r,e,t,s))}):tl(t)&&t.forEach(function(e,a){l.set(a,sr(e,n,r,a,t,s))});var O=h?e:(d?c?ti:ei:c?El:Dl)(t);return jt(O||t,function(e,a){O&&(e=t[a=e]),Zn(l,a,sr(e,n,r,a,t,s))}),l}function lr(t,n,r){var a=r.length;if(null==t)return!a;for(t=Ce(t);a--;){var i=r[a],s=n[i],l=t[i];if(l===e&&!(i in t)||!s(l))return!1}return!0}function or(n,r,a){if("function"!=typeof n)throw new Te(t);return Ti(function(){n.apply(e,a)},r)}function cr(e,t,n,r){var a=-1,i=St,s=!0,l=e.length,o=[],c=t.length;if(!l)return o;n&&(t=Tt(t,Wt(n))),r?(i=Nt,s=!1):200>t.length||(i=Kt,s=!1,t=new qn(t));e:for(;++a<l;){var d=e[a],u=null==n?d:n(d);if(d=r||0!==d?d:0,s&&u==u){for(var h=c;h--;)if(t[h]===u)continue e;o.push(d)}else i(t,u,r)||o.push(d)}return o}On.templateSettings={escape:W,evaluate:q,interpolate:K,variable:"",imports:{_:On}},On.prototype=Bn.prototype,On.prototype.constructor=On,Vn.prototype=Rn(Bn.prototype),Vn.prototype.constructor=Vn,Un.prototype=Rn(Bn.prototype),Un.prototype.constructor=Un,$n.prototype.clear=function(){this.__data__=Nn?Nn(null):{},this.size=0},$n.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},$n.prototype.get=function(t){var r=this.__data__;if(Nn){var a=r[t];return a===n?e:a}return Ae.call(r,t)?r[t]:e},$n.prototype.has=function(t){var n=this.__data__;return Nn?n[t]!==e:Ae.call(n,t)},$n.prototype.set=function(t,r){var a=this.__data__;return this.size+=this.has(t)?0:1,a[t]=Nn&&r===e?n:r,this},Hn.prototype.clear=function(){this.__data__=[],this.size=0},Hn.prototype.delete=function(e){var t=this.__data__,n=er(t,e);return n>=0&&(n==t.length-1?t.pop():Xe.call(t,n,1),--this.size,!0)},Hn.prototype.get=function(t){var n=this.__data__,r=er(n,t);return 0>r?e:n[r][1]},Hn.prototype.has=function(e){return er(this.__data__,e)>-1},Hn.prototype.set=function(e,t){var n=this.__data__,r=er(n,e);return 0>r?(++this.size,n.push([e,t])):n[r][1]=t,this},Wn.prototype.clear=function(){this.size=0,this.__data__={hash:new $n,map:new(kn||Hn),string:new $n}},Wn.prototype.delete=function(e){var t=si(this,e).delete(e);return this.size-=t?1:0,t},Wn.prototype.get=function(e){return si(this,e).get(e)},Wn.prototype.has=function(e){return si(this,e).has(e)},Wn.prototype.set=function(e,t){var n=si(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},qn.prototype.add=qn.prototype.push=function(e){return this.__data__.set(e,n),this},qn.prototype.has=function(e){return this.__data__.has(e)},Kn.prototype.clear=function(){this.__data__=new Hn,this.size=0},Kn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Kn.prototype.get=function(e){return this.__data__.get(e)},Kn.prototype.has=function(e){return this.__data__.has(e)},Kn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Hn){var r=n.__data__;if(!kn||199>r.length)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Wn(r)}return n.set(e,t),this.size=n.size,this};var dr=Da(yr),ur=Da(vr,!0);function hr(e,t){var n=!0;return dr(e,function(e,r,a){return n=!!t(e,r,a)}),n}function mr(t,n,r){for(var a=-1,i=t.length;++a<i;){var s=t[a],l=n(s);if(null!=l&&(o===e?l==l&&!ll(l):r(l,o)))var o=l,c=s}return c}function pr(e,t){var n=[];return dr(e,function(e,r,a){t(e,r,a)&&n.push(e)}),n}function fr(e,t,n,r,a){var i=-1,s=e.length;for(n||(n=pi),a||(a=[]);++i<s;){var l=e[i];t>0&&n(l)?t>1?fr(l,t-1,n,r,a):It(a,l):r||(a[a.length]=l)}return a}var gr=Ea(),xr=Ea(!0);function yr(e,t){return e&&gr(e,t,Dl)}function vr(e,t){return e&&xr(e,t,Dl)}function br(e,t){return Ct(t,function(t){return Xs(e[t])})}function jr(t,n){for(var r=0,a=(n=ga(n,t)).length;null!=t&&a>r;)t=t[Pi(n[r++])];return r&&r==a?t:e}function kr(e,t,n){var r=t(e);return $s(e)?r:It(r,n(e))}function wr(t){return null==t?t===e?"[object Undefined]":"[object Null]":st&&st in Ce(t)?function(t){var n=Ae.call(t,st),r=t[st];try{t[st]=e;var a=!0}catch(In){}var i=Pe.call(t);return a&&(n?t[st]=r:delete t[st]),i}(t):function(e){return Pe.call(e)}(t)}function Cr(e,t){return e>t}function Sr(e,t){return null!=e&&Ae.call(e,t)}function Nr(e,t){return null!=e&&t in Ce(e)}function Tr(t,n,r){for(var a=r?Nt:St,i=t[0].length,s=t.length,l=s,o=ve(s),c=1/0,d=[];l--;){var u=t[l];l&&n&&(u=Tt(u,Wt(n))),c=gn(u.length,c),o[l]=r||!n&&(120>i||120>u.length)?e:new qn(l&&u)}u=t[0];var h=-1,m=o[0];e:for(;++h<i&&d.length<c;){var p=u[h],f=n?n(p):p;if(p=r||0!==p?p:0,!(m?Kt(m,f):a(d,f,r))){for(l=s;--l;){var g=o[l];if(!(g?Kt(g,f):a(t[l],f,r)))continue e}m&&m.push(f),d.push(p)}}return d}function Ir(t,n,r){var a=null==(t=Ci(t,n=ga(n,t)))?t:t[Pi(Qi(n))];return null==a?e:vt(a,t,r)}function _r(e){return el(e)&&wr(e)==u}function Dr(t,n,r,a,i){return t===n||(null==t||null==n||!el(t)&&!el(n)?t!=t&&n!=n:function(t,n,r,a,i,s){var l=$s(t),o=$s(n),c=l?h:ui(t),d=o?h:ui(n),g=(c=c==u?b:c)==b,x=(d=d==u?b:d)==b,j=c==d;if(j&&Ks(t)){if(!Ks(n))return!1;l=!0,g=!1}if(j&&!g)return s||(s=new Kn),l||ol(t)?Ja(t,n,r,a,i,s):function(e,t,n,r,a,i,s){switch(n){case I:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case T:return!(e.byteLength!=t.byteLength||!i(new Ue(e),new Ue(t)));case m:case p:case v:return Rs(+e,+t);case f:return e.name==t.name&&e.message==t.message;case k:case C:return e==t+"";case y:var l=en;case w:var o=1&r;if(l||(l=rn),e.size!=t.size&&!o)return!1;var c=s.get(e);if(c)return c==t;r|=2,s.set(e,t);var d=Ja(l(e),l(t),r,a,i,s);return s.delete(e),d;case S:if(Pn)return Pn.call(e)==Pn.call(t)}return!1}(t,n,c,r,a,i,s);if(!(1&r)){var N=g&&Ae.call(t,"__wrapped__"),_=x&&Ae.call(n,"__wrapped__");if(N||_){var D=N?t.value():t,E=_?n.value():n;return s||(s=new Kn),i(D,E,r,a,s)}}return!!j&&(s||(s=new Kn),function(t,n,r,a,i,s){var l=1&r,o=ei(t),c=o.length;if(c!=ei(n).length&&!l)return!1;for(var d=c;d--;){var u=o[d];if(!(l?u in n:Ae.call(n,u)))return!1}var h=s.get(t),m=s.get(n);if(h&&m)return h==n&&m==t;var p=!0;s.set(t,n),s.set(n,t);for(var f=l;++d<c;){var g=t[u=o[d]],x=n[u];if(a)var y=l?a(x,g,u,n,t,s):a(g,x,u,t,n,s);if(!(y===e?g===x||i(g,x,r,a,s):y)){p=!1;break}f||(f="constructor"==u)}if(p&&!f){var v=t.constructor,b=n.constructor;v==b||!("constructor"in t)||!("constructor"in n)||"function"==typeof v&&v instanceof v&&"function"==typeof b&&b instanceof b||(p=!1)}return s.delete(t),s.delete(n),p}(t,n,r,a,i,s))}(t,n,r,a,Dr,i))}function Er(t,n,r,a){var i=r.length,s=i,l=!a;if(null==t)return!s;for(t=Ce(t);i--;){var o=r[i];if(l&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++i<s;){var c=(o=r[i])[0],d=t[c],u=o[1];if(l&&o[2]){if(d===e&&!(c in t))return!1}else{var h=new Kn;if(a)var m=a(d,u,c,t,n,h);if(!(m===e?Dr(u,d,3,a,h):m))return!1}}return!0}function Lr(e){return!(!Zs(e)||(t=e,Fe&&Fe in t))&&(Xs(e)?Re:ue).test(Mi(e));var t}function Ar(e){return"function"==typeof e?e:null==e?no:"object"==typeof e?$s(e)?Or(e[0],e[1]):Mr(e):ho(e)}function zr(e){if(!bi(e))return pn(e);var t=[];for(var n in Ce(e))Ae.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Fr(e,t){return t>e}function Pr(e,t){var n=-1,r=Ws(e)?ve(e.length):[];return dr(e,function(e,a,i){r[++n]=t(e,a,i)}),r}function Mr(e){var t=li(e);return 1==t.length&&t[0][2]?ki(t[0][0],t[0][1]):function(n){return n===e||Er(n,e,t)}}function Or(t,n){return xi(t)&&ji(n)?ki(Pi(t),n):function(r){var a=Sl(r,t);return a===e&&a===n?Nl(r,t):Dr(n,a,3)}}function Rr(t,n,r,a,i){t!==n&&gr(n,function(s,l){if(i||(i=new Kn),Zs(s))!function(t,n,r,a,i,s,l){var o=Si(t,r),c=Si(n,r),d=l.get(c);if(d)Jn(t,r,d);else{var u=s?s(o,c,r+"",t,n,l):e,h=u===e;if(h){var m=$s(c),p=!m&&Ks(c),f=!m&&!p&&ol(c);u=c,m||p||f?$s(o)?u=o:qs(o)?u=Na(o):p?(h=!1,u=ba(c,!0)):f?(h=!1,u=ka(c,!0)):u=[]:rl(c)||Us(c)?(u=o,Us(o)?u=gl(o):Zs(o)&&!Xs(o)||(u=mi(c))):h=!1}h&&(l.set(c,u),i(u,c,a,s,l),l.delete(c)),Jn(t,r,u)}}(t,n,l,r,Rr,a,i);else{var o=a?a(Si(t,l),s,l+"",t,n,i):e;o===e&&(o=s),Jn(t,l,o)}},El)}function Br(t,n){var r=t.length;if(r)return fi(n+=0>n?r:0,r)?t[n]:e}function Vr(e,t,n){t=t.length?Tt(t,function(e){return $s(e)?function(t){return jr(t,1===e.length?e[0]:e)}:e}):[no];var r=-1;return t=Tt(t,Wt(ii())),function(e){var t=e.length;for(e.sort(function(e,t){return function(e,t,n){for(var r=-1,a=e.criteria,i=t.criteria,s=a.length,l=n.length;++r<s;){var o=wa(a[r],i[r]);if(o)return l>r?o*("desc"==n[r]?-1:1):o}return e.index-t.index}(e,t,n)});t--;)e[t]=e[t].value;return e}(Pr(e,function(e,n,a){return{criteria:Tt(t,function(t){return t(e)}),index:++r,value:e}}))}function Ur(e,t,n){for(var r=-1,a=t.length,i={};++r<a;){var s=t[r],l=jr(e,s);n(l,s)&&Xr(i,ga(s,e),l)}return i}function $r(e,t,n,r){var a=r?Pt:Ft,i=-1,s=t.length,l=e;for(e===t&&(t=Na(t)),n&&(l=Tt(e,Wt(n)));++i<s;)for(var o=0,c=t[i],d=n?n(c):c;(o=a(l,d,o,r))>-1;)l!==e&&Xe.call(l,o,1),Xe.call(e,o,1);return e}function Hr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var a=t[n];if(n==r||a!==i){var i=a;fi(a)?Xe.call(e,a,1):oa(e,a)}}return e}function Wr(e,t){return e+Bt(vn()*(t-e+1))}function qr(e,t){var n="";if(!e||1>t||t>l)return n;do{t%2&&(n+=e),(t=Bt(t/2))&&(e+=e)}while(t);return n}function Kr(e,t){return Ii(wi(e,t,no),e+"")}function Yr(e){return Qn(Rl(e))}function Qr(e,t){var n=Rl(e);return Ei(n,ir(t,0,n.length))}function Xr(t,n,r,a){if(!Zs(t))return t;for(var i=-1,s=(n=ga(n,t)).length,l=s-1,o=t;null!=o&&++i<s;){var c=Pi(n[i]),d=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(i!=l){var u=o[c];(d=a?a(u,c,o):e)===e&&(d=Zs(u)?u:fi(n[i+1])?[]:{})}Zn(o,c,d),o=o[c]}return t}var Gr=Tn?function(e,t){return Tn.set(e,t),e}:no,Jr=ot?function(e,t){return ot(e,"toString",{configurable:!0,enumerable:!1,value:Zl(t),writable:!0})}:no;function Zr(e){return Ei(Rl(e))}function ea(e,t,n){var r=-1,a=e.length;0>t&&(t=-t>a?0:a+t),0>(n=n>a?a:n)&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var i=ve(a);++r<a;)i[r]=e[r+t];return i}function ta(e,t){var n;return dr(e,function(e,r,a){return!(n=t(e,r,a))}),!!n}function na(e,t,n){var r=0,a=null==e?r:e.length;if("number"==typeof t&&t==t&&2147483647>=a){for(;a>r;){var i=r+a>>>1,s=e[i];null===s||ll(s)||(n?s>t:s>=t)?a=i:r=i+1}return a}return ra(e,t,no,n)}function ra(t,n,r,a){var i=0,s=null==t?0:t.length;if(0===s)return 0;for(var l=(n=r(n))!=n,o=null===n,c=ll(n),d=n===e;s>i;){var u=Bt((i+s)/2),h=r(t[u]),m=h!==e,p=null===h,f=h==h,g=ll(h);if(l)var x=a||f;else x=d?f&&(a||m):o?f&&m&&(a||!p):c?f&&m&&!p&&(a||!g):!p&&!g&&(a?n>=h:n>h);x?i=u+1:s=u}return gn(s,4294967294)}function aa(e,t){for(var n=-1,r=e.length,a=0,i=[];++n<r;){var s=e[n],l=t?t(s):s;if(!n||!Rs(l,o)){var o=l;i[a++]=0===s?0:s}}return i}function ia(e){return"number"==typeof e?e:ll(e)?o:+e}function sa(e){if("string"==typeof e)return e;if($s(e))return Tt(e,sa)+"";if(ll(e))return Mn?Mn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function la(e,t,n){var r=-1,a=St,i=e.length,s=!0,l=[],o=l;if(n)s=!1,a=Nt;else if(200>i)o=t?[]:l;else{var c=t?null:qa(e);if(c)return rn(c);s=!1,a=Kt,o=new qn}e:for(;++r<i;){var d=e[r],u=t?t(d):d;if(d=n||0!==d?d:0,s&&u==u){for(var h=o.length;h--;)if(o[h]===u)continue e;t&&o.push(u),l.push(d)}else a(o,u,n)||(o!==l&&o.push(u),l.push(d))}return l}function oa(e,t){return null==(e=Ci(e,t=ga(t,e)))||delete e[Pi(Qi(t))]}function ca(e,t,n,r){return Xr(e,t,n(jr(e,t)),r)}function da(e,t,n,r){for(var a=e.length,i=r?a:-1;(r?i--:++i<a)&&t(e[i],i,e););return n?ea(e,r?0:i,r?i+1:a):ea(e,r?i+1:0,r?a:i)}function ua(e,t){var n=e;return n instanceof Un&&(n=n.value()),_t(t,function(e,t){return t.func.apply(t.thisArg,It([e],t.args))},n)}function ha(e,t,n){var r=e.length;if(2>r)return r?la(e[0]):[];for(var a=-1,i=ve(r);++a<r;)for(var s=e[a],l=-1;++l<r;)l!=a&&(i[a]=cr(i[a]||s,e[l],t,n));return la(fr(i,1),t,n)}function ma(t,n,r){for(var a=-1,i=t.length,s=n.length,l={};++a<i;){var o=s>a?n[a]:e;r(l,t[a],o)}return l}function pa(e){return qs(e)?e:[]}function fa(e){return"function"==typeof e?e:no}function ga(e,t){return $s(e)?e:xi(e,t)?[e]:Fi(xl(e))}var xa=Kr;function ya(t,n,r){var a=t.length;return r=r===e?a:r,n||a>r?ea(t,n,r):t}var va=ct||function(e){return lt.clearTimeout(e)};function ba(e,t){if(t)return e.slice();var n=e.length,r=$e?$e(n):new e.constructor(n);return e.copy(r),r}function ja(e){var t=new e.constructor(e.byteLength);return new Ue(t).set(new Ue(e)),t}function ka(e,t){var n=t?ja(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function wa(t,n){if(t!==n){var r=t!==e,a=null===t,i=t==t,s=ll(t),l=n!==e,o=null===n,c=n==n,d=ll(n);if(!o&&!d&&!s&&t>n||s&&l&&c&&!o&&!d||a&&l&&c||!r&&c||!i)return 1;if(!a&&!s&&!d&&n>t||d&&r&&i&&!a&&!s||o&&r&&i||!l&&i||!c)return-1}return 0}function Ca(e,t,n,r){for(var a=-1,i=e.length,s=n.length,l=-1,o=t.length,c=fn(i-s,0),d=ve(o+c),u=!r;++l<o;)d[l]=t[l];for(;++a<s;)(u||i>a)&&(d[n[a]]=e[a]);for(;c--;)d[l++]=e[a++];return d}function Sa(e,t,n,r){for(var a=-1,i=e.length,s=-1,l=n.length,o=-1,c=t.length,d=fn(i-l,0),u=ve(d+c),h=!r;++a<d;)u[a]=e[a];for(var m=a;++o<c;)u[m+o]=t[o];for(;++s<l;)(h||i>a)&&(u[m+n[s]]=e[a++]);return u}function Na(e,t){var n=-1,r=e.length;for(t||(t=ve(r));++n<r;)t[n]=e[n];return t}function Ta(t,n,r,a){var i=!r;r||(r={});for(var s=-1,l=n.length;++s<l;){var o=n[s],c=a?a(r[o],t[o],o,r,t):e;c===e&&(c=t[o]),i?rr(r,o,c):Zn(r,o,c)}return r}function Ia(e,t){return function(n,r){var a=$s(n)?bt:tr,i=t?t():{};return a(n,e,ii(r,2),i)}}function _a(t){return Kr(function(n,r){var a=-1,i=r.length,s=i>1?r[i-1]:e,l=i>2?r[2]:e;for(s=t.length>3&&"function"==typeof s?(i--,s):e,l&&gi(r[0],r[1],l)&&(s=3>i?e:s,i=1),n=Ce(n);++a<i;){var o=r[a];o&&t(n,o,a,s)}return n})}function Da(e,t){return function(n,r){if(null==n)return n;if(!Ws(n))return e(n,r);for(var a=n.length,i=t?a:-1,s=Ce(n);(t?i--:++i<a)&&!1!==r(s[i],i,s););return n}}function Ea(e){return function(t,n,r){for(var a=-1,i=Ce(t),s=r(t),l=s.length;l--;){var o=s[e?l:++a];if(!1===n(i[o],o,i))break}return t}}function La(t){return function(n){var r=Zt(n=xl(n))?sn(n):e,a=r?r[0]:n.charAt(0),i=r?ya(r,1).join(""):n.slice(1);return a[t]()+i}}function Aa(e){return function(t){return _t(Xl(Ul(t).replace(qe,"")),e,"")}}function za(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Rn(e.prototype),r=e.apply(n,t);return Zs(r)?r:n}}function Fa(t){return function(n,r,a){var i=Ce(n);if(!Ws(n)){var s=ii(r,3);n=Dl(n),r=function(e){return s(i[e],e,i)}}var l=t(n,r,a);return l>-1?i[s?n[l]:l]:e}}function Pa(n){return Za(function(r){var a=r.length,i=a,s=Vn.prototype.thru;for(n&&r.reverse();i--;){var l=r[i];if("function"!=typeof l)throw new Te(t);if(s&&!o&&"wrapper"==ri(l))var o=new Vn([],!0)}for(i=o?i:a;++i<a;){var c=ri(l=r[i]),d="wrapper"==c?ni(l):e;o=d&&yi(d[0])&&424==d[1]&&!d[4].length&&1==d[9]?o[ri(d[0])].apply(o,d[3]):1==l.length&&yi(l)?o[c]():o.thru(l)}return function(){var e=arguments,t=e[0];if(o&&1==e.length&&$s(t))return o.plant(t).value();for(var n=0,i=a?r[n].apply(this,e):t;++n<a;)i=r[n].call(this,i);return i}})}function Ma(t,n,r,a,s,l,o,c,d,u){var h=n&i,m=1&n,p=2&n,f=24&n,g=512&n,x=p?e:za(t);return function i(){for(var y=arguments.length,v=ve(y),b=y;b--;)v[b]=arguments[b];if(f)var j=ai(i),k=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(v,j);if(a&&(v=Ca(v,a,s,f)),l&&(v=Sa(v,l,o,f)),y-=k,f&&u>y){var w=nn(v,j);return Ha(t,n,Ma,i.placeholder,r,v,w,c,d,u-y)}var C=m?r:this,S=p?C[t]:t;return y=v.length,c?v=function(t,n){for(var r=t.length,a=gn(n.length,r),i=Na(t);a--;){var s=n[a];t[a]=fi(s,r)?i[s]:e}return t}(v,c):g&&y>1&&v.reverse(),h&&y>d&&(v.length=d),this&&this!==lt&&this instanceof i&&(S=x||za(S)),S.apply(C,v)}}function Oa(e,t){return function(n,r){return function(e,t,n,r){return yr(e,function(e,a,i){t(r,n(e),a,i)}),r}(n,e,t(r),{})}}function Ra(t,n){return function(r,a){var i;if(r===e&&a===e)return n;if(r!==e&&(i=r),a!==e){if(i===e)return a;"string"==typeof r||"string"==typeof a?(r=sa(r),a=sa(a)):(r=ia(r),a=ia(a)),i=t(r,a)}return i}}function Ba(e){return Za(function(t){return t=Tt(t,Wt(ii())),Kr(function(n){var r=this;return e(t,function(e){return vt(e,r,n)})})})}function Va(t,n){var r=(n=n===e?" ":sa(n)).length;if(2>r)return r?qr(n,t):n;var a=qr(n,Lt(t/an(n)));return Zt(n)?ya(sn(a),0,t).join(""):a.slice(0,t)}function Ua(t){return function(n,r,a){return a&&"number"!=typeof a&&gi(n,r,a)&&(r=a=e),n=hl(n),r===e?(r=n,n=0):r=hl(r),function(e,t,n,r){for(var a=-1,i=fn(Lt((t-e)/(n||1)),0),s=ve(i);i--;)s[r?i:++a]=e,e+=n;return s}(n,r,a=a===e?r>n?1:-1:hl(a),t)}}function $a(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=fl(t),n=fl(n)),e(t,n)}}function Ha(t,n,r,i,s,l,o,c,d,u){var h=8&n;n|=h?a:64,4&(n&=~(h?64:a))||(n&=-4);var m=[t,n,s,h?l:e,h?o:e,h?e:l,h?e:o,c,d,u],p=r.apply(e,m);return yi(t)&&Ni(p,m),p.placeholder=i,_i(p,t,n)}function Wa(e){var t=we[e];return function(e,n){if(e=fl(e),(n=null==n?0:gn(ml(n),292))&&hn(e)){var r=(xl(e)+"e").split("e");return+((r=(xl(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var qa=Cn&&1/rn(new Cn([,-0]))[1]==s?function(e){return new Cn(e)}:lo;function Ka(e){return function(t){var n,r,a,i=ui(t);return i==y?en(t):i==w?(r=-1,a=Array((n=t).size),n.forEach(function(e){a[++r]=[e,e]}),a):function(e,t){return Tt(t,function(t){return[t,e[t]]})}(t,e(t))}}function Ya(n,s,l,o,c,d,u,h){var m=2&s;if(!m&&"function"!=typeof n)throw new Te(t);var p=o?o.length:0;if(p||(s&=-97,o=c=e),u=u===e?u:fn(ml(u),0),h=h===e?h:ml(h),p-=c?c.length:0,64&s){var f=o,g=c;o=c=e}var x=m?e:ni(n),y=[n,s,l,o,c,f,g,d,u,h];if(x&&function(e,t){var n=e[1],a=t[1],s=n|a,l=131>s,o=a==i&&8==n||a==i&&256==n&&e[7].length<=t[8]||384==a&&t[7].length<=t[8]&&8==n;if(!l&&!o)return e;1&a&&(e[2]=t[2],s|=1&n?0:4);var c=t[3];if(c){var d=e[3];e[3]=d?Ca(d,c,t[4]):c,e[4]=d?nn(e[3],r):t[4]}(c=t[5])&&(d=e[5],e[5]=d?Sa(d,c,t[6]):c,e[6]=d?nn(e[5],r):t[6]),(c=t[7])&&(e[7]=c),a&i&&(e[8]=null==e[8]?t[8]:gn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=s}(y,x),n=y[0],s=y[1],l=y[2],o=y[3],c=y[4],!(h=y[9]=y[9]===e?m?0:n.length:fn(y[9]-p,0))&&24&s&&(s&=-25),s&&1!=s)v=8==s||16==s?function(t,n,r){var a=za(t);return function i(){for(var s=arguments.length,l=ve(s),o=s,c=ai(i);o--;)l[o]=arguments[o];var d=3>s&&l[0]!==c&&l[s-1]!==c?[]:nn(l,c);return s-=d.length,r>s?Ha(t,n,Ma,i.placeholder,e,l,d,e,e,r-s):vt(this&&this!==lt&&this instanceof i?a:t,this,l)}}(n,s,h):s!=a&&33!=s||c.length?Ma.apply(e,y):function(e,t,n,r){var a=1&t,i=za(e);return function t(){for(var s=-1,l=arguments.length,o=-1,c=r.length,d=ve(c+l),u=this&&this!==lt&&this instanceof t?i:e;++o<c;)d[o]=r[o];for(;l--;)d[o++]=arguments[++s];return vt(u,a?n:this,d)}}(n,s,l,o);else var v=function(e,t,n){var r=1&t,a=za(e);return function t(){return(this&&this!==lt&&this instanceof t?a:e).apply(r?n:this,arguments)}}(n,s,l);return _i((x?Gr:Ni)(v,y),n,s)}function Qa(t,n,r,a){return t===e||Rs(t,De[r])&&!Ae.call(a,r)?n:t}function Xa(t,n,r,a,i,s){return Zs(t)&&Zs(n)&&(s.set(n,t),Rr(t,n,e,Xa,s),s.delete(n)),t}function Ga(t){return rl(t)?e:t}function Ja(t,n,r,a,i,s){var l=1&r,o=t.length,c=n.length;if(!(o==c||l&&c>o))return!1;var d=s.get(t),u=s.get(n);if(d&&u)return d==n&&u==t;var h=-1,m=!0,p=2&r?new qn:e;for(s.set(t,n),s.set(n,t);++h<o;){var f=t[h],g=n[h];if(a)var x=l?a(g,f,h,n,t,s):a(f,g,h,t,n,s);if(x!==e){if(x)continue;m=!1;break}if(p){if(!Et(n,function(e,t){if(!Kt(p,t)&&(f===e||i(f,e,r,a,s)))return p.push(t)})){m=!1;break}}else if(f!==g&&!i(f,g,r,a,s)){m=!1;break}}return s.delete(t),s.delete(n),m}function Za(t){return Ii(wi(t,e,Hi),t+"")}function ei(e){return kr(e,Dl,ci)}function ti(e){return kr(e,El,di)}var ni=Tn?function(e){return Tn.get(e)}:lo;function ri(e){for(var t=e.name+"",n=_n[t],r=Ae.call(_n,t)?n.length:0;r--;){var a=n[r],i=a.func;if(null==i||i==e)return a.name}return t}function ai(e){return(Ae.call(On,"placeholder")?On:e).placeholder}function ii(){var e=On.iteratee||ro;return e=e===ro?Ar:e,arguments.length?e(arguments[0],arguments[1]):e}function si(e,t){var n,r,a=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?a["string"==typeof t?"string":"hash"]:a.map}function li(e){for(var t=Dl(e),n=t.length;n--;){var r=t[n],a=e[r];t[n]=[r,a,ji(a)]}return t}function oi(t,n){var r=function(t,n){return null==t?e:t[n]}(t,n);return Lr(r)?r:e}var ci=dn?function(e){return null==e?[]:(e=Ce(e),Ct(dn(e),function(t){return Ye.call(e,t)}))}:fo,di=dn?function(e){for(var t=[];e;)It(t,ci(e)),e=He(e);return t}:fo,ui=wr;function hi(e,t,n){for(var r=-1,a=(t=ga(t,e)).length,i=!1;++r<a;){var s=Pi(t[r]);if(!(i=null!=e&&n(e,s)))break;e=e[s]}return i||++r!=a?i:!!(a=null==e?0:e.length)&&Js(a)&&fi(s,a)&&($s(e)||Us(e))}function mi(e){return"function"!=typeof e.constructor||bi(e)?{}:Rn(He(e))}function pi(e){return $s(e)||Us(e)||!!(nt&&e&&e[nt])}function fi(e,t){var n=typeof e;return!!(t=null==t?l:t)&&("number"==n||"symbol"!=n&&me.test(e))&&e>-1&&e%1==0&&t>e}function gi(e,t,n){if(!Zs(n))return!1;var r=typeof t;return!!("number"==r?Ws(n)&&fi(t,n.length):"string"==r&&t in n)&&Rs(n[t],e)}function xi(e,t){if($s(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ll(e))||Q.test(e)||!Y.test(e)||null!=t&&e in Ce(t)}function yi(e){var t=ri(e),n=On[t];if("function"!=typeof n||!(t in Un.prototype))return!1;if(e===n)return!0;var r=ni(n);return!!r&&e===r[0]}(jn&&ui(new jn(new ArrayBuffer(1)))!=I||kn&&ui(new kn)!=y||wn&&ui(wn.resolve())!=j||Cn&&ui(new Cn)!=w||Sn&&ui(new Sn)!=N)&&(ui=function(t){var n=wr(t),r=n==b?t.constructor:e,a=r?Mi(r):"";if(a)switch(a){case Dn:return I;case En:return y;case Ln:return j;case An:return w;case zn:return N}return n});var vi=Ee?Xs:go;function bi(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||De)}function ji(e){return e==e&&!Zs(e)}function ki(t,n){return function(r){return null!=r&&r[t]===n&&(n!==e||t in Ce(r))}}function wi(t,n,r){return n=fn(n===e?t.length-1:n,0),function(){for(var e=arguments,a=-1,i=fn(e.length-n,0),s=ve(i);++a<i;)s[a]=e[n+a];a=-1;for(var l=ve(n+1);++a<n;)l[a]=e[a];return l[n]=r(s),vt(t,this,l)}}function Ci(e,t){return 2>t.length?e:jr(e,ea(t,0,-1))}function Si(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Ni=Di(Gr),Ti=ht||function(e,t){return lt.setTimeout(e,t)},Ii=Di(Jr);function _i(e,t,n){var r=t+"";return Ii(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(te,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return jt(d,function(n){var r="_."+n[0];t&n[1]&&!St(e,r)&&e.push(r)}),e.sort()}(function(e){var t=e.match(ne);return t?t[1].split(re):[]}(r),n)))}function Di(t){var n=0,r=0;return function(){var a=xn(),i=16-(a-r);if(r=a,i>0){if(++n>=800)return arguments[0]}else n=0;return t.apply(e,arguments)}}function Ei(t,n){var r=-1,a=t.length,i=a-1;for(n=n===e?a:n;++r<n;){var s=Wr(r,i),l=t[s];t[s]=t[r],t[r]=l}return t.length=n,t}var Li,Ai,zi,Fi=(Li=function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(X,function(e,n,r,a){t.push(r?a.replace(se,"$1"):n||e)}),t},Ai=As(Li,function(e){return 500===zi.size&&zi.clear(),e}),zi=Ai.cache,Ai);function Pi(e){if("string"==typeof e||ll(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Mi(e){if(null!=e){try{return Le.call(e)}catch(In){}try{return e+""}catch(In){}}return""}function Oi(e){if(e instanceof Un)return e.clone();var t=new Vn(e.__wrapped__,e.__chain__);return t.__actions__=Na(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Ri=Kr(function(e,t){return qs(e)?cr(e,fr(t,1,qs,!0)):[]}),Bi=Kr(function(t,n){var r=Qi(n);return qs(r)&&(r=e),qs(t)?cr(t,fr(n,1,qs,!0),ii(r,2)):[]}),Vi=Kr(function(t,n){var r=Qi(n);return qs(r)&&(r=e),qs(t)?cr(t,fr(n,1,qs,!0),e,r):[]});function Ui(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var a=null==n?0:ml(n);return 0>a&&(a=fn(r+a,0)),zt(e,ii(t,3),a)}function $i(t,n,r){var a=null==t?0:t.length;if(!a)return-1;var i=a-1;return r!==e&&(i=ml(r),i=0>r?fn(a+i,0):gn(i,a-1)),zt(t,ii(n,3),i,!0)}function Hi(e){return null!=e&&e.length?fr(e,1):[]}function Wi(t){return t&&t.length?t[0]:e}var qi=Kr(function(e){var t=Tt(e,pa);return t.length&&t[0]===e[0]?Tr(t):[]}),Ki=Kr(function(t){var n=Qi(t),r=Tt(t,pa);return n===Qi(r)?n=e:r.pop(),r.length&&r[0]===t[0]?Tr(r,ii(n,2)):[]}),Yi=Kr(function(t){var n=Qi(t),r=Tt(t,pa);return(n="function"==typeof n?n:e)&&r.pop(),r.length&&r[0]===t[0]?Tr(r,e,n):[]});function Qi(t){var n=null==t?0:t.length;return n?t[n-1]:e}var Xi=Kr(Gi);function Gi(e,t){return e&&e.length&&t&&t.length?$r(e,t):e}var Ji=Za(function(e,t){var n=null==e?0:e.length,r=ar(e,t);return Hr(e,Tt(t,function(e){return fi(e,n)?+e:e}).sort(wa)),r});function Zi(e){return null==e?e:bn.call(e)}var es=Kr(function(e){return la(fr(e,1,qs,!0))}),ts=Kr(function(t){var n=Qi(t);return qs(n)&&(n=e),la(fr(t,1,qs,!0),ii(n,2))}),ns=Kr(function(t){var n=Qi(t);return n="function"==typeof n?n:e,la(fr(t,1,qs,!0),e,n)});function rs(e){if(!e||!e.length)return[];var t=0;return e=Ct(e,function(e){if(qs(e))return t=fn(e.length,t),!0}),$t(t,function(t){return Tt(e,Rt(t))})}function as(t,n){if(!t||!t.length)return[];var r=rs(t);return null==n?r:Tt(r,function(t){return vt(n,e,t)})}var is=Kr(function(e,t){return qs(e)?cr(e,t):[]}),ss=Kr(function(e){return ha(Ct(e,qs))}),ls=Kr(function(t){var n=Qi(t);return qs(n)&&(n=e),ha(Ct(t,qs),ii(n,2))}),os=Kr(function(t){var n=Qi(t);return n="function"==typeof n?n:e,ha(Ct(t,qs),e,n)}),cs=Kr(rs),ds=Kr(function(t){var n=t.length,r=n>1?t[n-1]:e;return r="function"==typeof r?(t.pop(),r):e,as(t,r)});function us(e){var t=On(e);return t.__chain__=!0,t}function hs(e,t){return t(e)}var ms=Za(function(t){var n=t.length,r=n?t[0]:0,a=this.__wrapped__,i=function(e){return ar(e,t)};return 1>=n&&!this.__actions__.length&&a instanceof Un&&fi(r)?((a=a.slice(r,+r+(n?1:0))).__actions__.push({func:hs,args:[i],thisArg:e}),new Vn(a,this.__chain__).thru(function(t){return n&&!t.length&&t.push(e),t})):this.thru(i)}),ps=Ia(function(e,t,n){Ae.call(e,n)?++e[n]:rr(e,n,1)}),fs=Fa(Ui),gs=Fa($i);function xs(e,t){return($s(e)?jt:dr)(e,ii(t,3))}function ys(e,t){return($s(e)?kt:ur)(e,ii(t,3))}var vs=Ia(function(e,t,n){Ae.call(e,n)?e[n].push(t):rr(e,n,[t])}),bs=Kr(function(e,t,n){var r=-1,a="function"==typeof t,i=Ws(e)?ve(e.length):[];return dr(e,function(e){i[++r]=a?vt(t,e,n):Ir(e,t,n)}),i}),js=Ia(function(e,t,n){rr(e,n,t)});function ks(e,t){return($s(e)?Tt:Pr)(e,ii(t,3))}var ws=Ia(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),Cs=Kr(function(e,t){if(null==e)return[];var n=t.length;return n>1&&gi(e,t[0],t[1])?t=[]:n>2&&gi(t[0],t[1],t[2])&&(t=[t[0]]),Vr(e,fr(t,1),[])}),Ss=ut||function(){return lt.Date.now()};function Ns(t,n,r){return n=r?e:n,n=t&&null==n?t.length:n,Ya(t,i,e,e,e,e,n)}function Ts(n,r){var a;if("function"!=typeof r)throw new Te(t);return n=ml(n),function(){return--n>0&&(a=r.apply(this,arguments)),n>1||(r=e),a}}var Is=Kr(function(e,t,n){var r=1;if(n.length){var i=nn(n,ai(Is));r|=a}return Ya(e,r,t,n,i)}),_s=Kr(function(e,t,n){var r=3;if(n.length){var i=nn(n,ai(_s));r|=a}return Ya(t,r,e,n,i)});function Ds(n,r,a){var i,s,l,o,c,d,u=0,h=!1,m=!1,p=!0;if("function"!=typeof n)throw new Te(t);function f(t){var r=i,a=s;return i=s=e,u=t,o=n.apply(a,r)}function g(t){var n=t-d;return d===e||n>=r||0>n||m&&t-u>=l}function x(){var e=Ss();if(g(e))return y(e);c=Ti(x,function(e){var t=r-(e-d);return m?gn(t,l-(e-u)):t}(e))}function y(t){return c=e,p&&i?f(t):(i=s=e,o)}function v(){var t=Ss(),n=g(t);if(i=arguments,s=this,d=t,n){if(c===e)return function(e){return u=e,c=Ti(x,r),h?f(e):o}(d);if(m)return va(c),c=Ti(x,r),f(d)}return c===e&&(c=Ti(x,r)),o}return r=fl(r)||0,Zs(a)&&(h=!!a.leading,l=(m="maxWait"in a)?fn(fl(a.maxWait)||0,r):l,p="trailing"in a?!!a.trailing:p),v.cancel=function(){c!==e&&va(c),u=0,i=d=s=c=e},v.flush=function(){return c===e?o:y(Ss())},v}var Es=Kr(function(e,t){return or(e,1,t)}),Ls=Kr(function(e,t,n){return or(e,fl(t)||0,n)});function As(e,n){if("function"!=typeof e||null!=n&&"function"!=typeof n)throw new Te(t);var r=function(){var t=arguments,a=n?n.apply(this,t):t[0],i=r.cache;if(i.has(a))return i.get(a);var s=e.apply(this,t);return r.cache=i.set(a,s)||i,s};return r.cache=new(As.Cache||Wn),r}function zs(e){if("function"!=typeof e)throw new Te(t);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}As.Cache=Wn;var Fs=xa(function(e,t){var n=(t=1==t.length&&$s(t[0])?Tt(t[0],Wt(ii())):Tt(fr(t,1),Wt(ii()))).length;return Kr(function(r){for(var a=-1,i=gn(r.length,n);++a<i;)r[a]=t[a].call(this,r[a]);return vt(e,this,r)})}),Ps=Kr(function(t,n){var r=nn(n,ai(Ps));return Ya(t,a,e,n,r)}),Ms=Kr(function(t,n){var r=nn(n,ai(Ms));return Ya(t,64,e,n,r)}),Os=Za(function(t,n){return Ya(t,256,e,e,e,n)});function Rs(e,t){return e===t||e!=e&&t!=t}var Bs=$a(Cr),Vs=$a(function(e,t){return e>=t}),Us=_r(function(){return arguments}())?_r:function(e){return el(e)&&Ae.call(e,"callee")&&!Ye.call(e,"callee")},$s=ve.isArray,Hs=mt?Wt(mt):function(e){return el(e)&&wr(e)==T};function Ws(e){return null!=e&&Js(e.length)&&!Xs(e)}function qs(e){return el(e)&&Ws(e)}var Ks=un||go,Ys=pt?Wt(pt):function(e){return el(e)&&wr(e)==p};function Qs(e){if(!el(e))return!1;var t=wr(e);return t==f||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!rl(e)}function Xs(e){if(!Zs(e))return!1;var t=wr(e);return t==g||t==x||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Gs(e){return"number"==typeof e&&e==ml(e)}function Js(e){return"number"==typeof e&&e>-1&&e%1==0&&l>=e}function Zs(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function el(e){return null!=e&&"object"==typeof e}var tl=ft?Wt(ft):function(e){return el(e)&&ui(e)==y};function nl(e){return"number"==typeof e||el(e)&&wr(e)==v}function rl(e){if(!el(e)||wr(e)!=b)return!1;var t=He(e);if(null===t)return!0;var n=Ae.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Le.call(n)==Me}var al=gt?Wt(gt):function(e){return el(e)&&wr(e)==k},il=xt?Wt(xt):function(e){return el(e)&&ui(e)==w};function sl(e){return"string"==typeof e||!$s(e)&&el(e)&&wr(e)==C}function ll(e){return"symbol"==typeof e||el(e)&&wr(e)==S}var ol=yt?Wt(yt):function(e){return el(e)&&Js(e.length)&&!!et[wr(e)]},cl=$a(Fr),dl=$a(function(e,t){return t>=e});function ul(e){if(!e)return[];if(Ws(e))return sl(e)?sn(e):Na(e);if(it&&e[it])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[it]());var t=ui(e);return(t==y?en:t==w?rn:Rl)(e)}function hl(e){return e?(e=fl(e))===s||e===-1/0?17976931348623157e292*(0>e?-1:1):e==e?e:0:0===e?e:0}function ml(e){var t=hl(e),n=t%1;return t==t?n?t-n:t:0}function pl(e){return e?ir(ml(e),0,c):0}function fl(e){if("number"==typeof e)return e;if(ll(e))return o;if(Zs(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Zs(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Ht(e);var n=de.test(e);return n||he.test(e)?at(e.slice(2),n?2:8):ce.test(e)?o:+e}function gl(e){return Ta(e,El(e))}function xl(e){return null==e?"":sa(e)}var yl=_a(function(e,t){if(bi(t)||Ws(t))Ta(t,Dl(t),e);else for(var n in t)Ae.call(t,n)&&Zn(e,n,t[n])}),vl=_a(function(e,t){Ta(t,El(t),e)}),bl=_a(function(e,t,n,r){Ta(t,El(t),e,r)}),jl=_a(function(e,t,n,r){Ta(t,Dl(t),e,r)}),kl=Za(ar),wl=Kr(function(t,n){t=Ce(t);var r=-1,a=n.length,i=a>2?n[2]:e;for(i&&gi(n[0],n[1],i)&&(a=1);++r<a;)for(var s=n[r],l=El(s),o=-1,c=l.length;++o<c;){var d=l[o],u=t[d];(u===e||Rs(u,De[d])&&!Ae.call(t,d))&&(t[d]=s[d])}return t}),Cl=Kr(function(t){return t.push(e,Xa),vt(Al,e,t)});function Sl(t,n,r){var a=null==t?e:jr(t,n);return a===e?r:a}function Nl(e,t){return null!=e&&hi(e,t,Nr)}var Tl=Oa(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Pe.call(t)),e[t]=n},Zl(no)),Il=Oa(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Pe.call(t)),Ae.call(e,t)?e[t].push(n):e[t]=[n]},ii),_l=Kr(Ir);function Dl(e){return Ws(e)?Yn(e):zr(e)}function El(e){return Ws(e)?Yn(e,!0):function(e){if(!Zs(e))return function(e){var t=[];if(null!=e)for(var n in Ce(e))t.push(n);return t}(e);var t=bi(e),n=[];for(var r in e)("constructor"!=r||!t&&Ae.call(e,r))&&n.push(r);return n}(e)}var Ll=_a(function(e,t,n){Rr(e,t,n)}),Al=_a(function(e,t,n,r){Rr(e,t,n,r)}),zl=Za(function(e,t){var n={};if(null==e)return n;var r=!1;t=Tt(t,function(t){return t=ga(t,e),r||(r=t.length>1),t}),Ta(e,ti(e),n),r&&(n=sr(n,7,Ga));for(var a=t.length;a--;)oa(n,t[a]);return n}),Fl=Za(function(e,t){return null==e?{}:function(e,t){return Ur(e,t,function(t,n){return Nl(e,n)})}(e,t)});function Pl(e,t){if(null==e)return{};var n=Tt(ti(e),function(e){return[e]});return t=ii(t),Ur(e,n,function(e,n){return t(e,n[0])})}var Ml=Ka(Dl),Ol=Ka(El);function Rl(e){return null==e?[]:qt(e,Dl(e))}var Bl=Aa(function(e,t,n){return t=t.toLowerCase(),e+(n?Vl(t):t)});function Vl(e){return Ql(xl(e).toLowerCase())}function Ul(e){return(e=xl(e))&&e.replace(pe,Xt).replace(Ke,"")}var $l=Aa(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),Hl=Aa(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),Wl=La("toLowerCase"),ql=Aa(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),Kl=Aa(function(e,t,n){return e+(n?" ":"")+Ql(t)}),Yl=Aa(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),Ql=La("toUpperCase");function Xl(t,n,r){return t=xl(t),(n=r?e:n)===e?function(e){return Ge.test(e)}(t)?function(e){return e.match(Qe)||[]}(t):function(e){return e.match(ae)||[]}(t):t.match(n)||[]}var Gl=Kr(function(t,n){try{return vt(t,e,n)}catch(In){return Qs(In)?In:new je(In)}}),Jl=Za(function(e,t){return jt(t,function(t){t=Pi(t),rr(e,t,Is(e[t],e))}),e});function Zl(e){return function(){return e}}var eo=Pa(),to=Pa(!0);function no(e){return e}function ro(e){return Ar("function"==typeof e?e:sr(e,1))}var ao=Kr(function(e,t){return function(n){return Ir(n,e,t)}}),io=Kr(function(e,t){return function(n){return Ir(e,n,t)}});function so(e,t,n){var r=Dl(t),a=br(t,r);null!=n||Zs(t)&&(a.length||!r.length)||(n=t,t=e,e=this,a=br(t,Dl(t)));var i=!(Zs(n)&&"chain"in n&&!n.chain),s=Xs(e);return jt(a,function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(i||t){var n=e(this.__wrapped__);return(n.__actions__=Na(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,It([this.value()],arguments))})}),e}function lo(){}var oo=Ba(Tt),co=Ba(wt),uo=Ba(Et);function ho(e){return xi(e)?Rt(Pi(e)):function(e){return function(t){return jr(t,e)}}(e)}var mo=Ua(),po=Ua(!0);function fo(){return[]}function go(){return!1}var xo,yo=Ra(function(e,t){return e+t},0),vo=Wa("ceil"),bo=Ra(function(e,t){return e/t},1),jo=Wa("floor"),ko=Ra(function(e,t){return e*t},1),wo=Wa("round"),Co=Ra(function(e,t){return e-t},0);return On.after=function(e,n){if("function"!=typeof n)throw new Te(t);return e=ml(e),function(){if(1>--e)return n.apply(this,arguments)}},On.ary=Ns,On.assign=yl,On.assignIn=vl,On.assignInWith=bl,On.assignWith=jl,On.at=kl,On.before=Ts,On.bind=Is,On.bindAll=Jl,On.bindKey=_s,On.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return $s(e)?e:[e]},On.chain=us,On.chunk=function(t,n,r){n=(r?gi(t,n,r):n===e)?1:fn(ml(n),0);var a=null==t?0:t.length;if(!a||1>n)return[];for(var i=0,s=0,l=ve(Lt(a/n));a>i;)l[s++]=ea(t,i,i+=n);return l},On.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,a=[];++t<n;){var i=e[t];i&&(a[r++]=i)}return a},On.concat=function(){var e=arguments.length;if(!e)return[];for(var t=ve(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return It($s(n)?Na(n):[n],fr(t,1))},On.cond=function(e){var n=null==e?0:e.length,r=ii();return e=n?Tt(e,function(e){if("function"!=typeof e[1])throw new Te(t);return[r(e[0]),e[1]]}):[],Kr(function(t){for(var r=-1;++r<n;){var a=e[r];if(vt(a[0],this,t))return vt(a[1],this,t)}})},On.conforms=function(e){return function(e){var t=Dl(e);return function(n){return lr(n,e,t)}}(sr(e,1))},On.constant=Zl,On.countBy=ps,On.create=function(e,t){var n=Rn(e);return null==t?n:nr(n,t)},On.curry=function t(n,r,a){var i=Ya(n,8,e,e,e,e,e,r=a?e:r);return i.placeholder=t.placeholder,i},On.curryRight=function t(n,r,a){var i=Ya(n,16,e,e,e,e,e,r=a?e:r);return i.placeholder=t.placeholder,i},On.debounce=Ds,On.defaults=wl,On.defaultsDeep=Cl,On.defer=Es,On.delay=Ls,On.difference=Ri,On.differenceBy=Bi,On.differenceWith=Vi,On.drop=function(t,n,r){var a=null==t?0:t.length;return a?ea(t,0>(n=r||n===e?1:ml(n))?0:n,a):[]},On.dropRight=function(t,n,r){var a=null==t?0:t.length;return a?ea(t,0,0>(n=a-(n=r||n===e?1:ml(n)))?0:n):[]},On.dropRightWhile=function(e,t){return e&&e.length?da(e,ii(t,3),!0,!0):[]},On.dropWhile=function(e,t){return e&&e.length?da(e,ii(t,3),!0):[]},On.fill=function(t,n,r,a){var i=null==t?0:t.length;return i?(r&&"number"!=typeof r&&gi(t,n,r)&&(r=0,a=i),function(t,n,r,a){var i=t.length;for(0>(r=ml(r))&&(r=-r>i?0:i+r),0>(a=a===e||a>i?i:ml(a))&&(a+=i),a=r>a?0:pl(a);a>r;)t[r++]=n;return t}(t,n,r,a)):[]},On.filter=function(e,t){return($s(e)?Ct:pr)(e,ii(t,3))},On.flatMap=function(e,t){return fr(ks(e,t),1)},On.flatMapDeep=function(e,t){return fr(ks(e,t),s)},On.flatMapDepth=function(t,n,r){return r=r===e?1:ml(r),fr(ks(t,n),r)},On.flatten=Hi,On.flattenDeep=function(e){return null!=e&&e.length?fr(e,s):[]},On.flattenDepth=function(t,n){return null!=t&&t.length?fr(t,n=n===e?1:ml(n)):[]},On.flip=function(e){return Ya(e,512)},On.flow=eo,On.flowRight=to,On.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var a=e[t];r[a[0]]=a[1]}return r},On.functions=function(e){return null==e?[]:br(e,Dl(e))},On.functionsIn=function(e){return null==e?[]:br(e,El(e))},On.groupBy=vs,On.initial=function(e){return null!=e&&e.length?ea(e,0,-1):[]},On.intersection=qi,On.intersectionBy=Ki,On.intersectionWith=Yi,On.invert=Tl,On.invertBy=Il,On.invokeMap=bs,On.iteratee=ro,On.keyBy=js,On.keys=Dl,On.keysIn=El,On.map=ks,On.mapKeys=function(e,t){var n={};return t=ii(t,3),yr(e,function(e,r,a){rr(n,t(e,r,a),e)}),n},On.mapValues=function(e,t){var n={};return t=ii(t,3),yr(e,function(e,r,a){rr(n,r,t(e,r,a))}),n},On.matches=function(e){return Mr(sr(e,1))},On.matchesProperty=function(e,t){return Or(e,sr(t,1))},On.memoize=As,On.merge=Ll,On.mergeWith=Al,On.method=ao,On.methodOf=io,On.mixin=so,On.negate=zs,On.nthArg=function(e){return e=ml(e),Kr(function(t){return Br(t,e)})},On.omit=zl,On.omitBy=function(e,t){return Pl(e,zs(ii(t)))},On.once=function(e){return Ts(2,e)},On.orderBy=function(t,n,r,a){return null==t?[]:($s(n)||(n=null==n?[]:[n]),$s(r=a?e:r)||(r=null==r?[]:[r]),Vr(t,n,r))},On.over=oo,On.overArgs=Fs,On.overEvery=co,On.overSome=uo,On.partial=Ps,On.partialRight=Ms,On.partition=ws,On.pick=Fl,On.pickBy=Pl,On.property=ho,On.propertyOf=function(t){return function(n){return null==t?e:jr(t,n)}},On.pull=Xi,On.pullAll=Gi,On.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?$r(e,t,ii(n,2)):e},On.pullAllWith=function(t,n,r){return t&&t.length&&n&&n.length?$r(t,n,e,r):t},On.pullAt=Ji,On.range=mo,On.rangeRight=po,On.rearg=Os,On.reject=function(e,t){return($s(e)?Ct:pr)(e,zs(ii(t,3)))},On.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,a=[],i=e.length;for(t=ii(t,3);++r<i;){var s=e[r];t(s,r,e)&&(n.push(s),a.push(r))}return Hr(e,a),n},On.rest=function(n,r){if("function"!=typeof n)throw new Te(t);return Kr(n,r=r===e?r:ml(r))},On.reverse=Zi,On.sampleSize=function(t,n,r){return n=(r?gi(t,n,r):n===e)?1:ml(n),($s(t)?Xn:Qr)(t,n)},On.set=function(e,t,n){return null==e?e:Xr(e,t,n)},On.setWith=function(t,n,r,a){return a="function"==typeof a?a:e,null==t?t:Xr(t,n,r,a)},On.shuffle=function(e){return($s(e)?Gn:Zr)(e)},On.slice=function(t,n,r){var a=null==t?0:t.length;return a?(r&&"number"!=typeof r&&gi(t,n,r)?(n=0,r=a):(n=null==n?0:ml(n),r=r===e?a:ml(r)),ea(t,n,r)):[]},On.sortBy=Cs,On.sortedUniq=function(e){return e&&e.length?aa(e):[]},On.sortedUniqBy=function(e,t){return e&&e.length?aa(e,ii(t,2)):[]},On.split=function(t,n,r){return r&&"number"!=typeof r&&gi(t,n,r)&&(n=r=e),(r=r===e?c:r>>>0)?(t=xl(t))&&("string"==typeof n||null!=n&&!al(n))&&!(n=sa(n))&&Zt(t)?ya(sn(t),0,r):t.split(n,r):[]},On.spread=function(e,n){if("function"!=typeof e)throw new Te(t);return n=null==n?0:fn(ml(n),0),Kr(function(t){var r=t[n],a=ya(t,0,n);return r&&It(a,r),vt(e,this,a)})},On.tail=function(e){var t=null==e?0:e.length;return t?ea(e,1,t):[]},On.take=function(t,n,r){return t&&t.length?ea(t,0,0>(n=r||n===e?1:ml(n))?0:n):[]},On.takeRight=function(t,n,r){var a=null==t?0:t.length;return a?ea(t,0>(n=a-(n=r||n===e?1:ml(n)))?0:n,a):[]},On.takeRightWhile=function(e,t){return e&&e.length?da(e,ii(t,3),!1,!0):[]},On.takeWhile=function(e,t){return e&&e.length?da(e,ii(t,3)):[]},On.tap=function(e,t){return t(e),e},On.throttle=function(e,n,r){var a=!0,i=!0;if("function"!=typeof e)throw new Te(t);return Zs(r)&&(a="leading"in r?!!r.leading:a,i="trailing"in r?!!r.trailing:i),Ds(e,n,{leading:a,maxWait:n,trailing:i})},On.thru=hs,On.toArray=ul,On.toPairs=Ml,On.toPairsIn=Ol,On.toPath=function(e){return $s(e)?Tt(e,Pi):ll(e)?[e]:Na(Fi(xl(e)))},On.toPlainObject=gl,On.transform=function(e,t,n){var r=$s(e),a=r||Ks(e)||ol(e);if(t=ii(t,4),null==n){var i=e&&e.constructor;n=a?r?new i:[]:Zs(e)&&Xs(i)?Rn(He(e)):{}}return(a?jt:yr)(e,function(e,r,a){return t(n,e,r,a)}),n},On.unary=function(e){return Ns(e,1)},On.union=es,On.unionBy=ts,On.unionWith=ns,On.uniq=function(e){return e&&e.length?la(e):[]},On.uniqBy=function(e,t){return e&&e.length?la(e,ii(t,2)):[]},On.uniqWith=function(t,n){return n="function"==typeof n?n:e,t&&t.length?la(t,e,n):[]},On.unset=function(e,t){return null==e||oa(e,t)},On.unzip=rs,On.unzipWith=as,On.update=function(e,t,n){return null==e?e:ca(e,t,fa(n))},On.updateWith=function(t,n,r,a){return a="function"==typeof a?a:e,null==t?t:ca(t,n,fa(r),a)},On.values=Rl,On.valuesIn=function(e){return null==e?[]:qt(e,El(e))},On.without=is,On.words=Xl,On.wrap=function(e,t){return Ps(fa(t),e)},On.xor=ss,On.xorBy=ls,On.xorWith=os,On.zip=cs,On.zipObject=function(e,t){return ma(e||[],t||[],Zn)},On.zipObjectDeep=function(e,t){return ma(e||[],t||[],Xr)},On.zipWith=ds,On.entries=Ml,On.entriesIn=Ol,On.extend=vl,On.extendWith=bl,so(On,On),On.add=yo,On.attempt=Gl,On.camelCase=Bl,On.capitalize=Vl,On.ceil=vo,On.clamp=function(t,n,r){return r===e&&(r=n,n=e),r!==e&&(r=(r=fl(r))==r?r:0),n!==e&&(n=(n=fl(n))==n?n:0),ir(fl(t),n,r)},On.clone=function(e){return sr(e,4)},On.cloneDeep=function(e){return sr(e,5)},On.cloneDeepWith=function(t,n){return sr(t,5,n="function"==typeof n?n:e)},On.cloneWith=function(t,n){return sr(t,4,n="function"==typeof n?n:e)},On.conformsTo=function(e,t){return null==t||lr(e,t,Dl(t))},On.deburr=Ul,On.defaultTo=function(e,t){return null==e||e!=e?t:e},On.divide=bo,On.endsWith=function(t,n,r){t=xl(t),n=sa(n);var a=t.length,i=r=r===e?a:ir(ml(r),0,a);return(r-=n.length)>=0&&t.slice(r,i)==n},On.eq=Rs,On.escape=function(e){return(e=xl(e))&&H.test(e)?e.replace(U,Gt):e},On.escapeRegExp=function(e){return(e=xl(e))&&J.test(e)?e.replace(G,"\\$&"):e},On.every=function(t,n,r){var a=$s(t)?wt:hr;return r&&gi(t,n,r)&&(n=e),a(t,ii(n,3))},On.find=fs,On.findIndex=Ui,On.findKey=function(e,t){return At(e,ii(t,3),yr)},On.findLast=gs,On.findLastIndex=$i,On.findLastKey=function(e,t){return At(e,ii(t,3),vr)},On.floor=jo,On.forEach=xs,On.forEachRight=ys,On.forIn=function(e,t){return null==e?e:gr(e,ii(t,3),El)},On.forInRight=function(e,t){return null==e?e:xr(e,ii(t,3),El)},On.forOwn=function(e,t){return e&&yr(e,ii(t,3))},On.forOwnRight=function(e,t){return e&&vr(e,ii(t,3))},On.get=Sl,On.gt=Bs,On.gte=Vs,On.has=function(e,t){return null!=e&&hi(e,t,Sr)},On.hasIn=Nl,On.head=Wi,On.identity=no,On.includes=function(e,t,n,r){e=Ws(e)?e:Rl(e),n=n&&!r?ml(n):0;var a=e.length;return 0>n&&(n=fn(a+n,0)),sl(e)?a>=n&&e.indexOf(t,n)>-1:!!a&&Ft(e,t,n)>-1},On.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var a=null==n?0:ml(n);return 0>a&&(a=fn(r+a,0)),Ft(e,t,a)},On.inRange=function(t,n,r){return n=hl(n),r===e?(r=n,n=0):r=hl(r),function(e,t,n){return e>=gn(t,n)&&e<fn(t,n)}(t=fl(t),n,r)},On.invoke=_l,On.isArguments=Us,On.isArray=$s,On.isArrayBuffer=Hs,On.isArrayLike=Ws,On.isArrayLikeObject=qs,On.isBoolean=function(e){return!0===e||!1===e||el(e)&&wr(e)==m},On.isBuffer=Ks,On.isDate=Ys,On.isElement=function(e){return el(e)&&1===e.nodeType&&!rl(e)},On.isEmpty=function(e){if(null==e)return!0;if(Ws(e)&&($s(e)||"string"==typeof e||"function"==typeof e.splice||Ks(e)||ol(e)||Us(e)))return!e.length;var t=ui(e);if(t==y||t==w)return!e.size;if(bi(e))return!zr(e).length;for(var n in e)if(Ae.call(e,n))return!1;return!0},On.isEqual=function(e,t){return Dr(e,t)},On.isEqualWith=function(t,n,r){var a=(r="function"==typeof r?r:e)?r(t,n):e;return a===e?Dr(t,n,e,r):!!a},On.isError=Qs,On.isFinite=function(e){return"number"==typeof e&&hn(e)},On.isFunction=Xs,On.isInteger=Gs,On.isLength=Js,On.isMap=tl,On.isMatch=function(e,t){return e===t||Er(e,t,li(t))},On.isMatchWith=function(t,n,r){return r="function"==typeof r?r:e,Er(t,n,li(n),r)},On.isNaN=function(e){return nl(e)&&e!=+e},On.isNative=function(e){if(vi(e))throw new je("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Lr(e)},On.isNil=function(e){return null==e},On.isNull=function(e){return null===e},On.isNumber=nl,On.isObject=Zs,On.isObjectLike=el,On.isPlainObject=rl,On.isRegExp=al,On.isSafeInteger=function(e){return Gs(e)&&e>=-9007199254740991&&l>=e},On.isSet=il,On.isString=sl,On.isSymbol=ll,On.isTypedArray=ol,On.isUndefined=function(t){return t===e},On.isWeakMap=function(e){return el(e)&&ui(e)==N},On.isWeakSet=function(e){return el(e)&&"[object WeakSet]"==wr(e)},On.join=function(e,t){return null==e?"":mn.call(e,t)},On.kebabCase=$l,On.last=Qi,On.lastIndexOf=function(t,n,r){var a=null==t?0:t.length;if(!a)return-1;var i=a;return r!==e&&(i=0>(i=ml(r))?fn(a+i,0):gn(i,a-1)),n==n?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(t,n,i):zt(t,Mt,i,!0)},On.lowerCase=Hl,On.lowerFirst=Wl,On.lt=cl,On.lte=dl,On.max=function(t){return t&&t.length?mr(t,no,Cr):e},On.maxBy=function(t,n){return t&&t.length?mr(t,ii(n,2),Cr):e},On.mean=function(e){return Ot(e,no)},On.meanBy=function(e,t){return Ot(e,ii(t,2))},On.min=function(t){return t&&t.length?mr(t,no,Fr):e},On.minBy=function(t,n){return t&&t.length?mr(t,ii(n,2),Fr):e},On.stubArray=fo,On.stubFalse=go,On.stubObject=function(){return{}},On.stubString=function(){return""},On.stubTrue=function(){return!0},On.multiply=ko,On.nth=function(t,n){return t&&t.length?Br(t,ml(n)):e},On.noConflict=function(){return lt._===this&&(lt._=Oe),this},On.noop=lo,On.now=Ss,On.pad=function(e,t,n){e=xl(e);var r=(t=ml(t))?an(e):0;if(!t||r>=t)return e;var a=(t-r)/2;return Va(Bt(a),n)+e+Va(Lt(a),n)},On.padEnd=function(e,t,n){e=xl(e);var r=(t=ml(t))?an(e):0;return t&&t>r?e+Va(t-r,n):e},On.padStart=function(e,t,n){e=xl(e);var r=(t=ml(t))?an(e):0;return t&&t>r?Va(t-r,n)+e:e},On.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),yn(xl(e).replace(Z,""),t||0)},On.random=function(t,n,r){if(r&&"boolean"!=typeof r&&gi(t,n,r)&&(n=r=e),r===e&&("boolean"==typeof n?(r=n,n=e):"boolean"==typeof t&&(r=t,t=e)),t===e&&n===e?(t=0,n=1):(t=hl(t),n===e?(n=t,t=0):n=hl(n)),t>n){var a=t;t=n,n=a}if(r||t%1||n%1){var i=vn();return gn(t+i*(n-t+rt("1e-"+((i+"").length-1))),n)}return Wr(t,n)},On.reduce=function(e,t,n){var r=$s(e)?_t:Vt,a=3>arguments.length;return r(e,ii(t,4),n,a,dr)},On.reduceRight=function(e,t,n){var r=$s(e)?Dt:Vt,a=3>arguments.length;return r(e,ii(t,4),n,a,ur)},On.repeat=function(t,n,r){return n=(r?gi(t,n,r):n===e)?1:ml(n),qr(xl(t),n)},On.replace=function(){var e=arguments,t=xl(e[0]);return 3>e.length?t:t.replace(e[1],e[2])},On.result=function(t,n,r){var a=-1,i=(n=ga(n,t)).length;for(i||(i=1,t=e);++a<i;){var s=null==t?e:t[Pi(n[a])];s===e&&(a=i,s=r),t=Xs(s)?s.call(t):s}return t},On.round=wo,On.runInContext=ee,On.sample=function(e){return($s(e)?Qn:Yr)(e)},On.size=function(e){if(null==e)return 0;if(Ws(e))return sl(e)?an(e):e.length;var t=ui(e);return t==y||t==w?e.size:zr(e).length},On.snakeCase=ql,On.some=function(t,n,r){var a=$s(t)?Et:ta;return r&&gi(t,n,r)&&(n=e),a(t,ii(n,3))},On.sortedIndex=function(e,t){return na(e,t)},On.sortedIndexBy=function(e,t,n){return ra(e,t,ii(n,2))},On.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=na(e,t);if(n>r&&Rs(e[r],t))return r}return-1},On.sortedLastIndex=function(e,t){return na(e,t,!0)},On.sortedLastIndexBy=function(e,t,n){return ra(e,t,ii(n,2),!0)},On.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=na(e,t,!0)-1;if(Rs(e[n],t))return n}return-1},On.startCase=Kl,On.startsWith=function(e,t,n){return e=xl(e),n=null==n?0:ir(ml(n),0,e.length),t=sa(t),e.slice(n,n+t.length)==t},On.subtract=Co,On.sum=function(e){return e&&e.length?Ut(e,no):0},On.sumBy=function(e,t){return e&&e.length?Ut(e,ii(t,2)):0},On.template=function(t,n,r){var a=On.templateSettings;r&&gi(t,n,r)&&(n=e),t=xl(t),n=bl({},n,a,Qa);var i,s,l=bl({},n.imports,a.imports,Qa),o=Dl(l),c=qt(l,o),d=0,u=n.interpolate||fe,h="__p += '",m=Se((n.escape||fe).source+"|"+u.source+"|"+(u===K?le:fe).source+"|"+(n.evaluate||fe).source+"|$","g"),p="//# sourceURL="+(Ae.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ze+"]")+"\n";t.replace(m,function(e,n,r,a,l,o){return r||(r=a),h+=t.slice(d,o).replace(ge,Jt),n&&(i=!0,h+="' +\n__e("+n+") +\n'"),l&&(s=!0,h+="';\n"+l+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),d=o+e.length,e}),h+="';\n";var f=Ae.call(n,"variable")&&n.variable;if(f){if(ie.test(f))throw new je("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(s?h.replace(O,""):h).replace(R,"$1").replace(B,"$1;"),h="function("+(f||"obj")+") {\n"+(f?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var g=Gl(function(){return ke(o,p+"return "+h).apply(e,c)});if(g.source=h,Qs(g))throw g;return g},On.times=function(e,t){if(1>(e=ml(e))||e>l)return[];var n=c,r=gn(e,c);t=ii(t),e-=c;for(var a=$t(r,t);++n<e;)t(n);return a},On.toFinite=hl,On.toInteger=ml,On.toLength=pl,On.toLower=function(e){return xl(e).toLowerCase()},On.toNumber=fl,On.toSafeInteger=function(e){return e?ir(ml(e),-9007199254740991,l):0===e?e:0},On.toString=xl,On.toUpper=function(e){return xl(e).toUpperCase()},On.trim=function(t,n,r){if((t=xl(t))&&(r||n===e))return Ht(t);if(!t||!(n=sa(n)))return t;var a=sn(t),i=sn(n);return ya(a,Yt(a,i),Qt(a,i)+1).join("")},On.trimEnd=function(t,n,r){if((t=xl(t))&&(r||n===e))return t.slice(0,ln(t)+1);if(!t||!(n=sa(n)))return t;var a=sn(t);return ya(a,0,Qt(a,sn(n))+1).join("")},On.trimStart=function(t,n,r){if((t=xl(t))&&(r||n===e))return t.replace(Z,"");if(!t||!(n=sa(n)))return t;var a=sn(t);return ya(a,Yt(a,sn(n))).join("")},On.truncate=function(t,n){var r=30,a="...";if(Zs(n)){var i="separator"in n?n.separator:i;r="length"in n?ml(n.length):r,a="omission"in n?sa(n.omission):a}var s=(t=xl(t)).length;if(Zt(t)){var l=sn(t);s=l.length}if(r>=s)return t;var o=r-an(a);if(1>o)return a;var c=l?ya(l,0,o).join(""):t.slice(0,o);if(i===e)return c+a;if(l&&(o+=c.length-o),al(i)){if(t.slice(o).search(i)){var d,u=c;for(i.global||(i=Se(i.source,xl(oe.exec(i))+"g")),i.lastIndex=0;d=i.exec(u);)var h=d.index;c=c.slice(0,h===e?o:h)}}else if(t.indexOf(sa(i),o)!=o){var m=c.lastIndexOf(i);m>-1&&(c=c.slice(0,m))}return c+a},On.unescape=function(e){return(e=xl(e))&&$.test(e)?e.replace(V,on):e},On.uniqueId=function(e){var t=++ze;return xl(e)+t},On.upperCase=Yl,On.upperFirst=Ql,On.each=xs,On.eachRight=ys,On.first=Wi,so(On,(xo={},yr(On,function(e,t){Ae.call(On.prototype,t)||(xo[t]=e)}),xo),{chain:!1}),On.VERSION="4.17.21",jt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){On[e].placeholder=On}),jt(["drop","take"],function(t,n){Un.prototype[t]=function(r){r=r===e?1:fn(ml(r),0);var a=this.__filtered__&&!n?new Un(this):this.clone();return a.__filtered__?a.__takeCount__=gn(r,a.__takeCount__):a.__views__.push({size:gn(r,c),type:t+(0>a.__dir__?"Right":"")}),a},Un.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),jt(["filter","map","takeWhile"],function(e,t){var n=t+1,r=1==n||3==n;Un.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:ii(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),jt(["head","last"],function(e,t){var n="take"+(t?"Right":"");Un.prototype[e]=function(){return this[n](1).value()[0]}}),jt(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");Un.prototype[e]=function(){return this.__filtered__?new Un(this):this[n](1)}}),Un.prototype.compact=function(){return this.filter(no)},Un.prototype.find=function(e){return this.filter(e).head()},Un.prototype.findLast=function(e){return this.reverse().find(e)},Un.prototype.invokeMap=Kr(function(e,t){return"function"==typeof e?new Un(this):this.map(function(n){return Ir(n,e,t)})}),Un.prototype.reject=function(e){return this.filter(zs(ii(e)))},Un.prototype.slice=function(t,n){t=ml(t);var r=this;return r.__filtered__&&(t>0||0>n)?new Un(r):(0>t?r=r.takeRight(-t):t&&(r=r.drop(t)),n!==e&&(r=0>(n=ml(n))?r.dropRight(-n):r.take(n-t)),r)},Un.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Un.prototype.toArray=function(){return this.take(c)},yr(Un.prototype,function(t,n){var r=/^(?:filter|find|map|reject)|While$/.test(n),a=/^(?:head|last)$/.test(n),i=On[a?"take"+("last"==n?"Right":""):n],s=a||/^find/.test(n);i&&(On.prototype[n]=function(){var n=this.__wrapped__,l=a?[1]:arguments,o=n instanceof Un,c=l[0],d=o||$s(n),u=function(e){var t=i.apply(On,It([e],l));return a&&h?t[0]:t};d&&r&&"function"==typeof c&&1!=c.length&&(o=d=!1);var h=this.__chain__,m=!!this.__actions__.length,p=s&&!h,f=o&&!m;if(!s&&d){n=f?n:new Un(this);var g=t.apply(n,l);return g.__actions__.push({func:hs,args:[u],thisArg:e}),new Vn(g,h)}return p&&f?t.apply(this,l):(g=this.thru(u),p?a?g.value()[0]:g.value():g)})}),jt(["pop","push","shift","sort","splice","unshift"],function(e){var t=Ie[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);On.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var a=this.value();return t.apply($s(a)?a:[],e)}return this[n](function(n){return t.apply($s(n)?n:[],e)})}}),yr(Un.prototype,function(e,t){var n=On[t];if(n){var r=n.name+"";Ae.call(_n,r)||(_n[r]=[]),_n[r].push({name:t,func:n})}}),_n[Ma(e,2).name]=[{name:"wrapper",func:e}],Un.prototype.clone=function(){var e=new Un(this.__wrapped__);return e.__actions__=Na(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Na(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Na(this.__views__),e},Un.prototype.reverse=function(){if(this.__filtered__){var e=new Un(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Un.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=$s(e),r=0>t,a=n?e.length:0,i=function(e,t,n){for(var r=-1,a=n.length;++r<a;){var i=n[r],s=i.size;switch(i.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=gn(t,e+s);break;case"takeRight":e=fn(e,t-s)}}return{start:e,end:t}}(0,a,this.__views__),s=i.start,l=i.end,o=l-s,c=r?l:s-1,d=this.__iteratees__,u=d.length,h=0,m=gn(o,this.__takeCount__);if(!n||!r&&a==o&&m==o)return ua(e,this.__actions__);var p=[];e:for(;o--&&m>h;){for(var f=-1,g=e[c+=t];++f<u;){var x=d[f],y=x.iteratee,v=x.type,b=y(g);if(2==v)g=b;else if(!b){if(1==v)continue e;break e}}p[h++]=g}return p},On.prototype.at=ms,On.prototype.chain=function(){return us(this)},On.prototype.commit=function(){return new Vn(this.value(),this.__chain__)},On.prototype.next=function(){this.__values__===e&&(this.__values__=ul(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?e:this.__values__[this.__index__++]}},On.prototype.plant=function(t){for(var n,r=this;r instanceof Bn;){var a=Oi(r);a.__index__=0,a.__values__=e,n?i.__wrapped__=a:n=a;var i=a;r=r.__wrapped__}return i.__wrapped__=t,n},On.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Un){var n=t;return this.__actions__.length&&(n=new Un(this)),(n=n.reverse()).__actions__.push({func:hs,args:[Zi],thisArg:e}),new Vn(n,this.__chain__)}return this.thru(Zi)},On.prototype.toJSON=On.prototype.valueOf=On.prototype.value=function(){return ua(this.__wrapped__,this.__actions__)},On.prototype.first=On.prototype.head,it&&(On.prototype[it]=function(){return this}),On}();ct?((ct.exports=cn)._=cn,ot._=cn):lt._=cn}()),ar.exports);const sr=at(ir),lr=({tip:e})=>Et.jsx("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",padding:"50px 0"},children:Et.jsx(s,{tip:e,size:"large",children:Et.jsx("div",{className:"content",style:{padding:"50px"}})})});var or,cr,dr,ur,hr,mr={exports:{}};function pr(){return cr?or:(cr=1,or="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}function fr(){if(ur)return dr;ur=1;var e=pr();function t(){}function n(){}return n.resetWarningCache=t,dr=function(){function r(t,n,r,a,i,s){if(s!==e){var l=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function a(){return r}r.isRequired=r;var i={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:t};return i.PropTypes=i,i}}function gr(){return hr||(hr=1,mr.exports=fr()()),mr.exports}const xr=at(gr()),yr={waiting:"gold",pending:"purple",in_progress:"blue",completed:"green",cancelled:"red"},vr={waiting:"Chờ xác nhận",pending:"Tạm dừng",in_progress:"Đang thực hiện",completed:"Đã kết thúc",cancelled:"Đã hủy"},br=e=>vr[e]||e,{Option:jr}=t,kr=({value:e,onChange:n,placeholder:r="Chọn địa điểm",style:a={width:"100%"},disabled:i=!1,allowClear:l=!0,showSearch:o=!0,activeOnly:c=!1,multiple:d=!1,loading:u=!1,locations:h=[],locationsLoading:m=!1,locationsError:p=null,onError:f=null,onSuccess:g=null,showAllOption:x=!1,allOptionLabel:y="Tất cả",...v})=>{b.useEffect(()=>{p&&f&&f(p)},[p,f]);const j=[...c?h.filter(e=>e.isActive):h].sort((e,t)=>e.name.localeCompare(t.name,"vi"));return Et.jsxs(t,{value:e,onChange:e=>{n&&n(e)},placeholder:r,style:a,disabled:i||m,allowClear:l,mode:d?"multiple":void 0,loading:u||m,notFoundContent:m?Et.jsx("div",{style:{textAlign:"center",padding:"8px"},children:Et.jsx(s,{size:"small"})}):p?Et.jsx("div",{style:{textAlign:"center",padding:"8px",color:"#ff4d4f"},children:"Lỗi tải dữ liệu"}):Et.jsx("div",{style:{textAlign:"center",padding:"8px",color:"#999"},children:"Không có dữ liệu"}),...v,children:[x&&Et.jsx(jr,{value:"Tất cả",children:y}),j.map(e=>Et.jsx(jr,{value:e.id,children:e.name},e.id))]})};kr.propTypes={value:xr.oneOfType([xr.string,xr.number,xr.array]),onChange:xr.func,placeholder:xr.string,style:xr.object,disabled:xr.bool,allowClear:xr.bool,showSearch:xr.bool,activeOnly:xr.bool,multiple:xr.bool,loading:xr.bool,locations:xr.array,locationsLoading:xr.bool,locationsError:xr.string,onError:xr.func,onSuccess:xr.func,showAllOption:xr.bool,allOptionLabel:xr.string};const{Option:wr}=t,{RangePicker:Cr}=u,{Text:Sr}=r;function Nr({filters:n={},setFilters:r,filterLoading:a={},locations:i=[],locationsLoading:s=!1,locationsError:l=null,onSearchChange:o,searchLoading:c=!1}){const d=e.useCallback((e,t)=>{r(n=>({...n,[e]:t}))},[r]);e.useCallback(e=>{const t=e.target.value;o?o(t):d("search",t)},[o,d]),e.useCallback(()=>{o?o(""):d("search","")},[o,d]);const u=n.statusLabels||vr;return Et.jsx(f,{style:{marginBottom:"24px"},children:Et.jsxs(X,{gutter:16,align:"middle",children:[Et.jsx(G,{children:Et.jsx(Sr,{strong:!0,children:"Trạng thái:"})}),Et.jsx(G,{children:Et.jsxs(t,{style:{width:180},placeholder:"Chọn trạng thái",value:n.status||void 0,onChange:e=>d("status",e),loading:a.status,children:[Et.jsx(wr,{value:"",children:"Tất cả"}),Object.entries(u).map(([e,t])=>Et.jsx(wr,{value:e,children:t},e))]})}),Et.jsx(G,{children:Et.jsx(Sr,{strong:!0,children:"Địa điểm:"})}),Et.jsx(G,{children:Et.jsx(kr,{style:{width:180},placeholder:"Chọn địa điểm",value:n.location||void 0,onChange:e=>{d("location",e)},onError:e=>{},locations:i,locationsLoading:s,locationsError:l})}),Et.jsx(G,{children:Et.jsx(Sr,{strong:!0,children:"Thời gian:"})}),Et.jsx(G,{children:Et.jsxs(t,{style:{width:180},placeholder:"Chọn loại thời gian",value:n.dateField||void 0,onChange:e=>d("dateField",e),allowClear:!0,children:[Et.jsx(wr,{value:"checkInTime",children:"Thời gian bắt đầu"}),Et.jsx(wr,{value:"checkOutTime",children:"Thời gian kết thúc"}),Et.jsx(wr,{value:"createdAt",children:"Ngày tạo"})]})}),Et.jsx(G,{children:Et.jsx(Cr,{format:"DD/MM/YYYY",value:n.dateRange,onChange:e=>{e&&e[0]&&e[1]&&e[1].diff(e[0],"days")>90||d("dateRange",e)},disabledDate:e=>e&&e>K().endOf("day"),placeholder:["Từ ngày","Đến ngày"],style:{width:300}})})]})})}Nr.propTypes={filters:xr.shape({status:xr.string,dateField:xr.string,dateRange:xr.array,statusLabels:xr.object,location:xr.oneOfType([xr.string,xr.number]),search:xr.string}),setFilters:xr.func.isRequired,filterLoading:xr.shape({status:xr.bool}),searchLoading:xr.bool,locations:xr.array,locationsLoading:xr.bool,locationsError:xr.string,onSearchChange:xr.func};const Tr=()=>{const e=localStorage.getItem("token");if(!e)throw Error("Token expired");return{Authorization:"Bearer "+e}},Ir=async e=>{const t={Authorization:"Bearer "+localStorage.getItem("token")};return(await Mt.post("/api/partners",e,{headers:t})).data},_r=({visible:t,onCancel:n,onSuccess:r,existingPartners:a=[],title:s="Thêm nhân sự thực hiện"})=>{const[l,c]=e.useState(!1),[d,u]=e.useState([{fullname:"",donVi:"",email:"",phone:"",cccd:""}]),h=(e,t,n)=>{const r=[...d];r[e]={...r[e],[t]:n},u(r)},[m,f]=e.useState({}),[g,x]=e.useState({});e.useEffect(()=>{d.forEach((e,t)=>{if(e.fullname?.trim()&&e.donVi?.trim()){const n=setTimeout(async()=>{await y(e.fullname,e.donVi,e.cccd,t)},500);return()=>clearTimeout(n)}})},[d]);const y=async(e,t,n,r=-1)=>{if(!(e&&e.trim()&&t&&t.trim()))return!1;const a=e.trim(),i=t.trim(),s=(n||"").trim();if(d.find((e,t)=>t!==r&&e.fullname?.trim()===a&&(e.donVi||"").trim()===i&&(e.cccd||"").trim()===s))return!0;try{const e=await(async(e,t,n="")=>{const r=Tr();return(await Mt.get("/api/partners/check-duplicate",{params:{fullname:e,donVi:t,cccd:n},headers:r})).data})(a,i,s),t=`${a}-${i}-${s}`;return f(n=>({...n,[t]:e})),e.hasWarning?x(n=>({...n,[t]:e})):x(e=>{const n={...e};return delete n[t],n}),e.isDuplicate}catch(l){return!1}},v=(e,t,n,r=-1)=>{if(!(e&&e.trim()&&t&&t.trim()))return!1;const a=e.trim(),i=t.trim(),s=(n||"").trim();if(d.find((e,t)=>t!==r&&e.fullname?.trim()===a&&(e.donVi||"").trim()===i&&(e.cccd||"").trim()===s))return!0;const l=m[`${a}-${i}-${s}`];return l?.isDuplicate||!1},b=(e,t,n,r=-1)=>{if(!(e&&e.trim()&&t&&t.trim()))return null;const a=e.trim(),i=t.trim(),s=(n||"").trim(),l=g[`${a}-${i}-${s}`];return l?.hasWarning?l:null},j=(e,t)=>{const n=[];if(e.fullname&&e.fullname.trim()&&e.donVi&&e.donVi.trim()&&v(e.fullname,e.donVi,e.cccd,t)){const r=e.cccd&&e.cccd.trim()?` và số thẻ "${e.cccd.trim()}"`:"";n.push(`Dòng ${t+1}: Đã tồn tại đối tác với họ tên "${e.fullname.trim()}", đơn vị "${e.donVi.trim()}"${r}`)}return e.cccd&&e.cccd.trim()&&(/^\d{1,12}$/.test(e.cccd.trim())||n.push(`Dòng ${t+1}: Số thẻ nhân viên phải có 1-12 chữ số`)),e.email&&e.email.trim()&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email.trim())||n.push(`Dòng ${t+1}: Email không đúng định dạng`)),e.phone&&e.phone.trim()&&(/^[0-9+\-\s()]{10,15}$/.test(e.phone.trim())||n.push(`Dòng ${t+1}: Số điện thoại không đúng định dạng`)),n},w=()=>{const e=d.some(e=>e.fullname&&e.fullname.trim()&&e.donVi&&e.donVi.trim()&&e.cccd&&e.cccd.trim()),t=d.every((e,t)=>{if(e.fullname?.trim()||e.donVi?.trim()||e.email?.trim()||e.phone?.trim()||e.cccd?.trim()){const n=e.fullname&&e.fullname.trim()&&e.donVi&&e.donVi.trim()&&e.cccd&&e.cccd.trim(),r=0===j(e,t).length;return n&&r}return!0});return e&&t},C=()=>{u([{fullname:"",donVi:"",email:"",phone:"",cccd:""}]),n&&n()};return Et.jsx($,{open:t,onCancel:C,title:s,width:800,footer:[Et.jsx(p,{onClick:C,children:"Hủy"},"cancel"),Et.jsx(k,{title:w()?"":(()=>{if(!d.some(e=>e.fullname&&e.fullname.trim()&&e.donVi&&e.donVi.trim()&&e.cccd&&e.cccd.trim()))return"Vui lòng điền đầy đủ thông tin";const e=[],t=[];return d.forEach((n,r)=>{if(n.fullname?.trim()||n.donVi?.trim()||n.email?.trim()||n.phone?.trim()||n.cccd?.trim()){const a=n.fullname&&n.fullname.trim()&&n.donVi&&n.donVi.trim()&&n.cccd&&n.cccd.trim(),i=j(n,r),s=b(n.fullname,n.donVi,n.cccd,r);a&&0>=i.length||e.push(r+1),s&&t.push(r+1)}}),e.length>0?`Dòng ${e.join(", ")} chưa hợp lệ. Vui lòng kiểm tra lại thông tin.`:t.length>0?`Dòng ${t.join(", ")} có cảnh báo. Vui lòng kiểm tra lại CCCD.`:""})(),placement:"top",children:Et.jsx(p,{type:"primary",style:{backgroundColor:"#003c71",borderColor:"#003c71"},loading:l,disabled:!w(),onClick:async()=>{const e=[];for(let n=0;n<d.length;n++){const t=d[n];if(t.fullname?.trim()&&t.donVi?.trim()&&await y(t.fullname,t.donVi,t.cccd,n)){const r=t.cccd&&t.cccd.trim()?` và số thẻ "${t.cccd.trim()}"`:"";e.push(`Dòng ${n+1}: Đã tồn tại đối tác với họ tên "${t.fullname.trim()}", đơn vị "${t.donVi.trim()}"${r}`)}}if(d.forEach((t,n)=>{const r=j(t,n);e.push(...r)}),e.length>0)i.error(e.join("\n"));else{c(!0);try{const e=[];for(const t of d)if(t.fullname&&t.fullname.trim()&&t.donVi&&t.donVi.trim()){const n=await Ir({...t,fullname:t.fullname.trim(),donVi:t.donVi.trim(),email:t.email?.trim()||"",phone:t.phone?.trim()||"",cccd:t.cccd?.trim()||""});e.push({type:"partner",id:n.id,fullName:n.fullname,donVi:n.donVi,email:n.email,phone:n.phone,cccd:n.cccd,key:n.id,value:n.id,label:n.fullname+(n.donVi?` (${n.donVi})`:"")})}u([{fullname:"",donVi:"",email:"",phone:"",cccd:""}]),r&&r(e),e.length>0&&i.success(`Đã tạo thành công ${e.length} đối tác`)}catch(t){if(400===t.response?.status&&t.response?.data?.errors){const e=t.response.data.errors;Array.isArray(e)?i.error(e.join("\n")):i.error(e)}else 500===t.response?.status?i.error("Lỗi hệ thống. Vui lòng thử lại sau."):i.error("Tạo mới đối tác thất bại: "+(t.response?.data?.message||t.message))}finally{c(!1)}}},children:"Tạo mới"})},"submit")],children:Et.jsxs("div",{style:{maxHeight:"60vh",overflowY:"auto"},children:[d.map((e,t)=>Et.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 mb-3",children:[Et.jsxs("div",{className:"flex justify-between items-center mb-2",children:[Et.jsxs("span",{className:"font-medium text-gray-700",children:["Nhân Sự ",t+1]}),d.length>1&&Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>(e=>{d.length>1&&u(d.filter((t,n)=>n!==e))})(t),size:"small",children:"Xóa"})]}),Et.jsxs(X,{gutter:[8,8],children:[Et.jsx(G,{span:12,children:Et.jsx(o,{placeholder:"Họ tên ",value:e.fullname,onChange:e=>h(t,"fullname",e.target.value),status:!e.fullname.trim()||v(e.fullname,e.donVi,e.cccd,t)?"error":""})}),Et.jsx(G,{span:12,children:Et.jsx(o,{placeholder:"Công ty / Phòng ban",value:e.donVi,onChange:e=>h(t,"donVi",e.target.value),status:!e.donVi.trim()||v(e.fullname,e.donVi,e.cccd,t)?"error":""})}),Et.jsx(G,{span:8,children:Et.jsx(o,{placeholder:"Số thẻ / CCCD (1-12 số)",value:e.cccd,onChange:e=>h(t,"cccd",e.target.value),status:!e.cccd.trim()||e.cccd&&!/^\d{1,12}$/.test(e.cccd.trim())||v(e.fullname,e.donVi,e.cccd,t)?"error":""})}),Et.jsx(G,{span:8,children:Et.jsx(o,{placeholder:"Email",value:e.email,onChange:e=>h(t,"email",e.target.value),status:e.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email.trim())?"error":""})}),Et.jsx(G,{span:8,children:Et.jsx(o,{placeholder:"Số điện thoại",value:e.phone,onChange:e=>h(t,"phone",e.target.value),status:e.phone&&!/^[0-9+\-\s()]{10,15}$/.test(e.phone.trim())?"error":""})})]}),(()=>{const n=j(e,t);return n.length>0?Et.jsx("div",{className:"mt-2",children:n.map((e,t)=>Et.jsx("div",{className:"text-red-500 text-xs",children:e},t))}):null})(),(()=>{const n=b(e.fullname,e.donVi,e.cccd,t);return n?Et.jsxs("div",{className:"mt-2",children:[Et.jsxs("div",{className:"text-orange-500 text-xs flex items-start",children:[Et.jsx("span",{className:"mr-1",children:"⚠️"}),Et.jsx("span",{children:n.message})]}),n.existingPartner&&Et.jsx("div",{className:"text-gray-500 text-xs mt-1 ml-4",children:Et.jsxs("div",{children:[" ",n.existingPartner.fullname," - ",n.existingPartner.donVi," - ",n.existingPartner.cccd||"Chưa có"]})})]}):null})()]},t)),Et.jsx("div",{className:"mb-3",children:Et.jsx(p,{type:"primary",size:"normal",icon:Et.jsx(Z,{}),onClick:()=>{u([...d,{fullname:"",donVi:"",email:"",phone:"",cccd:""}])},style:{width:"80px",backgroundColor:"#0072BC",borderColor:"#0072BC",marginRight:8},children:"Thêm"})}),Et.jsxs("div",{className:"text-xs text-gray-500 mt-3",children:[Et.jsx("div",{children:"* Họ tên đối tác là bắt buộc"}),Et.jsx("div",{children:"* Đơn vị là bắt buộc (Đối với phòng ban thuộc trung tâm hoặc NHCT thì ghi mã phòng ban - ví dụ DCE-ITD)"}),Et.jsx("div",{children:"* Số thẻ nhân viên / số CCCD bắt buộc"})]})]})})};var Dr,Er,Lr,Ar,zr,Fr,Pr,Mr,Or,Rr,Br,Vr,Ur,$r,Hr,Wr,qr,Kr,Yr,Qr,Xr,Gr,Jr,Zr,ea,ta,na,ra;function aa(){return Er?Dr:(Er=1,Dr=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)})}function ia(){if(Fr)return zr;Fr=1;var e=function(){if(Ar)return Lr;Ar=1;var e="object"==typeof globalThis&&globalThis&&globalThis.Object===Object&&globalThis;return Lr=e}(),t="object"==typeof self&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return zr=n}function sa(){if($r)return Ur;$r=1;var e=ia().Symbol;return Ur=e}const la=at(function(){if(ra)return na;ra=1;var e=aa(),t=function(){if(Mr)return Pr;Mr=1;var e=ia();return Pr=function(){return e.Date.now()}}(),n=function(){if(ta)return ea;ta=1;var e=function(){if(Vr)return Br;Vr=1;var e=function(){if(Rr)return Or;Rr=1;var e=/\s/;return Or=function(t){for(var n=t.length;n--&&e.test(t.charAt(n)););return n}}(),t=/^\s+/;return Br=function(n){return n?n.slice(0,e(n)+1).replace(t,""):n}}(),t=aa(),n=function(){if(Zr)return Jr;Zr=1;var e=function(){if(Qr)return Yr;Qr=1;var e=sa(),t=function(){if(Wr)return Hr;Wr=1;var e=sa(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,a=e?e.toStringTag:void 0;return Hr=function(e){var t=n.call(e,a),i=e[a];try{e[a]=void 0;var s=!0}catch(In){}var l=r.call(e);return s&&(t?e[a]=i:delete e[a]),l}}(),n=function(){if(Kr)return qr;Kr=1;var e=Object.prototype.toString;return qr=function(t){return e.call(t)}}(),r=e?e.toStringTag:void 0;return Yr=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":r&&r in Object(e)?t(e):n(e)}}(),t=Gr?Xr:(Gr=1,Xr=function(e){return null!=e&&"object"==typeof e});return Jr=function(n){return"symbol"==typeof n||t(n)&&"[object Symbol]"==e(n)}}(),r=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt;return ea=function(l){if("number"==typeof l)return l;if(n(l))return NaN;if(t(l)){var o="function"==typeof l.valueOf?l.valueOf():l;l=t(o)?o+"":o}if("string"!=typeof l)return 0===l?l:+l;l=e(l);var c=a.test(l);return c||i.test(l)?s(l.slice(2),c?2:8):r.test(l)?NaN:+l}}(),r=Math.max,a=Math.min;return na=function(i,s,l){var o,c,d,u,h,m,p=0,f=!1,g=!1,x=!0;if("function"!=typeof i)throw new TypeError("Expected a function");function y(e){var t=o,n=c;return o=c=void 0,p=e,u=i.apply(n,t)}function v(e){var t=e-m;return void 0===m||t>=s||0>t||g&&e-p>=d}function b(){var e=t();if(v(e))return j(e);h=setTimeout(b,function(e){var t=s-(e-m);return g?a(t,d-(e-p)):t}(e))}function j(e){return h=void 0,x&&o?y(e):(o=c=void 0,u)}function k(){var e=t(),n=v(e);if(o=arguments,c=this,m=e,n){if(void 0===h)return function(e){return p=e,h=setTimeout(b,s),f?y(e):u}(m);if(g)return clearTimeout(h),h=setTimeout(b,s),y(m)}return void 0===h&&(h=setTimeout(b,s)),u}return s=n(s)||0,e(l)&&(f=!!l.leading,d=(g="maxWait"in l)?r(n(l.maxWait)||0,s):d,x="trailing"in l?!!l.trailing:x),k.cancel=function(){void 0!==h&&clearTimeout(h),p=0,o=m=c=h=void 0},k.flush=function(){return void 0===h?u:j(t())},k}}()),{TextArea:oa}=o,{Option:ca}=t,{Text:da}=r,ua=({value:n=[],onChange:r})=>{const[a,i]=e.useState([]),[s,l]=e.useState(!1),[o,d]=e.useState(!1),u=e.useCallback(la(async e=>{if(e&&e.trim().length>=2){l(!0);try{const t=await(async e=>{const t=Tr();return(await Mt.get("/api/partners/search",{params:{keyword:e},headers:t})).data})(e);i(t.map(e=>({label:e.fullname+(e.donVi?` (${e.donVi})`:""),value:e.id,key:e.id,partner:e})))}catch{i([])}l(!1)}else i([])},300),[]),h=n.map(e=>({key:e.key??e.id,value:e.value??e.id,label:e.label||e.fullName||e.fullname||e.name}));return Et.jsxs(Et.Fragment,{children:[Et.jsx(t,{mode:"multiple",showSearch:!0,labelInValue:!0,value:h,onChange:e=>{const t=e.filter(e=>"__create__"!==e.value).map(e=>n.find(t=>t.value===e.value)||(a.find(t=>t.value===e.value)?.partner?{...a.find(t=>t.value===e.value).partner,type:"partner",id:a.find(t=>t.value===e.value).partner.id,key:a.find(t=>t.value===e.value).partner.id,value:a.find(t=>t.value===e.value).partner.id,label:a.find(t=>t.value===e.value).label}:{id:e.value,key:e.value,value:e.value,label:e.label,type:"partner",fullName:e.label}));r(t)},onSearch:u,onSelect:(e,t)=>{if("__create__"===e.value||"__create__"===e.key)return void d(!0);const a=t.partner;n.find(e=>e.id===a.id)||r([...n,{type:"partner",id:a.id,fullName:a.fullname,donVi:a.donVi,email:a.email,phone:a.phone,cccd:a.cccd,key:a.id,value:a.id,label:a.fullname+(a.donVi?` (${a.donVi})`:"")}])},onDeselect:e=>{r(n.filter(t=>t.value!==e.value))},options:[...a,{label:"+ Thêm mới nhân sự",value:"__create__",key:"__create__"}],placeholder:"Nhập tên nhân sự, tìm kiếm hoặc tạo mới",style:{width:"100%"},loading:s,optionFilterProp:"label",notFoundContent:s?"Đang tìm kiếm...":Et.jsx("span",{style:{color:"red"},children:"Không tìm thấy đối tác phù hợp"}),tagRender:e=>{const{label:t,closable:r,onClose:a}=e,i=n.find(t=>t.value===e.value||t.id===e.value);return Et.jsx(k,{title:i?Et.jsxs("div",{children:[Et.jsxs("div",{children:[Et.jsx("b",{children:"Họ tên:"})," ",i.fullName||i.fullname||i.label]}),i.donVi&&Et.jsxs("div",{children:[Et.jsx("b",{children:"Đơn vị:"})," ",i.donVi]}),i.email&&Et.jsxs("div",{children:[Et.jsx("b",{children:"Email:"})," ",i.email]}),i.phone&&Et.jsxs("div",{children:[Et.jsx("b",{children:"Điện thoại:"})," ",i.phone]}),i.cccd&&Et.jsxs("div",{children:[Et.jsx("b",{children:"Số thẻ \\ CCCD:"})," ",i.cccd]}),i.role&&Et.jsxs("div",{children:[Et.jsx("b",{children:"Vai trò:"})," ",i.role]})]}):Et.jsx("div",{children:"Không tìm thấy thông tin"}),placement:"top",mouseEnterDelay:.3,children:Et.jsxs(W,{color:"blue",closable:r,onClose:a,style:{cursor:"pointer",margin:2},children:[Et.jsx(c,{style:{marginRight:4}}),t]})})}}),Et.jsx(_r,{visible:o,onCancel:()=>d(!1),onSuccess:e=>{r([...n,...e]),d(!1)},title:"Thêm mới nhân sự"})]})};function ha({modalType:e,modalVisible:t,form:n,selectedTask:r,locations:s=[],locationsLoading:l=!1,locationsError:o=null,handleModalSubmit:d,handleAttachmentRemove:h,processFileName:f,downloadFile:g,setModalVisible:x,unlockTask:y,fetchTaskDetail:v,getCurrentUserRole:b,handleStatusChange:j,showReasonModal:w,setReopenModalVisible:C,sortedHistory:S,firstContent:T,renderChangeContent:I,setModalType:_,showModal:D}){return Et.jsx($,{title:Et.jsxs("div",{className:"flex items-center w-full",children:[Et.jsx("span",{children:"create"===e?"Thêm công việc":"edit"===e?"Cập nhật công việc":"Chi tiết công việc"}),"view"===e&&Et.jsx("div",{children:Et.jsx(p,{type:"primary",style:{backgroundColor:"#52c41a",borderColor:"#52c41a",marginLeft:"10px"},icon:Et.jsx(oe,{}),onClick:e=>{if(e.stopPropagation(),r){const e={worker:Array.isArray(r.staff)?r.staff.map(e=>({...e,key:e.key??e.id,value:e.value??e.id,label:e.fullName?e.donVi?`${e.fullName} (${e.donVi})`:e.fullName:e.label||e.fullname||e.name})):[],taskTitle:r.taskTitle||"",taskDescription:r.taskDescription||""};n.setFieldsValue(e),_("create")}},title:"Tạo mới từ công việc này"})})]}),open:t,maskClosable:!1,keyboard:!1,centered:!0,closable:!0,onOk:"view"!==e?d:null,onCancel:async()=>{try{"edit"===e&&r?.id&&r.isLocked&&await y(r.id),n.resetFields(),"edit"===e?(_("view"),r?.id&&await v(r.id)):x(!1)}catch{i.error("Có lỗi xảy ra khi hủy thao tác")}},afterClose:()=>{n.resetFields(),"edit"===e&&r?.id&&r.isLocked&&y(r.id)},footer:null,width:1400,destroyOnHide:!0,children:"view"===e?Et.jsx(Et.Fragment,{children:Et.jsxs("div",{className:"flex gap-4",children:[Et.jsxs("div",{className:"create"===e?"w-full":"w-2/3 rounded-lg",children:[Et.jsxs("div",{className:"flex-1 p-2 bg-white rounded border border-gray-200 shadow min-h-[400px] max-h-[700px]",children:[Et.jsxs(X,{gutter:[8,8],children:[Et.jsxs(G,{span:8,children:[Et.jsxs("div",{className:"mb-4 sticky",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Mã CV"}),Et.jsxs(W,{color:"blue",children:["#",r?.id]})]}),Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Địa điểm"}),Et.jsx(W,{color:"green",children:r?.location})]}),Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Trạng thái"}),Et.jsx(W,{color:yr[r?.status],children:vr[r?.status]})]})]}),Et.jsxs(G,{span:8,children:[Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Thời gian bắt đầu"}),Et.jsxs("div",{children:[Et.jsx(N,{className:"mr-2"}),r?.checkInTime&&ut(new Date(r.checkInTime),"HH:mm dd/MM/yyyy")]}),Et.jsxs("div",{className:"text-s text-gray-400 mt-1",children:[Et.jsx(c,{className:"mr-1"}),"Người xác nhận: ",r?.creator?.fullname]})]}),Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Thời gian kết thúc"}),Et.jsx("div",{children:r?.checkOutTime?Et.jsxs(Et.Fragment,{children:[Et.jsx(N,{className:"mr-2"}),ut(new Date(r.checkOutTime),"HH:mm dd/MM/yyyy"),r?.completer&&Et.jsxs("div",{className:"text-s text-gray-400 mt-1",children:[Et.jsx(c,{className:"mr-1"}),"Người xác nhận: ",r.completer.fullname]})]}):Et.jsx("span",{className:"text-gray-400",children:"Chưa có"})})]})]}),Et.jsx(G,{span:8,children:Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Họ tên nhân sự"}),r?.staff&&r.staff.length>0?Et.jsx("div",{className:"max-h-[300px] overflow-x-auto max-w-full rounded",children:Et.jsx("div",{className:"flex gap-1 flex-wrap",children:r.staff.map((e,t)=>Et.jsx("div",{className:"flex flex-col min-w-[200px] max-w-[300px] break-words ",children:Et.jsxs("div",{className:"flex items-center mb-1",children:[Et.jsx(c,{className:"mr-2"}),Et.jsx("span",{children:e.fullName}),e.donVi&&Et.jsxs("span",{className:"ml-2 text-gray-400",children:["(",e.donVi,")"]}),Et.jsx(k,{title:Et.jsxs("div",{children:[Et.jsxs("div",{children:[Et.jsx("b",{children:"Họ tên:"})," ",e.fullName]}),e.donVi&&Et.jsxs("div",{children:[Et.jsx("b",{children:"Đơn vị:"})," ",e.donVi]}),e.email&&Et.jsxs("div",{children:[Et.jsx("b",{children:"Email:"})," ",e.email]}),e.phone&&Et.jsxs("div",{children:[Et.jsx("b",{children:"Điện thoại:"})," ",e.phone]}),e.cccd&&Et.jsxs("div",{children:[Et.jsx("b",{children:"Số thẻ \\ CCCD:"})," ",e.cccd]}),e.role&&Et.jsxs("div",{children:[Et.jsx("b",{children:"Vai trò:"})," ",e.role]})]}),placement:"right",children:Et.jsx(Y,{style:{color:"#1677ff",marginLeft:8,cursor:"pointer"}})})]})},t))})}):r?.fullName?Et.jsx("div",{className:"overflow-x-auto max-w-full",children:Et.jsx("div",{className:"flex gap-1 flex-wrap",children:r.fullName.split(",").map((e,t)=>Et.jsx("div",{className:"flex flex-col min-w-[200px] max-w-[300px] break-words ",children:Et.jsxs("div",{className:"flex items-center mb-1",children:[Et.jsx(c,{className:"mr-2"}),Et.jsx("span",{children:e.trim()})]})},t))})}):Et.jsx("span",{className:"text-gray-400",children:"Chưa có nhân sự"})]})})]}),Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Công việc thực hiện"}),Et.jsx("div",{className:"bg-gray-50 p-1 rounded whitespace-pre-line break-words",children:r?.taskTitle})]}),r?.attachments?.length>0&&Et.jsxs("div",{className:"mb-4",children:[Et.jsxs(m,{className:"text-gray-500 mb-2",children:[Et.jsx("span",{children:"Phê duyệt"}),Et.jsx(k,{title:Et.jsxs(Et.Fragment,{children:["Với các phê duyệt bằng mail thì lưu mail dưới dạng .msg và upload.",Et.jsx("br",{}),Et.jsx("br",{}),"Với các phê duyệt bằng tin nhắn, chụp màn hình tin nhắn phê duyệt và upload.",Et.jsx("br",{}),Et.jsx("br",{}),"Hỗ trợ các định dạng: .doc, .docx, .pdf, .xls, .xlsx, .jpg, .jpeg, .png, .msg."]}),placement:"right",children:Et.jsx(Y,{style:{color:"#1677ff",cursor:"pointer"}})})]}),Et.jsx("div",{className:"flex flex-wrap gap-2",children:r.attachments.map((e,t)=>{const n=f(e);return Et.jsxs(W,{color:"blue",style:{cursor:"pointer",margin:"4px"},onClick:()=>g(e),title:n,children:[Et.jsx(ee,{})," ",n]},t)})})]}),Et.jsxs("div",{className:"",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Nội dung công việc"}),Et.jsx("div",{className:"p-1 whitespace-pre-line break-words",children:Et.jsxs("div",{style:{maxHeight:"20vh",overflowY:"auto",background:"#f6f8fa",borderRadius:8,padding:8,border:"1px solid #e5e7eb",width:"100%",boxSizing:"border-box",marginTop:8},children:[T&&r?.createdBy&&Et.jsxs("div",{style:{display:"flex",flexDirection:"column",marginBottom:4},children:[Et.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,marginBottom:4},children:[Et.jsx(c,{style:{color:"#1677ff"}}),Et.jsxs("span",{style:{fontWeight:500},children:[" ",r.creator.fullname]}),Et.jsx("span",{style:{color:"#888",fontSize:14},children:ut(new Date(r.createdAt),"HH:mm dd/MM/yyyy")}),Et.jsx("span",{style:{color:"#888",fontSize:14},children:" :"})]}),T||Et.jsx("span",{style:{color:"#bbb"},children:"Chưa có"})]}),S?.map((e,t)=>Et.jsxs("div",{style:{display:"flex",flexDirection:"column",marginBottom:4},children:[Et.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,marginBottom:4},children:[Et.jsx(c,{style:{color:"#1677ff"}}),Et.jsx("span",{style:{fontWeight:500},children:e.changedBy?.fullname||"Hệ thống"}),Et.jsx("span",{style:{color:"#888",fontSize:12},children:ut(new Date(e.createdAt),"HH:mm dd/MM/yyyy")})]}),Et.jsx("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"break-word"},children:e.changes.map((e,t)=>"content"!==e.type||"taskDescription"!==e.field&&e.field?null:Et.jsxs("div",{style:{paddingBottom:6},children:[Et.jsx("span",{style:{color:"#888",fontSize:12},children:"  đã cập nhật :"})," ",e.newValue||Et.jsx("span",{style:{color:"#bbb"},children:"Chưa có"})]},t))})]},t))]})})]}),r?.cancelReason&&Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Lý do hủy"}),Et.jsx("div",{className:"bg-gray-50 p-3 rounded text-red-500",children:r.cancelReason})]})]}),Et.jsx("br",{}),Et.jsxs("div",{className:"flex justify-between items-centermb-3 border border-gray-200 z-10 p-2 rounded-lg shadow-sm ma",children:[Et.jsxs("div",{children:["waiting"===r?.status&&Et.jsxs(m,{children:[Et.jsx(te,{title:"Bắt đầu thực hiện công việc?",description:"Bạn có chắc chắn muốn bắt đầu thực hiện công việc này?",onConfirm:()=>j(r.id,"in_progress",!1,"Bắt đầu thực hiện công việc"),okText:"Xác nhận",cancelText:"Hủy",okButtonProps:{style:{backgroundColor:"#003c71",borderColor:"#003c71",color:"white"}},children:Et.jsx(p,{type:"primary",icon:Et.jsx(ne,{}),style:{backgroundColor:"#003c71",borderColor:"#003c71",marginRight:8},children:"Bắt đầu thực hiện"})}),Et.jsx(p,{type:"primary",icon:Et.jsx(Y,{}),onClick:()=>w("pause"),style:{backgroundColor:"#722ed1",borderColor:"#722ed1",marginRight:8},children:"Tạm dừng"})]}),"in_progress"===r?.status&&Et.jsxs(m,{children:[Et.jsx(te,{title:"Kết thúc công việc?",description:"Bạn có chắc chắn muốn kết thúc công việc này?",onConfirm:()=>j(r.id,"completed",!1,"Kết thúc công việc"),okText:"Xác nhận",cancelText:"Hủy",okButtonProps:{style:{backgroundColor:"#003c71",borderColor:"#003c71",color:"white"}},children:Et.jsx(p,{type:"primary",icon:Et.jsx(re,{}),style:{backgroundColor:"#003c71",borderColor:"#003c71"},children:"Kết thúc công việc"})}),Et.jsx(p,{type:"primary",icon:Et.jsx(Y,{}),onClick:()=>w("pause"),style:{backgroundColor:"#722ed1",borderColor:"#722ed1",marginRight:8},children:"Tạm dừng"})]}),"pending"===r?.status&&Et.jsx(m,{children:Et.jsx(p,{type:"primary",icon:Et.jsx(ne,{}),onClick:()=>w("resume"),style:{backgroundColor:"#003c71",borderColor:"#003c71",marginRight:8},children:"Tiếp tục"})})]}),Et.jsxs("div",{children:[["waiting","in_progress"].includes(r?.status)&&Et.jsx(p,{type:"primary",icon:Et.jsx(ae,{}),onClick:()=>D("edit",r),style:{backgroundColor:"#003c71",borderColor:"#003c71",marginRight:8},children:"Cập nhật"}),"completed"===r?.status&&"manager"===b()&&Et.jsx(p,{type:"primary",icon:Et.jsx(ne,{}),onClick:()=>C(!0),style:{backgroundColor:"#003c71",borderColor:"#003c71",marginRight:8},children:"Mở lại"}),Et.jsx(p,{onClick:async()=>{n.resetFields(),x(!1)},children:"Đóng"})]})]})]}),"create"!==e&&r?.history?.length>0&&Et.jsxs("div",{className:"w-1/3 p-2 bg-gray-50 border border-gray-200 max-h-[700px] overflow-y-auto rounded",children:[Et.jsx("div",{className:"text-lg font-semibold mb-3 sticky top-0 bg-blue-300 z-10 p-2 border rounded-lg shadow-sm",children:"Lịch sử cập nhật"}),Et.jsx(ie,{className:"mt-4",items:r.history.map((e,t)=>({key:t,children:Et.jsxs("div",{className:"p-2 border border-gray-200 rounded-lg mb-3",children:[Et.jsxs("div",{className:"flex items-center gap-2",children:[Et.jsx(c,{className:"text-blue-500"}),Et.jsx("span",{className:"font-medium",children:e.changedBy?.fullname}),Et.jsx("span",{className:"text-gray-500",children:"•"}),Et.jsx("span",{className:"text-gray-500 text-sm",children:ut(new Date(e.createdAt),"HH:mm dd/MM/yyyy")}),e.isAutomatic&&Et.jsxs(W,{color:"blue",className:"ml-2",children:[Et.jsx(Y,{})," Tự động"]})]}),e.changeReason&&Et.jsx("div",{className:"text-gray-600 italic mt-2 text-sm",children:e.changeReason}),Et.jsx("div",{className:"bg-gray-50 rounded-lg mt-3",children:(e.changes||[]).filter(e=>!("content"===e.type&&("taskDescription"===e.field||!e.field))).map((e,t)=>Et.jsx("div",{className:"mb-3 last:mb-0",children:I(e)},t))})]})}))})]})]})}):Et.jsxs("div",{className:"flex gap-4",children:[Et.jsxs("div",{className:"create"===e?"w-full":"w-2/3 rounded-lg",children:[Et.jsx("div",{className:"flex-1 p-2 bg-white rounded border border-gray-200 shadow min-h-[400px] max-h-[700px] overflow-auto",children:Et.jsxs(a,{form:n,layout:"vertical",onFinish:d,children:[Et.jsxs(X,{gutter:4,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"location",label:"Địa điểm làm việc",rules:[{required:!0,message:"Vui lòng chọn địa điểm làm việc"}],style:{marginBottom:6},children:Et.jsx(kr,{placeholder:"Chọn địa điểm làm việc",disabled:"edit"===e,activeOnly:!0,locations:s,locationsLoading:l,locationsError:o})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{label:"Nhân sự",name:"worker",rules:"create"===e||"edit"===e?[{required:!0,message:"Vui lòng chọn ít nhất 1 nhân sự"}]:[],style:{marginBottom:6},children:Et.jsx(ua,{})})})]}),Et.jsxs(X,{gutter:4,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"checkInTime",label:"Thời gian bắt đầu",rules:[{required:!0,message:"Vui lòng chọn thời gian bắt đầu"}],style:{marginBottom:6},children:Et.jsx(u,{showTime:{format:"HH:mm"},format:"DD/MM/YYYY HH:mm",placeholder:"Chọn thời gian bắt đầu",style:{width:"100%"},disabled:"edit"===e})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"checkOutTime",label:"Thời gian kết thúc",dependencies:["checkInTime"],rules:[{required:!0,message:"Vui lòng chọn thời gian kết thúc"},({getFieldValue:e})=>({validator(t,n){const r=e("checkInTime");return n&&r?n.isAfter(r)?Promise.resolve():Promise.reject(Error("Thời gian kết thúc phải lớn hơn thời gian bắt đầu!")):Promise.resolve()}})],style:{marginBottom:6},children:Et.jsx(u,{showTime:{format:"HH:mm"},format:"DD/MM/YYYY HH:mm",placeholder:"Chọn thời gian kết thúc ",style:{width:"100%"},disabled:"edit"===e})})})]}),Et.jsx(a.Item,{name:"taskTitle",label:"Công việc thực hiện",rules:[{required:!0,message:"Vui lòng nhập "}],style:{marginBottom:6},children:Et.jsx(oa,{rows:1,autoSize:{minRows:1,maxRows:5},placeholder:"Nhập nội dung ",readOnly:"edit"===e})}),Et.jsxs(m,{className:"text-gray-500 mb-2",style:{marginBottom:6},children:[Et.jsx("span",{children:"Phê duyệt"}),Et.jsx(k,{title:Et.jsxs(Et.Fragment,{children:["Với các phê duyệt bằng mail thì lưu mail dưới dạng .msg và upload.",Et.jsx("br",{}),Et.jsx("br",{}),"Với các phê duyệt bằng tin nhắn, chụp màn hình tin nhắn phê duyệt và upload.",Et.jsx("br",{}),Et.jsx("br",{}),"Hỗ trợ các định dạng: .doc, .docx, .pdf, .xls, .xlsx, .jpg, .jpeg, .png, .msg."]}),placement:"right",children:Et.jsx(Y,{style:{color:"#1677ff",cursor:"pointer"}})})]}),Et.jsx(a.Item,{name:"attachments",valuePropName:"fileList",rules:[{required:!0,message:"Vui lòng đính kèm tờ trình"}],getValueFromEvent:e=>Array.isArray(e)?e:e?.fileList,style:{marginBottom:6},children:Et.jsx(se,{multiple:!0,maxCount:10,listType:"text",action:!1,showUploadList:{showDownloadIcon:!1,showRemoveIcon:!0,removeIcon:Et.jsx(J,{style:{color:"#ff4d4f"}})},beforeUpload:e=>{if(e.size/1024/1024>=50)return i.error("File không được vượt quá 50MB!"),!1;if(e.name.toLowerCase().endsWith(".msg"))return!0;if(!["image/jpeg","image/png","image/gif","image/webp","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/plain","text/csv","application/zip","application/x-zip-compressed","application/vnd.ms-outlook","application/octet-stream"].includes(e.type))return i.error(`Loại file không được hỗ trợ! (${e.type})`),!1;const t=e.name.toLowerCase().substring(e.name.lastIndexOf("."));return[".jpg",".jpeg",".png",".gif",".webp",".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".txt",".csv",".zip",".ZIP",".msg"].includes(t)?!/[<>:"/\\|?*]/.test(e.name)||(i.error("Tên file chứa ký tự không hợp lệ!"),!1):(i.error("Phần mở rộng file không được hỗ trợ!"),!1)},accept:".jpg,.jpeg,.png,.gif,.webp,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.csv,.zip,.msg",onRemove:h,itemRender:(e,t)=>{const n=f(t);return"uploading"===t.status?Et.jsxs("div",{className:"flex items-center justify-between w-full",children:[Et.jsxs(W,{color:"processing",className:"flex-grow",children:[Et.jsx(q,{})," ",n]}),Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>h(t)})]}):Et.jsxs("div",{className:"flex items-center justify-between w-full",children:[Et.jsxs(W,{color:"blue",children:[Et.jsx(ee,{})," ",n]}),Et.jsx(m,{children:Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>h(t)})})]})},children:Et.jsx(p,{icon:Et.jsx(le,{}),type:"primary",size:"small",style:{backgroundColor:"#003c71",borderColor:"#003c71",marginBottom:6},children:"Chọn file"})})}),Et.jsx(a.Item,{name:"taskDescription",label:"Nội dung công việc",style:{marginBottom:6},children:Et.jsx(oa,{rows:1,autoSize:{minRows:1,maxRows:5},placeholder:"Nhập nội dung công việc cần thực hiện"})}),Et.jsx(a.Item,{name:"changeReason",label:"Căn cứ",rules:[{max:500,message:"Lý do thay đổi không được vượt quá 500 ký tự"}],hidden:"create"===e,style:{marginBottom:6},children:Et.jsx(oa,{rows:1,autoSize:{minRows:1,maxRows:5},placeholder:"Nhập lý do thay đổi thông tin"})}),"edit"===e&&Et.jsxs("div",{style:{maxHeight:"25vh",overflowY:"auto",background:"#f6f8fa",borderRadius:8,padding:8,border:"1px solid #e5e7eb",width:"100%",boxSizing:"border-box",marginBottom:8},children:[T&&r?.createdBy&&Et.jsx("div",{style:{display:"flex",flexDirection:"column",marginBottom:4},children:Et.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,marginBottom:4},children:[Et.jsx(c,{style:{color:"#1677ff"}}),Et.jsxs("span",{style:{fontWeight:500},children:[" ",r.creator.fullname]}),Et.jsx("span",{style:{color:"#888",fontSize:12},children:ut(new Date(r.createdAt),"HH:mm dd/MM/yyyy")}),Et.jsx("span",{style:{color:"#888",fontSize:12},children:" đã tạo:"})," ",T||Et.jsx("span",{style:{color:"#bbb"},children:"Chưa có"})]})}),S?.map((e,t)=>Et.jsxs("div",{style:{display:"flex",flexDirection:"column",marginBottom:4},children:[Et.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,marginBottom:4},children:[Et.jsx(c,{style:{color:"#1677ff"}}),Et.jsx("span",{style:{fontWeight:500},children:e.changedBy?.fullname||"Hệ thống"}),Et.jsx("span",{style:{color:"#888",fontSize:12},children:ut(new Date(e.createdAt),"HH:mm dd/MM/yyyy")})]}),Et.jsx("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"break-word"},children:e.changes.map((e,t)=>"content"!==e.type||"taskDescription"!==e.field&&e.field?null:Et.jsxs("div",{style:{paddingBottom:6},children:[Et.jsx("span",{style:{color:"#888",fontSize:12},children:"  đã cập nhật :"})," ",e.newValue||Et.jsx("span",{style:{color:"#bbb"},children:"Chưa có"})]},t))})]},t))]})]})}),Et.jsx("br",{}),Et.jsxs("div",{className:"flex justify-between gap-1 items-center mb-3 border border-gray-200 z-10 p-2 rounded-lg shadow-sm",children:[Et.jsx(p,{onClick:async()=>{n.resetFields(),x(!1)},type:"primary",style:{backgroundColor:"#003c71",borderColor:"#143c71"},children:"Huỷ"}),Et.jsx(p,{type:"primary",onClick:d,style:{backgroundColor:"#003c71",borderColor:"#003c71"},children:"create"===e?"Thêm mới":"Cập nhật"})]})]}),"create"!==e&&r?.history?.length>0&&Et.jsxs("div",{className:"w-1/3 p-2 bg-gray-50 border border-gray-200 max-h-[700px] overflow-y-auto rounded",children:[Et.jsx("div",{className:"text-lg font-semibold mb-3 sticky top-0 bg-blue-300 z-10 p-2 border rounded-lg shadow-sm",children:"Lịch sử cập nhật"}),Et.jsx(ie,{className:"mt-4",items:r.history.map((e,t)=>({key:t,children:Et.jsxs("div",{className:"p-2 border border-gray-200 rounded-lg mb-3",children:[Et.jsxs("div",{className:"flex items-center gap-2",children:[Et.jsx(c,{className:"text-blue-500"}),Et.jsx("span",{className:"font-medium",children:e.changedBy?.fullname}),Et.jsx("span",{className:"text-gray-500",children:"•"}),Et.jsx("span",{className:"text-gray-500 text-sm",children:ut(new Date(e.createdAt),"HH:mm dd/MM/yyyy")}),e.isAutomatic&&Et.jsxs(W,{color:"blue",className:"ml-2",children:[Et.jsx(Y,{})," Tự động"]})]}),e.changeReason&&Et.jsx("div",{className:"text-gray-600 italic mt-2 text-sm",children:e.changeReason}),Et.jsx("div",{className:"bg-gray-50 rounded-lg mt-3",children:(e.changes||[]).filter(e=>!("content"===e.type&&("taskDescription"===e.field||!e.field))).map((e,t)=>Et.jsx("div",{className:"mb-3 last:mb-0",children:I(e)},t))})]})}))})]})]})})}const{TextArea:ma}=o;function pa({pendingAction:e,reasonModalVisible:t,setReasonModalVisible:n,handleReasonSubmit:r,reopenModalVisible:i,setReopenModalVisible:s,handleReopen:l,reasonForm:o,reopenForm:c}){return Et.jsxs(Et.Fragment,{children:[Et.jsx($,{title:"pause"===e?"Lý do tạm dừng":"Lý do tiếp tục",open:t,onOk:r,onCancel:()=>{n(!1),o.resetFields()},okText:"Xác nhận",okButtonProps:{style:{backgroundColor:"#003c71",borderColor:"#003c71",color:"white"}},cancelText:"Hủy",zIndex:1001,children:Et.jsx(a,{form:o,layout:"vertical",children:Et.jsx(a.Item,{name:"reason",label:"Lý do",rules:[{required:!0,message:"Vui lòng nhập lý do"},{max:500,message:"Lý do không được vượt quá 500 ký tự"}],children:Et.jsx(ma,{rows:4,placeholder:`Nhập lý do ${"pause"===e?"tạm dừng":"tiếp tục"} công việc`,showCount:!0,maxLength:500})})})}),Et.jsx($,{title:"Mở lại công việc",open:i,onOk:l,onCancel:()=>{s(!1),c.resetFields()},okText:"Xác nhận",zIndex:1003,cancelText:"Hủy",okButtonProps:{style:{backgroundColor:"#003c71",borderColor:"#003c71",color:"white"}},children:Et.jsxs(a,{form:c,layout:"vertical",children:[Et.jsx(a.Item,{name:"reopenTime",label:"Thời gian kết thúc mới",required:!0,rules:[{required:!0,message:"Vui lòng chọn thời gian kết thúc mới"}],children:Et.jsx(u,{showTime:{format:"HH:mm"},format:"DD/MM/YYYY HH:mm",style:{width:"100%"},placeholder:"Chọn thời gian kết thúc mới"})}),Et.jsx(a.Item,{name:"reason",label:"Lý do mở lại công việc",rules:[{required:!0,message:"Vui lòng nhập lý do mở lại công việc"},{max:500,message:"Lý do không được vượt quá 500 ký tự"}],children:Et.jsx(ma,{rows:4,placeholder:"Nhập lý do mở lại công việc",showCount:!0,maxLength:500})})]})})]})}const fa=()=>{const e=localStorage.getItem("token");return e?{Authorization:"Bearer "+e}:null},ga=async({page:e=1,limit:t=15,status:n,location:r,fromDate:a,toDate:i,dateField:s,search:l}={})=>{const o=fa();if(!o)throw Error("Token expired");const c={page:e,pageSize:t,timestamp:Date.now()};n&&(c.status=n),r&&(c.location=r),a&&(c.fromDate=a),i&&(c.toDate=i),s&&(c.dateField=s),l&&l.trim()&&(c.search=l.trim());try{return(await Mt.get("/api/tasks",{params:c,headers:o})).data}catch(d){throw d}},xa=async e=>{const t=fa();if(!t)throw Error("Token expired");try{const[n,r]=await Promise.all([Mt.get("/api/tasks/"+e,{headers:t}),Mt.get(`/api/tasks/${e}/history`,{headers:t})]);return{...n.data,history:r.data.history||[]}}catch(n){throw n}},ya=async e=>{const t=fa();if(!t)throw Error("Token expired");try{return await Mt.post(`/api/tasks/${e}/lock`,{},{headers:t})}catch(n){throw n}},va=async e=>{const t=fa();if(!t)throw Error("Token expired");try{return await Mt.delete(`/api/tasks/${e}/lock`,{headers:t})}catch(n){throw n}},ba=async({taskId:e,newStatus:t,reason:n,userId:r,system:a=!1})=>{const i=fa();if(!i)throw Error("Token expired");try{return await Mt.put(`/api/tasks/${e}/status`,{status:t,isSystemChange:a,changeReason:n,completedBy:r,completedAt:new Date},{headers:i})}catch(s){throw s}},ja=async e=>{const t=fa();if(!t)throw Error("Token expired");const n=e.get("staff");if(n)try{const t=JSON.parse(n);e.set("staff",JSON.stringify(t))}catch(In){}try{return await Mt.post("/api/tasks",e,{headers:{...t,"Content-Type":"multipart/form-data"}})}catch(r){throw r}},ka=async(e,t)=>{const n=fa();if(!n)throw Error("Token expired");const r=t.get("staff");if(r)try{const e=JSON.parse(r);t.set("staff",JSON.stringify(e))}catch(In){}try{return await Mt.put("/api/tasks/"+e,t,{headers:{...n,"Content-Type":"multipart/form-data"}})}catch(a){throw a}},wa=async(e,t)=>{const n=fa();if(!n)throw Error("Token expired");try{return await Mt.post(`/api/tasks/${e}/staff`,{staffData:t},{headers:n})}catch(r){throw r}},Ca=async(e,t,n)=>{const r=fa();if(!r)throw Error("Token expired");try{return await Mt.delete(`/api/tasks/${e}/staff`,{params:{staffId:t,staffType:n},headers:r})}catch(a){throw a}};function Sa({tasks:e,loading:t,onView:n,onDelete:r,getCurrentUserId:a,getCurrentUserRole:i,pagination:s,onPaginationChange:l,exportToExcel:o}){const d=[{title:"Mã",dataIndex:"id",key:"id",width:"4%",className:"custom-header border-gray-200",render:e=>Et.jsxs("div",{className:"text-center",children:["CV ",e]})},{title:"Địa điểm",dataIndex:"location",key:"location",width:"8%",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"text-s whitespace-pre-line break-words",children:e})},{title:"Họ tên nhân sự vào/ra TTDL",dataIndex:"staff",key:"staff",width:"14%",className:"custom-header border-gray-200",render:(e,t)=>e&&e.length>0?Et.jsx("div",{className:"whitespace-pre-line break-words",children:e.map((e,t)=>Et.jsxs("div",{className:"items-center mb-1",children:[Et.jsx(c,{className:"mr-2 text-blue-500"}),Et.jsx("span",{className:"break-words",children:e.fullName}),Et.jsxs("span",{className:"text-gray-500",children:[e.donVi?` (${e.donVi})`:""," "]})]},t))}):t.fullName?Et.jsx("div",{className:"whitespace-pre-line break-words",children:t.fullName.split(",").map((e,t)=>Et.jsxs("div",{className:"flex items-center mb-1",children:[Et.jsx(c,{className:"mr-2 text-blue-500"}),Et.jsx("span",{className:"break-words",children:e.trim()})]},t))}):"-"},{title:"Công việc thực hiện",dataIndex:"taskTitle",key:"taskTitle",width:"20%",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e})},{title:"Nội dung",dataIndex:"taskDescription",key:"taskDescription",width:"20%",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e})},{title:"Thời gian bắt đầu",dataIndex:"checkInTime",key:"checkInTime",width:"8%",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:new Date(e).toLocaleString("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"})})},{title:"Thời gian kết thúc",dataIndex:"checkOutTime",key:"checkOutTime",width:"8%",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e?new Date(e).toLocaleString("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"}):"-"})},{title:"Trạng thái",dataIndex:"status",key:"status",width:"6%",align:"center",className:"custom-header border-gray-200",render:e=>Et.jsxs(W,{color:yr[e],children:[" ",vr[e]," "]})},{title:"Thao tác",key:"action",width:"5%",align:"center",className:"custom-header border-gray-200",render:(e,t)=>{const s=t.creator?.id===a(),l="manager"===i(),o=(s||l)&&"completed"!==t.status;return Et.jsxs(m,{children:[Et.jsx(p,{type:"primary",size:"small",className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white whitespace-nowrap",onClick:()=>n(t),children:"Chi Tiết"}),o&&Et.jsx(te,{title:"Xóa công việc?",description:"Bạn có chắc chắn muốn xóa công việc này?",onConfirm:()=>r(t.id),okText:"Xóa",cancelText:"Hủy",okButtonProps:{style:{backgroundColor:"#003c71",borderColor:"#003c71",color:"white"}},children:Et.jsx(p,{danger:!0,type:"primary",size:"small",className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white whitespace-nowrap",children:"Xóa"})})]})}}];return Et.jsx(H,{columns:d,dataSource:e,rowKey:"id",pagination:{current:s?.page||1,pageSize:s?.limit||15,total:s?.total||0,onChange:l,showSizeChanger:!0,pageSizeOptions:["15","20","50","100"],defaultPageSize:15,showTotal:e=>"Tổng số "+e,locale:{items_per_page:"/ Trang"}},bordered:!0,loading:t,defaultSortOrder:"ascend"})}const Na=e=>{if(!e)return"";try{return e.normalize("NFC")}catch(t){return e}},Ta=e=>{try{if(!e)return"";let t=e;try{t=decodeURIComponent(e)}catch(In){}try{const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);const n=new TextDecoder("utf-8").decode(e);n&&(t=n)}catch(In){}return Na(t)}catch(t){return e}},Ia=e=>{if(!e)return"";try{let t="";t=e.response?.originalName?Ta(e.response.originalName):e.originFileObj?Na(e.originFileObj.name):e.originalName?Ta(e.originalName):e.name?Na(e.name):"string"==typeof e?Ta(e):Na(e+"");const n=50;if(t.length>n){const e=t.lastIndexOf(".");if(-1===e)return t.substring(0,n-3)+"...";const r=t.substring(e),a=t.substring(0,e);t=a.substring(0,n-r.length-3)+"..."+r}return t}catch(t){return e.response?.originalName?Ta(e.response.originalName):e.originalName?Ta(e.originalName):e.name?Na(e.name):Na(e+"")}},{Title:_a,Text:Da}=r,Ea=({change:e})=>{const t=e=>{try{return e?JSON.parse(e):e}catch{return e}};return Et.jsxs("div",{className:"flex items-center gap-2",children:[Et.jsx(W,{color:"blue",children:"Trạng thái"}),Et.jsx(Da,{type:"secondary",children:"•"}),Et.jsx(Da,{children:br(t(e.oldValue))}),Et.jsx(Da,{type:"secondary",children:"→"}),Et.jsx(Da,{children:br(t(e.newValue))})]})},La=({change:e})=>{const t=e=>{if(!e)return"Chưa có";try{return K(e).format("HH:mm DD/MM/YYYY")}catch{return e}},n="checkInTime"===e.field?"Thời gian bắt đầu":"checkOutTime"===e.field?"Thời gian kết thúc":"Thời gian";return Et.jsxs("div",{className:"flex items-center gap-2",children:[Et.jsx(W,{color:"green",children:n}),Et.jsx(Da,{type:"secondary",children:"•"}),Et.jsx(Da,{children:t(e.oldValue)}),Et.jsx(Da,{type:"secondary",children:"→"}),Et.jsx(Da,{children:t(e.newValue)})]})},Aa=({change:e})=>{const t=e=>{try{const t=e?JSON.parse(e):[];return Array.isArray(t)?t:[]}catch{return[]}},n=t(e.oldValue),r=t(e.newValue);if(n.length>0&&!e.newValue)return Et.jsxs("div",{className:"flex flex-row gap-1",children:[Et.jsx(W,{color:"purple",children:"Nhân sự"}),Et.jsxs("span",{style:{color:"red"},children:[" Xóa: ",n.join(", ")]})]});if((!e.oldValue||0===n.length)&&r.length>0)return Et.jsxs("div",{className:"flex flex-row gap-1",children:[Et.jsx(W,{color:"purple",children:"Nhân sự"}),Et.jsxs("span",{style:{color:"green"},children:["Thêm: ",r.join(", ")]})]});const a=r.filter(e=>!n.includes(e)),i=n.filter(e=>!r.includes(e));return Et.jsxs("div",{className:"flex flex-row gap-1",children:[Et.jsx(W,{color:"purple",children:"Nhân sự"}),a.length>0&&Et.jsx("div",{children:Et.jsxs("span",{style:{color:"green"},children:["Thêm: ",a.join(", ")]})}),i.length>0&&Et.jsx("div",{children:Et.jsxs("span",{style:{color:"red"},children:[" Xóa: ",i.join(", ")]})}),0===a.length&&0===i.length&&Et.jsx("div",{children:Et.jsx("span",{children:"Không thay đổi"})})]})},za=({change:e})=>Et.jsxs("div",{className:"flex items-center gap-2",children:[Et.jsx(W,{color:"orange",children:"File đính kèm"}),Et.jsx(Da,{type:"secondary",children:"•"}),e.oldValue&&Et.jsxs(Da,{type:"danger",children:[Et.jsx(ce,{})," ",Ia(e.oldValue)]}),e.newValue&&Et.jsxs(Da,{type:"success",children:[Et.jsx(de,{})," ",Ia(e.newValue)]})]}),Fa=e=>{switch(e.type){case"status":return Et.jsx(Ea,{change:e});case"time":return Et.jsx(La,{change:e});case"staff":return Et.jsx(Aa,{change:e});case"attachment":return Et.jsx(za,{change:e});default:return null}},Pa=async(e,t,n)=>{if(!e)return void n.error("Không thể tải file. File không hợp lệ.");const r=((e,t)=>{if(!e)return null;if(!e.filename)return null;const n=e.taskId||t&&t.id;return n?`https://192.168.1.7/api/tasks/${n}/attachments/${e.filename}`:null})(e,t);if(!r)return void n.error("Không thể tải file. URL không hợp lệ.");const a=n.loading("Đang tải file...",0);try{const t={Authorization:"Bearer "+localStorage.getItem("token")},a=await fetch(r,{headers:t});if(!a.ok)throw Error(`File không tồn tại hoặc không thể truy cập (${a.status})`);let i="";if(e.originalName)try{const t=new Uint8Array(e.originalName.length);for(let n=0;n<e.originalName.length;n++)t[n]=e.originalName.charCodeAt(n);i=new TextDecoder("utf-8").decode(t)}catch(In){i=e.originalName}if(!i){const e=a.headers.get("Content-Disposition");if(e){const t=/filename\*?=([^;]+)/i.exec(e);if(t&&t[1])try{let e=t[1].replace(/['"]/g,"");e.startsWith("UTF-8''")&&(e=e.substring(7)),i=decodeURIComponent(e)}catch(In){}}}if(!i&&e.path)try{const t=e.path.split(/[\\/]/);i=t[t.length-1];const n=/^\d{8}_\d{6}_[a-f0-9]{8}_/;n.test(i)&&(i=i.replace(n,""))}catch(In){}i||(i="downloaded_file");try{i=i.normalize("NFC"),i.includes(".")||(i=`${i}.${e.path?e.path.split(".").pop():"docx"}`)}catch(In){}const s=await a.blob(),l=window.URL.createObjectURL(s),o=document.createElement("a");o.href=l,o.download=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(l),n.success("Tải file thành công")}catch(i){n.error("Không thể tải file: "+i.message)}finally{a()}},Ma=e=>e?.id,Oa=e=>e?.role,Ra=e=>{const t=localStorage.getItem("token");return t?{Authorization:"Bearer "+t}:(i.error("Phiên đăng nhập đã hết hạn"),e("/login"),null)},Ba=async({type:e,task:t,setModalType:n,setSelectedTask:r,setModalVisible:a,setRemovedAttachments:i,fetchTaskDetail:s,getCurrentUserId:l,lockTask:o,message:c,form:d})=>{if(n(e),i([]),"view"===e&&t)r(t),a(!0),await s(t.id);else if("edit"===e){const e=await s(t.id);if(!e)return c.error("Không thể tải thông tin công việc. Vui lòng thử lại sau."),void a(!1);if(e.lockedBy&&e.lockedBy!==l())return c.warning("Công việc đang được chỉnh sửa bởi "+(e.lockedByUser?.fullname||"người khác")),void n("view");try{await o(e.id),r({...e,isLocked:!0})}catch(u){return 423===u.response?.status?(c.warning(u.response?.data?.message||"Công việc đang được chỉnh sửa bởi người khác"),void n("view")):(c.error("Không thể khóa công việc để chỉnh sửa"),void n("view"))}d.resetFields(),setTimeout(()=>{d.setFieldsValue({location:e?.location,worker:e?.staff&&e.staff.length>0?e.staff.map(e=>({...e,key:e.id,value:e.id,label:(e.fullName||e.fullname||e.name)+(e.donVi?` (${e.donVi})`:"")})):e?.fullName?e.fullName.split(",").map(e=>({type:"partner",id:null,fullName:e.trim(),key:null,value:null,label:e.trim()})):[],taskDescription:"",taskTitle:e.taskTitle,checkInTime:e.checkInTime?K(e.checkInTime):void 0,checkOutTime:e.checkOutTime?K(e.checkOutTime):void 0,attachments:(e?.attachments||[]).map((e,t)=>({uid:t,name:e.originalName,status:"done",url:e.url,response:e})),changeReason:""})},100),a(!0)}else r(null),d.resetFields(),a(!0)},Va=async({form:e,modalType:t,selectedTask:n,removedAttachments:r,createTask:a,updateTask:i,message:s,navigate:l,setModalVisible:o,fetchTaskDetail:c,fetchAllTasksData:d,unlockTask:u,setModalType:h,locations:m=[]})=>{try{const l=await e.validateFields(),f=(l.worker||[]).filter(Boolean).map(e=>e?e.type?e:"number"==typeof e.id?e.fullName||e.fullname?{...e,type:"partner"}:{...e,type:"user"}:{...e,type:"partner"}:null).filter(Boolean),g=new FormData;if(l.location){const e=m?.find(e=>e.id===l.location);e?g.set("location",e.name):g.set("location",l.location)}if("string"==typeof l.name&&g.set("name",l.name.trim()),l.taskDescription&&g.set("taskDescription",l.taskDescription.trim()),l.taskTitle&&g.set("taskTitle",l.taskTitle.trim()),l.checkInTime&&g.set("checkInTime",l.checkInTime.format("YYYY-MM-DD HH:mm:ss")),l.checkOutTime&&g.set("checkOutTime",l.checkOutTime.format("YYYY-MM-DD HH:mm:ss")),l.attachments){const e=l.attachments.filter(e=>e.originFileObj);e.length>0&&e.forEach(e=>{g.append("attachments",e.originFileObj)})}if(r.length>0){const e=r.map(e=>e.path);g.set("removedAttachments",JSON.stringify(e))}let x="";x="edit"===t?l.changeReason?.trim()||"Cập nhật thông tin":"Tạo mới công việc",g.set("changeReason",x),f.length>0&&g.set("partners",JSON.stringify(f));const y=s.loading("Đang xử lý...",0);try{let e;if("create"===t){e=await a(g);const t=e?.task?.id||e?.id;t&&f.length>0&&await Promise.all(f.map(e=>wa(t,e))),s.success("Tạo công việc thành công"),o(!1),d()}else{await i(n.id,g);const e=await(async e=>{const t=fa();if(!t)throw Error("Token expired");try{return(await Mt.get(`/api/tasks/${e}/staff`,{headers:t})).data}catch(n){throw n}})(n.id),t=e.map(e=>e.id),r=f.map(e=>e.id),a=f.filter(e=>!t.includes(e.id)),l=e.filter(e=>!r.includes(e.id));if(a.length>0||l.length>0){const e={staff:{added:a.map(e=>e.fullName||e.fullname||e.name),removed:l.map(e=>e.fullName||e.fullname||e.name)}};g.set("trackChanges",JSON.stringify(e))}for(const i of f)if(!t.includes(i.id)){const e=i.type?i:{...i,type:i.fullName||i.fullname?"partner":"user"};await wa(n.id,e)}for(const i of e)r.includes(i.id)||await Ca(n.id,i.id,i.type);s.success("Cập nhật công việc thành công"),h("view"),c(n.id),d()}}finally{if(y(),"edit"===t&&n?.id&&n.isLocked)try{await u(n.id)}catch(p){p.response}}}catch(p){if("Token expired"===p.message)return s.error("Phiên đăng nhập đã hết hạn"),void l("/login");s.error(p.response?.data?.message||"Có lỗi xảy ra khi lưu thông tin")}},Ua=(e,t,n)=>{if(e.url||e.response){const t=e.response||e;n(e=>e.some(e=>e.path===t.path)?e:[...e,t])}const r=(t.getFieldValue("attachments")||[]).filter(t=>t.uid!==e.uid);return t.setFieldsValue({attachments:r}),!0},$a=(e,t,n,r)=>{t(e),n(!0),r.resetFields()},Ha=async({reasonForm:e,pendingAction:t,selectedTask:n,handleStatusChange:r,setReasonModalVisible:a})=>{try{const i=await e.validateFields(),{reason:s}=i;"pause"===t?await r(n.id,"pending",!1,s):"resume"===t&&await r(n.id,"in_progress",!1,s),a(!1),e.resetFields()}catch(i){}},Wa=async({reopenForm:e,selectedTask:t,getAuthHeader:n,message:r,navigate:a,setReopenModalVisible:i,fetchTaskDetail:s,fetchAllTasksData:l})=>{try{const a=await e.validateFields(),{reopenTime:o,reason:c}=a;if(!o)return void r.warning("Vui lòng chọn thời gian kết thúc mới");if(t.checkOutTime&&K(o).isBefore(K(t.checkOutTime)))return void r.warning("Thời gian kết thúc mới phải sau thời gian kết thúc cũ");const d=n();if(!d)return;const u=new FormData;if(u.set("status","in_progress"),u.set("checkOutTime",o.format("YYYY-MM-DD HH:mm:ss")),u.set("changeReason",c||"Mở lại công việc"),t.staff&&t.staff.length>0){const e=t.staff.map(e=>({type:e.type||(e.fullName?"partner":"user"),id:e.id,fullName:e.fullName||e.fullname||e.name,donVi:e.donVi}));u.set("worker",JSON.stringify(e))}else t.fullName&&(u.set("worker",t.fullName),u.set("fullName",t.fullName));u.set("taskDescription",t.taskDescription||""),u.set("taskTitle",t.taskTitle||""),u.set("location",t.location||""),u.set("checkInTime",t.checkInTime||"");const h={status:{oldValue:t.status,newValue:"in_progress"},checkOutTime:{oldValue:t.checkOutTime,newValue:o.format("YYYY-MM-DD HH:mm:ss")}};u.set("trackChanges",JSON.stringify(h));const m=r.loading("Đang mở lại công việc...",0);try{await Mt.put("https://192.168.1.7/api/tasks/"+t.id,u,{headers:{...d,"Content-Type":"multipart/form-data"}}),r.success("Đã mở lại công việc"),i(!1),e.resetFields(),await s(t.id),await l()}finally{m()}}catch(o){if(401===o.response?.status)return r.error("Phiên đăng nhập đã hết hạn"),void a("/login");if(400===o.response?.status)return void r.error(o.response.data.message||"Không thể mở lại công việc");r.error("Có lỗi xảy ra khi mở lại công việc")}},{TextArea:qa}=o,{Option:Ka}=t,{RangePicker:Ya}=u,{Title:Qa}=r;function Xa(){const{currentUser:t}=Kt(),n=mt(),[r]=a.useForm(),{locations:s,loading:l,error:o}=((t={})=>{const{autoFetch:n=!0,activeOnly:r=!1,searchTerm:a="",onError:s=null,onSuccess:l=null}=t,[o,c]=e.useState([]),[d,u]=e.useState(!1),[h,m]=e.useState(null),p=e.useRef({autoFetch:n,activeOnly:r,searchTerm:a,onError:s,onSuccess:l});p.current={autoFetch:n,activeOnly:r,searchTerm:a,onError:s,onSuccess:l};const f=e.useRef(!1),g=e.useCallback(async(e={})=>{const{forceRefresh:t=!1,customSearchTerm:n=p.current.searchTerm,customActiveOnly:r=p.current.activeOnly}=e;if((!d||t)&&(!f.current||t))try{let e;return u(!0),m(null),e=n&&n.trim()?await(async e=>{try{return(await Mt.get("/api/locations?search="+encodeURIComponent(e))).data}catch(h){throw Error("Không thể tìm kiếm địa điểm")}})(n):r?await(async()=>{try{return(await Mt.get("/api/locations?isActive=true")).data}catch(h){throw Error("Không thể tải danh sách địa điểm hoạt động")}})():await(async()=>{try{return(await Mt.get("/api/locations")).data}catch(h){throw Error("Không thể tải danh sách địa điểm")}})(),c(e),f.current=!0,p.current.onSuccess&&p.current.onSuccess(e),e}catch(a){const e=a.message||"Không thể tải danh sách địa điểm";throw m(e),i.error(e),p.current.onError&&p.current.onError(a),a}finally{u(!1)}},[]),x=e.useCallback(()=>g({forceRefresh:!0}),[g]),y=e.useCallback(e=>g({forceRefresh:!0,customSearchTerm:e}),[g]),v=e.useCallback(e=>o.find(t=>t.id===e),[o]),b=e.useCallback(e=>o.find(t=>t.name===e),[o]),j=e.useCallback(()=>o.filter(e=>e.isActive),[o]),k=e.useCallback(()=>o.filter(e=>!e.isActive),[o]);return e.useEffect(()=>(p.current.autoFetch&&!f.current&&g(),()=>{f.current=!1}),[n,r,a]),{locations:o,loading:d,error:h,fetchLocations:g,refreshLocations:x,searchLocationsByTerm:y,getLocationById:v,getLocationByName:b,getActiveLocations:j,getInactiveLocations:k,totalLocations:o.length,activeLocationsCount:o.filter(e=>e.isActive).length,inactiveLocationsCount:o.filter(e=>!e.isActive).length}})({autoFetch:!0,activeOnly:!1,onError:e=>{}}),[c,d]=e.useState(!1),[u,h]=e.useState("view"),[g,x]=e.useState(null),[y]=a.useForm(),[v,b]=e.useState([]),[j,k]=e.useState(!1),[w,C]=e.useState([]),[S,N]=e.useState(""),T=e.useRef(),[I,_]=e.useState({status:"",search:"",dateRange:null,location:null}),[D,E]=e.useState(null),[L,A]=e.useState(!1),[z]=a.useForm(),[P,M]=e.useState(!1),[O,R]=e.useState({page:1,limit:15,total:0,totalPages:0}),B=e.useCallback(async(e,t,r)=>{k(!0);try{const n={page:t,limit:r};if(I.status&&(n.status=I.status),I.location){const e=s.find(e=>e.id===I.location);e&&(n.location=e.name)}I.dateRange&&I.dateRange[0]&&I.dateRange[1]&&(n.fromDate=I.dateRange[0].startOf("day").toISOString(),n.toDate=I.dateRange[1].endOf("day").toISOString()),I.dateField&&(n.dateField=I.dateField),e?.trim()&&(n.search=e.trim());const a=await ga(n);C(a.tasks),R(e=>({...e,total:a.total,totalPages:a.totalPages}))}catch(a){if("Token expired"===a.message)return i.error("Phiên đăng nhập đã hết hạn"),void n("/login");i.error("Không thể tải danh sách công việc")}finally{k(!1)}},[n,I.status,I.location,I.dateRange,I.dateField,s]);e.useEffect(()=>{T.current=B},[B]);const V=e.useCallback(async(e,t)=>{T.current&&await T.current("",e,t)},[]),U=e.useMemo(()=>I.status&&"all"!==I.status?w.filter(e=>e.status===I.status):w,[w,I.status]),$=e.useMemo(()=>j&&S?.trim()?[]:U,[U,j,S]),H=e.useCallback(ir.debounce(e=>{R(e=>({...e,page:1})),T.current&&T.current(e,1,15)},300),[]),W=e.useCallback(e=>{N(e),_(t=>({...t,search:e})),H(e)},[H]);e.useEffect(()=>{if(I.status&&"all"!==I.status){const e=w.filter(e=>e.status===I.status).length;R(t=>({...t,total:e,totalPages:Math.ceil(e/t.limit),page:1}))}},[w,I.status]),e.useEffect(()=>{N(I.search||"")},[]),e.useEffect(()=>{V(O.page,O.limit)},[O.page,O.limit,I.location,I.dateRange,I.dateField,I.status,s.length]);const q=async e=>{try{const t=await xa(e);return x(t),t}catch(t){return"Token expired"===t.message?(i.error("Phiên đăng nhập đã hết hạn"),void n("/login")):(i.error("Không thể tải thông tin chi tiết"),null)}},K=async(e,r,a=!1,s=null)=>{try{const n=w.find(t=>t.id===e);if(!n)return void i.error("Không tìm thấy công việc");if(n.status===r)return;let l=s;if(!l&&!a){const e={waiting:"Chờ xử lý",pending:"Tạm dừng",in_progress:"Đang thực hiện",completed:"Đã kết thúc",cancelled:"Đã hủy"};l=`Chuyển trạng thái từ "${e[n.status]||n.status}" sang "${e[r]||r}"`}const o=await ba({taskId:e,newStatus:r,reason:l,userId:t.id,system:a});if(a||(i.success("Cập nhật trạng thái thành công"),V()),C(t=>t.map(t=>t.id===e?o:t)),c&&g&&g.id===e){const t=await q(e);t&&x(t)}}catch(l){if("Token expired"===l.message)return i.error("Phiên đăng nhập đã hết hạn"),void n("/login");a||i.error("Không thể cập nhật trạng thái")}},Y=g?.history?.filter(e=>e?.changes?.some(e=>"content"===e?.type&&("taskDescription"===e?.field||!e?.field)))?.sort((e,t)=>new Date(e.createdAt)-new Date(t.createdAt));let Q="";if(Y?.length>0){const e=Y[0]?.changes?.find(e=>"content"===e?.type&&("taskDescription"===e?.field||!e?.field)&&e?.oldValue);Q=e?.oldValue||""}else Q=g?.taskDescription||"";e.useEffect(()=>{let e=null,t=0,n=null,r=!0;const a=()=>{try{e&&(e.close(),e=null),e=new WebSocket("wss://192.168.1.7/ws"),e.onopen=()=>{r&&(t=0,n&&(clearTimeout(n),n=null))},e.onmessage=e=>{if(r)try{const t=JSON.parse(e.data);if("task_update"===t.type&&(C(e=>{const n=e.findIndex(e=>e.id===t.task.id);if(-1===n)return"create"===t.changeType?[t.task,...e]:e;if("delete"===t.changeType)return e.filter(e=>e.id!==t.task.id);const r=[...e],a=r[n];return r[n]={...a,...t.task,status:t.task.status||a.status,completedAt:t.task.completedAt||a.completedAt,completedBy:t.task.completedBy||a.completedBy},r}),C(e=>{const n=e.findIndex(e=>e.id===t.task.id);if(-1===n)return"create"===t.changeType?[t.task,...e]:e;if("delete"===t.changeType)return e.filter(e=>e.id!==t.task.id);const r=[...e],a=r[n];return r[n]={...a,...t.task,status:t.task.status||a.status,completedAt:t.task.completedAt||a.completedAt,completedBy:t.task.completedBy||a.completedBy},r}),g?.id===t.task.id&&x(e=>({...e,...t.task,status:t.task.status||e.status,completedAt:t.task.completedAt||e.completedAt,completedBy:t.task.completedBy||e.completedBy})),"status"===t.changeType)){const e=vr[t.oldValue]||t.oldValue,n=vr[t.newValue]||t.newValue;i.info(`Công việc #${t.task.id} đã được cập nhật trạng thái từ "${e}" sang "${n}"`)}}catch(t){}},e.onerror=e=>{},e.onclose=e=>{r&&(1e3!==e.code&&5>t?(t++,n=setTimeout(a,3e3)):5>t||i.warning("Mất kết nối với máy chủ. Vui lòng tải lại trang để kết nối lại."))}}catch(s){5>t&&r&&(t++,n=setTimeout(a,3e3))}};return a(),()=>{r=!1,n&&clearTimeout(n),e&&(e.close(1e3,"Component unmounting"),e=null)}},[g]);const X=e.useCallback(e=>{_(e),R(e=>({...e,page:1}))},[]);return Et.jsxs("div",{className:"p-0",children:[Et.jsx("style",{children:"\n          .ant-table-cell {\n            white-space: pre-line !important;\n            word-wrap: break-word !important;\n            word-break: break-word !important;\n          }\n          .ant-table-thead > tr > th {\n            white-space: pre-line !important;\n            word-wrap: break-word !important;\n            word-break: break-word !important;\n          }\n        "}),Et.jsxs(f,{children:[Et.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Et.jsx(Qa,{level:4,style:{color:"#003c71",margin:0},children:"Danh sách vào ra Trung Tâm Dữ Liệu"}),Et.jsxs(m,{children:[Et.jsx(p,{type:"primary",icon:Et.jsx(F,{}),style:{backgroundColor:"#0072BC",borderColor:"#0072BC"},onClick:()=>n("/dc/partners"),children:"Danh sách nhân sự"}),Et.jsx(p,{type:"primary",icon:Et.jsx(Z,{}),style:{backgroundColor:"#003c71",borderColor:"#003c71"},onClick:()=>Ba({type:"create",setModalType:h,setSelectedTask:x,setModalVisible:d,setRemovedAttachments:b,form:r}),children:"Tạo mới"})]})]}),Et.jsx(Nr,{filters:{...I,search:S,statusLabels:vr},setFilters:X,filterLoading:{status:!1},locations:s,locationsLoading:l,locationsError:o,onSearchChange:W,searchLoading:j&&S?.trim()},`filters-${I.status}-${I.location}`),j?Et.jsx(lr,{tip:"Đang tải danh sách công việc..."}):Et.jsx(Et.Fragment,{children:Et.jsx(Sa,{tasks:$,loading:j,pagination:O,onPaginationChange:(e,t)=>{R(n=>({...n,page:e,limit:t}))},onView:e=>Ba({type:"view",task:e,setModalType:h,setSelectedTask:x,setModalVisible:d,setRemovedAttachments:b,fetchTaskDetail:q,form:r}),onDelete:async e=>{try{await(async e=>{const t=fa();if(!t)throw Error("Token expired");try{return await Mt.delete("/api/tasks/"+e,{headers:t})}catch(n){throw n}})(e),i.success("Xóa công việc thành công"),h("view"),x(null),V()}catch(t){if("Token expired"===t.message)return i.error("Phiên đăng nhập đã hết hạn"),void n("/login");i.error("Không thể xóa công việc")}},getCurrentUserId:()=>Ma(t),getCurrentUserRole:()=>Oa(t),exportToExcel:async()=>{try{k(!0);const e={page:1,limit:1e4};if(I.status&&(e.status=I.status),I.location){const t=s.find(e=>e.id===I.location);t&&(e.location=t.name)}I.dateRange&&I.dateRange[0]&&I.dateRange[1]&&(e.fromDate=I.dateRange[0].startOf("day").toISOString(),e.toDate=I.dateRange[1].endOf("day").toISOString()),I.dateField&&(e.dateField=I.dateField),I.search&&I.search.trim()&&(e.search=I.search.trim());const t=(await ga(e)).tasks.map(e=>{let t="";return e.staff&&e.staff.length>0?t=e.staff.map(e=>`${e.fullName}${e.donVi?` (${e.donVi})`:""}`).join(", "):e.fullName&&(t=e.fullName),{"Mã":"CV "+e.id,"Địa điểm":e.location||"","Họ tên nhân sự vào/ra TTDL":t,"Công việc thực hiện":e.taskTitle||"","Nội dung":e.taskDescription||"","Thời gian bắt đầu":e.checkInTime?new Date(e.checkInTime).toLocaleString("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"}):"","Thời gian kết thúc":e.checkOutTime?new Date(e.checkOutTime).toLocaleString("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"}):"","Trạng thái":vr[e.status]||e.status,"Người tạo":e.creator?.fullname||e.creator?.fullName||e.creatorName||""}}),n=jt.book_new(),r=jt.json_to_sheet(t),a=[{wch:8},{wch:15},{wch:30},{wch:25},{wch:40},{wch:18},{wch:18},{wch:12},{wch:20}];r["!cols"]=a;const l=jt.decode_range(r["!ref"]);for(let i=l.s.r;i<=l.e.r;++i)for(let e=l.s.c;e<=l.e.c;++e){const t=jt.encode_cell({r:i,c:e});r[t]&&(r[t].s||(r[t].s={}),r[t].s.alignment={...r[t].s.alignment,wrapText:!0,vertical:"top"})}jt.book_append_sheet(n,r,"Danh sách công việc");const o=(new Date).toISOString().slice(0,19).replace(/:/g,"-");kt(n,`Danh_sach_cong_viec_${o}.xlsx`),i.success(`Đã xuất ${t.length} bản ghi ra file Excel`)}catch(e){if("Token expired"===e.message)return i.error("Phiên đăng nhập đã hết hạn"),void n("/login");i.error("Không thể xuất file Excel")}finally{k(!1)}}})})]}),Et.jsx(ha,{modalType:u,modalVisible:c,form:r,selectedTask:g,locations:s,locationsLoading:l,locationsError:o,STATUS_LABELS:vr,handleModalSubmit:()=>Va({form:r,modalType:u,selectedTask:g,removedAttachments:v,createTask:ja,updateTask:ka,message:i,navigate:n,setModalVisible:d,fetchTaskDetail:q,fetchAllTasksData:V,unlockTask:va,setModalType:h,locations:s}),handleAttachmentRemove:e=>Ua(e,r,b),processFileName:Ia,downloadFile:e=>Pa(e,g,i),setModalVisible:d,unlockTask:va,fetchTaskDetail:q,getCurrentUserRole:()=>Oa(t),showReasonModal:e=>$a(e,E,A,z),setReopenModalVisible:M,sortedHistory:Y,firstContent:Q,renderChangeContent:Fa,setModalType:h,showModal:(e,n)=>Ba({type:e,task:n,setModalType:h,setSelectedTask:x,setModalVisible:d,setRemovedAttachments:b,fetchTaskDetail:q,getCurrentUserId:()=>Ma(t),lockTask:ya,message:i,form:r}),handleStatusChange:K}),Et.jsx(pa,{pendingAction:D,reasonModalVisible:L,setReasonModalVisible:A,handleReasonSubmit:()=>Ha({reasonForm:z,pendingAction:D,selectedTask:g,handleStatusChange:K,setReasonModalVisible:A}),reopenModalVisible:P,setReopenModalVisible:M,handleReopen:()=>Wa({reopenForm:y,selectedTask:g,getAuthHeader:()=>Ra(n),message:i,navigate:n,setReopenModalVisible:M,fetchTaskDetail:q,fetchAllTasksData:V}),reasonForm:z,reopenForm:y})]})}const{Title:Ga,Text:Ja}=r,{RangePicker:Za}=u,ei=()=>{const[t,n]=e.useState(!1),[r,a]=e.useState({totalUsers:0,activeShifts:0,completedHandovers:0,pendingHandovers:0,totalTasks:0,completedTasks:0,inProgressTasks:0,totalShifts:0,completedShifts:0,ongoingShifts:0}),[i,l]=e.useState([]),[o,d]=e.useState([K().subtract(7,"day"),K()]);e.useEffect(()=>{o?.[0]&&o?.[1]&&u()},[o]);const u=async()=>{try{n(!0);const[e,t]=await Promise.all([Mt.get("/api/manager/stats",{params:{startDate:o[0].format("YYYY-MM-DD"),endDate:o[1].format("YYYY-MM-DD")}}),Mt.get("/api/manager/recent-handovers",{params:{startDate:o[0].format("YYYY-MM-DD"),endDate:o[1].format("YYYY-MM-DD")}})]);a(e.data),l(t.data)}catch(e){}finally{n(!1)}},h=[{title:"Ngày",dataIndex:"date",key:"date",render:e=>ut(new Date(e),"dd/MM/yyyy",{locale:kn})},{title:"Ca làm việc",dataIndex:["FromShift","code"],key:"shift",render:e=>"Ca "+e},{title:"Người bàn giao",dataIndex:["FromUser","fullname"],key:"fromUser"},{title:"Người nhận",dataIndex:["ToUser","fullname"],key:"toUser"},{title:"Trạng thái",dataIndex:"status",key:"status",render:e=>{const t={pending:{color:"orange",text:"Chờ xác nhận"},completed:{color:"green",text:"Đã hoàn thành"},rejected:{color:"red",text:"Đã từ chối"}};return Et.jsx("span",{style:{color:t[e]?.color},children:t[e]?.text||e})}}],p=({title:e,value:t,icon:n,color:r,suffix:a,loading:i})=>Et.jsx(f,{variant:"outlined",className:"hover:shadow-lg transition-all duration-300",children:Et.jsx(me,{title:Et.jsx(Ja,{type:"secondary",children:e}),value:t,prefix:n,suffix:a,valueStyle:{color:r},loading:i})}),g=({title:e,percent:t,color:n,loading:r})=>Et.jsxs(f,{variant:"outlined",className:"hover:shadow-lg transition-all duration-300",children:[Et.jsx(Ga,{level:5,type:"secondary",children:e}),Et.jsx(pe,{percent:t,strokeColor:n,showInfo:!1,className:"mt-4"}),Et.jsxs(Ja,{strong:!0,style:{color:n},className:"text-lg mt-2 block",children:[t,"%"]})]});return Et.jsxs("div",{className:"space-y-6",children:[Et.jsxs("div",{className:"flex justify-between items-center mb-6",children:[Et.jsx(Ga,{level:4,style:{margin:0},children:"Tổng quan hệ thống"}),Et.jsx(Za,{value:o,onChange:d,className:"w-80"})]}),Et.jsxs(s,{spinning:t,children:[Et.jsxs(X,{gutter:[16,16],children:[Et.jsx(G,{xs:24,sm:12,lg:6,children:Et.jsx(p,{title:"Tổng số nhân viên",value:r.totalUsers,icon:Et.jsx(c,{}),color:"#1890ff",loading:t})}),Et.jsx(G,{xs:24,sm:12,lg:6,children:Et.jsx(p,{title:"Ca làm việc hiện tại",value:r.activeShifts,icon:Et.jsx(ue,{}),color:"#52c41a",loading:t})}),Et.jsx(G,{xs:24,sm:12,lg:6,children:Et.jsx(p,{title:"Biên bản đã hoàn thành",value:r.completedHandovers,icon:Et.jsx(he,{}),color:"#13c2c2",loading:t})}),Et.jsx(G,{xs:24,sm:12,lg:6,children:Et.jsx(p,{title:"Biên bản chờ xác nhận",value:r.pendingHandovers,icon:Et.jsx(D,{}),color:"#faad14",loading:t})})]}),Et.jsxs(X,{gutter:[16,16],className:"mt-6",children:[Et.jsx(G,{xs:24,md:8,children:Et.jsx(g,{title:"Tiến độ công việc",percent:Math.round(r.completedTasks/r.totalTasks*100)||0,color:"#1890ff",loading:t})}),Et.jsx(G,{xs:24,md:8,children:Et.jsx(g,{title:"Tiến độ ca làm việc",percent:Math.round(r.completedShifts/r.totalShifts*100)||0,color:"#52c41a",loading:t})}),Et.jsx(G,{xs:24,md:8,children:Et.jsx(g,{title:"Tiến độ bàn giao",percent:Math.round(r.completedHandovers/(r.completedHandovers+r.pendingHandovers)*100)||0,color:"#13c2c2",loading:t})})]}),Et.jsx(f,{title:Et.jsxs(m,{children:[Et.jsx(N,{}),Et.jsx("span",{children:"Biên bản bàn giao gần đây"})]}),variant:"outlined",className:"mt-6 hover:shadow-lg transition-all duration-300",children:Et.jsx(H,{dataSource:i,columns:h,rowKey:"id",loading:t,pagination:{pageSize:5}})})]})]})};var ti,ni={exports:{}},ri=(ti||(ti=1,ni.exports=function(e,t,n){t.prototype.isBetween=function(e,t,r,a){var i=n(e),s=n(t),l="("===(a=a||"()")[0],o=")"===a[1];return(l?this.isAfter(i,r):!this.isBefore(i,r))&&(o?this.isBefore(s,r):!this.isAfter(s,r))||(l?this.isBefore(i,r):!this.isAfter(i,r))&&(o?this.isAfter(s,r):!this.isBefore(s,r))}}),ni.exports);const ai=at(ri);K.extend(ai);const{Title:ii,Text:si}=r,{Option:li}=t,{RangePicker:oi}=u,ci=()=>{const n=mt(),{currentUser:r}=Kt(),[a,l]=e.useState(!1),[o,c]=e.useState({status:!1,date:!1}),[d,u]=e.useState([]),[h,g]=e.useState({status:"all",dateRange:null}),[x,y]=e.useState({page:1,limit:15,total:0,totalPages:0}),v=["all","draft","pending","completed","rejected"],b={all:{color:"default",text:"Tất cả"},draft:{color:"blue",text:"Chưa bàn giao"},pending:{color:"orange",text:"Chờ xác nhận"},completed:{color:"green",text:"Đã bàn giao"},rejected:{color:"red",text:"Từ chối"}},j=async(e="all",t=null,n=1,r=15)=>{try{l(!0);const a=new URLSearchParams({page:n,limit:r,status:e,sort:"date:desc,FromShift.code:asc"});if(t&&t[0]&&t[1]){const e=K(t[0]).format("YYYY-MM-DD"),n=K(t[1]).format("YYYY-MM-DD");a.append("dateRange",`${e},${n}`)}const i=await Mt.get(`/api/shifts/handover/by-status/${e}?${a}`),{handovers:s,total:o,totalPages:c}=i.data,d=[...s].sort((e,t)=>{const n=new Date(e.date),r=new Date(t.date);if(n.getTime()!==r.getTime())return r.getTime()-n.getTime();const a=e=>{if(!e)return 999;const t=e.charAt(0).toUpperCase(),n=parseInt(e.substring(1))||0;switch(t){case"T":return 4-n;case"H":return 6-n;case"V":return 9-n;default:return 999}};return a(e.FromShift?.code)-a(t.FromShift?.code)});u(d),y(e=>({...e,total:o,totalPages:c,page:n,limit:r}))}catch(a){i.error("Lỗi khi tải danh sách bàn giao")}finally{l(!1)}};e.useEffect(()=>{j(h.status,h.dateRange,x.page,x.limit)},[]);const[w,C]=e.useState(null);e.useEffect(()=>()=>{C(null)},[]);const S=[{title:"Ngày",dataIndex:"date",key:"date",width:100,className:"custom-header border-r border-l border-gray-200",render:e=>ut(new Date(e),"dd/MM/yyyy",{locale:kn})},{title:"Ca ",key:"shift",width:50,className:"custom-header border-r border-gray-200",render:(e,t)=>Et.jsx("div",{className:"text-center",children:t.FromShift?.code||"N/A"})},{title:"Bên Giao Ca",key:"fromUsers",width:450,className:"custom-header border-r border-gray-200",render:(e,t)=>{let n=t.FromUsers||[];return Et.jsxs("div",{children:[n.map((e,t)=>Et.jsxs(W,{color:"blue",children:[e.fullname||e.fullName,"leader"===e.ShiftHandoverUser?.role&&" (Trưởng ca)"]},t)),0===n.length&&Et.jsx(W,{color:"default",children:"Không có thông tin"})]})}},{title:"Bên Nhận Ca",key:"toUsers",width:450,className:"custom-header border-r border-gray-200",render:(e,t)=>{const n=t.ToUsers||[];return Et.jsx("div",{children:n.length>0?n.map((e,t)=>Et.jsxs(W,{color:"green",children:[e.fullname||e.fullName,("leader"===e.ShiftHandoverUser?.role||"leader"===e.role)&&" (Trưởng ca)"]},t)):Et.jsx(W,{color:"default",children:"Chưa có người nhận"})})}},{title:"Trạng thái",dataIndex:"status",key:"status",width:100,className:"custom-header border-gray-200",defaultSortOrder:"ascend",sorter:(e,t)=>{const n={draft:1,pending:2,completed:3};return n[e.status]-n[t.status]},render:e=>{const t={draft:{color:"blue",text:"Chưa bàn giao"},pending:{color:"orange",text:"Chờ xác nhận"},completed:{color:"green",text:"Đã bàn giao"},rejected:{color:"red",text:"Từ chối"}};return Et.jsx(W,{color:t[e]?.color,children:t[e]?.text})}},{title:"Thao tác",key:"action",width:100,className:"custom-header border-gray-200",render:(e,t)=>Et.jsxs(m,{children:[Et.jsx(k,{title:"Chi tiết",children:Et.jsx(p,{icon:Et.jsx(fe,{}),type:"primary",size:"small",className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>{n("manager"===r?.role?"/manager/handovers/"+t.id:"/dc/handover/"+t.id)},children:"Chi tiết"})}),"draft"===t.status&&t.FromUsers?.some(e=>e.id===r?.id)&&Et.jsx(Et.Fragment,{children:Et.jsx(k,{title:"Xoá",children:Et.jsx(p,{icon:Et.jsx(J,{}),type:"primary",size:"small",className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white",onClick:()=>N(t.id),children:"Xoá"})})})]})}],N=async e=>{$.confirm({title:"Xác nhận xoá",content:"Bạn chắc chắn muốn xoá biên bản này?",okText:"Xoá",okType:"danger",cancelText:"Huỷ",onOk:async()=>{try{await Mt.delete("https://192.168.1.7/api/shifts/handover/"+e),i.success("Xoá thành công"),j(h.status,h.dateRange,x.page,x.limit)}catch(t){i.error(t.response?.data?.message||"Lỗi khi xoá")}}})};return a?Et.jsx("div",{className:"flex justify-center items-center min-h-screen",children:Et.jsx(s,{size:"large",children:Et.jsx("div",{className:"p-8",children:Et.jsx("p",{className:"text-gray-600",children:"Đang tải danh sách biên bản bàn giao..."})})})}):Et.jsxs(f,{style:{borderRadius:12},children:[Et.jsx(X,{justify:"space-between",align:"middle",className:"mb-4",children:Et.jsx(G,{children:Et.jsx(ii,{level:4,style:{color:"#003c71",margin:0},children:"Danh sách biên bản bàn giao"})})}),Et.jsx(X,{gutter:[16,16],className:"mb-4",children:Et.jsx(G,{flex:"auto",children:Et.jsxs(m,{wrap:!0,children:[Et.jsx(t,{value:h.status,onChange:e=>{if(v.includes(e)){c(e=>({...e,status:!0}));try{g(t=>({...t,status:e})),y(e=>({...e,page:1,limit:15})),j(e,h.dateRange,1,15)}catch(t){i.error("Lỗi khi lọc theo trạng thái")}finally{c(e=>({...e,status:!1}))}}else i.error("Trạng thái không hợp lệ")},style:{width:250},loading:o.status,children:v.map(e=>Et.jsx(li,{value:e,children:b[e].text},e))}),Et.jsx(oi,{format:"DD/MM/YYYY",value:h.dateRange,onChange:e=>{if(e&&e[0]&&e[1]&&e[1].diff(e[0],"days")>30)i.warning("Chỉ được chọn tối đa 30 ngày");else{c(e=>({...e,date:!0}));try{g(t=>({...t,dateRange:e})),y(e=>({...e,page:1,limit:15})),j(h.status,e,1,15)}finally{c(e=>({...e,date:!1}))}}},loading:o.date,disabledDate:e=>e&&e>K().endOf("day"),placeholder:["Từ ngày","Đến ngày"]})]})})}),Et.jsx(H,{columns:S,dataSource:d,rowKey:"id",bordered:!0,loading:a,pagination:{current:x.page,pageSize:x.limit,total:x.total,onChange:(e,t)=>{y(n=>({...n,page:e,limit:t})),j(h.status,h.dateRange,e,t)},showSizeChanger:!0,pageSizeOptions:["15","20","50","100"],defaultPageSize:15,showTotal:e=>"Tổng số "+e}})]})},di=(e,t="dd/MM/yyyy")=>{if(!e)return"";try{const n="string"==typeof e?ht(e):e;return ut(n,t,{locale:kn})}catch(n){return""}},ui=e=>di(e,"HH:mm dd/MM/yyyy"),hi=new class{constructor(){this.deviceNamesCache=null,this.lastFetchTime=null,this.cacheExpiry=3e5}async fetchDeviceNames(){try{const e=await Mt.get("/api/devices/names");if(e.data.success)return this.deviceNamesCache=e.data.data,this.lastFetchTime=Date.now(),e.data.data;throw Error(e.data.message||"Không thể lấy danh sách tên device")}catch(e){throw e}}async getDeviceNames(){return this.deviceNamesCache&&this.lastFetchTime&&Date.now()-this.lastFetchTime<this.cacheExpiry?this.deviceNamesCache:await this.fetchDeviceNames()}async getDeviceName(e){const t=await this.getDeviceNames();return t[e]?.name||"Thiết bị "+e}async getDeviceInfo(e){return(await this.getDeviceNames())[e]||{id:e,name:"Thiết bị "+e}}async getDeviceList(){const e=await this.getDeviceNames();return Object.values(e).sort((e,t)=>e.id-t.id)}clearCache(){this.deviceNamesCache=null,this.lastFetchTime=null}isCacheValid(){return this.deviceNamesCache&&this.lastFetchTime&&Date.now()-this.lastFetchTime<this.cacheExpiry}},mi=()=>{const[t,n]=e.useState({}),[r,a]=e.useState(!0),[i,s]=e.useState(null),l=e.useCallback(async()=>{try{a(!0),s(null);const e=await hi.getDeviceNames();n(e)}catch(e){s(e.message)}finally{a(!1)}},[]),o=e.useCallback(async()=>{hi.clearCache(),await l()},[l]),c=e.useCallback(e=>t[e]?.name||"Thiết bị "+e,[t]),d=e.useCallback(e=>t[e]||{id:e,name:"Thiết bị "+e},[t]),u=e.useCallback(()=>Object.values(t).sort((e,t)=>e.id-t.id),[t]);return e.useEffect(()=>{l()},[l]),{deviceNames:t,loading:r,error:i,fetchDeviceNames:l,refreshDeviceNames:o,getDeviceName:c,getDeviceInfo:d,getDeviceList:u}},pi=async e=>{try{return(await Mt.post("/api/email/send",e)).data}catch(t){throw t.response?.data||t.message}},fi="Chưa xử lý",gi="Đang xử lý",xi="Đã xử lý",yi={[fi]:"Chưa xử lý",[gi]:"Đang xử lý",[xi]:"Đã xử lý"},vi={[fi]:"red",[gi]:"orange",[xi]:"green"},bi=[{value:fi,label:yi[fi]},{value:gi,label:yi[gi]},{value:xi,label:yi[xi]}],ji=[{value:"all",label:"Tất cả"},...bi],{Title:ki,Text:wi}=r,{TextArea:Ci}=o,Si=({image:t,deviceErrorId:n,style:r,onClick:a})=>{const[i,l]=e.useState(null),[o,c]=e.useState(!0),[d,u]=e.useState(!1);return e.useEffect(()=>{let e;return n&&t&&(async()=>{try{c(!0),u(!1);const r=localStorage.getItem("token");let a;a=t.includes("temp")?`https://192.168.1.7/uploads/device-errors/temp/${n}/${t}`:`https://192.168.1.7/api/devices/errors/${n}/images/${t}`;const i=await fetch(a,{headers:{Authorization:"Bearer "+r}});if(!i.ok)throw Error("Fetch image failed");const s=await i.blob();e=window.URL.createObjectURL(s),l(e)}catch(r){u(!0)}finally{c(!1)}})(),()=>{e&&window.URL.revokeObjectURL(e)}},[n,t]),o?Et.jsx("div",{style:{...r,display:"flex",alignItems:"center",justifyContent:"center",background:"#f0f0f0",borderRadius:"4px"},children:Et.jsx(s,{size:"small"})}):d?Et.jsxs("div",{style:{...r,display:"flex",alignItems:"center",justifyContent:"center",background:"#f0f0f0",borderRadius:"4px",color:"#999",fontSize:"12px"},children:[Et.jsx(_,{style:{marginRight:4}}),"Lỗi tải ảnh"]}):Et.jsx("img",{src:i,alt:"Hình ảnh lỗi thiết bị",style:r,onClick:e=>{a&&a(e)}})},Ni=({visible:n,onClose:r,error:s,history:l,onResolve:h,onRefresh:g,setSelectedError:x})=>{const[y]=a.useForm(),[v]=a.useForm(),[b]=a.useForm(),[j,w]=e.useState(!1),[C,S]=e.useState(!1),[N,T]=e.useState(!1),[I,_]=e.useState(!1),[D,E]=e.useState([]),[L,A]=e.useState([]),[z,F]=e.useState(!1),[P,M]=e.useState(""),[O,R]=e.useState(0),[B,V]=e.useState([]),{currentUser:U}=e.useContext(Wt);if(e.useEffect(()=>{if(n&&s){y.setFieldsValue({resolveStatus:s.resolveStatus,resolveNote:s.resolveNote,errorCause:s.errorCause,serialNumber:s.serialNumber,errorCode:s.errorCode,position:s.position||"",solution:C?"":s.solution});try{const e=s.images?JSON.parse(s.images):[],t=Array.isArray(e)?e.map((e,t)=>({uid:"-"+t,name:e.split("/").pop(),status:"done",isExisting:!0})):[];E(t)}catch(In){E([])}}n||(y&&y.resetFields(),v&&v.resetFields(),b&&b.resetFields(),S(!1),T(!1),_(!1))},[n,s,y,v,b,C]),e.useEffect(()=>{I&&b&&b.setFieldsValue({to:["CNTT@vietinbank.vn"],cc:["datacenter@vietinbank.vn"]})},[I,b]),!s)return null;const H=e=>"create"===e||"resolve"===e||"update"===e?"#003c71":"#8c8c8c",q=e=>{switch(e){case"errorCause":return"Nguyên nhân";case"solution":return"Quá trình xử lý";case"serialNumber":return"Số serial";case"errorCode":return"Mã lỗi";case"position":return"Vị trí";case"location":return"Địa điểm";case"resolveStatus":return"Trạng thái xử lý";case"resolveNote":return"Nội dung";case"resolvedAt":return"Thời điểm xử lý";default:return e}},Q=sr.groupBy(l,e=>e.changeId||e.id),ee=Object.values(Q).sort((e,t)=>new Date(t[0].createdAt)-new Date(e[0].createdAt)),te=(e,t,n)=>Et.jsx(Et.Fragment,{children:e.map(e=>e.field&&"all"!==e.field&&"solution"!==e.field&&"resolveStatus"!==e.field&&Et.jsx("div",{style:{marginBottom:4},children:"resolvedAt"===e.field||"resolveNote"===e.field?Et.jsxs(Et.Fragment,{children:[Et.jsx("b",{children:n(e.field)}),' : "',Et.jsx("span",{style:{color:"#389e0d"},children:"resolvedAt"===e.field?e.newValue?new Date(e.newValue).toLocaleString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}):"":e.newValue}),'"']}):void 0!==e.oldValue&&null!==e.oldValue&&""!==e.oldValue&&e.oldValue!==e.newValue?Et.jsxs(Et.Fragment,{children:["Đã thay đổi ",Et.jsx("b",{children:n(e.field)}),' từ "',Et.jsx("span",{style:{color:"#d46b08"},children:"resolvedAt"===e.field?e.oldValue?new Date(e.oldValue).toLocaleString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}):"":e.oldValue}),'" thành "',Et.jsx("span",{style:{color:"#389e0d"},children:"resolvedAt"===e.field?e.newValue?new Date(e.newValue).toLocaleString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}):"":e.newValue}),'"']}):Et.jsxs(Et.Fragment,{children:["Đã cập nhật ",Et.jsx("b",{children:n(e.field)}),' thành "',Et.jsx("span",{style:{color:"#389e0d"},children:"resolvedAt"===e.field?e.newValue?new Date(e.newValue).toLocaleString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}):"":e.newValue}),'"']})},e.field))}),ne=ee.map(e=>{const t=e[0],n=e.some(e=>"resolveStatus"===e.field&&"Đã xử lý"===e.newValue);let r="";r="create"===t.changeType?"Tạo mới":n?"Đã xử lý":"update"===t.changeType?"Cập nhật":"resolve"===t.changeType?"Đã xử lý":"Khác";const a="Đã xử lý"===r?"#003c71":H(t.changeType);return{color:H(t.changeType),children:Et.jsxs("div",{className:"p-2 border border-gray-200 rounded-md",children:[Et.jsxs("div",{className:"flex items-center justify-between gap-1",children:[Et.jsxs("div",{className:"flex items-center gap-1",children:[Et.jsx(c,{className:"text-blue-500"}),Et.jsx("span",{className:"font-medium text-sm",children:t.changedByUser?.username}),Et.jsx("span",{className:"text-gray-400",children:"•"}),Et.jsx("span",{className:"text-gray-400 text-sm",children:new Date(t.createdAt).toLocaleString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})})]}),Et.jsx(W,{color:a,style:{fontWeight:400,textTransform:"capitalize"},children:r})]}),Et.jsx("div",{className:"rounded-lg p-1",children:te(e,0,q)})]})}}),se=async e=>{try{if(w(!0),L.length>0)try{const e=localStorage.getItem("token");for(const n of L)try{await it.delete(`https://192.168.1.7/api/devices/errors/${s.id}/images/${encodeURIComponent(n)}`,{headers:{Authorization:"Bearer "+e}})}catch(t){}}catch(n){i.warning("Có lỗi khi xóa ảnh, nhưng thông tin đã được cập nhật")}const l=D.filter(e=>e.filename&&"done"===e.status).map(e=>e.filename);if(l.length>0)try{const e=localStorage.getItem("token");await it.post(`/api/devices/errors/${s.id}/move-temp-images`,{tempImageNames:l},{headers:{Authorization:"Bearer "+e}})}catch(r){i.warning("Có lỗi khi lưu ảnh, nhưng thông tin đã được cập nhật")}const o={...e,solution:e.solution&&""!==e.solution.trim()?e.solution:s.solution,position:e.position||s.position};if(await h(o),i.success("Đã cập nhật"),S(!1),T(!1),E([]),A([]),g&&await g(),x&&s?.id)try{const e=localStorage.getItem("token"),t=await fetch("/api/devices/errors/"+s.id,{headers:{Authorization:"Bearer "+e}});if(t.ok){const e=await t.json();x(e)}}catch(a){}}catch(n){i.error("Không thể cập nhật lỗi")}finally{w(!1)}},le=async e=>{try{e.url||e.preview||e.originFileObj&&(e.preview=await oe(e.originFileObj)),M(e.name||e.url?.substring(e.url.lastIndexOf("/")+1)||"Hình ảnh"),F(!0)}catch(t){i.error("Không thể xem trước hình ảnh")}},oe=e=>new Promise((t,n)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=()=>t(r.result),r.onerror=e=>n(e)});return Et.jsxs(a.Provider,{children:[Et.jsx($,{title:Et.jsxs("div",{className:"flex items-center gap-2",children:[Et.jsx(fe,{}),Et.jsx("span",{children:"Chi tiết lỗi thiết bị"})]}),open:n,onCancel:r,width:1400,centered:!0,footer:null,styles:{body:{maxHeight:"calc(100vh - 200px)"}},children:Et.jsxs("div",{className:"flex gap-4",children:[Et.jsx("div",{className:"w-2/3 rounded-lg",children:C?(()=>{try{return Et.jsxs(a,{form:y,onFinish:se,layout:"vertical",children:[Et.jsxs("div",{style:{maxHeight:"calc(600px - 60px)",overflowY:"auto",padding:"10px"},className:"border border-gray-200 z-10 p-1 rounded-lg shadow-sm ma",children:[Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:6,children:Et.jsx(a.Item,{name:"subDeviceName",label:"Tên thiết bị",initialValue:s.subDeviceName,children:Et.jsx(o,{readOnly:!0})})}),Et.jsx(G,{span:6,children:Et.jsx(a.Item,{name:"position",label:"Vị trí",initialValue:s.position,children:Et.jsx(o,{placeholder:"Ví dụ: Rack A1, Slot 2"})})}),Et.jsx(G,{span:6,children:Et.jsx(a.Item,{name:"serialNumber",label:"Serial",initialValue:s.serialNumber,rules:[{required:!0,message:"Nhập serial"}],children:Et.jsx(Ci,{autoSize:{minRows:1,maxRows:5},style:{resize:"none"}})})}),Et.jsx(G,{span:6,children:Et.jsx(a.Item,{name:"errorCode",label:"Mã lỗi",initialValue:s.errorCode,rules:[{required:!0,message:"Nhập mã lỗi"}],children:Et.jsx(Ci,{autoSize:{minRows:1,maxRows:5},style:{resize:"none"}})})})]}),Et.jsx(a.Item,{name:"errorCause",label:"Nguyên nhân",initialValue:s.errorCause,children:Et.jsx(Ci,{autoSize:{minRows:1,maxRows:5},style:{resize:"none"}})}),Et.jsx(a.Item,{label:"Quá trình xử lý",children:Et.jsx("div",{className:"bg-gray-50 p-1 rounded border border-gray-200",style:{maxHeight:200,overflowY:"auto"},children:(()=>{const e=l.filter(e=>"solution"===e.field).sort((e,t)=>new Date(e.createdAt)-new Date(t.createdAt));let t="",n=s.createdAt,r="";const a=l.find(e=>"create"===e.changeType);a&&(a.changedByUser?.fullname||a.changedByUser?.username)?r=a.changedByUser.fullname||a.changedByUser.username:s.creator?.fullname?r=s.creator.fullname:s.createdByUser?.fullname?r=s.createdByUser.fullname:s.createdByUser?.username?r=s.createdByUser.username:s.createdBy&&(r="ID: "+s.createdBy);const i=l.find(e=>"create"===e.changeType&&"solution"===e.field);return i?(t=i.newValue||"",n=i.createdAt):e.length>0&&e[0].oldValue?(t=e[0].oldValue,n=e[0].createdAt):s.solution&&(t=s.solution),Et.jsxs(Et.Fragment,{children:[t&&Et.jsxs("div",{style:{display:"flex",flexDirection:"column",marginBottom:4},children:[Et.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,marginBottom:4},children:[Et.jsx(c,{style:{color:"#1677ff"}}),Et.jsx("span",{style:{fontWeight:500},children:r&&Et.jsxs(Et.Fragment,{children:[" ",r]})}),Et.jsx("span",{style:{color:"#888",fontSize:12},children:n&&Et.jsxs(Et.Fragment,{children:[" ",ut(new Date(n),"HH:mm dd/MM/yyyy")]})}),Et.jsx("span",{style:{color:"#888",fontSize:12},children:" đã tạo:"})]}),Et.jsx("div",{style:{borderRadius:2,padding:2},children:t})]}),e.map((e,t)=>Et.jsxs("div",{style:{display:"flex",flexDirection:"column",marginBottom:4},children:[Et.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,marginBottom:4},children:[Et.jsx(c,{style:{color:"#1677ff"}}),Et.jsxs("span",{style:{fontWeight:500},children:[e.changedByUser?.fullname||e.changedByUser?.username," -"]}),Et.jsx("span",{style:{color:"#888",fontSize:12},children:ut(new Date(n),"HH:mm dd/MM/yyyy")}),Et.jsx("span",{style:{color:"#888",fontSize:12},children:" :"})]}),Et.jsx("div",{style:{borderRadius:2,padding:2},children:e.newValue})]},t))]})})()})}),Et.jsx(a.Item,{name:"solution",label:"Quá trình xử lý",children:Et.jsx(Ci,{autoSize:{minRows:1,maxRows:5},style:{resize:"none"}})}),Et.jsxs(a.Item,{label:"Hình ảnh lỗi",children:[Et.jsxs("div",{className:"flex items-center gap-1",children:[Et.jsx("input",{type:"file",multiple:!0,accept:"image/*",style:{display:"none"},id:"multiple-image-upload-edit",onChange:async e=>{const t=Array.from(e.target.files);if(0!==t.length)if(D.length+t.length>10)i.error("Tối đa 10 ảnh!");else{for(const e of t){if(!e.type.startsWith("image/"))return void i.error(`File ${e.name} không phải hình ảnh!`);if(e.size/1024/1024>=5)return void i.error(`File ${e.name} quá lớn (tối đa 5MB)!`)}1===t.length?await(async e=>{try{const t=new FormData;t.append("images",e.originFileObj||e);const n=localStorage.getItem("token");if(!n)return i.error("Phiên làm việc hết hạn. Vui lòng đăng nhập lại."),!1;const r=await it.post(`/api/devices/errors/${s.id}/temp/images`,t,{headers:{Authorization:"Bearer "+n,"Content-Type":"multipart/form-data"},timeout:3e4});if(r.data.uploadedFiles&&r.data.uploadedFiles.length>0){i.success(`Upload ${r.data.uploadedFiles.length} hình ảnh thành công`);const e=r.data.uploadedFiles.map(e=>`/uploads/device-errors/temp/${s.id}/${e.filename}`),t=await Promise.all(e.map(async e=>{try{const t=e.split("/").pop(),n=`https://192.168.1.7/api/devices/errors/${s.id}/temp/images/${t}`,r=localStorage.getItem("token");if(!r)return n;const a=await it.get(n,{headers:{Authorization:"Bearer "+r},responseType:"blob"});return window.URL.createObjectURL(a.data)}catch(t){const n=e.split("/").pop();return`https://192.168.1.7/api/devices/errors/${t.id}/temp/images/${n}`}})),n=e.map((e,n)=>({uid:`temp-${Date.now()}-${Math.random().toString(36).substring(2,15)}-${n}`,name:e.split("/").pop(),status:"done",url:t[n],thumbUrl:t[n],filename:e.split("/").pop()}));return E(e=>[...e,...n]),!0}return i.warning("Không có hình ảnh nào được upload"),!1}catch(t){return 401===t.response?.status?i.error("Phiên làm việc hết hạn. Vui lòng đăng nhập lại."):"ECONNABORTED"===t.code?i.error("Upload hình ảnh bị timeout. Vui lòng thử lại."):t.response?.data?.message?i.error(t.response.data.message):i.error("Upload hình ảnh thất bại. Vui lòng thử lại."),!1}})(t[0]):await(async e=>{try{const t=localStorage.getItem("token");if(!t)return i.error("Phiên làm việc hết hạn. Vui lòng đăng nhập lại."),!1;const n=new FormData;e.forEach(e=>{n.append("images",e.originFileObj||e)});const r=await it.post(`/api/devices/errors/${s.id}/temp/images`,n,{headers:{Authorization:"Bearer "+t,"Content-Type":"multipart/form-data"},timeout:3e4});if(r.data.uploadedFiles&&r.data.uploadedFiles.length>0){i.success(`Upload thành công ${r.data.uploadedFiles.length} hình ảnh`);const e=r.data.uploadedFiles.map(e=>`/uploads/device-errors/temp/${s.id}/${e.filename}`),t=await Promise.all(e.map(async e=>{try{const t=e.split("/").pop(),n=`https://192.168.1.7/api/devices/errors/${s.id}/temp/images/${t}`,r=localStorage.getItem("token");if(!r)return n;const a=await it.get(n,{headers:{Authorization:"Bearer "+r},responseType:"blob"});return window.URL.createObjectURL(a.data)}catch(t){const n=e.split("/").pop();return`https://192.168.1.7/api/devices/errors/${t.id}/temp/images/${n}`}})),n=e.map((e,n)=>({uid:`temp-${Date.now()}-${Math.random().toString(36).substring(2,15)}-${n}`,name:e.split("/").pop(),status:"done",url:t[n],thumbUrl:t[n],filename:e.split("/").pop()}));return E(e=>[...e,...n]),!0}return i.warning("Không có hình ảnh nào được upload"),!1}catch(t){return 401===t.response?.status?i.error("Phiên làm việc hết hạn. Vui lòng đăng nhập lại."):"ECONNABORTED"===t.code?i.error("Upload hình ảnh bị timeout. Vui lòng thử lại."):t.response?.data?.message?i.error(t.response.data.message):i.error("Upload hình ảnh thất bại. Vui lòng thử lại."),!1}})(t),e.target.value=""}}}),Et.jsxs(p,{type:"primary",className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white whitespace-nowrap",onClick:()=>document.getElementById("multiple-image-upload-edit").click(),disabled:D.length>=10,children:[Et.jsx(Z,{}),Et.jsx("div",{className:"ml-1",children:"Upload ảnh"}),Et.jsxs("div",{className:"text-white",children:["(",D.length,"/10 ảnh)"]})]}),Et.jsx(k,{title:Et.jsxs(Et.Fragment,{children:["Upload tối đa 10 ảnh. Dung lượng tối đa mỗi ảnh 5MB.",Et.jsx("br",{}),Et.jsx("br",{}),"Hỗ trợ các định dạng: .doc, .docx, .pdf, .xls, .xlsx, .jpg, .jpeg, .png, .msg."]}),placement:"right",children:Et.jsx(Y,{style:{color:"#1677ff",cursor:"pointer"}})})]}),Et.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:D.map((e,t)=>Et.jsxs("div",{style:{position:"relative",width:104,height:104},children:[e.url&&e.url.startsWith("blob:")?Et.jsx("img",{src:e.url,alt:e.name||"Ảnh "+(t+1),style:{width:"100%",height:"100%",objectFit:"cover",border:"1px solid #d9d9d9",borderRadius:6,cursor:"pointer"},onClick:()=>le(e)}):e.isExisting?Et.jsx(Si,{image:e.name,deviceErrorId:s.id,style:{width:"100%",height:"100%",objectFit:"cover",border:"1px solid #d9d9d9",borderRadius:6,cursor:"pointer"},onClick:()=>le(e)}):Et.jsx("img",{src:e.url||e.thumbUrl,alt:e.name||"Ảnh "+(t+1),style:{width:"100%",height:"100%",objectFit:"cover",border:"1px solid #d9d9d9",borderRadius:6,cursor:"pointer"},onClick:()=>le(e)}),Et.jsx(p,{type:"text",size:"small",danger:!0,icon:Et.jsx(J,{}),style:{position:"absolute",top:4,right:4,background:"rgba(255, 255, 255, 0.9)",border:"none",borderRadius:"50%",width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>(async e=>{try{const t=localStorage.getItem("token");if(!t)return void i.error("Phiên làm việc hết hạn. Vui lòng đăng nhập lại.");let n,r="";if(r=e.filename?e.filename:e.url&&e.url.includes("/api/devices/errors/")?e.url.split("/").pop():e.url&&e.url.startsWith("blob:")?e.name:e.name||"unknown",!(e.filename||e.url&&e.url.includes("temp")||e.url&&e.url.startsWith("blob:")))return A(e=>[...e,r]),E(t=>t.filter(t=>t.uid!==e.uid)),void i.success("Đã đánh dấu xóa hình ảnh");n=`/api/devices/errors/${s.id}/temp/images/${encodeURIComponent(r)}`,200===(await it.delete("https://192.168.1.7"+n,{headers:{Authorization:"Bearer "+t}})).status?(i.success("Xóa hình ảnh thành công"),E(t=>t.filter(t=>t.uid!==e.uid))):i.error("Xóa hình ảnh thất bại")}catch(t){401===t.response?.status?i.error("Phiên làm việc hết hạn. Vui lòng đăng nhập lại."):t.response?.data?.message?i.error(t.response.data.message):i.error("Xóa hình ảnh thất bại")}})(e)})]},e.uid||t))})]})]}),Et.jsx("br",{}),Et.jsx("div",{className:"flex justify-end items-center mb-3 border border-gray-200 z-10 p-2 rounded-lg shadow-sm ma",children:Et.jsxs(m,{children:[Et.jsx(p,{type:"primary",htmlType:"submit",loading:j,style:{backgroundColor:"#003c71",borderColor:"#003c71",color:"white",minWidth:"100px"},children:"Cập nhật"}),Et.jsx(p,{onClick:async()=>{const e=D.filter(e=>e.filename);if(e.length>0)try{const n=localStorage.getItem("token");if(n){for(const r of e)try{await it.delete(`/api/devices/errors/${s.id}/temp/images/${encodeURIComponent(r.filename)}`,{headers:{Authorization:"Bearer "+n}})}catch(t){}i.success("Đã xóa ảnh tạm thời")}}catch(t){}S(!1),E([]),A([])},style:{minWidth:"100px"},children:"Hủy"})]})})]})}catch(e){return Et.jsx("div",{children:"Error rendering form"})}})():Et.jsxs("div",{children:[Et.jsxs("div",{style:{maxHeight:"calc(600px - 60px)",overflowY:"auto",padding:"10px"},className:"border border-gray-200 z-10 p-2 rounded-lg shadow-sm ma",children:[Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:6,children:Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Thiết bị"}),Et.jsx("div",{className:"whitespace-pre-line break-words",children:s.subDeviceName})]})}),Et.jsx(G,{span:6,children:Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Vị trí"}),Et.jsx("div",{className:"whitespace-pre-line break-words",children:s.position||"Chưa có"})]})}),Et.jsx(G,{span:6,children:Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Số serial"}),Et.jsx("div",{className:"whitespace-pre-line break-words",children:s.serialNumber})]})}),Et.jsx(G,{span:6,children:Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Mã lỗi"}),Et.jsx("div",{className:"whitespace-pre-line break-words",children:s.errorCode})]})})]}),Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:6,children:Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Địa điểm"}),Et.jsx(W,{className:"whitespace-pre-line break-words",color:"blue",children:s.location||"Chưa có"})]})}),Et.jsx(G,{span:6,children:Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Trạng thái"}),Et.jsx(W,{color:vi[s.resolveStatus]||"default",children:s.resolveStatus})]})})]}),Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Nguyên nhân"}),Et.jsx("div",{className:"bg-gray-50 p-2 rounded whitespace-pre-line break-words",children:s.errorCause})]}),s.images&&Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"text-gray-500 mb-2",children:"Hình ảnh lỗi"}),Et.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{try{const e=JSON.parse(s.images);return Array.isArray(e)?e.map((t,n)=>{const r=t.split("/").pop();return Et.jsx("div",{className:"relative",children:Et.jsx(Si,{image:r,deviceErrorId:s.id,style:{width:120,height:90,objectFit:"cover",borderRadius:"4px",cursor:"pointer"},onClick:()=>{V(e),R(n),M(r),F(!0)}})},n)}):null}catch(In){return null}})()})]}),(s.resolveStatus,s.resolveStatus===xi&&Et.jsxs("div",{className:"mb-1",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Nội dung"}),Et.jsx("div",{className:"bg-gray-50 p-2 rounded whitespace-pre-line break-words",children:s.resolveNote})]})),Et.jsxs("div",{className:"mb-1",children:[Et.jsx("div",{className:"text-gray-500 mb-1",children:"Quá trình xử lý"}),Et.jsx("div",{className:"bg-gray-50 p-2 rounded border border-gray-200",style:{maxHeight:200,overflowY:"auto"},children:(()=>{const e=l.filter(e=>"solution"===e.field).sort((e,t)=>new Date(e.createdAt)-new Date(t.createdAt));let t="",n=s.createdAt,r="";const a=l.find(e=>"create"===e.changeType);a&&(a.changedByUser?.fullname||a.changedByUser?.username)?r=a.changedByUser.fullname||a.changedByUser.username:s.creator?.fullname?r=s.creator.fullname:s.createdByUser?.fullname?r=s.createdByUser.fullname:s.createdByUser?.username?r=s.createdByUser.username:s.createdBy&&(r="ID: "+s.createdBy);const i=l.find(e=>"create"===e.changeType&&"solution"===e.field);return i?(t=i.newValue||"",n=i.createdAt):e.length>0&&e[0].oldValue?(t=e[0].oldValue,n=e[0].createdAt):s.solution&&(t=s.solution),Et.jsxs(Et.Fragment,{children:[t?Et.jsxs("div",{style:{display:"flex",flexDirection:"column",marginBottom:4},children:[Et.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,marginBottom:4},children:[Et.jsx(c,{style:{color:"#1677ff"}}),Et.jsx("span",{style:{fontWeight:500},children:r&&Et.jsxs(Et.Fragment,{children:[" ",r]})}),Et.jsx("span",{style:{color:"#888",fontSize:12},children:n&&Et.jsxs(Et.Fragment,{children:[" ",ut(new Date(n),"HH:mm dd/MM/yyyy")]})}),Et.jsx("span",{style:{color:"#888",fontSize:12},children:" đã tạo:"})]}),Et.jsx("div",{style:{borderRadius:2,padding:2},children:t})]}):Et.jsx("div",{style:{color:"#888"},children:"Chưa có quá trình xử lý"}),e.map((e,t)=>Et.jsxs("div",{style:{display:"flex",flexDirection:"column",marginBottom:4},children:[Et.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5,marginBottom:4},children:[Et.jsx(c,{style:{color:"#1677ff"}}),Et.jsxs("span",{style:{fontWeight:500},children:[e.changedByUser?.fullname||e.changedByUser?.username," -"]}),Et.jsx("span",{style:{color:"#888",fontSize:12},children:ut(new Date(n),"HH:mm dd/MM/yyyy")}),Et.jsx("span",{style:{color:"#888",fontSize:12},children:" :"})]}),Et.jsx("div",{style:{borderRadius:2,padding:2},children:e.newValue})]},t))]})})()})]})]}),Et.jsx("br",{}),Et.jsxs("div",{className:"flex justify-between items-center mt-4 border border-gray-200 z-10 p-2 rounded-lg shadow-sm",children:[Et.jsxs("div",{className:"flex gap-2",children:[s.resolveStatus===fi&&Et.jsxs(Et.Fragment,{children:[Et.jsx(p,{type:"primary",icon:Et.jsx(ue,{}),onClick:async()=>{try{w(!0);const e={...s,resolveStatus:gi,resolveNote:"Bắt đầu xử lý lỗi",solution:s.solution,errorCause:s.errorCause,position:s.position};if(await h(e),i.success("Đã chuyển sang trạng thái đang xử lý"),g&&await g(),x&&s?.id)try{const e=localStorage.getItem("token"),t=await fetch("/api/devices/errors/"+s.id,{headers:{Authorization:"Bearer "+e}});if(t.ok){const e=await t.json();x(e)}}catch{}}catch(e){i.error("Không thể chuyển trạng thái")}finally{w(!1)}},style:{backgroundColor:"#fa8c16",borderColor:"#fa8c16"},children:"Bắt đầu xử lý"}),Et.jsx(p,{type:"primary",icon:Et.jsx(re,{}),onClick:()=>T(!0),style:{backgroundColor:"#003c71",borderColor:"#003c71"},children:"Xử lý xong"})]}),s.resolveStatus===gi&&Et.jsx(Et.Fragment,{children:Et.jsx(p,{type:"primary",icon:Et.jsx(re,{}),onClick:()=>T(!0),style:{backgroundColor:"#003c71",borderColor:"#003c71"},children:"Xử lý xong"})}),Et.jsx(p,{type:"primary",icon:Et.jsx(d,{}),onClick:()=>_(!0),style:{backgroundColor:"#1890ff",borderColor:"#1890ff"},children:"Gửi Email"})]}),Et.jsxs("div",{className:"flex gap-2",children:[Et.jsx(p,{type:"primary",icon:Et.jsx(ae,{}),onClick:()=>S(!0),style:{backgroundColor:"#003c71",borderColor:"#003c71"},children:"Cập nhật"}),Et.jsx(p,{onClick:r,children:"Đóng"})]})]})]})}),Et.jsx("div",{className:"w-1/3 rounded-lg",children:Et.jsxs(f,{style:{minHeight:400,maxHeight:600,height:"100%"},children:[Et.jsxs(ki,{level:4,style:{color:"#003c71",margin:"0px"},children:[Et.jsx(ge,{})," Lịch sử thay đổi"]}),Et.jsx(ie,{items:ne.length>0?ne:[{color:"gray",children:Et.jsx("div",{children:"Không có lịch sử thay đổi"})}],style:{maxHeight:"calc(600px - 60px)",overflowY:"auto",marginTop:"10px",padding:"10px"}})]})})]})}),Et.jsx($,{title:Et.jsxs("div",{className:"flex items-center gap-2",children:[Et.jsx(re,{}),Et.jsx("span",{children:"Xử lý lỗi"})]}),open:N,onCancel:()=>T(!1),footer:null,width:600,centered:!0,children:Et.jsxs(a,{form:v,onFinish:async e=>{try{w(!0);const t={...s,resolveStatus:e.resolveStatus,resolvedAt:e.resolvedAt.toISOString(),resolveNote:e.resolveNote,solution:e.solution||s.solution,errorCause:e.errorCause||s.errorCause,position:e.position||s.position};await h(t);const n=yi[e.resolveStatus];if(i.success("Đã cập nhật trạng thái thành: "+n),T(!1),S(!1),g&&await g(),x&&s?.id)try{const e=localStorage.getItem("token"),t=await fetch("/api/devices/errors/"+s.id,{headers:{Authorization:"Bearer "+e}});if(t.ok){const e=await t.json();x(e)}}catch{}}catch(t){i.error("Không thể xử lý lỗi")}finally{w(!1)}},layout:"vertical",initialValues:{resolvedAt:K()},children:[Et.jsx(a.Item,{name:"resolvedAt",label:"Thời điểm xử lý",rules:[{required:!0,message:"Vui lòng chọn thời điểm xử lý"}],children:Et.jsx(u,{showTime:!0,format:"DD/MM/YYYY HH:mm",style:{width:"100%"}})}),Et.jsx(a.Item,{name:"resolveStatus",label:"Trạng thái xử lý",rules:[{required:!0,message:"Vui lòng chọn trạng thái xử lý"}],initialValue:xi,children:Et.jsx(t,{placeholder:"trạng thái xử lý",options:[{value:xi,label:yi[xi]}]})}),Et.jsx(a.Item,{name:"resolveNote",label:"Ghi chú xử lý",rules:[{required:!0,message:"Vui lòng nhập ghi chú xử lý"}],children:Et.jsx(Ci,{rows:1,autoSize:{minRows:1,maxRows:5}})}),Et.jsx(a.Item,{children:Et.jsxs(m,{children:[Et.jsx(p,{type:"primary",htmlType:"submit",loading:j,style:{backgroundColor:"#003c71",borderColor:"#003c71",color:"white",minWidth:"100px"},children:"Xác nhận"}),Et.jsx(p,{onClick:()=>T(!1),style:{minWidth:"100px"},children:"Hủy"})]})})]})}),Et.jsx($,{title:Et.jsxs("div",{className:"flex items-center gap-2",children:[Et.jsx(d,{}),Et.jsx("span",{children:"Gửi email thông báo"})]}),open:I,onCancel:()=>_(!1),footer:null,width:800,centered:!0,children:Et.jsx(a,{form:b,onFinish:async e=>{try{w(!0);let r=[];if(s.images)try{const e=JSON.parse(s.images);if(Array.isArray(e)&&e.length>0){const n=localStorage.getItem("token");if(n)for(let a=0;a<e.length;a++)try{const t=e[a].split("/").pop(),i=`https://192.168.1.7/api/devices/errors/${s.id}/images/${t}`,l=await it.get(i,{headers:{Authorization:"Bearer "+n},responseType:"blob"}),o=await l.data.arrayBuffer(),c=btoa(new Uint8Array(o).reduce((e,t)=>e+String.fromCharCode(t),"")),d=t.split("_")[0],u=t.substring(t.lastIndexOf("."));r.push({filename:`${s.subDeviceName}_${d}${u}`,content:c,contentType:l.headers["content-type"]||"image/jpeg"})}catch(t){}}}catch(n){}const a={to:e.to,cc:e.cc,subject:"Thông báo lỗi thiết bị : "+s.subDeviceName,attachments:r,html:`\n          <div style="font-family: Arial, sans-serif; width: 100%;">\n            ${e.customContent?`\n            <div >\n              ${e.customContent.replace(/\n/g,"<br>")}\n            </div>\n            `:""}\n            <h2 style="color: #003c71; margin-bottom: 20px;">Thông tin lỗi thiết bị</h2>\n            <table style="width: 100%; border-collapse: collapse; border: 1px solid #e5e7eb;">\n              <tbody>\n                <tr>\n                  <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; width: 30%; border: 1px solid #e5e7eb;">Tên thiết bị</td>\n                  <td style="padding: 12px; border: 1px solid #e5e7eb;">${s.subDeviceName}</td>\n                </tr>\n                <tr>\n                  <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; border: 1px solid #e5e7eb;">Vị trí</td>\n                  <td style="padding: 12px; border: 1px solid #e5e7eb;">${s.position||"Chưa có"}</td>\n                </tr>\n                <tr>\n                  <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; border: 1px solid #e5e7eb;">Số serial</td>\n                  <td style="padding: 12px; border: 1px solid #e5e7eb;">${s.serialNumber}</td>\n                </tr>\n                <tr>\n                  <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; border: 1px solid #e5e7eb;">Mã lỗi</td>\n                  <td style="padding: 12px; border: 1px solid #e5e7eb;">${s.errorCode}</td>\n                </tr>\n                <tr>\n                  <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; border: 1px solid #e5e7eb;">Thời điểm ghi nhận</td>\n                  <td style="padding: 12px; border: 1px solid #e5e7eb;">${new Date(s.createdAt).toLocaleString("vi-VN")}</td>\n                </tr>\n                ${s.resolvedAt?`\n                <tr>\n                  <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; border: 1px solid #e5e7eb;">Thời điểm xử lý</td>\n                  <td style="padding: 12px; border: 1px solid #e5e7eb;">${new Date(s.resolvedAt).toLocaleString("vi-VN")}</td>\n                </tr>\n                `:""}\n                ${s.resolveNote?`\n                <tr>\n                  <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; border: 1px solid #e5e7eb;">Ghi chú xử lý</td>\n                  <td style="padding: 12px; border: 1px solid #e5e7eb; white-space: pre-line;">${s.resolveNote}</td>\n                </tr>\n                `:""}\n                <tr>\n                <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; border: 1px solid #e5e7eb;">Trạng thái</td>\n                <td style="padding: 12px; border: 1px solid #e5e7eb;">\n                  <span style="display: inline-block; padding: 4px 8px; border-radius: 4px; background-color: ${"Đã xử lý"===s.resolveStatus?"#52c41a":"#ff4d4f"}; color: white;">\n                    ${s.resolveStatus}\n                  </span>\n                </td>\n              </tr>\n                              <tr >\n              <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; border: 1px solid #e5e7eb;">Liên hệ</td>\n              <td style="padding: 12px; border: 1px solid #e5e7eb; white-space: pre-line;">${U?.username}@vietinbank.vn</td>\n                    </tr>\n              </tbody>\n            </table>\n            ${r.length>0?`\n            <div style="margin-top: 20px;">\n              <h3 style="color: #003c71; margin-bottom: 10px;">Hình ảnh lỗi (${r.length} ảnh):</h3>\n              <p style="color: #666; font-size: 14px;">Các hình ảnh đã được đính kèm trong email.</p>\n            </div>\n            `:""}\n          </div>\n        `,text:e.customContent?`\n${e.customContent}\n\n----------------------------------------\n\nThông tin lỗi thiết bị\n=====================\nThiết bị: ${s.subDeviceName}\nVị trí: ${s.position||"Chưa có"}\nSố serial: ${s.serialNumber}\nMã lỗi: ${s.errorCode}\nTrạng thái: ${s.resolveStatus}\nQuá trình xử lý: ${s.solution||"Chưa có"}\nThời điểm ghi nhận: ${new Date(s.createdAt).toLocaleString("vi-VN")}\n${s.resolvedAt?"Thời điểm xử lý: "+new Date(s.resolvedAt).toLocaleString("vi-VN"):""}\n${s.resolveNote?"Ghi chú xử lý: "+s.resolveNote:""}\n${r.length>0?`\nHình ảnh: ${r.length} ảnh đính kèm`:""}\n        `:""};await pi(a),i.success("Gửi email thành công"+(r.length>0?` với ${r.length} ảnh đính kèm`:"")),_(!1),b.resetFields()}catch(r){i.error("Không thể gửi email: "+r.message)}finally{w(!1)}},layout:"vertical",initialValues:{to:["CNTT@vietinbank.vn"],cc:["datacenter@vietinbank.vn"]},children:Et.jsxs(X,{gutter:16,children:[Et.jsxs(G,{span:12,children:[Et.jsx(a.Item,{name:"to",label:"Người nhận",rules:[{required:!0,message:"Vui lòng nhập email người nhận"}],children:Et.jsx(t,{mode:"tags",placeholder:"Nhập email người nhận",style:{width:"100%"},tokenSeparators:[",",";"],onInputKeyDown:e=>{"Tab"===e.key&&e.stopPropagation()}})}),Et.jsx(a.Item,{name:"cc",label:"CC",children:Et.jsx(t,{mode:"tags",placeholder:"Nhập email CC",style:{width:"100%"},tokenSeparators:[",",";",""],onInputKeyDown:e=>{"Tab"===e.key&&e.stopPropagation()},initialValues:{to:["datacenter@vietinbank.vn"]}})}),Et.jsx(a.Item,{name:"customContent",label:"Nội dung ",tooltip:"Nội dung này sẽ được hiển thị ở đầu email",children:Et.jsx(Ci,{rows:4,placeholder:"Nhập nội dung  (tùy chọn)",style:{resize:"none"}})}),Et.jsx(a.Item,{children:Et.jsxs(m,{children:[Et.jsx(p,{type:"primary",htmlType:"submit",loading:j,style:{backgroundColor:"#003c71",borderColor:"#003c71",color:"white",minWidth:"100px"},children:"Gửi"}),Et.jsx(p,{onClick:()=>_(!1),style:{minWidth:"100px"},children:"Hủy"})]})})]}),Et.jsx(G,{span:12,children:Et.jsxs("div",{className:"bg-gray-50 p-4 rounded border border-gray-200",style:{maxHeight:"400px",overflowY:"auto"},children:[Et.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Nội dung email: "}),Et.jsx("table",{className:"w-full border-collapse",children:Et.jsxs("tbody",{children:[Et.jsxs("tr",{className:"border-b border-gray-200",children:[Et.jsx("td",{className:"py-2 px-3 font-medium bg-gray-100 w-1/3",children:"Tiêu đề:"}),Et.jsx("td",{className:"py-2 px-3",children:"Thông báo lỗi thiết bị: "+s.subDeviceName})]}),Et.jsxs("tr",{className:"border-b border-gray-200",children:[Et.jsx("td",{className:"py-2 px-3 font-medium bg-gray-100",children:"Thiết bị:"}),Et.jsx("td",{className:"py-2 px-3",children:s.subDeviceName})]}),Et.jsxs("tr",{className:"border-b border-gray-200",children:[Et.jsx("td",{className:"py-2 px-3 font-medium bg-gray-100",children:"Vị trí:"}),Et.jsx("td",{className:"py-2 px-3",children:s.position||"Chưa có"})]}),Et.jsxs("tr",{className:"border-b border-gray-200",children:[Et.jsx("td",{className:"py-2 px-3 font-medium bg-gray-100",children:"Số serial:"}),Et.jsx("td",{className:"py-2 px-3",children:s.serialNumber})]}),Et.jsxs("tr",{className:"border-b border-gray-200",children:[Et.jsx("td",{className:"py-2 px-3 font-medium bg-gray-100",children:"Mã lỗi:"}),Et.jsx("td",{className:"py-2 px-3",children:s.errorCode})]}),Et.jsxs("tr",{className:"border-b border-gray-200",children:[Et.jsx("td",{className:"py-2 px-3 font-medium bg-gray-100",children:"Thời điểm ghi nhận:"}),Et.jsx("td",{className:"py-2 px-3",children:new Date(s.createdAt).toLocaleString("vi-VN")})]}),s.resolvedAt&&Et.jsxs("tr",{className:"border-b border-gray-200",children:[Et.jsx("td",{className:"py-2 px-3 font-medium bg-gray-100",children:"Thời điểm xử lý:"}),Et.jsx("td",{className:"py-2 px-3",children:new Date(s.resolvedAt).toLocaleString("vi-VN")})]}),s.resolveNote&&Et.jsxs("tr",{className:"border-b border-gray-200",children:[Et.jsx("td",{className:"py-2 px-3 font-medium bg-gray-100",children:"Ghi chú xử lý:"}),Et.jsx("td",{className:"py-2 px-3 whitespace-pre-line",children:s.resolveNote})]}),Et.jsxs("tr",{className:"border-b border-gray-200",children:[Et.jsx("td",{className:"py-2 px-3 font-medium bg-gray-100",children:"Trạng thái:"}),Et.jsx("td",{className:"py-2 px-3",children:Et.jsx(W,{color:vi[s.resolveStatus]||"default",children:s.resolveStatus})})]}),Et.jsxs("tr",{className:"border-b border-gray-200",children:[Et.jsx("td",{className:"py-2 px-3 font-medium bg-gray-100",children:"Liên hệ:"}),Et.jsxs("td",{className:"py-2 px-3",children:[U?.username,"@vietinbank.vn"]})]})]})})]})})]})})}),Et.jsx($,{open:z,title:P,footer:null,onCancel:()=>F(!1),width:"80%",centered:!0,styles:{body:{textAlign:"center",padding:0}},children:Et.jsxs("div",{style:{position:"relative"},children:[B.length>0&&Et.jsx(Si,{image:B[O]?.split("/").pop(),deviceErrorId:s?.id,style:{width:"100%",maxHeight:"70vh",objectFit:"contain"}}),B.length>1&&Et.jsxs(Et.Fragment,{children:[Et.jsx(p,{type:"primary",icon:Et.jsx(xe,{}),onClick:()=>{R((O-1+B.length)%B.length)},style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",zIndex:1e3}}),Et.jsx(p,{type:"primary",icon:Et.jsx(ye,{}),onClick:()=>{R((O+1)%B.length)},style:{position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",zIndex:1e3}}),Et.jsxs("div",{style:{position:"absolute",bottom:16,left:"50%",transform:"translateX(-50%)",background:"rgba(0,0,0,0.7)",color:"white",padding:"4px 12px",borderRadius:"12px",fontSize:"14px"},children:[O+1," / ",B.length]})]})]})})]})};K.extend(Dn),K.extend(zn),K.extend(ve),K.tz.setDefault("Asia/Ho_Chi_Minh");const{TextArea:Ti}=o,{Title:Ii,Text:_i}=r,Di="https://192.168.1.7";b.memo(({formIndex:t,deviceIndex:n,deviceId:r,deviceName:i,onResultChange:s})=>{const l=e.useCallback(e=>{const t=e.target.value;s(n,{isNormal:t})},[n,s]);return Et.jsxs(Et.Fragment,{children:[Et.jsx(a.Item,{name:["deviceCheckForm","forms",t,"devices",n,"id"],hidden:!0,initialValue:r,children:Et.jsx(o,{})}),Et.jsx(a.Item,{name:["deviceCheckForm","forms",t,"devices",n,"name"],hidden:!0,initialValue:i,children:Et.jsx(o,{})}),Et.jsx(a.Item,{name:["deviceCheckForm","forms",t,"devices",n,"result","isNormal"],noStyle:!0,initialValue:!0,children:Et.jsxs(be.Group,{onChange:l,children:[Et.jsx(be,{value:!0,children:"Hoạt động bình thường"}),Et.jsx(be,{value:!1,children:"Có lỗi"})]})}),Et.jsx(a.Item,{noStyle:!0,shouldUpdate:(e,r)=>{const a=e?.deviceCheckForm?.forms?.[t]?.devices?.[n]?.result?.isNormal,i=r?.deviceCheckForm?.forms?.[t]?.devices?.[n]?.result?.isNormal;return a!==i},children:({getFieldValue:e})=>!1===e(["deviceCheckForm","forms",t,"devices",n,"result","isNormal"])?Et.jsxs("div",{className:"mt-4",children:[Et.jsx(a.Item,{name:["deviceCheckForm","forms",t,"devices",n,"result","details","deviceName"],label:"Tên thiết bị lỗi",rules:[{required:!0,message:"Vui lòng nhập tên thiết bị lỗi"}],children:Et.jsx(o,{})}),Et.jsx(a.Item,{name:["deviceCheckForm","forms",t,"devices",n,"result","details","serialNumber"],label:"Số serial",children:Et.jsx(o,{})}),Et.jsx(a.Item,{name:["deviceCheckForm","forms",t,"devices",n,"result","details","location"],label:"Vị trí",rules:[{required:!0,message:"Vui lòng nhập vị trí thiết bị"}],children:Et.jsx(o,{})}),Et.jsx(a.Item,{name:["deviceCheckForm","forms",t,"devices",n,"result","details","error"],label:"Mô tả lỗi",rules:[{required:!0,message:"Vui lòng nhập mô tả lỗi"}],children:Et.jsx(Ti,{rows:2})}),Et.jsx(a.Item,{name:["deviceCheckForm","forms",t,"devices",n,"result","details","solution"],label:"Phương án xử lý",rules:[{required:!0,message:"Vui lòng nhập phương án xử lý"}],children:Et.jsx(Ti,{rows:2})}),Et.jsx(a.Item,{name:["deviceCheckForm","forms",t,"devices",n,"result","details","resolved"],label:"Trạng thái xử lý",valuePropName:"checked",children:Et.jsx(je,{children:"Đã xử lý"})})]}):null})]})});const Ei=({currentShift:t,currentUser:r,hideCreateButton:l=!1,hideDeleteButton:c=!1})=>{const[d,g]=e.useState([]),[x,y]=e.useState(!1),[v,b]=e.useState(!1),[j,k]=e.useState([]),[w,C]=e.useState(null),[S,N]=e.useState({visible:!1,formId:null}),[T,I]=e.useState({visible:!1,error:null,history:[]}),[_,D]=e.useState(!1),[E,L]=e.useState([]),A=mt(),{logout:z}=Kt(),[F]=a.useForm(),{getDeviceList:P,loading:M}=mi();e.useEffect(()=>{(async()=>{try{const e=await P();L(e)}catch(e){L([{id:1,name:"Hệ thống phân phối điện UPS"},{id:2,name:"Hệ thống UPS"},{id:3,name:"Hệ thống làm mát"},{id:4,name:"Hệ thống giám sát hình ảnh"},{id:5,name:"Hệ thống kiểm soát truy cập"},{id:6,name:"PCCC"},{id:7,name:"Hệ thống giám sát hạ tầng TTDL"},{id:8,name:"Hệ thống khác"}])}})()},[P]);const O=e.useCallback(async e=>{try{if(D(!0),!E||0===E.length)return void D(!1);const t=localStorage.getItem("token");let n=[];const r=E.map(async n=>{try{const r=await Mt.get(Di+"/api/devices/errors",{headers:{Authorization:"Bearer "+t},params:{deviceId:n.id,location:e,"resolveStatus[]":[fi,gi]}}),a=r.data?.errors||[];return a.length>0?a.map(e=>({...e,deviceId:n.id,status:"Có lỗi",resultStatus:"Có lỗi",subDeviceName:"string"==typeof e.subDeviceName?e.subDeviceName:"",serialNumber:"string"==typeof e.serialNumber?e.serialNumber:"",errorCode:"string"==typeof e.errorCode?e.errorCode:"",errorCause:"string"==typeof e.errorCause?e.errorCause:"",solution:"string"==typeof e.solution?e.solution:"",notes:"string"==typeof e.notes?e.notes:"",uniqueId:e.uniqueId||`${n.id}-${Date.now()}-${Math.random()}`})):[{deviceId:n.id,status:"Bình thường",resultStatus:"Bình thường",subDeviceName:"",serialNumber:"",errorCode:"",errorCause:"",solution:"",notes:"",uniqueId:`${n.id}-${Date.now()}-${Math.random()}`}]}catch(r){return[{deviceId:n.id,status:"Bình thường",resultStatus:"Bình thường",subDeviceName:"",serialNumber:"",errorCode:"",errorCause:"",solution:"",notes:"",uniqueId:`${n.id}-${Date.now()}-${Math.random()}`}]}});n=(await Promise.all(r)).flat(),g(n.map(e=>({...e,resolveStatus:e.resolveStatus||fi}))),F.setFieldsValue({deviceItems:n})}catch(t){i.error("Không thể tải dữ liệu thiết bị")}finally{D(!1)}},[F,E]);e.useEffect(()=>{E.length>0&&v&&O(t?.WorkShift?.name||"")},[E,v,t?.WorkShift?.name,O]);const R=e.useCallback(async e=>{try{const t=localStorage.getItem("token");return(await Mt.get(`${Di}/api/devices/errors/${e}/history`,{headers:{Authorization:"Bearer "+t}})).data}catch{return i.error("Không thể lấy thông tin chi tiết lỗi"),[]}},[]),B=e.useCallback(async e=>{try{const t=await R(e.id);I({visible:!0,error:e,history:t})}catch{i.error("Không thể lấy thông tin chi tiết lỗi")}},[R]),V=e.useCallback(async e=>{try{const n=localStorage.getItem("token"),r=await Mt.put(`${Di}/api/devices/errors/${T.error.id}`,e,{headers:{Authorization:"Bearer "+n}});if(r.data){i.success("Cập nhật lỗi thành công");const e=await R(T.error.id);I(t=>({...t,error:r.data,history:e}));const n=t?.WorkShift?.name||"";await O(n)}}catch(n){i.error("Không thể cập nhật lỗi")}},[T.error,R,t,O]),U=e.useCallback((e,t)=>Et.jsx(f,{size:"small",style:{padding:"4px",background:e.resolveStatus===xi?"#f6ffed":"#fff1f0",borderColor:e.resolveStatus===xi?"#52c41a":"#ff4d4f"},title:Et.jsx("div",{children:Et.jsxs("span",{style:{color:"#ff4d4f"},children:["Tên thiết bị: ",e.subDeviceName||"Không rõ"]})}),children:Et.jsxs("div",{children:[Et.jsxs("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[Et.jsx("b",{children:"Serial:"})," ",e.serialNumber||"-"]}),Et.jsxs("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[Et.jsx("b",{children:"Tình trạng lỗi:"})," ",e.errorCode||"-"]}),Et.jsxs("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[Et.jsx("b",{children:"Nguyên nhân:"})," ",e.errorCause||"-"]}),Et.jsxs("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[Et.jsx("b",{children:"Giải pháp:"})," ",e.solution||"-"]}),Et.jsxs("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",marginTop:"8px"},children:[Et.jsx("b",{children:"Trạng thái :"}),e.resolveStatus&&e.resolveStatus.trim()?Et.jsx(W,{color:(e=>{if(!e||!e.trim())return"default";switch(e){case xi:return"success";case gi:return"warning";case fi:return"error";default:return"default"}})(e.resolveStatus),style:{marginLeft:8},children:e.resolveStatus}):Et.jsx("span",{style:{marginLeft:8,color:"#8c8c8c"},children:"Chưa xử lý"})]}),Et.jsx("div",{className:"flex gap-2 mt-2",children:Et.jsx(p,{type:"primary",size:"small",icon:Et.jsx(ke,{}),onClick:()=>B(e),className:"bg-blue-600",children:"Chi tiết"})})]})},e.uniqueId||`${e.deviceId}-${e.id||t}`),[B]),q=e.useMemo(()=>[{title:"STT",dataIndex:"id",key:"id",width:60,className:"custom-header border-gray-200",render:(e,t,n)=>Et.jsx("div",{className:"text-center",children:n+1})},{title:"Thiết bị",dataIndex:"name",key:"name",width:"30%",className:"custom-header border-gray-200"},{title:"Trạng thái",key:"status",className:"custom-header border-gray-200",render:(e,t)=>{const n=d.filter(e=>e.deviceId===t.id&&"Có lỗi"===e.status&&(e.resolveStatus===fi||e.resolveStatus===gi)),r=0===n.length;return Et.jsxs("div",{children:[Et.jsx("div",{className:"flex items-center justify-between mb-2",children:Et.jsx("div",{children:r?Et.jsx(W,{color:"green",children:"Bình thường"}):Et.jsx(W,{color:"red",children:"Có lỗi"})})}),!r&&Et.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:n.map((e,t)=>U(e,t))})]})}}],[d,U]),Y=async()=>{try{y(!0);const e=localStorage.getItem("token");if(!e)return void i.error("Phiên đăng nhập đã hết hạn");const n=await Mt.get(Di+"/api/shift-check/forms",{headers:{Authorization:"Bearer "+e},params:{workShiftId:t?.WorkShift?.id}});n.data&&Array.isArray(n.data)?(k(n.data),n.data.length>0?C(""+(n.data.length-1)):C(null)):(k([]),C(null))}catch(e){401===e.response?.status?i.error("Phiên đăng nhập đã hết hạn"):i.error("Không thể tải biên bản kiểm tra")}finally{y(!1)}};return e.useEffect(()=>{F.setFieldsValue({deviceItems:d})},[d,F]),e.useEffect(()=>{if(t?.WorkShift?.id&&E.length>0){const e=E.map(e=>({deviceId:e.id,status:"Bình thường",resultStatus:"Bình thường",subDeviceName:"",serialNumber:"",errorCode:"",errorCause:"",solution:"",notes:"",resolveStatus:"",uniqueId:Date.now()+Math.random()}));g(e)}},[t?.WorkShift?.id,E]),e.useEffect(()=>{t?.WorkShift?.id&&Y()},[t?.WorkShift?.id]),Et.jsxs("div",{className:"mt-6",children:[Et.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Et.jsx(Ii,{level:4,style:{color:"#003c71",margin:0},children:"Biên bản kiểm tra thiết bị"}),!l&&Et.jsx(p,{type:"primary",icon:Et.jsx(Z,{}),onClick:async()=>{b(!0)},disabled:"handover"===t?.WorkShift?.status,className:"bg-blue-600",children:"Tạo biên bản mới"})]}),v?Et.jsx(s,{spinning:_||M,children:Et.jsxs(a,{form:F,layout:"vertical",onFinish:async e=>{try{y(!0);const n=localStorage.getItem("token");if(!n)return void i.error("Phiên đăng nhập đã hết hạn");if(!e.location||!e.checkedAt)return void i.error("Vui lòng điền đầy đủ thông tin bắt buộc");const a=(F.getFieldValue("deviceItems")||d).filter(Boolean);if(!a||0===a.length)return void i.error("Vui lòng thêm ít nhất một thiết bị");const s=a.filter(e=>"Bình thường"===e.status||"Có lỗi"===e.status&&(e.resolveStatus===fi||e.resolveStatus===gi)),l=a.filter(e=>"Có lỗi"===e.status&&(e.resolveStatus===fi||e.resolveStatus===gi)).map(e=>({id:e.id,deviceId:e.deviceId,status:e.status,resultStatus:e.resultStatus,subDeviceName:e.subDeviceName||"",serialNumber:e.serialNumber||"",errorCode:e.errorCode||"",errorCause:e.errorCause||"",solution:e.solution||"",resolveStatus:e.resolveStatus,resolvedAt:e.resolvedAt,resolveNote:e.resolveNote,resolvedBy:e.resolvedBy,createdBy:r.id})),o={workShiftId:t.WorkShift.id,checkerId:r.id,location:e.location,checkedAt:e.checkedAt.format("YYYY-MM-DD HH:mm:ss"),notes:e.notes||"",date:t.WorkShift.date,shift:t.WorkShift.code,items:s.map(e=>({id:e.id,deviceId:e.deviceId,status:e.status,resultStatus:e.resultStatus,subDeviceName:e.subDeviceName||"",serialNumber:e.serialNumber||"",errorCode:e.errorCode||"",errorCause:e.errorCause||"",solution:e.solution||"",resolveStatus:"Có lỗi"===e.status?e.resolveStatus||fi:"",resolvedAt:e.resolvedAt,resolveNote:e.resolveNote,resolvedBy:e.resolvedBy,createdBy:r.id})),deviceErrors:l};(await Mt.post(Di+"/api/shift-check/forms",o,{headers:{Authorization:"Bearer "+n}})).data&&(i.success("Tạo biên bản kiểm tra thành công"),b(!1),F.resetFields(),Y(),C(j.length.toString()))}catch(n){401===n.response?.status?i.error("Phiên đăng nhập đã hết hạn"):n.response?.data?.message?i.error(n.response.data.message):i.error("Không thể tạo biên bản kiểm tra")}finally{y(!1)}},initialValues:{location:t?.WorkShift?.name,checkedAt:K()},children:[Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"location",label:"Địa điểm kiểm tra",rules:[{required:!0,message:"Vui lòng nhập địa điểm kiểm tra"}],children:Et.jsx(o,{placeholder:"Nhập địa điểm"})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"checkedAt",label:"Thời gian kiểm tra",rules:[{required:!0,message:"Vui lòng chọn thời gian kiểm tra"}],children:Et.jsx(u,{showTime:!0,format:"HH:mm DD/MM/YYYY",style:{width:"100%"}})})})]}),Et.jsx(h,{children:"Danh sách thiết bị kiểm tra"}),Et.jsx(H,{dataSource:E,rowKey:"id",bordered:!0,pagination:!1,columns:q}),Et.jsx("div",{className:"text-center mt-6",children:Et.jsxs(m,{children:[Et.jsx(p,{htmlType:"submit",type:"primary",className:"bg-blue-600",loading:x,icon:Et.jsx(Z,{}),children:"Lưu biên bản"}),Et.jsx(p,{type:"primary",icon:Et.jsx(we,{}),className:"bg-red-600",onClick:()=>{b(!1),F.resetFields()},children:"Hủy"})]})})]})}):Array.isArray(j)&&j.length>0?Et.jsx(n,{type:"card",activeKey:w||""+(j.length-1),onChange:e=>C(e),items:[...j||[]].reverse().map((e,n)=>({key:n.toString(),label:Et.jsxs("div",{className:"flex items-center gap-2",children:[Et.jsxs("span",{children:["Biên bản ",n+1]}),"datacenter"===r.role&&!c&&Et.jsx(p,{type:"text",danger:!0,size:"small",disabled:"handover"===t?.WorkShift?.status,icon:Et.jsx(J,{}),onClick:t=>{t.stopPropagation(),N({visible:!0,formId:e.id})}})]}),children:Et.jsxs(Et.Fragment,{children:[Et.jsxs(Ce,{bordered:!0,column:1,className:"mb-6",children:[Et.jsx(Ce.Item,{label:"Địa điểm kiểm tra",children:e.location}),Et.jsx(Ce.Item,{label:"Thời điểm kiểm tra",children:ui(e.checkedAt)}),Et.jsx(Ce.Item,{label:"Người kiểm tra",children:e.checker?.fullname||"-"})]}),e.items&&e.items.length>0&&Et.jsx(H,{dataSource:[...new Set(e.items.map(e=>e.deviceId))].map((t,n)=>{const r=e.items.filter(e=>e.deviceId===t),a=r.filter(e=>"Có lỗi"===e.status),i=(r.find(e=>"Bình thường"===e.status),r[0]),s=i.deviceNameSnapshot||"Thiết bị "+t,l=i.deviceCategorySnapshot||"",o=i.devicePositionSnapshot||"";return{id:t,deviceId:t,name:s,category:l,position:o,key:t,index:n+1,errorItems:a,status:a.length>0?"Có lỗi":"Bình thường"}}),rowKey:"key",pagination:!1,bordered:!0,columns:[{title:"STT",dataIndex:"index",key:"index",width:60,className:"custom-header border-gray-200",render:(e,t,n)=>Et.jsx("div",{className:"text-center",children:n+1})},{title:"Thiết bị",dataIndex:"name",key:"name",width:"30%",className:"custom-header border-gray-200"},{title:"Trạng thái",dataIndex:"status",key:"status",className:"custom-header border-gray-200",render:(e,t)=>{const n=e=>{if(!e||!e.trim())return"default";switch(e){case xi:return"success";case gi:return"warning";case fi:return"error";default:return"default"}};return t.errorItems&&t.errorItems.length>0?Et.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:t.errorItems.slice().sort((e,t)=>(e.subDeviceName||"").localeCompare(t.subDeviceName||"")).map((e,t)=>Et.jsxs(f,{size:"small",style:{background:"#fff1f0",borderColor:"#ff4d4f"},title:Et.jsxs("span",{style:{color:"#ff4d4f"},children:["Tên thiết bị: ",e.subDeviceName||"Không rõ"]}),children:[Et.jsxs("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[Et.jsx("b",{children:"Serial:"})," ",e.serialNumber||"-"]}),Et.jsxs("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[Et.jsx("b",{children:"Tình trạng lỗi:"})," ",e.errorCode||"-"]}),Et.jsxs("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[Et.jsx("b",{children:"Nguyên nhân:"})," ",e.errorCause||"-"]}),Et.jsxs("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[Et.jsx("b",{children:"Giải pháp:"})," ",e.solution||"-"]}),Et.jsxs("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",marginTop:"8px"},children:[Et.jsx("b",{children:"Trạng thái :"}),e.resolveStatus&&e.resolveStatus.trim()?Et.jsx(W,{color:n(e.resolveStatus),style:{marginLeft:8},children:e.resolveStatus}):Et.jsx("span",{style:{marginLeft:8,color:"red"},children:"Chưa xử lý"})]})]},e.uniqueId||`${e.deviceId}-${e.id||t}`))}):Et.jsx(W,{color:"green",children:"Bình thường"})}}]})]})}))}):Et.jsx("div",{className:"text-center py-8",children:Et.jsx(_i,{type:"secondary",children:"Chưa có biên bản kiểm tra thiết bị"})}),Et.jsxs($,{title:"Xác nhận xóa biên bản",open:S.visible,onOk:()=>(async e=>{try{const t=localStorage.getItem("token");if(!t)return i.error("Phiên đăng nhập đã hết hạn"),z(),void A("/login");(await Mt.delete(`${Di}/api/shift-check/forms/${e}`,{headers:{Authorization:"Bearer "+t}})).data&&(i.success("Xóa biên bản thành công"),N({visible:!1,formId:null}),Y())}catch(t){401===t.response?.status?(i.error("Phiên đăng nhập đã hết hạn"),z(),A("/login")):i.error(t.response?.data?.message||"Không thể xóa biên bản")}})(S.formId),onCancel:()=>N({visible:!1,formId:null}),okText:"Xóa",cancelText:"Hủy",okButtonProps:{danger:!0},children:[Et.jsx("p",{children:"Bạn có chắc chắn muốn xóa biên bản này không?"}),Et.jsx("p",{className:"text-red-500",children:"Lưu ý: Hành động này không thể hoàn tác."})]}),Et.jsx(Ni,{visible:T.visible,onClose:()=>I({visible:!1,error:null,history:[]}),error:T.error,history:T.history,onResolve:V})]})},{TextArea:Li}=o,{Title:Ai,Text:zi}=r,Fi=()=>{const{id:r}=gt(),o=mt(),{currentUser:u,authLoading:h}=Kt(),[g,x]=e.useState(!1),[y,v]=e.useState(!1),[b,j]=e.useState(null),[k,w]=e.useState(null),[C,S]=e.useState(!1),[N,T]=e.useState(!1),[I,_]=e.useState(""),[D,E]=e.useState(""),[L,A]=e.useState(!1),[z,F]=e.useState(!1),P=e.useRef(null),M=e.useRef(null),[O,R]=e.useState(!1),[B,V]=e.useState(null),[U,K]=e.useState(!1),[Y]=a.useForm(),[Q,J]=e.useState({isSending:!1,step:"",progress:0,error:null}),[Z,te]=e.useState(!1);e.useEffect(()=>{(async()=>{if(h)return;const e=localStorage.getItem("token");if(!e)return i.error("Vui lòng đăng nhập"),void o("/login");v(!0),j(null);try{await it.get("https://192.168.1.7/api/form-templates/handover",{headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}})}catch(t){j(t.message),401===t.response?.status?(i.error("Phiên đăng nhập hết hạn"),o("/login")):403===t.response?.status?i.error("Bạn không có quyền truy cập template"):i.error("Không thể tải template form bàn giao")}finally{v(!1)}})()},[h,o]),e.useEffect(()=>{ne()},[r]);const ne=async()=>{try{x(!0),R(!0),V(null);const e=await it.get("https://192.168.1.7/api/shifts/handover/"+r,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});w(e.data);let t=!1;u?.currentShiftId&&e.data.toShiftId&&(t=Number(u.currentShiftId)===Number(e.data.toShiftId)),!t&&e.data.ToUsers&&Array.isArray(e.data.ToUsers)&&(t=e.data.ToUsers.some(e=>e.id===u?.id)),!t&&e.data.ToShift?.Users&&(t=e.data.ToShift.Users.some(e=>e.id===u?.id)),!t&&u?.currentShiftCode&&(t=e.data.ToShift?.code===u.currentShiftCode),A(t);const n=e.data.FromUsers?.some(e=>e.id===u?.id);F(n)}catch(e){V("Có lỗi khi tải thông tin file đính kèm"),i.error("Có lỗi khi tải thông tin biên bản bàn giao"),o("/dc/handover")}finally{x(!1),R(!1)}};e.useEffect(()=>{k?.devices&&k.devices.forEach((e,t)=>{})},[k]);const re=async()=>{try{const t=localStorage.getItem("token");if(!t)return i.error("Vui lòng đăng nhập"),void o("/login");if(!z)return void i.error("Bạn không thuộc ca này");if("draft"!==k.status)return void i.error("Chỉ có thể gửi bàn giao ở trạng thái bản nháp");const n=Y.getFieldValue("to")||[],a=Y.getFieldValue("cc")||[],s=Y.getFieldValue("customContent")||"";if(0===n.length)return void i.error("Vui lòng nhập ít nhất một địa chỉ email người nhận");const l=(k.attachments||[]).map(async e=>{try{const n=await it.get(`https://192.168.1.7/api/shifts/handover/${k.id}/attachments/${e.filename}`,{headers:{Authorization:"Bearer "+t},responseType:"arraybuffer"}),r=btoa(new Uint8Array(n.data).reduce((e,t)=>e+String.fromCharCode(t),""));return{filename:e.originalname||e.filename,content:r,contentType:n.headers["content-type"]}}catch(n){return null}}),c=(await Promise.all(l)).filter(Boolean),d={to:n,cc:a,subject:`Báo cáo ca ${k.FromShift?.code} ngày ${ut(new Date(k.FromShift?.date),"dd/MM/yyyy",{locale:kn})}`,html:`\n          <div style="font-family: Arial, sans-serif; width: 100%;">\n          ${s?`\n          <div >\n            ${s.replace(/\n/g,"<br>")}\n          </div>\n          `:""}\n            <h2 style="color: #003c71; margin-bottom: 20px;">Biên bản bàn giao ca</h2>\n            <table style="width: 100%; border-collapse: collapse; border: 1px solid #e5e7eb;">\n              <tbody>\n                <tr>\n                  <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; width: 30%; border: 1px solid #e5e7eb;">Ca làm việc</td>\n                  <td style="padding: 12px; border: 1px solid #e5e7eb;">${k.FromShift?.code} - ${ut(new Date(k.FromShift?.date),"dd/MM/yyyy",{locale:kn})}</td>\n                </tr>\n                <tr>\n                  <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; border: 1px solid #e5e7eb;">Thành viên</td>\n                  <td style="padding: 12px; border: 1px solid #e5e7eb;">\n                    ${k.FromUsers?.map(e=>e.fullname||e.fullName).join(", ")}\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n\n            <h3 style="color: #003c71; margin: 20px 0 10px;">Nội dung bàn giao</h3>\n            <table style="width: 100%; border-collapse: collapse; border: 1px solid #e5e7eb;">\n              <tbody>\n                <tr>\n                  <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; width: 30%; border: 1px solid #e5e7eb;">Công cụ, tài liệu</td>\n                  <td style="padding: 12px; border: 1px solid #e5e7eb;">\n                    ${"complete"===k.handoverForm?.tools?.status?"✓ Đủ":"⚠️ Thiếu"}\n                    ${k.handoverForm?.tools?.missing?.items?.length>0?"<br>Thiếu: "+k.handoverForm.tools.missing.items.join(", "):""}\n                        ${k.handoverForm?.tools.missing.description?"<br>Mô tả: "+k.handoverForm?.tools.missing.description:""}\n                  </td>\n                </tr>\n                <tr>\n                  <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; border: 1px solid #e5e7eb;">Vệ sinh môi trường</td>\n                  <td style="padding: 12px; border: 1px solid #e5e7eb;">\n                    ${k.handoverForm?.environment?.status?"✓ Tốt":"⚠️ Chưa tốt"}\n                    ${k.handoverForm?.environment?.description?"<br>Mô tả: "+k.handoverForm?.environment?.description:""}\n                  </td>\n                </tr>\n                <tr>\n                  <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; border: 1px solid #e5e7eb;">Thiết bị có lỗi</td>\n                  <td style="padding: 12px; border: 1px solid #e5e7eb;">\n                    ${k.devices?.filter(e=>"Có lỗi"===e.status).length>0?k.devices.filter(e=>"Có lỗi"===e.status).map(e=>`\n                          <div style="margin-bottom: 12px; padding: 8px; background-color: #fff1f0; border-left: 4px solid #ff4d4f;">\n                            <div style="font-weight: bold; color: #ff4d4f; margin-bottom: 4px;">\n                              ${e.deviceNameSnapshot||"Hệ thống không xác định"}\n                            </div>\n                            <div style="margin-left: 12px;">\n                              <div><strong>Thiết bị:</strong> ${e.subDeviceName||"Không xác định"}</div>\n                              <div><strong>Serial:</strong> ${e.serialNumber||"Không có"}</div>\n                              <div><strong>Mã lỗi:</strong> ${e.errorCode||"Không có"}</div>\n                              <div><strong>Trạng thái xử lý:</strong> <span style="color: ${e.resolveStatus&&e.resolveStatus.trim()?le(e.resolveStatus):"#8c8c8c"};">${e.resolveStatus&&e.resolveStatus.trim()?e.resolveStatus:"Không áp dụng"}</span></div>\n                              <div><strong>Nguyên nhân:</strong> ${e.errorCause||"Không có"}</div>\n                              <div><strong>Giải pháp:</strong> ${e.solution||"Không có"}</div>\n                            </div>\n                          </div>\n                        `).join(""):"✓ Không có lỗi"}\n                  </td>\n                </tr>\n                <tr>\n                  <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; border: 1px solid #e5e7eb;">Công việc tồn đọng</td>\n                  <td style="padding: 12px; border: 1px solid #e5e7eb;">\n                    ${k.Tasks?.length>0?k.Tasks.map(e=>{const t=e=>{switch(e){case"in_progress":return"#1890ff";case"waiting":case"pending":return"#faad14";case"completed":return"#52c41a";case"cancelled":return"#ff4d4f"}};return`\n                          <div style="margin-bottom: 16px; padding: 12px; background-color: #fafafa; border-left: 4px solid ${t(e.status)};">\n                            <div style="font-weight: bold; font-size: 16px; margin-bottom: 8px;">\n                              CV${e.taskId} - ${e.taskTitle}\n                            </div>\n                            <div style="margin-left: 12px;">\n                              <div style="margin-bottom: 4px;"><strong>Nội dung:</strong> ${e.taskDescription||"Không có"}</div>\n                              <div style="margin-bottom: 4px;"><strong>Người thực hiện:</strong> ${e.fullName||"Chưa phân công"}</div>\n                              <div style="margin-bottom: 4px;">\n                                <strong>Thời gian:</strong>\n                                ${e.checkInTime?ut(new Date(e.checkInTime),"HH:mm dd/MM/yyyy",{locale:kn}):"Chưa bắt đầu"}\n                                ${e.checkOutTime?" - "+ut(new Date(e.checkOutTime),"HH:mm dd/MM/yyyy",{locale:kn}):""}\n                              </div>\n                              <div style="margin-top: 8px; color: ${t(e.status)}; font-weight: bold;">\n                                Trạng thái: ${(e=>{switch(e){case"in_progress":return"Đang thực hiện";case"waiting":return"Chờ xử lý";case"completed":return"Đã hoàn thành";case"cancelled":return"Đã hủy";case"pending":return"Tạm dừng"}})(e.status)}\n                              </div>\n                            </div>\n                          </div>\n                        `}).join(""):"✓ Không có công việc tồn đọng"}\n                  </td>\n                </tr>\n                <tr>\n                  <td style="padding: 12px; background-color: #f3f4f6; font-weight: bold; border: 1px solid #e5e7eb;">Ghi chú bàn giao</td>\n                  <td style="padding: 12px; border: 1px solid #e5e7eb;">${k.content||"Không có"}</td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        `,attachments:c};try{J({isSending:!0,step:"Đang chuẩn bị gửi email...",progress:10,error:null}),d.attachments?.length>0&&J(e=>({...e,step:"Đang xử lý file đính kèm...",progress:30})),J(e=>({...e,step:"Đang gửi email...",progress:50}));const e=await pi(d);if(!e.success)throw Error(e.message||"Gửi email thất bại");J(e=>({...e,step:"Gửi email thành công!",progress:100})),i.success("Gửi email thành công")}catch(e){return J(t=>({...t,isSending:!1,step:"Gửi email thất bại",progress:0,error:e.message||"Gửi email thất bại. Vui lòng thử lại sau."})),void i.error(e.message||"Gửi email thất bại. Vui lòng thử lại sau.")}try{const e=await it.post(`https://192.168.1.7/api/shifts/handover/draft/${r}/submit`,{handoverForm:k.handoverForm},{headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"}});e.data&&!e.data.error?(i.success("Gửi bàn giao thành công"),K(!1),J({isSending:!1,step:"",progress:0,error:null}),ne(),o("/dc/handover")):i.error(e.data.message||"Có lỗi khi gửi bàn giao")}catch(e){i.error("Gửi bàn giao thất bại. Vui lòng thử lại sau.")}}catch(e){i.error("Có lỗi xảy ra. Vui lòng thử lại sau.")}},ae=()=>o("/dc/handover"),ie={draft:Et.jsx(W,{color:"blue",children:"Đang làm việc"}),pending:Et.jsx(W,{color:"orange",children:"Chờ xác nhận"}),completed:Et.jsx(W,{color:"green",children:"Đã bàn giao"}),rejected:Et.jsx(W,{color:"red",children:"Đã từ chối"})},se=(e,t,n="Không rõ")=>e||t||n,le=e=>{if(!e||!e.trim())return"#8c8c8c";switch(e){case xi:return vi.RESOLVED;case gi:return vi.IN_PROGRESS;default:return vi.PENDING}},oe=e=>{if(!e||!e.trim())return"default";switch(e){case xi:return"success";case gi:return"warning";default:return"error"}};return e.useEffect(()=>{},[k]),g||y?Et.jsx(s,{spinning:g,tip:"Đang tải...",fullscreen:!0,children:Et.jsx("div",{className:"p-6"})}):b?Et.jsx("div",{className:"min-h-screen bg-gray-100 p-6",children:Et.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:Et.jsxs("p",{children:["Lỗi khi tải template: ",b]})})}):k?Et.jsxs("div",{className:"min-h-screen bg-gray-100 p-6",children:[Et.jsxs("div",{className:"bg-gradient-to-r from-[#003c71] to-[#0079c2] text-white p-4 rounded shadow mb-6",children:[Et.jsxs("div",{className:"flex justify-between items-center",children:[Et.jsx("div",{className:"flex items-center",children:Et.jsx(p,{type:"link",icon:Et.jsx(Se,{}),onClick:ae,className:"text-white",children:"Quay lại"})}),Et.jsx("div",{children:Et.jsx(Ai,{level:3,style:{color:"white",margin:0},children:"Chi tiết bàn giao"})})]}),Et.jsx("p",{className:"mt-1 text-sm text-white",children:"Thông tin chi tiết về biên bản bàn giao giữa các ca trực"})]}),Et.jsx("div",{children:Et.jsx(n,{defaultActiveKey:"1",items:[{key:"1",label:Et.jsx("span",{className:"font-medium text-base",children:"Thông tin bàn giao"}),className:"custom-tab",children:Et.jsxs("div",{className:"space-y-6",children:[Et.jsx(f,{title:Et.jsx("div",{className:"text-2xl font-bold text-center font-['Roboto']",children:"BIÊN BẢN BÀN GIAO CA"}),variant:"outlined",className:"shadow-sm w-full",children:Et.jsxs("div",{className:"space-y-3",children:[Et.jsxs("div",{className:"flex items-center",children:[Et.jsx("span",{className:"font-medium mr-2 min-w-[120px]",children:"Trạng thái:"}),ie[k.status]]}),Et.jsxs("div",{className:"flex items-center",children:[Et.jsx("span",{className:"font-medium mr-2 min-w-[120px]",children:"Địa điểm làm việc:"}),Et.jsx("span",{children:se(k.FromShift?.name)})]}),Et.jsxs("div",{className:"flex items-center",children:[Et.jsx("span",{className:"font-medium mr-2 min-w-[120px]",children:"Ca làm việc:"}),Et.jsx("span",{children:`${se(k.FromShift?.code)} - ${ut(new Date(k.FromShift?.date),"dd/MM/yyyy",{locale:kn})}`})]}),k.confirmedAt&&Et.jsxs("div",{className:"flex items-center",children:[Et.jsx("span",{className:"font-medium mr-2 min-w-[120px]",children:"Thời gian bàn giao ca:"}),Et.jsx("span",{children:ut(new Date(k.confirmedAt),"HH:mm dd/MM/yyyy ",{locale:kn})})]}),k.confirmNote&&Et.jsxs("div",{className:"flex items-start",children:[Et.jsx("span",{className:"font-medium mr-2 min-w-[120px]",children:"Ghi chú xác nhận:"}),Et.jsx("span",{children:k.confirmNote})]}),k.rejectNote&&Et.jsxs("div",{className:"flex items-start",children:[Et.jsx("span",{className:"font-medium mr-2 min-w-[120px]",children:"Lý do từ chối:"}),Et.jsx("span",{className:"text-red-600",children:k.rejectNote})]})]})}),Et.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Et.jsxs(f,{title:"Bên giao ca",variant:"outlined",className:"shadow-sm",children:[Et.jsx("p",{children:Et.jsx("strong",{children:"Người giao:"})}),Et.jsx("ul",{className:"ml-4 list-disc",children:(k.FromUsers||[]).map(e=>Et.jsx("li",{children:e.fullname||e.fullName},e.id))})]}),Et.jsxs(f,{title:"Bên nhận ca",variant:"outlined",className:"shadow-sm",children:[Et.jsx("p",{children:Et.jsx("strong",{children:"Người nhận:"})}),k.ToUsers&&k.ToUsers.length>0?Et.jsx("ul",{className:"ml-4 list-disc",children:k.ToUsers.map(e=>Et.jsx("li",{children:e.fullname||e.fullName},e.id))}):Et.jsx("div",{className:"text-gray-500 italic ml-4",children:"Chưa có người nhận ca"})]})]}),k.handoverForm&&Et.jsxs("div",{className:"space-y-6 w-full",children:[Et.jsx(f,{title:"1. Công cụ, tài liệu làm việc",variant:"outlined",className:"shadow-sm",children:Et.jsxs("div",{className:"space-y-4",children:[Et.jsxs("div",{children:[Et.jsx("p",{className:"mb-2",children:"Tình trạng công cụ tài liệu"}),Et.jsx("div",{children:Et.jsx(W,{color:"complete"===k.handoverForm?.tools?.status?"blue":"red",children:"complete"===k.handoverForm?.tools?.status?"Đủ":"Thiếu"})})]}),k.handoverForm?.tools?.missing?.items&&k.handoverForm.tools.missing.items.length>0&&Et.jsxs("div",{children:[Et.jsx("p",{className:"font-medium mb-2",children:"Các mục thiếu:"}),Et.jsx("ul",{className:"list-disc pl-5 space-y-1",children:k.handoverForm.tools.missing.items.map((e,t)=>Et.jsx("li",{children:e},t))}),k.handoverForm.tools.missing.description&&Et.jsxs("div",{className:"mt-4",children:[Et.jsx("p",{className:"font-medium mb-2",children:"Mô tả nguyên nhân thiếu thiết bị:"}),Et.jsx("div",{className:"bg-gray-50 p-4 rounded",children:k.handoverForm.tools.missing.description})]})]})]})}),Et.jsx(f,{title:"2. Vệ sinh môi trường trong các phòng chức năng",variant:"outlined",className:"shadow-sm",children:Et.jsxs("div",{className:"space-y-4",children:[Et.jsxs("div",{children:[Et.jsx("p",{className:"mb-2",children:"Hiện trạng vệ sinh môi trường"}),Et.jsx("div",{children:Et.jsx(W,{color:k.handoverForm?.environment?.status?"success":"error",children:k.handoverForm?.environment?.status?"Tốt":"Chưa tốt"})})]}),!k.handoverForm?.environment?.status&&Et.jsxs("div",{children:[Et.jsx("p",{className:"mb-2",children:"Mô tả chi tiết tình trạng môi trường"}),Et.jsx("div",{className:"bg-gray-50 p-4 rounded",children:k.handoverForm?.environment?.description||"Không có mô tả"})]})]})}),Et.jsx(f,{title:"3. Tình trạng các hệ thống hạ tầng TTDL",variant:"outlined",className:"shadow-sm",children:Et.jsx("div",{className:"space-y-4",children:Et.jsx(H,{bordered:!0,size:"small",rowKey:"id",pagination:!1,columns:[{title:"STT",dataIndex:"index",key:"index",width:60,className:"custom-header border-gray-200",render:(e,t,n)=>Et.jsx("div",{className:"text-center",children:n+1})},{title:"Thiết bị",dataIndex:"deviceId",key:"deviceId",width:"30%",className:"custom-header border-gray-200",render:(e,t)=>t.deviceNameSnapshot||"Thiết bị "+e},{title:"Trạng thái",key:"status",width:"70%",className:"custom-header border-gray-200",render:(e,t)=>"Bình thường"===t.status?Et.jsx(W,{color:"success",children:"✓ Bình thường"}):"Có lỗi"===t.status?Et.jsxs(m,{direction:"vertical",className:"w-full",children:[Et.jsx(W,{color:"error",children:"✓ Có lỗi"}),Et.jsxs(f,{style:{background:"#fff1f0",borderColor:"#ff4d4f"},title:Et.jsxs("span",{style:{color:"#ff4d4f"},children:["Tên thiết bị: ",t.subDeviceName||"Không rõ"]}),children:[Et.jsxs("div",{className:"ant-descriptions-item",children:[Et.jsx("b",{children:"Serial:"})," ",t.serialNumber]}),Et.jsxs("div",{className:"ant-descriptions-item",children:[Et.jsx("b",{children:"Tình trạng lỗi:"})," ",t.errorCode]}),Et.jsxs("div",{className:"ant-descriptions-item",children:[Et.jsx("b",{children:"Nguyên nhân:"})," ",t.errorCause]}),Et.jsxs("div",{className:"ant-descriptions-item",children:[Et.jsx("b",{children:"Giải pháp:"})," ",t.solution]}),Et.jsxs("div",{className:"ant-descriptions-item",children:[Et.jsx("b",{children:"Trạng thái:"}),t.resolveStatus&&t.resolveStatus.trim()?Et.jsx(W,{color:oe(t.resolveStatus),style:{marginLeft:8},children:t.resolveStatus}):Et.jsx("span",{style:{marginLeft:8,color:"#8c8c8c"},children:"Không áp dụng"})]})]})]}):Et.jsx(W,{color:"default",children:"Không xác định"})}],dataSource:k.devices||[]})})}),Et.jsx(f,{title:"4. Các công việc đang thực hiện",variant:"outlined",className:"shadow-sm",children:Et.jsxs("div",{className:"space-y-4",children:[Et.jsxs("div",{children:[Et.jsx("p",{className:"mb-2",children:"Công việc đang tồn đọng"}),Et.jsx("div",{children:Et.jsx(W,{color:k.Tasks?.length>0?"blue":"default",children:k.Tasks?.length>0?"Có":"Không Có"})})]}),k.Tasks?.length>0&&Et.jsx(H,{bordered:!0,size:"small",rowKey:"id",pagination:!1,columns:[{title:"Mã",dataIndex:"taskId",key:"taskId",width:60,className:"custom-header border-gray-200",render:e=>Et.jsxs("div",{className:"text-center",children:["CV ",e]})},{title:"Địa điểm",dataIndex:"location",key:"location",width:100,className:"custom-header border-gray-200"},{title:"Tiêu đề công việc",dataIndex:"taskTitle",key:"taskTitle",width:300,className:"custom-header border-gray-200"},{title:"Nội dung công việc",dataIndex:"taskDescription",key:"taskDescription",width:300,className:"custom-header border-gray-200"},{title:"Người thực hiện",dataIndex:"fullName",key:"fullName",width:300,className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e.split(",").map((e,t)=>Et.jsxs("div",{className:"flex items-center mb-1",children:[Et.jsx(c,{className:"mr-1 flex-shrink-0"}),Et.jsx("span",{className:"break-words",children:e.trim()})]},`person-${t}-${e.trim()}`))})},{title:"Thời gian bắt đầu",dataIndex:"checkInTime",key:"checkInTime",width:150,className:"custom-header border-gray-200",render:e=>e?ut(new Date(e),"HH:mm dd/MM/yyyy",{locale:kn}):"Chưa bắt đầu"},{title:"Thời gian kết thúc",dataIndex:"checkOutTime",key:"checkOutTime",width:150,className:"custom-header border-r border-gray-200",render:e=>e?ut(new Date(e),"HH:mm dd/MM/yyyy",{locale:kn}):"Chưa kết thúc"},{title:"Trạng thái",dataIndex:"status",key:"status",width:120,className:"custom-header border-r border-gray-200",render:e=>Et.jsx(W,{color:"completed"===e?"success":"cancelled"===e?"error":"in_progress"===e?"processing":"pending"===e||"waiting"===e?"warning":"default",children:"in_progress"===e?"Đang thực hiện":"waiting"===e?"Chờ xử lý":"completed"===e?"Đã hoàn thành":"cancelled"===e?"Đã hủy":"pending"===e?"Tạm dừng":"Không xác định"})}],dataSource:k.Tasks})]})}),Et.jsx(f,{title:"5. Nội dung bàn giao",variant:"outlined",className:"shadow-sm",children:Et.jsx("div",{className:"space-y-4",children:Et.jsx("div",{className:"bg-gray-50 p-4 rounded",children:k.content||"Không có nội dung bàn giao"})})}),Et.jsx(f,{title:"6. File đính kèm",variant:"outlined",className:"shadow-sm",children:Et.jsx("div",{className:"space-y-4",children:O?Et.jsx("div",{className:"text-center py-4",children:Et.jsx(s,{tip:"Đang tải danh sách file..."})}):B?Et.jsx("div",{className:"text-center py-4",children:Et.jsx(zi,{type:"danger",children:B})}):k.attachments&&k.attachments.length>0?Et.jsx(Ne,{className:"mt-4",size:"small",dataSource:k.attachments,renderItem:e=>Et.jsx(Ne.Item,{actions:[Et.jsx(p,{type:"link",icon:Et.jsx(Te,{}),onClick:()=>(async e=>{try{x(!0);const t=localStorage.getItem("token"),n=`https://192.168.1.7/api/shifts/handover/${k.id}/attachments/${e.filename}`,r=await it({url:n,method:"GET",responseType:"blob",headers:{Authorization:"Bearer "+t}}),a=new Blob([r.data],{type:r.headers["content-type"]}),s=window.URL.createObjectURL(a),l=document.createElement("a");l.href=s,l.download=e.originalname,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(s),i.success("Tải file thành công")}catch(t){i.error("Không thể tải file. Vui lòng thử lại sau.")}finally{x(!1)}})(e),children:"Tải xuống"})],children:Et.jsx(Ne.Item.Meta,{avatar:Et.jsx(ee,{}),title:e.originalname,description:(e.size/1024).toFixed(2)+" KB"})})}):Et.jsx("div",{className:"text-center py-4",children:Et.jsx(zi,{type:"secondary",children:"Không có file đính kèm"})})})})]}),"draft"===k.status&&z&&Et.jsxs("div",{className:"flex justify-end mt-6 gap-1",children:[Et.jsx(p,{type:"primary",onClick:()=>{o("/dc/handover/edit/"+r)},style:{backgroundColor:"#1890ff",borderColor:"#1890ff"},children:"Chỉnh sửa"}),Et.jsx(p,{type:"primary",onClick:()=>{K(!0)},loading:g,danger:!0,children:"Bàn giao ca"})]}),Et.jsx("div",{className:"flex gap-4 justify-end",style:{position:"sticky",bottom:0,padding:"10px"},children:"pending"===k.status&&L&&Et.jsxs(Et.Fragment,{children:[Et.jsx(p,{type:"primary",className:"bg-[#003c71]",icon:Et.jsx(he,{}),onClick:()=>S(!0),disabled:!L,children:"Xác nhận nhận ca"}),Et.jsx(p,{danger:!0,icon:Et.jsx(Ie,{}),onClick:()=>T(!0),disabled:!L,children:"Từ chối"})]})})]})},{key:"2",label:Et.jsx("span",{className:"font-medium text-base",children:"Kiểm tra thiết bị"}),className:"custom-tab",children:Et.jsx("div",{className:"bg-white p-1 rounded-lg px-6",children:Et.jsx(Ei,{currentShift:{WorkShift:{id:k?.fromShiftId,code:k?.FromShift?.code,name:k?.FromShift?.name,date:k?.FromShift?.date,status:k?.FromShift?.status}},currentUser:u,hideCreateButton:!0,hideDeleteButton:!0})})}]})}),Et.jsx("div",{className:"mt-6 flex justify-center",children:Et.jsx(p,{type:"primary",icon:Et.jsx(Se,{}),onClick:ae,className:"bg-[#003c71]",children:"Quay lại danh sách"})}),Et.jsx($,{title:"Xác nhận nhận ca",open:C,onOk:async()=>{try{x(!0),await it.post("https://192.168.1.7/api/shifts/handover/confirm/"+r,{notes:I},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),i.success("Xác nhận bàn giao thành công"),S(!1),_(""),ne()}catch(e){i.error(e.response?.data?.message||"Có lỗi khi xác nhận bàn giao")}finally{x(!1)}},onCancel:()=>S(!1),confirmLoading:g,okButtonProps:{className:"bg-[#003c71]"},destroyOnHidden:!0,children:Et.jsx(a,{ref:P,layout:"vertical",children:Et.jsx(a.Item,{label:"Ghi chú",children:Et.jsx(Li,{rows:4,value:I,onChange:e=>_(e.target.value)})})})}),Et.jsx($,{title:Et.jsxs("div",{className:"flex items-center gap-2",children:[Et.jsx(d,{}),Et.jsx("span",{children:"Gửi email bàn giao"})]}),open:U,onOk:re,onCancel:()=>{K(!1),J({isSending:!1,step:"",progress:0,error:null})},footer:[Et.jsx(p,{onClick:()=>{K(!1),J({isSending:!1,step:"",progress:0,error:null})},children:"Hủy"},"back"),Et.jsx(p,{type:"primary",loading:g,onClick:re,className:"bg-[#003c71]",disabled:Q.isSending,children:"Gửi email và bàn giao"},"submit")],width:800,children:Et.jsxs(a,{form:Y,layout:"vertical",initialValues:{to:["datacenter@vietinbank.vn"],cc:["anhtt@vietinbank.vn","nhandv@vietinbank.vn","huu.nguyen@vietinbank.vn"]},children:[Et.jsxs(X,{gutter:16,children:[Et.jsxs(G,{span:12,children:[Et.jsx(a.Item,{name:"to",label:"Người nhận",rules:[{required:!0,message:"Vui lòng nhập email người nhận"}],children:Et.jsx(t,{mode:"tags",placeholder:"Nhập email người nhận",style:{width:"100%"},tokenSeparators:[",",";"],onInputKeyDown:e=>{"Tab"===e.key&&e.stopPropagation()}})}),Et.jsx(a.Item,{name:"cc",label:"CC",children:Et.jsx(t,{mode:"tags",placeholder:"Nhập email CC",style:{width:"100%"},tokenSeparators:[",",";"],onInputKeyDown:e=>{"Tab"===e.key&&e.stopPropagation()}})}),Et.jsx(a.Item,{name:"customContent",label:"Nội dung ",tooltip:"Nội dung này sẽ được hiển thị ở đầu email",children:Et.jsx(Li,{autoSize:{minRows:3,maxRows:6},placeholder:"Nhập nội dung  (tùy chọn)",style:{resize:"none"}})})]}),Et.jsx(G,{span:12,children:Et.jsxs("div",{className:"bg-gray-50 p-4 rounded border border-gray-200",style:{maxHeight:"400px",overflowY:"auto"},children:[Et.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Nội dung email sẽ gửi:"}),Et.jsx("table",{className:"w-full border-collapse",children:Et.jsxs("tbody",{children:[Et.jsxs("tr",{className:"border-b border-gray-200",children:[Et.jsx("td",{className:"py-2 px-3 font-medium bg-gray-100 w-1/3",children:"Tiêu đề:"}),Et.jsx("td",{className:"py-2 px-3",children:`Bàn giao ca  ${k.FromShift?.code} ngày ${ut(new Date(k.FromShift?.date),"dd/MM/yyyy",{locale:kn})}`})]}),Et.jsxs("tr",{className:"border-b border-gray-200",children:[Et.jsx("td",{className:"py-2 px-3 font-medium bg-gray-100",children:"Ca làm việc:"}),Et.jsx("td",{className:"py-2 px-3",children:`${k.FromShift?.code} - ${ut(new Date(k.FromShift?.date),"dd/MM/yyyy",{locale:kn})}`})]}),Et.jsxs("tr",{className:"border-b border-gray-200",children:[Et.jsx("td",{className:"py-2 px-3 font-medium bg-gray-100",children:"Người giao ca:"}),Et.jsx("td",{className:"py-2 px-3",children:k.FromUsers?.map(e=>e.fullname||e.fullName).join(", ")})]}),k.attachments&&k.attachments.length>0&&Et.jsxs("tr",{className:"border-b border-gray-200",children:[Et.jsx("td",{className:"py-2 px-3 font-medium bg-gray-100",children:"File đính kèm:"}),Et.jsx("td",{className:"py-2 px-3",children:Et.jsx("ul",{className:"list-disc pl-4",children:k.attachments.map(e=>Et.jsx("li",{children:e.originalname},e.filename))})})]})]})})]})})]}),Q.isSending&&Et.jsxs("div",{className:"mt-4",children:[Et.jsx(l,{message:Et.jsxs("div",{className:"flex items-center justify-between",children:[Et.jsxs("div",{className:"flex items-center",children:[Et.jsx(q,{className:"mr-2"}),Et.jsx("span",{children:Q.step})]}),Et.jsxs("span",{children:[Q.progress,"%"]})]}),type:"info",showIcon:!1,className:"mb-2"}),Et.jsx(pe,{percent:Q.progress,status:Q.error?"exception":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"},size:"small"})]}),Q.error&&Et.jsx(l,{message:Q.error,type:"error",showIcon:!0,className:"mt-4"})]})}),Et.jsx($,{title:"Từ chối nhận ca",open:N,onOk:async()=>{try{x(!0),await it.post("https://192.168.1.7/api/shifts/handover/reject/"+r,{notes:D},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),i.success("Từ chối bàn giao thành công"),T(!1),E(""),ne()}catch(e){i.error(e.response?.data?.message||"Có lỗi khi từ chối bàn giao")}finally{x(!1)}},onCancel:()=>T(!1),confirmLoading:g,okButtonProps:{danger:!0},destroyOnHidden:!0,children:Et.jsx(a,{ref:M,layout:"vertical",children:Et.jsx(a.Item,{label:"Lý do từ chối",children:Et.jsx(Li,{rows:4,value:D,onChange:e=>E(e.target.value)})})})})]}):Et.jsx("div",{children:"Loading..."})};var Pi,Mi={exports:{}};const Oi=at(function(){if(Pi)return Mi.exports;Pi=1;var e={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Ấ":"A","Ắ":"A","Ẳ":"A","Ẵ":"A","Ặ":"A","Æ":"AE","Ầ":"A","Ằ":"A","Ȃ":"A","Ả":"A","Ạ":"A","Ẩ":"A","Ẫ":"A","Ậ":"A","Ç":"C","Ḉ":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ế":"E","Ḗ":"E","Ề":"E","Ḕ":"E","Ḝ":"E","Ȇ":"E","Ẻ":"E","Ẽ":"E","Ẹ":"E","Ể":"E","Ễ":"E","Ệ":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ḯ":"I","Ȋ":"I","Ỉ":"I","Ị":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","Ố":"O","Ṍ":"O","Ṓ":"O","Ȏ":"O","Ỏ":"O","Ọ":"O","Ổ":"O","Ỗ":"O","Ộ":"O","Ờ":"O","Ở":"O","Ỡ":"O","Ớ":"O","Ợ":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ủ":"U","Ụ":"U","Ử":"U","Ữ":"U","Ự":"U","Ý":"Y","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","ấ":"a","ắ":"a","ẳ":"a","ẵ":"a","ặ":"a","æ":"ae","ầ":"a","ằ":"a","ȃ":"a","ả":"a","ạ":"a","ẩ":"a","ẫ":"a","ậ":"a","ç":"c","ḉ":"c","è":"e","é":"e","ê":"e","ë":"e","ế":"e","ḗ":"e","ề":"e","ḕ":"e","ḝ":"e","ȇ":"e","ẻ":"e","ẽ":"e","ẹ":"e","ể":"e","ễ":"e","ệ":"e","ì":"i","í":"i","î":"i","ï":"i","ḯ":"i","ȋ":"i","ỉ":"i","ị":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ố":"o","ṍ":"o","ṓ":"o","ȏ":"o","ỏ":"o","ọ":"o","ổ":"o","ỗ":"o","ộ":"o","ờ":"o","ở":"o","ỡ":"o","ớ":"o","ợ":"o","ù":"u","ú":"u","û":"u","ü":"u","ủ":"u","ụ":"u","ử":"u","ữ":"u","ự":"u","ý":"y","ÿ":"y","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Ĉ":"C","ĉ":"c","Ċ":"C","ċ":"c","Č":"C","č":"c","C̆":"C","c̆":"c","Ď":"D","ď":"d","Đ":"D","đ":"d","Ē":"E","ē":"e","Ĕ":"E","ĕ":"e","Ė":"E","ė":"e","Ę":"E","ę":"e","Ě":"E","ě":"e","Ĝ":"G","Ǵ":"G","ĝ":"g","ǵ":"g","Ğ":"G","ğ":"g","Ġ":"G","ġ":"g","Ģ":"G","ģ":"g","Ĥ":"H","ĥ":"h","Ħ":"H","ħ":"h","Ḫ":"H","ḫ":"h","Ĩ":"I","ĩ":"i","Ī":"I","ī":"i","Ĭ":"I","ĭ":"i","Į":"I","į":"i","İ":"I","ı":"i","Ĳ":"IJ","ĳ":"ij","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","Ḱ":"K","ḱ":"k","K̆":"K","k̆":"k","Ĺ":"L","ĺ":"l","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ŀ":"L","ŀ":"l","Ł":"l","ł":"l","Ḿ":"M","ḿ":"m","M̆":"M","m̆":"m","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","ŉ":"n","N̆":"N","n̆":"n","Ō":"O","ō":"o","Ŏ":"O","ŏ":"o","Ő":"O","ő":"o","Œ":"OE","œ":"oe","P̆":"P","p̆":"p","Ŕ":"R","ŕ":"r","Ŗ":"R","ŗ":"r","Ř":"R","ř":"r","R̆":"R","r̆":"r","Ȓ":"R","ȓ":"r","Ś":"S","ś":"s","Ŝ":"S","ŝ":"s","Ş":"S","Ș":"S","ș":"s","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","ț":"t","Ț":"T","Ť":"T","ť":"t","Ŧ":"T","ŧ":"t","T̆":"T","t̆":"t","Ũ":"U","ũ":"u","Ū":"U","ū":"u","Ŭ":"U","ŭ":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ȗ":"U","ȗ":"u","V̆":"V","v̆":"v","Ŵ":"W","ŵ":"w","Ẃ":"W","ẃ":"w","X̆":"X","x̆":"x","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Y̆":"Y","y̆":"y","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","ſ":"s","ƒ":"f","Ơ":"O","ơ":"o","Ư":"U","ư":"u","Ǎ":"A","ǎ":"a","Ǐ":"I","ǐ":"i","Ǒ":"O","ǒ":"o","Ǔ":"U","ǔ":"u","Ǖ":"U","ǖ":"u","Ǘ":"U","ǘ":"u","Ǚ":"U","ǚ":"u","Ǜ":"U","ǜ":"u","Ứ":"U","ứ":"u","Ṹ":"U","ṹ":"u","Ǻ":"A","ǻ":"a","Ǽ":"AE","ǽ":"ae","Ǿ":"O","ǿ":"o","Þ":"TH","þ":"th","Ṕ":"P","ṕ":"p","Ṥ":"S","ṥ":"s","X́":"X","x́":"x","Ѓ":"Г","ѓ":"г","Ќ":"К","ќ":"к","A̋":"A","a̋":"a","E̋":"E","e̋":"e","I̋":"I","i̋":"i","Ǹ":"N","ǹ":"n","Ồ":"O","ồ":"o","Ṑ":"O","ṑ":"o","Ừ":"U","ừ":"u","Ẁ":"W","ẁ":"w","Ỳ":"Y","ỳ":"y","Ȁ":"A","ȁ":"a","Ȅ":"E","ȅ":"e","Ȉ":"I","ȉ":"i","Ȍ":"O","ȍ":"o","Ȑ":"R","ȑ":"r","Ȕ":"U","ȕ":"u","B̌":"B","b̌":"b","Č̣":"C","č̣":"c","Ê̌":"E","ê̌":"e","F̌":"F","f̌":"f","Ǧ":"G","ǧ":"g","Ȟ":"H","ȟ":"h","J̌":"J","ǰ":"j","Ǩ":"K","ǩ":"k","M̌":"M","m̌":"m","P̌":"P","p̌":"p","Q̌":"Q","q̌":"q","Ř̩":"R","ř̩":"r","Ṧ":"S","ṧ":"s","V̌":"V","v̌":"v","W̌":"W","w̌":"w","X̌":"X","x̌":"x","Y̌":"Y","y̌":"y","A̧":"A","a̧":"a","B̧":"B","b̧":"b","Ḑ":"D","ḑ":"d","Ȩ":"E","ȩ":"e","Ɛ̧":"E","ɛ̧":"e","Ḩ":"H","ḩ":"h","I̧":"I","i̧":"i","Ɨ̧":"I","ɨ̧":"i","M̧":"M","m̧":"m","O̧":"O","o̧":"o","Q̧":"Q","q̧":"q","U̧":"U","u̧":"u","X̧":"X","x̧":"x","Z̧":"Z","z̧":"z","й":"и","Й":"И","ё":"е","Ё":"Е"},t=Object.keys(e).join("|"),n=RegExp(t,"g"),r=RegExp(t,"");function a(t){return e[t]}var i=function(e){return e.replace(n,a)};return Mi.exports=i,Mi.exports.has=function(e){return!!e.match(r)},Mi.exports.remove=i,Mi.exports}()),{TextArea:Ri}=o,{Title:Bi}=r,Vi=()=>{const n=mt(),{id:r}=gt(),{currentUser:d}=Kt(),[u,g]=e.useState(!1),[x,v]=e.useState(!0),[b,j]=e.useState(null),[k,w]=e.useState(null),[C,S]=e.useState([]),[N]=a.useForm(),[T,I]=e.useState(!1),[_,D]=e.useState([]),[E,L]=e.useState(!1),[A,z]=e.useState([]),[F,P]=e.useState(!0),[M,O]=e.useState([]),{getDeviceList:R,loading:B}=mi(),[V,U]=e.useState([]);e.useEffect(()=>{(async()=>{try{const e=await R();U(e)}catch(e){U([])}})()},[R]);const $=e.useCallback(async()=>{try{P(!0),await(async()=>{try{v(!0),j(null);const e=await Mt.get("/api/form-templates/handover");if(!e.data?.success||!e.data?.data)throw Error("Dữ liệu template không hợp lệ")}catch(e){throw j("Không thể tải mẫu form bàn giao. Vui lòng thử lại."),e}finally{v(!1)}})(),await(async()=>{try{g(!0);const e=await Mt.get("/api/shifts/current");if(e.data?.shift){const t={...e.data.shift,date:e.data.shift.date||(new Date).toISOString().split("T")[0]};w(t);const n=[...(await Mt.get(`/api/shifts/${e.data.shift.id}/users`)).data.data||[],...e.data.shift.workedUsers||[]].filter((e,t,n)=>t===n.findIndex(t=>t.id===e.id));S(n)}}catch(e){throw i.error("Không thể tải thông tin ca làm việc"),e}finally{g(!1)}})(),r?await(async()=>{try{g(!0);const t=(await Mt.get("/api/shifts/handover/"+r)).data,a=t.FromUsers?.some(e=>e.id===d?.id);if(!a)return i.error("Bạn không thuộc ca này"),void n("/dc/handover");if("draft"!==t.status)return i.error("Chỉ có thể sửa form bàn giao ở trạng thái bản nháp"),void n("/dc/handover");0===V.length&&await new Promise(e=>{const t=()=>{V.length>0?e():setTimeout(t,100)};t()});const s=[];for(const n of V)try{const e=await Mt.get("/api/devices/errors",{params:{deviceId:n.id,location:t.FromShift?.name,"resolveStatus[]":[fi,gi]}});e.data?.errors&&e.data.errors.length>0?e.data.errors.forEach(e=>{s.push({deviceErrorId:e.id,deviceId:n.id,status:"Có lỗi",resultStatus:"Có lỗi",subDeviceName:e.subDeviceName||"",serialNumber:e.serialNumber||"",errorCode:e.errorCode||"",errorCause:e.errorCause||"",solution:e.solution||"",resolveStatus:e.resolveStatus||fi,resolvedAt:null,resolveNote:null,resolvedBy:null,uniqueId:`error-${n.id}-${e.id}-${Date.now()}`,isNew:!1,createdAt:e.createdAt})}):s.push({deviceId:n.id,status:"Bình thường",resultStatus:"Bình thường",subDeviceName:"",serialNumber:"",errorCode:"",errorCause:"",solution:"",resolveStatus:fi,resolvedAt:null,resolveNote:null,resolvedBy:null,uniqueId:`normal-${n.id}-${Date.now()}`,isNew:!1})}catch(e){s.push({deviceId:n.id,status:"Bình thường",resultStatus:"Bình thường",subDeviceName:"",serialNumber:"",errorCode:"",errorCause:"",solution:"",resolveStatus:fi,resolvedAt:null,resolveNote:null,resolvedBy:null,uniqueId:`normal-${n.id}-${Date.now()}`,isNew:!1})}N.resetFields(),N.setFieldsValue({content:t.content||"",handoverForm:{tools:{status:t.handoverForm?.tools?.status||"complete",missing:{items:t.handoverForm?.tools?.missing?.items||[],description:t.handoverForm?.tools?.missing?.description||"",details:{computer:t.handoverForm?.tools?.missing?.details?.computer||!1,phone:t.handoverForm?.tools?.missing?.details?.phone||!1,key:t.handoverForm?.tools?.missing?.details?.key||!1,other:t.handoverForm?.tools?.missing?.details?.other||!1,otherDescription:t.handoverForm?.tools?.missing?.details?.otherDescription||""}}},environment:{status:t.handoverForm?.environment?.status??!0,description:t.handoverForm?.environment?.description||""},tasks:t.handoverForm?.tasks||[]},deviceItems:s}),z(s),I(!0),t.handoverForm?.tasks&&O(t.handoverForm.tasks),t.attachments&&t.attachments.length>0&&D(t.attachments)}catch(e){i.error("Không thể tải thông tin form bàn giao"),n("/dc/handover")}finally{g(!1)}})():setTimeout(()=>{N.setFieldsValue(Y())},0)}catch(e){i.error("Có lỗi xảy ra khi tải dữ liệu. Vui lòng thử lại")}finally{P(!1)}},[r,V]);e.useEffect(()=>{$()},[$]);const K=e.useCallback(async()=>{if(!r&&k?.name&&V.length>0)for(const t of V)try{const e=await Mt.get("/api/devices/errors",{params:{deviceId:t.id,location:k.name,"resolveStatus[]":[fi,gi]}});e.data?.errors&&e.data.errors.length>0?e.data.errors.forEach(e=>{z(n=>[...n,{deviceErrorId:e.id,deviceId:t.id,status:"Có lỗi",resultStatus:"Có lỗi",subDeviceName:e.subDeviceName||"",serialNumber:e.serialNumber||"",errorCode:e.errorCode||"",errorCause:e.errorCause||"",solution:e.solution||"",resolveStatus:e.resolveStatus||fi,resolvedAt:null,resolveNote:null,resolvedBy:null,uniqueId:`error-${t.id}-${e.id}-${Date.now()}`,isNew:!1,createdAt:e.createdAt}])}):z(e=>[...e,{deviceId:t.id,status:"Bình thường",resultStatus:"Bình thường",subDeviceName:"",serialNumber:"",errorCode:"",errorCause:"",solution:"",resolveStatus:fi,resolvedAt:null,resolveNote:null,resolvedBy:null,uniqueId:`normal-${t.id}-${Date.now()}`,isNew:!1}])}catch(e){z(e=>[...e,{deviceId:t.id,status:"Bình thường",resultStatus:"Bình thường",subDeviceName:"",serialNumber:"",errorCode:"",errorCause:"",solution:"",resolveStatus:fi,resolvedAt:null,resolveNote:null,resolvedBy:null,uniqueId:`normal-${t.id}-${Date.now()}`,isNew:!1}])}},[k?.name,r,V]);e.useEffect(()=>{K()},[K]);const Y=()=>({handoverForm:{tools:{status:"complete",missing:{items:[],description:"",details:{computer:!1,phone:!1,key:!1,other:!1,otherDescription:""}}},environment:{status:!0,description:"",hasOngoingTasks:!1,ongoingTasks:"",progress:"",estimatedCompletion:""},infrastructure:{powerDistribution:{status:"normal"},ups:{status:"normal"},cooling:{status:"normal"},cctv:{status:"normal"},accessControl:{status:"normal"},fireSystem:{status:"normal"},dcimSystem:{status:"normal"}},ongoingTasks:{hasOngoingTasks:!1,taskInfo:"",relatedTasks:""},tasks:[]}}),Q=e.useCallback(async()=>{try{if(!k?.name)return;const e=await Mt.get("/api/tasks",{params:{"status[]":["in_progress","waiting","pending"],location:k.name}});if(e.data?.tasks){O(e.data.tasks);const t=e.data.tasks.map(e=>{let t="";t=e.staff&&Array.isArray(e.staff)&&e.staff.length>0?e.staff.map(e=>{let t=e.fullName||e.name||"Không xác định";return e.donVi&&(t+=` (${e.donVi})`),t}).join(", "):e.fullName||"Công việc "+e.id;const n=Array.isArray(e.staff)?e.staff.map(e=>({id:e.id,fullName:e.fullName||e.name||"",donVi:e.donVi||"",email:e.email||"",phone:e.phone||"",role:e.role||null})):[];return{id:e.id,location:e.location,fullName:t,taskTitle:e.taskTitle,taskDescription:e.taskDescription,status:e.status,checkInTime:e.checkInTime,checkOutTime:e.checkOutTime,userId:e.userId,createdBy:e.createdBy,completedBy:e.completedBy,workSessionId:e.workSessionId,workShiftId:e.workShiftId,staff:n}});setTimeout(()=>{const e=N.getFieldsValue();N.setFieldsValue({handoverForm:{...e.handoverForm,tasks:t},ongoingTasks:t})},0)}}catch(e){i.error("Không thể lấy danh sách công việc đang làm")}},[k,N]);e.useEffect(()=>{k?.id&&Q()},[k,Q]);const[Z,te]=e.useState(null);return e.useEffect(()=>()=>{(async()=>{if(Z&&_.some(e=>e.isTemp))try{await(async e=>{try{return(await Mt.delete("/api/shifts/handover/temp/cleanup/"+e)).data}catch(t){throw t}})(Z)}catch(e){}})()},[Z]),e.useEffect(()=>{r&&(async()=>{if(r)try{const e=await Mt.get("/api/shifts/handover/"+r);e.data&&e.data.attachments?D(e.data.attachments):D([])}catch(e){i.error("Không thể tải thông tin form bàn giao")}})()},[r]),F||x||B?Et.jsxs("div",{className:"p-6 flex flex-col items-center justify-center",style:{minHeight:"400px"},children:[Et.jsx(s,{indicator:Et.jsx(q,{style:{fontSize:24},spin:!0})}),Et.jsx("div",{className:"mt-4",children:"Đang tải dữ liệu..."})]}):b?Et.jsx("div",{className:"p-6",children:Et.jsx(l,{message:"Lỗi",description:b,type:"error",showIcon:!0,action:Et.jsx(p,{icon:Et.jsx(_e,{}),onClick:$,type:"primary",children:"Thử lại"})})}):Et.jsx("div",{className:"p-6",children:Et.jsxs(f,{children:[Et.jsxs("div",{className:"mb-4 flex items-center",children:[Et.jsx(p,{icon:Et.jsx(Se,{}),onClick:()=>n("/dc/my-shifts"),className:"mr-4",children:"Quay lại"}),Et.jsx(Bi,{level:4,className:"mb-0",children:T?"Sửa bản nháp bàn giao":"Tạo bản nháp bàn giao"})]}),Et.jsx(f,{title:"Thông tin ca",className:"mb-4",children:Et.jsxs(X,{gutter:24,children:[Et.jsx(G,{span:8,children:Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"font-medium mb-1",children:"Ca làm việc:"}),Et.jsx(W,{color:"blue",children:k?.code||"N/A"})]})}),Et.jsx(G,{span:8,children:Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"font-medium mb-1",children:"Ngày làm việc:"}),Et.jsx("div",{children:k?.date?(e=>{try{const t=new Date(e);return isNaN(t.getTime())?ut(new Date,"dd/MM/yyyy",{locale:kn}):ut(t,"dd/MM/yyyy",{locale:kn})}catch(t){return ut(new Date,"dd/MM/yyyy",{locale:kn})}})(k.date):"N/A"})]})}),Et.jsx(G,{span:8,children:Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"font-medium mb-1",children:"Trạng thái:"}),Et.jsx(W,{color:(ne=k?.status,{waiting:"default",doing:"green",handover:"orange",done:"red"}[ne]||"default"),children:(e=>{switch(e){case"draft":return"Bản nháp";case"pending":return"Chờ duyệt";case"approved":return"Đã duyệt";case"rejected":return"Từ chối";case"doing":return"Đang làm việc";case"handover":return"Đang bàn giao";default:return e}})(k?.status)})]})}),Et.jsx(G,{span:24,children:Et.jsxs("div",{className:"mb-4",children:[Et.jsx("div",{className:"font-medium mb-1",children:"Người trong ca:"}),C&&C.length>0?Et.jsx(Ne,{size:"small",dataSource:C,renderItem:e=>Et.jsx(Ne.Item,{children:Et.jsxs(m,{children:[Et.jsx(y,{icon:Et.jsx(c,{})}),Et.jsx("span",{children:e.fullname}),e.id===d?.id&&Et.jsx(W,{color:"blue",children:"Bạn"})]})})}):Et.jsx("div",{children:"Chưa có người trong ca"})]})})]})}),Et.jsx(f,{title:"Biên Bản Bàn Giao",className:"mb-4",children:Et.jsxs(a,{form:N,layout:"vertical",children:[Et.jsxs(X,{gutter:16,className:"mb-4",children:[Et.jsxs(G,{span:12,children:[Et.jsx(a.Item,{name:["handoverForm","tools","status"],label:"Trạng thái công cụ làm việc",required:!0,children:Et.jsxs(t,{children:[Et.jsx(t.Option,{value:"complete",children:"Đầy đủ"}),Et.jsx(t.Option,{value:"incomplete",children:"Thiếu"})]})}),Et.jsx(a.Item,{noStyle:!0,shouldUpdate:(e,t)=>e?.handoverForm?.tools?.status!==t?.handoverForm?.tools?.status,children:({getFieldValue:e})=>"incomplete"===e(["handoverForm","tools","status"])&&Et.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[Et.jsx("div",{className:"font-medium mb-4",children:"Chọn thiết bị thiếu:"}),Et.jsxs(X,{gutter:[16,16],children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:["handoverForm","tools","missing","details","computer"],valuePropName:"checked",children:Et.jsx(je,{children:"Máy tính"})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:["handoverForm","tools","missing","details","phone"],valuePropName:"checked",children:Et.jsx(je,{children:"Điện thoại"})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:["handoverForm","tools","missing","details","key"],valuePropName:"checked",children:Et.jsx(je,{children:"Chìa khóa"})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:["handoverForm","tools","missing","details","other"],valuePropName:"checked",children:Et.jsx(je,{children:"Khác"})})})]}),Et.jsx(a.Item,{noStyle:!0,shouldUpdate:(e,t)=>e?.handoverForm?.tools?.missing?.details?.other!==t?.handoverForm?.tools?.missing?.details?.other,children:({getFieldValue:e})=>e(["handoverForm","tools","missing","details","other"])&&Et.jsx(a.Item,{name:["handoverForm","tools","missing","details","otherDescription"],label:"Mô tả thiết bị khác",rules:[{required:!0,message:"Vui lòng mô tả thiết bị khác"}],children:Et.jsx(o.TextArea,{rows:2,placeholder:"Nhập mô tả thiết bị khác"})})}),Et.jsx(a.Item,{name:["handoverForm","tools","missing","description"],label:"Mô tả chi tiết tình trạng thiếu thiết bị",required:!0,rules:[{required:!0,message:"Vui lòng mô tả chi tiết về tình trạng thiếu thiết bị"}],extra:"Vui lòng mô tả chi tiết nguyên nhân, thời điểm và tình trạng thiếu thiết bị",children:Et.jsx(Ri,{rows:3,placeholder:""})})]})})]}),Et.jsxs(G,{span:12,children:[Et.jsx(a.Item,{name:["handoverForm","environment","status"],label:"Trạng thái môi trường",required:!0,children:Et.jsxs(t,{children:[Et.jsx(t.Option,{value:!0,children:"Tốt"}),Et.jsx(t.Option,{value:!1,children:"Chưa tốt"})]})}),Et.jsx(a.Item,{noStyle:!0,shouldUpdate:(e,t)=>e?.handoverForm?.environment?.status!==t?.handoverForm?.environment?.status,children:({getFieldValue:e})=>!1===e(["handoverForm","environment","status"])&&Et.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:Et.jsx(a.Item,{name:["handoverForm","environment","description"],label:"Mô tả chi tiết tình trạng môi trường",required:!0,rules:[{required:!0,message:"Vui lòng mô tả chi tiết về tình trạng môi trường"}],extra:"Vui lòng mô tả chi tiết về các vấn đề môi trường cần khắc phục",children:Et.jsx(Ri,{rows:4,placeholder:""})})})})]})]}),Et.jsx(h,{children:"Danh sách thiết bị kiểm tra"}),Et.jsx(H,{dataSource:V,rowKey:"id",pagination:!1,bordered:!0,columns:[{title:"STT",dataIndex:"id",key:"id",width:60,className:"custom-header border-gray-200",render:(e,t,n)=>Et.jsx("div",{className:"text-center",children:n+1})},{title:"Thiết bị",dataIndex:"name",key:"name",width:"30%",className:"custom-header border-gray-200"},{title:"Trạng thái",key:"status",className:"custom-header border-gray-200",render:(e,t)=>{const n=A.filter(e=>e.deviceId===t.id&&"Có lỗi"===e.status),r=A.some(e=>e.deviceId===t.id&&e.isNew),a=A.filter(e=>e.deviceId===t.id&&"Có lỗi"===e.status&&(void 0===e.resolveStatus||e.resolveStatus===fi||e.resolveStatus===gi)),i=A.filter(e=>e.deviceId===t.id&&"Có lỗi"===e.status&&e.resolveStatus===xi),s=0===a.length&&0===i.length;return Et.jsx("div",{children:0!==n.length||r?Et.jsxs("div",{children:[Et.jsx("div",{className:"ant-space ant-space-horizontal ant-space-align-center ant-space-justify-between mb-2",children:Et.jsx("div",{children:s?Et.jsx(W,{color:"green",children:"Bình thường"}):Et.jsx(W,{color:"red",children:"Có lỗi"})})}),!s&&Et.jsx("div",{className:"ant-space ant-space-vertical ant-space-gap-4",children:[...a,...i].map(e=>Et.jsxs(f,{size:"small",className:"ant-card-bordered mb-4",style:{background:"#fff1f0",borderColor:"#ff4d4f"},title:Et.jsxs("span",{style:{color:"#ff4d4f"},children:["Tên thiết bị: ",e.subDeviceName||"Không rõ"]}),children:[Et.jsxs("div",{className:"ant-descriptions-item",children:[Et.jsx("b",{children:"Serial:"})," ",e.serialNumber]}),Et.jsxs("div",{className:"ant-descriptions-item",children:[Et.jsx("b",{children:"Tình trạng lỗi:"})," ",e.errorCode]}),Et.jsxs("div",{className:"ant-descriptions-item",children:[Et.jsx("b",{children:"Nguyên nhân:"})," ",e.errorCause]}),Et.jsxs("div",{className:"ant-descriptions-item",children:[Et.jsx("b",{children:"Giải pháp:"})," ",e.solution]}),Et.jsxs("div",{className:"ant-descriptions-item",children:[Et.jsx("b",{children:"Trạng thái:"})," ",e.resolveStatus]})]},e.uniqueId))})]}):Et.jsx(W,{color:"success",children:"✓ Bình thường"})})}}]})]})}),Et.jsxs(a,{form:N,onFinish:async()=>{try{g(!0);const t=await N.validateFields(),a=A.filter(Boolean),s=[],l=[];a.forEach(e=>{if("Bình thường"===e.status)s.push({deviceId:e.deviceId,status:"Bình thường",resultStatus:"Bình thường",subDeviceName:null,serialNumber:null,errorCode:null,errorCause:null,solution:null,resolveStatus:"",resolvedAt:null,resolveNote:null,resolvedBy:null});else if("Có lỗi"===e.status){const t={deviceId:e.deviceId,deviceName:V.find(t=>t.id===e.deviceId)?.name||"Thiết bị "+e.deviceId,status:"Có lỗi",resultStatus:"Có lỗi",subDeviceName:e.subDeviceName||"",serialNumber:e.serialNumber||"",errorCode:e.errorCode||"",errorCause:e.errorCause||"",solution:e.solution||"",resolveStatus:e.resolveStatus||fi,resolvedAt:e.resolvedAt||null,resolveNote:e.resolveNote||null,resolvedBy:e.resolvedBy||null};e.shiftHandoverDeviceId&&(t.id=e.shiftHandoverDeviceId),e.deviceErrorId&&(t.deviceErrorId=e.deviceErrorId),s.push(t),e.deviceErrorId&&l.push({id:e.deviceErrorId,deviceId:e.deviceId,deviceName:t.deviceName,status:"Có lỗi",resultStatus:"Có lỗi",subDeviceName:e.subDeviceName||"",serialNumber:e.serialNumber||"",errorCode:e.errorCode||"",errorCause:e.errorCause||"",solution:e.solution||"",resolveStatus:e.resolveStatus||fi,resolvedAt:e.resolvedAt||null,resolveNote:e.resolveNote||null,resolvedBy:e.resolvedBy||null})}});const o=t.handoverForm?.tools?.missing?.details,c=[];o&&(o.computer&&c.push("Máy tính"),o.phone&&c.push("Điện thoại"),o.key&&c.push("Chìa khóa"),o.other&&c.push("Khác"));const d=M.map(e=>{let t="";t=e.staff&&Array.isArray(e.staff)&&e.staff.length>0?e.staff.map(e=>{let t=e.fullName||e.name||"Không xác định";return e.donVi&&(t+=` (${e.donVi})`),t}).join(", "):e.fullName||"Công việc "+e.id;const n=Array.isArray(e.staff)?e.staff.map(e=>({id:e.id,fullName:e.fullName||e.name||"",donVi:e.donVi||"",email:e.email||"",phone:e.phone||"",role:e.role||null})):[];return{id:e.id,location:e.location,fullName:t,taskTitle:e.taskTitle,taskDescription:e.taskDescription,status:e.status,checkInTime:e.checkInTime,checkOutTime:e.checkOutTime,userId:e.userId,createdBy:e.createdBy,completedBy:e.completedBy,workSessionId:e.workSessionId,workShiftId:e.workShiftId,staff:n}}),u={shiftId:k?.id,content:t.content?.trim()||"",handoverForm:{tools:{status:t.handoverForm?.tools?.status||"complete",missing:{items:c,description:t.handoverForm?.tools?.missing?.description?.trim()||"",details:{computer:o?.computer||!1,phone:o?.phone||!1,key:o?.key||!1,other:o?.other||!1,otherDescription:o?.otherDescription?.trim()||""}}},environment:{status:t.handoverForm?.environment?.status??!0,description:t.handoverForm?.environment?.description?.trim()||""},tasks:d},devices:s,deviceErrors:l};let h;h=T?await Mt.patch("/api/shifts/handover/"+r,u):await Mt.post("/api/shifts/handover/draft",u);const m=h.data?.id||h.data?.handover?.id;if(m){if(Z&&_.some(e=>e.isTemp))try{await(async(e,t)=>{try{return(await Mt.post("/api/shifts/handover/temp/commit",{handoverId:e,sessionId:t})).data}catch(n){throw n}})(m,Z),i.success("Đã commit tất cả file tạm")}catch(e){i.warning("Không thể commit một số file tạm")}i.success(T?"Cập nhật bản nháp thành công":"Tạo bản nháp thành công"),n("/dc/handover/"+m)}else i.error("Không thể lấy ID của biên bản sau khi lưu"),n("/dc/handover")}catch(e){i.error(e.response?.data?.message||"Có lỗi xảy ra khi lưu dữ liệu")}finally{g(!1)}},layout:"vertical",className:"mt-4",initialValues:Y(),children:[Et.jsxs(f,{children:[Et.jsx(a.Item,{name:"ongoingTasks",label:"Công việc đang làm",children:Et.jsx(H,{dataSource:M,rowKey:"id",pagination:!1,bordered:!0,columns:[{title:"Mã",dataIndex:"id",key:"id",width:"4%",className:"custom-header border-gray-200",render:e=>Et.jsxs("div",{className:"text-center",children:["CV ",e]})},{title:"Địa điểm",dataIndex:"location",key:"location",width:200,className:"custom-header border-gray-200"},{title:"Tên công việc",dataIndex:"taskTitle",key:"taskTitle",width:200,className:"custom-header border-gray-200"},{title:"Mô tả",dataIndex:"taskDescription",key:"taskDescription",width:"30%",className:"custom-header border-gray-200"},{title:"Nhân sự",key:"staff",width:"15%",className:"custom-header border-gray-200",render:(e,t)=>Array.isArray(t.staff)&&t.staff.length>0?t.staff.map((e,n)=>Et.jsxs("span",{children:[e.fullName||e.name,e.donVi?` (${e.donVi})`:"",n<t.staff.length-1?", ":""]},e.id||n)):t.fullName||"Không xác định"},{title:"Thời gian vào",dataIndex:"checkInTime",key:"checkInTime",width:"10%",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:new Date(e).toLocaleString("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"})})},{title:"Thời gian ra",dataIndex:"checkOutTime",key:"checkOutTime",width:"10%",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:new Date(e).toLocaleString("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"})})},{title:"Trạng thái",dataIndex:"status",key:"status",width:100,className:"custom-header border-gray-200",render:e=>{const t={in_progress:{color:"processing",text:"Đang thực hiện"},waiting:{color:"default",text:"Chờ xử lý"},pending:{color:"warning",text:"Tạm dừng"}}[e]||{color:"default",text:e};return Et.jsx(W,{color:t.color,children:t.text})}}]})}),Et.jsx(a.Item,{name:"content",label:"Nội dung bàn giao",rules:[{required:!0,message:"Vui lòng nhập nội dung bàn giao"}],children:Et.jsx(Ri,{rows:3,placeholder:"Nhập nội dung bàn giao..."})}),Et.jsxs(f,{type:"inner",title:"File đính kèm",className:"mt-4",children:[Et.jsx(se,{name:"files",multiple:!0,beforeUpload:async e=>{try{if(L(!0),e.size/1024/1024>=10)return i.error("File không được vượt quá 10MB!"),!1;if(!["image/jpeg","image/png","image/gif","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-word.document.12","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel.sheet.12","application/vnd.ms-excel.sheet.macroEnabled.12","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.ms-powerpoint.presentation.12","application/vnd.ms-powerpoint.slideshow.12","application/vnd.ms-access","application/x-msaccess","application/x-mspublisher","application/vnd.visio","application/vnd.visio2013","application/vnd.ms-project","application/onenote","application/msonenote","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.oasis.opendocument.graphics","application/vnd.oasis.opendocument.chart","application/vnd.oasis.opendocument.formula","application/vnd.oasis.opendocument.database","application/vnd.oasis.opendocument.image","text/plain"].includes(e.type))return i.error(`Định dạng file ${e.type} không được hỗ trợ!`),!1;const t=(e=>{try{const t=e.split(".").pop(),n=e.substring(0,e.lastIndexOf("."));return`${Oi(n).replace(/[^a-zA-Z0-9]/g,"_").replace(/_+/g,"_").toLowerCase()}.${t}`}catch(t){return e}})(e.name),n=new File([e],t,{type:e.type});if(!r){const t=new FormData;t.append("files",n),t.append("originalname",e.name),Z||te(`temp_${d?.id}_${Date.now()}`),t.append("sessionId",Z||`temp_${d?.id}_${Date.now()}`);const r=await(async e=>{try{return(await Mt.post("/api/shifts/handover/temp/upload",e,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(t){throw t}})(t);if(r&&r.files){const t={filename:r.files[0].filename,originalname:e.name,size:e.size,type:e.type,sessionId:r.sessionId,isTemp:!0};D(e=>[...e,t]),te(r.sessionId),i.success("File đã được tải lên tạm thời")}else i.error("Không nhận được thông tin file từ server");return!1}const a=new FormData;a.append("files",n),a.append("originalname",e.name);const s=await Mt.post(`/api/shifts/handover/${r}/attachments`,a,{headers:{"Content-Type":"multipart/form-data"}});if(s.data&&s.data.files){const e=s.data.files.map(e=>({...e,filename:e.filename,originalname:e.originalname||e.name}));D(t=>[...t,...e]),i.success("Tải file lên thành công")}else i.error("Không nhận được thông tin file từ server");return!1}catch(t){return i.error(t.response?.data?.message||"Không thể tải file lên"),!1}finally{L(!1)}},showUploadList:!1,disabled:E,accept:".jpg,.jpeg,.png,.gif,.pdf,.doc,.docx,.xls,.xlsx,.xlsm,.ppt,.pptx,.ppsx,.mdb,.pub,.vsd,.vsdx,.mpp,.one,.odt,.ods,.odp,.odg,.odc,.odf,.odb,.odi,.txt",children:Et.jsx(p,{icon:Et.jsx(le,{}),loading:E,children:"Tải file lên"})}),_.length>0&&Et.jsx(Ne,{className:"mt-4",size:"small",dataSource:_,renderItem:e=>Et.jsx(Ne.Item,{actions:[Et.jsx(p,{type:"link",icon:Et.jsx(J,{}),onClick:()=>(async(e,t)=>{try{const r=_.find(e=>e.filename===t&&e.isTemp);if(r){try{await(async(e,t)=>{try{return(await Mt.delete(`/api/shifts/handover/temp/delete/${e}/${t}`)).data}catch(n){throw n}})(r.sessionId,t)}catch(n){}return D(e=>e.filter(e=>e.filename!==t)),void i.success("Đã xóa file khỏi danh sách")}if(!e)return;const a=await Mt.delete(`/api/shifts/handover/${e}/attachments/${t}`);a.data.handover?(D(a.data.handover.attachments||[]),i.success("Xóa file thành công")):i.error("Lỗi khi xóa file")}catch(n){if(404===n.response?.status){const t=await Mt.get("/api/shifts/handover/"+e);t&&D(t.data.attachments||[])}else i.error(n.response?.data?.message||"Lỗi khi xóa file")}})(r,e.filename),children:"Xóa"})],children:Et.jsx(Ne.Item.Meta,{avatar:Et.jsx(ee,{}),title:e.originalname,description:(e.size/1024).toFixed(2)+" KB"})})})]})]}),Et.jsx("div",{style:{marginTop:16,textAlign:"right"},children:Et.jsxs(m,{children:[Et.jsx(p,{onClick:()=>n(-1),children:"Quay Lại"}),Et.jsx(p,{type:"primary",htmlType:"submit",loading:u,style:{backgroundColor:"#1890ff",borderColor:"#1890ff"},children:"Lưu"})]})})]})]})});var ne},Ui="https://192.168.1.7",$i=()=>{const t=mt(),{id:n}=gt(),[r]=a.useForm(),[s,l]=e.useState(!1),[c,d]=e.useState(null),u=!!n;e.useEffect(()=>{u?h():m()},[n]);const h=async()=>{try{l(!0);const e=localStorage.getItem("token"),t=await it.get(`${Ui}/api/shifts/${n}/device-check`,{headers:{Authorization:"Bearer "+e}});t.data&&(d(t.data.workShift),r.setFieldsValue(t.data.deviceCheckForm))}catch(e){}finally{l(!1)}},m=async()=>{try{l(!0);const e=localStorage.getItem("token"),t=await it.get(Ui+"/api/shifts/current",{headers:{Authorization:"Bearer "+e}});t.data?.shift&&d(t.data.shift)}catch(e){}finally{l(!1)}};return s?Et.jsx("div",{className:"text-center py-4",children:"Đang tải..."}):c?Et.jsx("div",{className:"p-6",children:Et.jsx(f,{title:"Kiểm tra thiết bị - Ca "+c.code,children:Et.jsxs(a,{form:r,layout:"vertical",initialValues:{powerDistribution:{status:"normal",error:{deviceName:"",serialNumber:"",location:"",description:"",currentWork:"",nextActions:""}},ups:{status:"normal",error:{deviceName:"",serialNumber:"",location:"",description:"",currentWork:"",nextActions:""}},cooling:{status:"normal",error:{deviceName:"",serialNumber:"",location:"",description:"",currentWork:"",nextActions:""}},surveillance:{status:"normal",error:{deviceName:"",serialNumber:"",location:"",description:"",currentWork:"",nextActions:""}},accessControl:{status:"normal",error:{deviceName:"",serialNumber:"",location:"",description:"",currentWork:"",nextActions:""}},fireSystem:{status:"normal",error:{deviceName:"",serialNumber:"",location:"",description:"",currentWork:"",nextActions:""}},dataCenter:{status:"normal",error:{deviceName:"",serialNumber:"",location:"",description:"",currentWork:"",nextActions:""}}},onFinish:async e=>{try{l(!0);const r=localStorage.getItem("token"),a=u?`${Ui}/api/shifts/${n}/device-check`:Ui+"/api/shifts/device-check";(await it.post(a,{workShiftId:c.id,deviceCheckForm:e},{headers:{Authorization:"Bearer "+r}})).data&&(i.success("Lưu thông tin kiểm tra thiết bị thành công"),t("/dc/device-check"))}catch(r){}finally{l(!1)}},children:[Et.jsxs(f,{title:"1. Hệ thống phân phối điện UPS",className:"mb-4",children:[Et.jsx(a.Item,{name:["powerDistribution","status"],children:Et.jsxs(be.Group,{children:[Et.jsx(be,{value:"normal",children:"Hoạt động bình thường"}),Et.jsx(be,{value:"error",children:"Có lỗi"})]})}),Et.jsx(a.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.powerDistribution?.status!==t.powerDistribution?.status,children:({getFieldValue:e})=>"error"===e(["powerDistribution","status"])&&Et.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{label:"Tên thiết bị",name:["powerDistribution","error","deviceName"],children:Et.jsx(o,{})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{label:"Số serial",name:["powerDistribution","error","serialNumber"],children:Et.jsx(o,{})})})]}),Et.jsx(a.Item,{label:"Vị trí",name:["powerDistribution","error","location"],children:Et.jsx(o,{})}),Et.jsx(a.Item,{label:"Mô tả lỗi",name:["powerDistribution","error","description"],children:Et.jsx(o.TextArea,{rows:3})}),Et.jsx(a.Item,{label:"Công việc đang xử lý",name:["powerDistribution","error","currentWork"],children:Et.jsx(o.TextArea,{rows:3})}),Et.jsx(a.Item,{label:"Đề xuất xử lý tiếp theo",name:["powerDistribution","error","nextActions"],children:Et.jsx(o.TextArea,{rows:3})})]})})]}),Et.jsxs("div",{className:"flex justify-end gap-2",children:[Et.jsx(p,{onClick:()=>t("/dc/device-check"),children:"Quay lại"}),Et.jsx(p,{type:"primary",htmlType:"submit",loading:s,children:u?"Cập nhật":"Tạo mới"})]})]})})}):Et.jsx("div",{className:"text-center py-4",children:"Không tìm thấy thông tin ca làm việc"})},{Title:Hi,Text:Wi}=r,qi="https://192.168.1.7",Ki=()=>{const[t,n]=e.useState(!1),[r,s]=e.useState(null),[l,o]=e.useState([]),[c,d]=e.useState(!1),u=mt(),[h,g]=e.useState(null),x=JSON.parse(localStorage.getItem("user")||"{}"),[y]=a.useForm(),[v,b]=e.useState([]),[j,k]=e.useState(!1),[w,C]=e.useState("view"),[S,N]=e.useState(null),[I,_]=e.useState(!1),[D]=a.useForm(),[E,L]=e.useState(!1),[A]=a.useForm(),z=e.useRef(null);e.useEffect(()=>(F(),()=>{z.current&&z.current.abort()}),[]),e.useEffect(()=>(r?.WorkShift?.id&&!c&&P(),()=>{z.current&&z.current.abort()}),[r?.WorkShift?.id]);const F=async()=>{try{n(!0);const e=localStorage.getItem("token");if(!e)return i.error("Phiên đăng nhập đã hết hạn"),void u("/login");z.current&&z.current.abort(),z.current=new AbortController;const t=await Mt.get(qi+"/api/shifts/my-shifts",{headers:{Authorization:"Bearer "+e},signal:z.current.signal});if(t.data?.data?.[0]){const e=t.data.data[0];e.WorkShift.confirmedAt||i.warning("Ca trực chưa được xác nhận. Vui lòng xác nhận nhận ca trước khi bắt đầu làm việc."),s(e)}}catch(e){if("ERR_CANCELED"===e.code||"CanceledError"===e.name)return;404===e.response?.status?i.info("Bạn chưa chọn ca làm việc"):401===e.response?.status?(i.error("Phiên đăng nhập đã hết hạn"),u("/login")):i.error("Không thể tải thông tin ca làm việc")}finally{n(!1)}},P=async()=>{if(r?.WorkShift?.id&&!c)try{d(!0);const e=localStorage.getItem("token");if(!e)return;z.current&&z.current.abort(),z.current=new AbortController;const t={status:["pending","in_progress","completed"],location:r.WorkShift.name,toDate:(new Date).toISOString()};r.WorkShift.confirmedAt&&(t.fromDate=r.WorkShift.confirmedAt);const n=await Mt.get(qi+"/api/tasks",{headers:{Authorization:"Bearer "+e},params:t,signal:z.current.signal});n.data?.tasks?o(n.data.tasks||[]):o([])}catch(e){if("ERR_CANCELED"===e.code||"CanceledError"===e.name)return;401===e.response?.status?(i.error("Phiên đăng nhập đã hết hạn"),u("/login")):i.error("Không thể tải danh sách công việc liên quan")}finally{d(!1)}},M=async e=>{try{const t=localStorage.getItem("token"),n=await Mt.get(`${qi}/api/tasks/${e}/history`,{headers:{Authorization:"Bearer "+t}});n.data?.history&&g(e=>e?{...e,history:n.data.history}:e)}catch(t){i.error("Không thể tải lịch sử công việc")}},O=async e=>{try{const t=await xa(e);return g(t),t}catch(t){return"Token expired"===t.message?(i.error("Phiên đăng nhập đã hết hạn"),void u("/login")):(i.error("Không thể tải thông tin chi tiết"),null)}},R=async(e,t,n=!1,r=null)=>{try{const a=l.find(t=>t.id===e);if(!a)return void i.error("Không tìm thấy công việc");if(a.status===t)return;let s=r;if(!s&&!n){const e={waiting:"Chờ xử lý",pending:"Tạm dừng",in_progress:"Đang thực hiện",completed:"Đã kết thúc",cancelled:"Đã hủy"};s=`Chuyển trạng thái từ "${e[a.status]||a.status}" sang "${e[t]||t}"`}const c=await ba({taskId:e,newStatus:t,reason:s,userId:x.id,system:n});if(n||(i.success("Cập nhật trạng thái thành công"),P()),o(t=>t.map(t=>t.id===e?c:t)),j&&h&&h.id===e){const t=await O(e);t&&g(t)}}catch(a){if("Token expired"===a.message)return i.error("Phiên đăng nhập đã hết hạn"),void u("/login");n||i.error("Không thể cập nhật trạng thái")}},B=h?.history?.filter(e=>e?.changes?.some(e=>"content"===e?.type&&("taskDescription"===e?.field||!e?.field)))?.sort((e,t)=>new Date(e.createdAt)-new Date(t.createdAt));let V="";if(B?.length>0){const e=B[0]?.changes?.find(e=>"content"===e?.type&&("taskDescription"===e?.field||!e?.field)&&e?.oldValue);V=e?.oldValue||""}else V=h?.taskDescription||"";return t?Et.jsx("div",{children:"Đang tải..."}):r?r.WorkShift.confirmedAt?Et.jsxs(Et.Fragment,{children:[Et.jsx("div",{className:"w-full p-0",children:Et.jsxs(f,{variant:"outlined",className:"w-full",children:[Et.jsxs("div",{className:"flex justify-between items-center mb-6",children:[Et.jsx(Hi,{level:4,style:{color:"#003c71",margin:0},children:"Nội dung ca làm việc"}),Et.jsxs(m,{children:["doing"===r?.WorkShift?.status&&Et.jsx(p,{type:"primary",icon:Et.jsx(T,{}),onClick:async()=>{const e=localStorage.getItem("token"),t=localStorage.getItem("user");if(!e||!t)return i.error("Phiên đăng nhập hết hạn. Vui lòng đăng nhập lại."),void u("/login");try{if("datacenter"!==JSON.parse(t).role.toLowerCase())return void i.error("Bạn không có quyền truy cập tính năng này");if(r?.WorkShift?.id)try{const t=(await Mt.get(`${qi}/api/shifts/handover/by-shift/${r.WorkShift.id}`,{headers:{Authorization:"Bearer "+e}})).data.filter(e=>e.fromShiftId===r.WorkShift.id);if(t.length>0){const e=t.sort((e,t)=>{const n={draft:0,pending:1,completed:2,rejected:3};return n[e.status]!==n[t.status]?n[e.status]-n[t.status]:new Date(t.createdAt)-new Date(e.createdAt)})[0];u("/dc/handover/"+e.id),i.info("Đã tìm thấy biên bản bàn giao cho ca này")}else u("/dc/handover/create",{state:{shiftId:r.WorkShift.id}})}catch(n){i.error("Có lỗi khi kiểm tra biên bản bàn giao")}else i.error("Không thể tạo biên bản bàn giao. Vui lòng thử lại sau.")}catch(a){i.error("Dữ liệu người dùng không hợp lệ. Vui lòng đăng nhập lại."),localStorage.clear(),u("/login")}},className:"bg-[#003c71] hover:bg-[#002c51]",children:"Biên bản bàn giao"}),Et.jsx(W,{color:(e=>{switch(e){case"doing":return"success";case"handover":return"warning";case"done":return"error";default:return"default"}})(r.WorkShift.status),style:{fontSize:"16px",padding:"5px 16px"},children:(e=>{switch(e){case"doing":return"Đang làm việc";case"handover":return"Đang bàn giao";case"done":return"Đã kết thúc";default:return"Chưa bắt đầu"}})(r.WorkShift.status)})]})]}),Et.jsxs(Ce,{bordered:!0,column:{xxl:4,xl:3,lg:2,md:2,sm:1,xs:1},className:"w-full",children:[Et.jsx(Ce.Item,{label:"Ca làm việc",children:r.WorkShift.code}),Et.jsx(Ce.Item,{label:"Địa điểm",children:r.WorkShift.name}),Et.jsx(Ce.Item,{label:"Ngày",children:di(r.WorkShift.date)}),Et.jsx(Ce.Item,{label:"Thời điểm bắt đầu",children:r.WorkShift.confirmedAt?di(r.WorkShift.confirmedAt,"HH:mm"):"Chưa xác nhận"})]}),Et.jsxs("div",{className:"mt-6 w-full",children:[Et.jsx(Hi,{level:4,style:{color:"#003c71",margin:0},children:"Thành viên"}),Et.jsx("div",{className:"grid  lg:grid-cols-4 gap-4",children:r.WorkShift.Users?.map(e=>Et.jsx("div",{className:"p-3 bg-gray-50 rounded",children:Et.jsx(Wi,{children:e.fullname})},e.id))})]}),Et.jsxs("div",{className:"mt-6",children:[Et.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Et.jsx(Hi,{level:4,style:{color:"#003c71",margin:0},children:"Công việc liên quan"}),Et.jsx(p,{type:"primary",icon:Et.jsx(fe,{}),onClick:P,loading:c,className:"flex items-center bg-blue-600 hover:bg-blue-600",children:"Làm mới"})]}),Et.jsx(Sa,{tasks:l,loading:c,onView:async e=>{C("view");const t=await O(e.id);g(t),k(!0),M(e.id)},onEdit:async e=>{C("edit"),k(!0);const t=await O(e.id);if(!t)return i.error("Không thể tải thông tin công việc. Vui lòng thử lại sau."),void k(!1);try{await ya(t.id),g({...t,isLocked:!0})}catch(n){return i.warning("Công việc đang được chỉnh sửa bởi người khác"),void C("view")}M(e.id)},getCurrentUserId:()=>x?.id,getCurrentUserRole:()=>Oa(x)})]}),Et.jsx(Ei,{currentShift:r,currentUser:x})]})}),Et.jsx(ha,{modalType:w,modalVisible:j,form:y,selectedTask:h,STATUS_LABELS:vr,handleModalSubmit:()=>Va({form:y,modalType:w,selectedTask:h,removedAttachments:v,createTask:ja,updateTask:ka,message:i,navigate:u,setModalVisible:k,fetchTaskDetail:O,fetchAllTasksData:P,unlockTask:va,setModalType:C,locations:[]}),handleAttachmentRemove:e=>Ua(e,y,b),processFileName:Ia,downloadFile:e=>Pa(e,h,i),setModalVisible:k,unlockTask:va,fetchTaskDetail:O,getCurrentUserRole:()=>Oa(x),showReasonModal:e=>$a(e,N,_,D),setReopenModalVisible:L,sortedHistory:B,firstContent:V,renderChangeContent:Fa,setModalType:C,showModal:(e,t)=>Ba({type:e,task:t,setModalType:C,setSelectedTask:g,setModalVisible:k,setRemovedAttachments:b,fetchTaskDetail:O,getCurrentUserId:()=>Ma(x),lockTask:ya,message:i,form:y}),handleStatusChange:R}),Et.jsx(pa,{pendingAction:S,reasonModalVisible:I,setReasonModalVisible:_,handleReasonSubmit:()=>Ha({reasonForm:D,pendingAction:S,selectedTask:h,handleStatusChange:R,setReasonModalVisible:_}),reopenModalVisible:E,setReopenModalVisible:L,handleReopen:()=>Wa({reopenForm:A,selectedTask:h,getAuthHeader:()=>Ra(u),message:i,navigate:u,setReopenModalVisible:L,fetchTaskDetail:O,fetchAllTasksData:P}),reasonForm:D,reopenForm:A})]}):Et.jsxs("div",{className:"text-center py-8",children:[Et.jsx(Hi,{level:3,children:"Ca trực chưa được xác nhận"}),Et.jsx(Wi,{type:"secondary",children:"Vui lòng xác nhận nhận ca trước khi bắt đầu làm việc"})]}):Et.jsxs("div",{className:"text-center py-8",children:[Et.jsx(Hi,{level:3,children:"Bạn chưa chọn ca làm việc"}),Et.jsx(Wi,{type:"secondary",children:"Vui lòng chọn ca làm việc để xem thông tin chi tiết"})]})},{Option:Yi}=t,Qi=()=>{const[n,r]=e.useState(!1),[s,l]=e.useState([]),[d,h]=e.useState(!1),[g]=a.useForm(),[x,y]=e.useState(null);e.useEffect(()=>{v()},[]);const v=async()=>{try{r(!0);const e=await Mt.get("/api/users/manager/users");l(e.data)}catch(e){i.error("Lỗi khi tải danh sách người dùng")}finally{r(!1)}},b=[{title:"Họ và tên",dataIndex:"fullname",key:"fullname",sorter:(e,t)=>e.fullname.localeCompare(t.fullname)},{title:"Tên đăng nhập",dataIndex:"username",key:"username"},{title:"Ngày sinh",dataIndex:"dob",key:"dob",render:e=>e?K(e).format("DD/MM/YYYY"):"-"},{title:"Giới tính",dataIndex:"gender",key:"gender",render:e=>({male:"Nam",female:"Nữ",other:"Khác"}[e]||"-")},{title:"Vai trò",dataIndex:"role",key:"role",render:e=>{const t={manager:{color:"blue",text:"Quản lý"},datacenter:{color:"green",text:"DataCenter"},be:{color:"orange",text:"Batch Engineer"},admin:{color:"red",text:"Admin"},user:{color:"default",text:"Người dùng"}};return Et.jsx(W,{color:t[e]?.color,children:t[e]?.text})}},{title:"AD User",dataIndex:"isADUser",key:"isADUser",render:e=>Et.jsx(W,{color:e?"green":"default",children:e?"Có":"Không"})},{title:"Thao tác",key:"action",render:(e,t)=>Et.jsxs(m,{children:[Et.jsx(p,{icon:Et.jsx(ae,{}),type:"primary",size:"small",onClick:()=>(e=>{g.setFieldsValue({...e,dob:e.dob?K(e.dob):null}),y(e.id),h(!0)})(t),children:"Sửa"}),Et.jsx(te,{title:"Bạn có chắc chắn muốn xóa người dùng này?",onConfirm:()=>(async e=>{try{await Mt.delete("/api/users/manager/users/"+e),i.success("Xóa người dùng thành công"),v()}catch(t){i.error("Lỗi khi xóa người dùng")}})(t.id),okText:"Xóa",cancelText:"Hủy",children:Et.jsx(p,{icon:Et.jsx(J,{}),type:"primary",danger:!0,size:"small",children:"Xóa"})})]})}];return Et.jsxs("div",{className:"space-y-4",children:[Et.jsx(f,{title:"Danh sách người dùng",extra:Et.jsxs(m,{children:[Et.jsx(o,{placeholder:"Tìm kiếm...",prefix:Et.jsx(De,{}),onChange:e=>{}}),Et.jsx(p,{type:"primary",icon:Et.jsx(Z,{}),onClick:()=>{g.resetFields(),y(null),h(!0)},children:"Thêm người dùng"})]}),children:Et.jsx(H,{columns:b,dataSource:s,rowKey:"id",loading:n})}),Et.jsx($,{title:x?"Chỉnh sửa người dùng":"Thêm người dùng mới",open:d,onCancel:()=>h(!1),footer:null,children:Et.jsxs(a,{form:g,layout:"vertical",onFinish:async e=>{try{const t={...e,dob:e.dob?e.dob.format("YYYY-MM-DD"):null};x?(await Mt.put("/api/users/manager/users/"+x,t),i.success("Cập nhật người dùng thành công")):(await Mt.post("/api/users/manager/users",t),i.success("Thêm người dùng thành công")),h(!1),v()}catch(t){i.error("Lỗi khi lưu thông tin người dùng")}},children:[Et.jsx(a.Item,{name:"fullname",label:"Họ và tên",rules:[{required:!0,message:"Vui lòng nhập họ và tên"}],children:Et.jsx(o,{prefix:Et.jsx(c,{}),placeholder:"Nhập họ và tên"})}),Et.jsx(a.Item,{name:"username",label:"Tên đăng nhập",rules:[{required:!0,message:"Vui lòng nhập tên đăng nhập"}],children:Et.jsx(o,{placeholder:"Nhập tên đăng nhập"})}),!x&&Et.jsx(a.Item,{name:"password",label:"Mật khẩu",rules:[{required:!0,message:"Vui lòng nhập mật khẩu"}],children:Et.jsx(o.Password,{placeholder:"Nhập mật khẩu"})}),Et.jsx(a.Item,{name:"dob",label:"Ngày sinh",children:Et.jsx(u,{format:"DD/MM/YYYY",style:{width:"100%"},placeholder:"Chọn ngày sinh"})}),Et.jsx(a.Item,{name:"gender",label:"Giới tính",children:Et.jsxs(t,{placeholder:"Chọn giới tính",children:[Et.jsx(Yi,{value:"male",children:"Nam"}),Et.jsx(Yi,{value:"female",children:"Nữ"}),Et.jsx(Yi,{value:"other",children:"Khác"})]})}),Et.jsx(a.Item,{name:"role",label:"Vai trò",rules:[{required:!0,message:"Vui lòng chọn vai trò"}],children:Et.jsxs(t,{placeholder:"Chọn vai trò",children:[Et.jsx(Yi,{value:"manager",children:"Quản lý"}),Et.jsx(Yi,{value:"datacenter",children:"DataCenter"}),Et.jsx(Yi,{value:"be",children:"Batch Engineer"}),Et.jsx(Yi,{value:"admin",children:"Admin"}),Et.jsx(Yi,{value:"user",children:"Người dùng"})]})}),Et.jsx(a.Item,{name:"isADUser",label:"AD User",valuePropName:"checked",children:Et.jsx(Ee,{})}),Et.jsx(a.Item,{className:"text-right mb-0",children:Et.jsxs(m,{children:[Et.jsx(p,{onClick:()=>h(!1),children:"Hủy"}),Et.jsx(p,{type:"primary",htmlType:"submit",children:x?"Cập nhật":"Thêm mới"})]})})]})})]})},Xi=({columns:e,dataSource:t,loading:n=!1,pagination:r,onPaginationChange:a,rowKey:i="id",...s})=>{const l={current:r?.page||1,pageSize:r?.limit||15,total:r?.total||0,onChange:a,showSizeChanger:!0,pageSizeOptions:["15","20","50","100"],defaultPageSize:15,showTotal:e=>"Tổng số "+e,locale:{items_per_page:"/ Trang"},...r};return Et.jsx(H,{columns:e,dataSource:t,loading:n,rowKey:i,pagination:l,bordered:!0,defaultSortOrder:"ascend",...s})},Gi=({children:e,variant:t="primary",size:n="middle",icon:r,onClick:a,loading:i=!1,disabled:s=!1,className:l="",...o})=>{const c="#003c71",d={primary:{backgroundColor:c,borderColor:c,color:"white",hover:{backgroundColor:"#002a5a",borderColor:"#002a5a"}},secondary:{backgroundColor:"#2563eb",borderColor:"#2563eb",color:"white",hover:{backgroundColor:"#1d4ed8",borderColor:"#1d4ed8"}},danger:{backgroundColor:"#dc2626",borderColor:"#dc2626",color:"white",hover:{backgroundColor:"#b91c1c",borderColor:"#b91c1c"}}}[t],u="flex items-center gap-2 whitespace-nowrap "+l;return Et.jsx(p,{type:"primary",size:n,icon:r,onClick:a,loading:i,disabled:s,className:u,style:{backgroundColor:d.backgroundColor,borderColor:d.borderColor,color:d.color,...o.style},onMouseEnter:e=>{s||i||(e.target.style.backgroundColor=d.hover.backgroundColor,e.target.style.borderColor=d.hover.borderColor)},onMouseLeave:e=>{s||i||(e.target.style.backgroundColor=d.backgroundColor,e.target.style.borderColor=d.borderColor)},...o,children:e})},Ji=({children:e,onClick:t,icon:n,size:r="small",type:a="primary",className:i="",...s})=>{const l="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white whitespace-nowrap "+i;return Et.jsx(p,{onClick:t,size:r,type:a,icon:n,className:l,...s,children:e})},{TextArea:Zi}=o,{Title:es}=r,ts=()=>{const[t,r]=e.useState(!1),[s,c]=e.useState(!1),[d]=a.useForm(),[u,g]=e.useState(null),[x,y]=e.useState([]),[v,b]=e.useState(!1),[j,k]=e.useState(!1),[w,C]=e.useState(null),[S]=a.useForm(),[N,T]=e.useState([]),[I,_]=e.useState(!1),[D,E]=e.useState(!1),[L,A]=e.useState(null),[z]=a.useForm();e.useEffect(()=>{F(),P(),M()},[]);const F=async()=>{try{r(!0);const e=(await Mt.get("/api/settings/email")).data.data;d.setFieldsValue({email_smtp_host:e.email_smtp_host,email_smtp_port:e.email_smtp_port,email_smtp_secure:e.email_smtp_secure,email_smtp_user:e.email_smtp_user,email_smtp_pass:e.email_smtp_pass,email_smtp_tls_reject_unauthorized:e.email_smtp_tls_reject_unauthorized,email_smtp_debug:e.email_smtp_debug,email_smtp_logger:e.email_smtp_logger})}catch(e){i.error("Lỗi khi tải cấu hình email")}finally{r(!1)}},P=async()=>{try{b(!0);const e=await Mt.get("/api/locations/management/all");y(e.data)}catch(e){i.error("Lỗi khi tải danh sách địa điểm")}finally{b(!1)}},M=async()=>{try{_(!0);const e=await Mt.get("/api/devices/management/all");T(e.data)}catch(e){i.error("Lỗi khi tải danh sách thiết bị")}finally{_(!1)}},O=[{title:"Mã địa điểm",dataIndex:"code",key:"code",className:"custom-header border-gray-200",align:"center",render:e=>e},{title:"Tên địa điểm",dataIndex:"name",key:"name",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e})},{title:"Số ca trong ngày",dataIndex:"index",key:"index",className:"custom-header border-gray-200",align:"center",render:e=>Et.jsxs(W,{color:"blue",children:[e||0," ca"]})},{title:"Mô tả",dataIndex:"description",key:"description",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e})},{title:"Hotline",dataIndex:"hotline",key:"hotline",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e})},{title:"Trạng thái",dataIndex:"isActive",key:"isActive",className:"custom-header border-gray-200",align:"center",render:e=>Et.jsx(W,{color:e?"green":"red",children:e?"Hoạt động":"Không hoạt động"})},{title:"Thao tác",key:"actions",align:"center",className:"custom-header border-gray-200",render:(e,t)=>Et.jsxs(m,{children:[Et.jsx(Ji,{onClick:()=>{return C(e=t),S.setFieldsValue({...e,index:e.index||0,isActive:"boolean"!=typeof e.isActive||e.isActive}),void k(!0);var e},icon:Et.jsx(ae,{}),className:"bg-orange-600 hover:bg-orange-700",children:"Sửa"}),t.isActive?Et.jsx(te,{title:"Bạn có chắc muốn xóa địa điểm này?",onConfirm:()=>(async e=>{try{await Mt.delete("/api/locations/"+e),i.success("Xóa địa điểm thành công"),P()}catch(t){i.error("Lỗi khi xóa địa điểm")}})(t.id),okText:"Có",cancelText:"Không",children:Et.jsx(Ji,{icon:Et.jsx(J,{}),className:"bg-red-600 hover:bg-red-700",children:"Xóa"})}):Et.jsx(te,{title:"Bạn có chắc muốn khôi phục địa điểm này?",onConfirm:()=>(async e=>{try{await Mt.put(`/api/locations/${e}/restore`),i.success("Khôi phục địa điểm thành công"),P()}catch(t){i.error("Lỗi khi khôi phục địa điểm")}})(t.id),okText:"Có",cancelText:"Không",children:Et.jsx(Ji,{icon:Et.jsx(ze,{}),className:"bg-green-600 hover:bg-green-700",children:"Khôi phục"})})]})}],R=[{title:"ID",dataIndex:"id",key:"id",className:"custom-header border-gray-200",align:"center",render:e=>e},{title:"Tên thiết bị",dataIndex:"deviceName",key:"deviceName",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e})},{title:"Danh mục",dataIndex:"category",key:"category",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e})},{title:"Vị trí",dataIndex:"position",key:"position",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e})},{title:"Số Serial",dataIndex:"serialNumber",key:"serialNumber",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e})},{title:"Trạng thái",dataIndex:"isActive",key:"isActive",className:"custom-header border-gray-200",align:"center",render:e=>Et.jsx(W,{color:e?"green":"red",children:e?"Hoạt động":"Không hoạt động"})},{title:"Thao tác",key:"actions",align:"center",className:"custom-header border-gray-200",render:(e,t)=>Et.jsxs(m,{children:[Et.jsx(Ji,{onClick:()=>{return A(e=t),z.setFieldsValue({...e,isActive:"boolean"!=typeof e.isActive||e.isActive}),void E(!0);var e},icon:Et.jsx(ae,{}),className:"bg-orange-600 hover:bg-orange-700",children:"Sửa"}),t.isActive?Et.jsx(te,{title:"Bạn có chắc muốn xóa thiết bị này?",onConfirm:()=>(async e=>{try{await Mt.delete("/api/devices/"+e),i.success("Xóa thiết bị thành công"),M()}catch(t){i.error("Lỗi khi xóa thiết bị")}})(t.id),okText:"Có",cancelText:"Không",children:Et.jsx(Ji,{icon:Et.jsx(J,{}),className:"bg-red-600 hover:bg-red-700",children:"Xóa"})}):Et.jsx(te,{title:"Bạn có chắc muốn khôi phục thiết bị này?",onConfirm:()=>(async e=>{try{await Mt.put(`/api/devices/${e}/restore`),i.success("Khôi phục thiết bị thành công"),M()}catch(t){i.error("Lỗi khi khôi phục thiết bị")}})(t.id),okText:"Có",cancelText:"Không",children:Et.jsx(Ji,{icon:Et.jsx(ze,{}),className:"bg-green-600 hover:bg-green-700",children:"Khôi phục"})})]})}],B=[{key:"email",label:"Cấu hình Email",children:Et.jsxs("div",{className:"space-y-4",children:[Et.jsxs("div",{className:"flex justify-between items-center",children:[Et.jsx(es,{level:4,style:{color:"#003c71",margin:0},children:"Cấu hình SMTP Nội bộ"}),Et.jsxs(m,{children:[Et.jsx(Gi,{variant:"secondary",icon:Et.jsx(_e,{}),onClick:async()=>{try{r(!0),await Mt.post("/api/settings/email/initialize"),i.success("Khởi tạo cấu hình email mặc định thành công"),await F()}catch(e){i.error("Lỗi khi khởi tạo cấu hình email")}finally{r(!1)}},loading:t,children:"Khôi phục mặc định"}),Et.jsx(Gi,{variant:"primary",icon:Et.jsx(he,{}),onClick:async()=>{try{c(!0);const e=await Mt.post("/api/settings/email/test");e.data.success?(g({success:!0,message:e.data.message}),i.success("Kết nối email thành công!")):(g({success:!1,message:e.data.message}),i.error("Kết nối email thất bại!"))}catch(e){g({success:!1,message:"Lỗi khi test kết nối email"}),i.error("Lỗi khi test kết nối email")}finally{c(!1)}},loading:s,children:"Test kết nối"})]})]}),u&&Et.jsx(l,{message:u.success?"Kết nối thành công":"Kết nối thất bại",description:u.message,type:u.success?"success":"error",showIcon:!0,closable:!0}),Et.jsxs(a,{form:d,layout:"vertical",onFinish:async e=>{try{r(!0);const t={email_smtp_host:e.email_smtp_host,email_smtp_port:e.email_smtp_port.toString(),email_smtp_secure:e.email_smtp_secure.toString(),email_smtp_user:e.email_smtp_user,email_smtp_pass:e.email_smtp_pass,email_smtp_tls_reject_unauthorized:e.email_smtp_tls_reject_unauthorized.toString(),email_smtp_debug:e.email_smtp_debug.toString(),email_smtp_logger:e.email_smtp_logger.toString()};await Mt.put("/api/settings/email",{settings:t}),i.success("Cập nhật cấu hình email thành công"),g(null)}catch(t){i.error("Lỗi khi cập nhật cấu hình email")}finally{r(!1)}},children:[Et.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[Et.jsxs("div",{children:[Et.jsx(a.Item,{name:"email_smtp_host",label:"SMTP Host",rules:[{required:!0,message:"Vui lòng nhập SMTP Host"}],children:Et.jsx(o,{placeholder:"10.0.160.29"})}),Et.jsx(a.Item,{name:"email_smtp_port",label:"SMTP Port",rules:[{required:!0,message:"Vui lòng nhập SMTP Port"}],children:Et.jsx(o,{placeholder:"25"})}),Et.jsx(a.Item,{name:"email_smtp_secure",label:"SMTP Secure",valuePropName:"checked",children:Et.jsx(Ee,{})}),Et.jsx(a.Item,{name:"email_smtp_user",label:"SMTP Username",rules:[{required:!0,message:"Vui lòng nhập Username"}],children:Et.jsx(o,{placeholder:"icbv\\dopt"})})]}),Et.jsxs("div",{children:[Et.jsx(a.Item,{name:"email_smtp_pass",label:"SMTP Password",rules:[{required:!0,message:"Vui lòng nhập Password"}],children:Et.jsx(o.Password,{placeholder:"Nhập password"})}),Et.jsx(a.Item,{name:"email_smtp_tls_reject_unauthorized",label:"TLS Reject Unauthorized",valuePropName:"checked",children:Et.jsx(Ee,{})}),Et.jsx(a.Item,{name:"email_smtp_debug",label:"Debug Mode",valuePropName:"checked",children:Et.jsx(Ee,{})}),Et.jsx(a.Item,{name:"email_smtp_logger",label:"Logger",valuePropName:"checked",children:Et.jsx(Ee,{})})]})]}),Et.jsx(h,{}),Et.jsx(a.Item,{className:"text-right",children:Et.jsxs(m,{children:[Et.jsx(p,{onClick:()=>d.resetFields(),children:"Đặt lại"}),Et.jsx(Gi,{variant:"primary",icon:Et.jsx(Le,{}),loading:t,htmlType:"submit",children:"Lưu cấu hình"})]})})]})]})},{key:"locations",label:"Quản lý Địa điểm",children:Et.jsxs("div",{className:"space-y-4",children:[Et.jsxs("div",{className:"flex justify-between items-center",children:[Et.jsx(es,{level:4,style:{color:"#003c71",margin:0},children:"Quản lý địa điểm"}),Et.jsx(Gi,{variant:"primary",icon:Et.jsx(Z,{}),onClick:()=>{C(null),S.resetFields(),S.setFieldsValue({isActive:!0,index:0}),k(!0)},children:"Thêm địa điểm"})]}),Et.jsx(Xi,{columns:O,dataSource:x,loading:v,pagination:{page:1,limit:10,total:x.length},onPaginationChange:(e,t)=>{},rowKey:"code"})]})},{key:"devices",label:"Quản lý Thiết bị",children:Et.jsxs("div",{className:"space-y-4",children:[Et.jsxs("div",{className:"flex justify-between items-center",children:[Et.jsx(es,{level:4,style:{color:"#003c71",margin:0},children:"Quản lý thiết bị"}),Et.jsx(Gi,{variant:"primary",icon:Et.jsx(Z,{}),onClick:()=>{A(null),z.resetFields(),E(!0)},children:"Thêm thiết bị"})]}),Et.jsx(Xi,{columns:R,dataSource:N,loading:I,pagination:{page:1,limit:10,total:N.length},onPaginationChange:(e,t)=>{},rowKey:"id"})]})}];return Et.jsxs("div",{className:"p-0",children:[Et.jsxs(f,{children:[Et.jsx("div",{className:"flex justify-between items-center mb-4",children:Et.jsx(es,{level:4,style:{color:"#003c71",margin:0},children:"Cài đặt hệ thống"})}),Et.jsx(n,{defaultActiveKey:"email",items:B})]}),Et.jsx($,{title:w?"Chỉnh sửa địa điểm":"Thêm địa điểm mới",open:j,onCancel:()=>k(!1),footer:null,width:800,children:Et.jsxs(a,{form:S,layout:"vertical",onFinish:async e=>{try{"boolean"!=typeof e.isActive&&(e.isActive=!0),"number"!=typeof e.index&&(e.index=0),w?(await Mt.put("/api/locations/"+w.id,e),i.success("Cập nhật địa điểm thành công")):(await Mt.post("/api/locations",e),i.success("Thêm địa điểm thành công")),k(!1),P()}catch(t){i.error("Lỗi khi lưu địa điểm")}},children:[Et.jsx(a.Item,{name:"code",label:"Mã địa điểm",rules:[{required:!0,message:"Vui lòng nhập mã địa điểm"},{max:1,message:"Mã địa điểm chỉ được 1 ký tự"}],children:Et.jsx(o,{placeholder:"VD: T, H, V",maxLength:1})}),Et.jsx(a.Item,{name:"name",label:"Tên địa điểm",rules:[{required:!0,message:"Vui lòng nhập tên địa điểm"}],children:Et.jsx(o,{placeholder:"VD: Trần Hưng Đạo, Hòa Lạc, Vân Canh"})}),Et.jsx(a.Item,{name:"index",label:"Số ca trong ngày",rules:[{required:!0,message:"Vui lòng nhập số ca trong ngày"},{type:"number",min:0,max:10,message:"Số ca phải từ 0-10"}],children:Et.jsx(Ae,{placeholder:"VD: 2, 3",min:0,max:10,style:{width:"100%"}})}),Et.jsx(a.Item,{name:"description",label:"Mô tả",children:Et.jsx(Zi,{rows:3,placeholder:"Mô tả chi tiết về địa điểm"})}),Et.jsx(a.Item,{name:"hotline",label:"Hotline",children:Et.jsx(o,{placeholder:"VD: 1900-xxxx"})}),Et.jsx(a.Item,{name:"isActive",label:"Trạng thái hoạt động",valuePropName:"checked",initialValue:!0,children:Et.jsx(Ee,{})}),Et.jsx(a.Item,{className:"text-right",children:Et.jsxs(m,{children:[Et.jsx(p,{onClick:()=>k(!1),children:"Hủy"}),Et.jsx(Gi,{variant:"primary",icon:Et.jsx(Le,{}),htmlType:"submit",children:w?"Cập nhật":"Thêm mới"})]})})]})}),Et.jsx($,{title:L?"Chỉnh sửa thiết bị":"Thêm thiết bị mới",open:D,onCancel:()=>E(!1),footer:null,width:800,children:Et.jsxs(a,{form:z,layout:"vertical",onFinish:async e=>{try{"boolean"!=typeof e.isActive&&(e.isActive=!0),L?(await Mt.put("/api/devices/"+L.id,e),i.success("Cập nhật thiết bị thành công")):(await Mt.post("/api/devices",e),i.success("Thêm thiết bị thành công")),E(!1),M()}catch(t){i.error("Lỗi khi lưu thiết bị")}},children:[Et.jsx(a.Item,{name:"deviceName",label:"Tên thiết bị",rules:[{required:!0,message:"Vui lòng nhập tên thiết bị"}],children:Et.jsx(o,{placeholder:"VD: Hệ thống phân phối điện UPS"})}),Et.jsx(a.Item,{name:"category",label:"Danh mục",rules:[{required:!0,message:"Vui lòng nhập danh mục thiết bị"}],children:Et.jsx(o,{placeholder:"VD: UPS, Làm mát, PCCC"})}),Et.jsx(a.Item,{name:"position",label:"Vị trí",children:Et.jsx(o,{placeholder:"VD: Phòng điều khiển trung tâm"})}),Et.jsx(a.Item,{name:"serialNumber",label:"Số Serial",children:Et.jsx(o,{placeholder:"VD: SN123456789"})}),Et.jsx(a.Item,{name:"isActive",label:"Trạng thái hoạt động",valuePropName:"checked",initialValue:!0,children:Et.jsx(Ee,{})}),Et.jsx(a.Item,{className:"text-right",children:Et.jsxs(m,{children:[Et.jsx(p,{onClick:()=>E(!1),children:"Hủy"}),Et.jsx(Gi,{variant:"primary",icon:Et.jsx(Le,{}),htmlType:"submit",children:L?"Cập nhật":"Thêm mới"})]})})]})})]})},{Title:ns,Text:rs}=r,{RangePicker:as}=u,is=()=>{const[n,r]=e.useState([]),[s,l]=e.useState(!1),[c,d]=e.useState(!1),[u,h]=e.useState(!1),[g]=a.useForm(),[x,y]=e.useState(null),[v,b]=e.useState([]),[j,k]=e.useState([]),[w,C]=e.useState("all"),[S,N]=e.useState("all"),[T,I]=e.useState("Tất cả"),[_,D]=e.useState(null),[E,L]=e.useState({page:1,limit:15,total:0,totalPages:0}),[A,z]=e.useState([]),[F,P]=e.useState(!1),[M,O]=e.useState([]),[R,B]=e.useState([]),[V,U]=e.useState(new Map),[q,Y]=e.useState(!1),[Q,ee]=e.useState(""),[te,ne]=e.useState(""),re=mt(),ae=()=>localStorage.getItem("token");e.useEffect(()=>{const e=ae();e&&(it.defaults.headers.common.Authorization="Bearer "+e)},[]);const ie=()=>{i.error("Phiên làm việc hết hạn. Vui lòng đăng nhập lại."),localStorage.removeItem("token"),re("/login")},se=async(e,t="all",n="all",a=null,s=1,o=15)=>{try{l(!0);const i=ae();if(!i)return void ie();let c="/api/devices/errors";const d=[];if(e&&"all"!==e&&d.push("deviceId="+e),t&&"all"!==t&&d.push("resolveStatus="+t),n&&"Tất cả"!==n&&d.push("location="+n),a&&a[0]&&a[1]){const e=K(a[0]).startOf("day").utc().toISOString(),t=K(a[1]).endOf("day").utc().toISOString();d.push("startDate="+e),d.push("endDate="+t)}d.push("page="+s),d.push("limit="+o),d.length>0&&(c+="?"+d.join("&"));const u=await it.get(c,{headers:{Authorization:"Bearer "+i}}),h=u.data.errors||[];r(h),L(e=>({...e,total:u.data.total||0,totalPages:u.data.totalPages||0,page:s,limit:o}))}catch(c){401===c.response?.status?ie():i.error("Không thể lấy danh sách lỗi")}finally{l(!1)}},le=async e=>{try{const t=ae();if(!t)return void ie();const n=await it.get(`/api/devices/errors/${e}/history`,{headers:{Authorization:"Bearer "+t}});b(n.data)}catch(t){401===t.response?.status?ie():i.error("Không thể lấy lịch sử lỗi")}},oe=[{title:"Mã",dataIndex:"id",key:"id",width:"3%",className:"custom-header border-gray-200",render:e=>e,align:"center"},{title:"Địa điểm",dataIndex:"location",key:"location",width:"6%",className:"custom-header border-gray-200"},{title:"Tên thiết bị",dataIndex:"subDeviceName",key:"subDeviceName",width:"8%",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e})},{title:"Vị trí",dataIndex:"position",key:"position",width:"6%",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e||"Chưa có"})},{title:"Số serial",dataIndex:"serialNumber",key:"serialNumber",width:"8%",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e})},{title:"Mã lỗi",dataIndex:"errorCode",key:"errorCode",width:"8%",className:"custom-header border-gray-200",render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e})},{title:"Nguyên nhân",dataIndex:"errorCause",key:"errorCause",width:"8%",className:"custom-header border-gray-200",ellipsis:!0,render:e=>Et.jsx("div",{className:"whitespace-pre-line break-words",children:e})},{title:"Thời gian tạo",dataIndex:"createdAt",key:"createdAt",width:"5%",className:"custom-header border-gray-200",render:e=>K(e).format(" HH:mm DD/MM/YYYY")},{title:"Trạng thái",dataIndex:"resolveStatus",key:"resolveStatus",width:"4%",align:"center",className:"custom-header border-gray-200",render:e=>Et.jsx(W,{color:vi[e]||"default",className:"whitespace-pre-line break-words flex justify-center",children:e})},{title:"Thao tác",key:"actions",width:"3%",align:"center",className:"custom-header border-gray-200",render:(e,t)=>Et.jsx(m,{children:Et.jsx(p,{onClick:()=>(async e=>{try{const t=ae();if(!t)return void ie();const n=await it.get("/api/devices/errors/"+e.id,{headers:{Authorization:"Bearer "+t}});y(n.data),await le(e.id),d(!0)}catch(t){401===t.response?.status?ie():i.error("Không thể lấy thông tin chi tiết lỗi")}})(t),size:"small",type:"primary",className:"flex items-center gap-2 bg-[#0F60FF] hover:bg-[#0040FF] text-white whitespace-pre-line break-words justify-center",children:"Chi tiết"})})}];return e.useEffect(()=>{P(!0),it.get("/api/locations").then(e=>z(e.data)).catch(()=>z([])).finally(()=>P(!1))},[]),e.useEffect(()=>{(async()=>{try{const e=ae();if(!e)return void ie();const t=await it.get("/api/devices",{headers:{Authorization:"Bearer "+e}});k(t.data)}catch(e){401===e.response?.status?ie():i.error("Không thể lấy danh sách thiết bị")}})(),se(w,S,T,_,1,E.limit)},[]),Et.jsx("div",{className:"p-0",children:Et.jsxs(f,{children:[Et.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Et.jsx(ns,{level:4,style:{color:"#003c71",margin:0},children:"Quản lý sự cố hạ tầng Trung Tâm Dữ Liệu"}),Et.jsx(p,{type:"primary",icon:Et.jsx(Z,{}),onClick:()=>h(!0),style:{backgroundColor:"#003c71",borderColor:"#003c71",color:"white"},children:"Tạo mới"})]}),Et.jsx(f,{style:{marginBottom:"24px"},children:Et.jsxs(X,{gutter:16,align:"middle",children:[Et.jsx(G,{children:Et.jsx(rs,{strong:!0,children:"Thiết bị:"})}),Et.jsx(G,{children:Et.jsx(t,{style:{width:300},placeholder:"Chọn loại thiết bị",onChange:e=>{if(!e)return C("all"),void se("all",S,T,_,1,E.limit);C(e),se(e,S,T,_,1,E.limit)},value:"all"===w?void 0:w,allowClear:!0,children:j.map(e=>Et.jsx(t.Option,{value:e.id,children:e.deviceName},e.id))})}),Et.jsx(G,{children:Et.jsx(rs,{strong:!0,children:"Trạng thái:"})}),Et.jsx(G,{children:Et.jsx(t,{style:{width:180},placeholder:"Chọn trạng thái",value:"all"===S?void 0:S,onChange:e=>{if(!e)return N("all"),void se(w,"all",T,_,1,E.limit);N(e),se(w,e,T,_,1,E.limit)},allowClear:!0,options:ji})}),Et.jsx(G,{children:Et.jsx(rs,{strong:!0,children:"Địa điểm:"})}),Et.jsx(G,{children:Et.jsx(kr,{style:{width:180},value:"Tất cả"===T?void 0:T,onChange:e=>{if(!e)return I("Tất cả"),void se(w,S,"Tất cả",_,1,E.limit);let t=e;if(A.length>0){const n=A.find(t=>t.id===e||t.name===e);n&&(t=n.name)}I(t),se(w,S,t,_,1,E.limit)},placeholder:"Chọn địa điểm",allowClear:!0,locations:A,locationsLoading:F,optionLabelProp:"children",getPopupContainer:e=>e.parentNode,showAllOption:!1})}),Et.jsx(G,{children:Et.jsx(rs,{strong:!0,children:"Thời gian tạo:"})}),Et.jsx(G,{children:Et.jsx(as,{style:{width:300},onChange:e=>{D(e),se(w,S,T,e,1,E.limit)},value:_,format:"DD/MM/YYYY",placeholder:["Từ ngày","Đến ngày"],allowClear:!0,showTime:!1,disabledDate:e=>e&&e>K()})})]})}),Et.jsx(H,{columns:oe,dataSource:n,loading:s,rowKey:"id",pagination:{current:E.page,pageSize:E.limit,total:E.total,onChange:(e,t)=>{L(n=>({...n,page:e,limit:t})),se(w,S,T,_,e,t)},showSizeChanger:!0,pageSizeOptions:["15","20","50","100"],defaultPageSize:15,showTotal:e=>"Tổng số "+e,locale:{items_per_page:"/ Trang"}},bordered:!0,defaultSortOrder:"ascend"}),Et.jsx($,{title:"Tạo mới lỗi thiết bị",open:u,onCancel:()=>{h(!1),g.resetFields()},footer:null,width:800,children:Et.jsxs(a,{form:g,layout:"vertical",onFinish:async e=>{let t=e.location;if(A.length>0&&"Tất cả"!==e.location){const n=A.find(t=>t.id===e.location||t.name===e.location);n&&(t=n.name)}const n={...e,location:t,position:e.position||null,images:R.length>0?JSON.stringify(R):null,dateStart:e.dateStart?K(e.dateStart).toISOString():null,dateEnd:e.dateEnd?K(e.dateEnd).toISOString():null,dateTerminal:e.dateTerminal?K(e.dateTerminal).toISOString():null};try{const e=ae();if(!e)return void ie();await it.post("/api/devices/errors",n,{headers:{Authorization:"Bearer "+e}}),i.success("Tạo lỗi thiết bị thành công"),h(!1),g.resetFields(),O([]),B([]),se(w,S,T,_,1,E.limit)}catch(r){401===r.response?.status?ie():i.error(r.response?.data?.error||"Không thể tạo lỗi")}},children:[Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"deviceId",label:"Thiết bị",rules:[{required:!0,message:"Vui lòng chọn thiết bị"}],children:Et.jsx(t,{placeholder:"Chọn thiết bị",children:j.map(e=>Et.jsx(t.Option,{value:e.id,children:e.deviceName},e.id))})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"location",label:"Địa điểm",rules:[{required:!0,message:"Vui lòng chọn địa điểm"}],children:Et.jsx(kr,{placeholder:"Chọn địa điểm",activeOnly:!0,locations:A,locationsLoading:F,optionLabelProp:"children",getPopupContainer:e=>e.parentNode})})})]}),Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"subDeviceName",label:"Tên thiết bị",rules:[{required:!0,message:"Vui lòng nhập tên thiết bị"}],children:Et.jsx(o,{placeholder:"Nhập tên thiết bị"})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"serialNumber",label:"Số serial",rules:[{required:!0,message:"Vui lòng nhập số serial"}],children:Et.jsx(o,{placeholder:"Nhập số serial"})})})]}),Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"position",label:"Vị trí",rules:[{required:!0,message:"Vui lòng nhập vị trí thiết bị"}],children:Et.jsx(o,{placeholder:"Ví dụ: Rack A1, Slot 2"})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"resolveStatus",label:"Trạng thái",initialValue:fi,children:Et.jsx(t,{options:bi})})})]}),Et.jsx(X,{gutter:16,children:Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"errorCode",label:"Mã lỗi",rules:[{required:!0,message:"Vui lòng nhập mã lỗi"}],children:Et.jsx(o,{placeholder:"Nhập mã lỗi"})})})}),Et.jsx(a.Item,{name:"errorCause",label:"Nguyên nhân",rules:[{required:!0,message:"Vui lòng nhập nguyên nhân"}],children:Et.jsx(o.TextArea,{autoSize:{minRows:1,maxRows:6},placeholder:"Nhập nguyên nhân lỗi"})}),Et.jsx(a.Item,{name:"solution",label:"Giải pháp",rules:[{required:!0,message:"Vui lòng nhập giải pháp"}],children:Et.jsx(o.TextArea,{autoSize:{minRows:1,maxRows:6},placeholder:"Nhập giải pháp khắc phục"})}),Et.jsxs(a.Item,{label:"Hình ảnh lỗi",children:[Et.jsxs("div",{style:{marginBottom:16},children:[Et.jsx("input",{type:"file",multiple:!0,accept:"image/*",style:{display:"none"},id:"multiple-image-upload",onChange:async e=>{const t=Array.from(e.target.files);if(0!==t.length)if(M.length+t.length>10)i.error("Tối đa 10 ảnh!");else{for(const e of t){if(!e.type.startsWith("image/"))return void i.error(`File ${e.name} không phải hình ảnh!`);if(e.size/1024/1024>=5)return void i.error(`File ${e.name} quá lớn (tối đa 5MB)!`)}1===t.length?await(async e=>{try{const t=new FormData;t.append("images",e.originFileObj||e);const n=ae();if(!n)return i.error("Phiên làm việc hết hạn. Vui lòng đăng nhập lại."),!1;const r=await it.post("/api/devices/errors/temp/images",t,{headers:{Authorization:"Bearer "+n,"Content-Type":"multipart/form-data"},timeout:3e4});if(r.data.uploadedUrls&&r.data.uploadedUrls.length>0){i.success(`Upload ${r.data.uploadedUrls.length} hình ảnh thành công`);const t=r.data.uploadedUrls,n=await Promise.all(r.data.uploadedUrls.map(async e=>{try{const t="https://192.168.1.7/api/devices/errors/temp/images/"+e.split("/").pop(),n=ae();if(!n)return t;const r=await it.get(t,{headers:{Authorization:"Bearer "+n},responseType:"blob"});return window.URL.createObjectURL(r.data)}catch(t){return"https://192.168.1.7/api/devices/errors/temp/images/"+e.split("/").pop()}}));O(e=>[...e,...n]),B(e=>[...e,...t]);const a=new Map(V);return t.forEach((t,n)=>{const r=t.split("/").pop(),i=e.uid||`file-${Date.now()}-${n}`;a.set(i,r)}),U(a),r.data.warnings&&r.data.warnings.length>0&&r.data.warnings.forEach(e=>{i.warning(e)}),!0}return i.warning("Không có hình ảnh nào được upload"),!1}catch(t){return 401===t.response?.status?ie():"ECONNABORTED"===t.code?i.error("Upload hình ảnh bị timeout. Vui lòng thử lại."):t.response?.data?.message?i.error(t.response.data.message):i.error("Upload hình ảnh thất bại. Vui lòng thử lại."),!1}})(t[0]):await(async e=>{try{const t=ae();if(!t)return i.error("Phiên làm việc hết hạn. Vui lòng đăng nhập lại."),!1;const n=new FormData;e.forEach(e=>{n.append("images",e.originFileObj||e)});const r=await it.post("/api/devices/errors/temp/images",n,{headers:{Authorization:"Bearer "+t,"Content-Type":"multipart/form-data"},timeout:3e4});if(r.data.uploadedUrls&&r.data.uploadedUrls.length>0){i.success(`Upload thành công ${r.data.uploadedUrls.length} hình ảnh`);const t=r.data.uploadedUrls,n=await Promise.all(r.data.uploadedUrls.map(async e=>{try{const t="https://192.168.1.7/api/devices/errors/temp/images/"+e.split("/").pop(),n=ae();if(!n)return t;const r=await it.get(t,{headers:{Authorization:"Bearer "+n},responseType:"blob"});return window.URL.createObjectURL(r.data)}catch(t){return"https://192.168.1.7/api/devices/errors/temp/images/"+e.split("/").pop()}}));O(e=>[...e,...n]),B(e=>[...e,...t]);const a=new Map(V);return e.forEach((e,n)=>{if(t[n]){const r=t[n].split("/").pop(),i=e.uid||`file-${Date.now()}-${n}`;a.set(i,r)}}),U(a),r.data.warnings&&r.data.warnings.length>0&&r.data.warnings.forEach(e=>{i.warning(e)}),!0}return i.warning("Không có hình ảnh nào được upload"),!1}catch(t){return 401===t.response?.status?ie():"ECONNABORTED"===t.code?i.error("Upload hình ảnh bị timeout. Vui lòng thử lại."):t.response?.data?.message?i.error(t.response.data.message):i.error("Upload hình ảnh thất bại. Vui lòng thử lại."),!1}})(t),e.target.value=""}}}),Et.jsxs(p,{type:"dashed",onClick:()=>document.getElementById("multiple-image-upload").click(),style:{width:"100%",height:100,borderStyle:"dashed"},disabled:M.length>=10,children:[Et.jsx(Z,{}),Et.jsx("div",{style:{marginTop:8},children:"Chọn nhiều ảnh"}),Et.jsxs("div",{style:{fontSize:"12px",color:"#999"},children:[M.length,"/10 ảnh"]})]})]}),Et.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:M.map((e,t)=>Et.jsxs("div",{style:{position:"relative",width:104,height:104},children:[Et.jsx("img",{src:e,alt:"Ảnh "+(t+1),style:{width:"100%",height:"100%",objectFit:"cover",border:"1px solid #d9d9d9",borderRadius:6},onClick:()=>(async e=>{e.url||e.preview||(e.preview=await(e=>new Promise((t,n)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=()=>t(r.result),r.onerror=e=>n(e)}))(e.originFileObj)),ee(e.url||e.preview),Y(!0),ne(e.name||e.url.substring(e.url.lastIndexOf("/")+1))})({url:e,name:"image-"+(t+1)})}),Et.jsx(p,{type:"text",size:"small",danger:!0,icon:Et.jsx(J,{}),style:{position:"absolute",top:4,right:4,background:"rgba(255, 255, 255, 0.9)",border:"none",borderRadius:"50%",width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>(async e=>{try{const t=ae();if(!t)return void i.error("Phiên làm việc hết hạn. Vui lòng đăng nhập lại.");let n="";if(e.url&&e.url.includes("/api/devices/errors/temp/images/"))n=e.url.split("/").pop();else if(e.url&&e.url.startsWith("https://192.168.1.7"))n=e.url.split("/").pop();else if(e.url&&e.url.startsWith("blob:"))if(e.uid&&V.has(e.uid))n=V.get(e.uid);else{let t=null;if(e.uid&&e.uid.startsWith("-")){const n=Math.abs(parseInt(e.uid));if(n<R.length){const e=R.length-1-n;t=R[e]}}else t=R.find(t=>{const n=t.split("/").pop();return e.name===n||e.uid===n});n=t?t.split("/").pop():R.length>0?R[R.length-1].split("/").pop():e.name||"unknown"}else n=e.name||"unknown";if(e.response&&e.response.uploadedUrls&&e.response.uploadedUrls.length>0){const t=e.response.uploadedUrls[0].split("/").pop();t&&t!==n&&(n=t)}const r=await fetch("https://192.168.1.7/api/devices/errors/temp/images/"+encodeURIComponent(n),{method:"DELETE",headers:{Authorization:"Bearer "+t}});if(r.ok){i.success("Xóa hình ảnh thành công"),O(t=>t.filter(t=>t!==e.url));const t=e.url.split("/").pop();if(B(e=>e.filter(e=>!e.includes(t))),e.uid){const t=new Map(V);t.delete(e.uid),U(t)}}else if(401===r.status)ie();else{const e=await r.json();i.error(e.message||"Xóa hình ảnh thất bại")}}catch(t){"TypeError"===t.name&&t.message.includes("fetch")?i.error("Lỗi kết nối. Vui lòng thử lại."):i.error("Xóa hình ảnh thất bại")}})({url:e,uid:"-"+t})})]},t))}),Et.jsx("div",{style:{marginTop:8,fontSize:"12px",color:"#666"},children:"Hỗ trợ: JPG, PNG, GIF, WEBP. Kích thước tối đa: 5MB/ảnh. Có thể chọn nhiều file cùng lúc."})]}),Et.jsx(a.Item,{className:"mb-0 text-right",children:Et.jsxs(m,{children:[Et.jsx(p,{onClick:async()=>{if(M.length>0)try{const t=ae();if(t){for(const n of R){const r=n.split("/").pop();try{await it.delete("/api/devices/errors/temp/images/"+encodeURIComponent(r),{headers:{Authorization:"Bearer "+t}})}catch(e){}}i.success("Đã xóa ảnh tạm thời")}}catch(e){}h(!1),g.resetFields(),O([]),B([]),U(new Map)},children:"Hủy"}),Et.jsx(p,{type:"primary",htmlType:"submit",style:{backgroundColor:"#003c71",borderColor:"#003c71",color:"white"},children:"Tạo mới"})]})})]})}),Et.jsx(Ni,{visible:c,onClose:()=>d(!1),error:x,history:v,onResolve:async e=>{try{const t=ae();if(!t)return void ie();const n={resolveStatus:e.resolveStatus,resolveNote:e.resolveNote,solution:e.solution,errorCause:e.errorCause,subDeviceName:e.subDeviceName,serialNumber:e.serialNumber,errorCode:e.errorCode,position:e.position};"Đã xử lý"===e.resolveStatus&&(n.resolvedAt=new Date),await it.put("/api/devices/errors/"+x.id,n,{headers:{Authorization:"Bearer "+t}}),i.success("Cập nhật lỗi thành công"),se(w,S,T,_,1,E.limit),await le(x.id);const r=await it.get("/api/devices/errors/"+x.id,{headers:{Authorization:"Bearer "+t}});y(r.data.error||r.data)}catch(t){401===t.response?.status?ie():i.error("Không thể cập nhật lỗi")}},onRefresh:()=>se(w,S,T,_,1,E.limit),setSelectedError:y}),Et.jsx($,{open:q,title:te,footer:null,onCancel:()=>Y(!1),children:Et.jsx("img",{alt:"preview",style:{width:"100%"},src:Q})})]})})},ss=()=>{const e=localStorage.getItem("token");return e?{Authorization:"Bearer "+e}:null},ls=async e=>{const t=ss();if(!t)throw Error("Token expired");try{return(await Mt.post("/api/tapes",e,{headers:t})).data}catch(n){throw n}},{Title:os,Text:cs}=r,{RangePicker:ds}=u,us=[{id:12,name:"COMMCELL"}],hs=()=>{const[n,r]=e.useState([]),[s,l]=e.useState(!1),[c,d]=e.useState(!1),[h]=a.useForm(),[g,x]=e.useState({page:1,limit:15,total:0,totalPages:0}),[y,v]=e.useState({location:"all",serverId:"all",dateRange:null}),b=mt(),[j,k]=e.useState([]),w=()=>{i.error("Phiên làm việc hết hạn. Vui lòng đăng nhập lại."),localStorage.removeItem("token"),b("/login")},C=async(e=1,t=15,n=y)=>{try{l(!0);const a={page:e,limit:t};n.location&&"all"!==n.location&&(a.location=n.location),n.serverId&&"all"!==n.serverId&&(a.serverId=n.serverId),n.dateRange&&n.dateRange[0]&&n.dateRange[1]&&(a.dateStart=n.dateRange[0].startOf("day").toISOString(),a.dateEnd=n.dateRange[1].endOf("day").toISOString());const i=await(async e=>{const t=ss();if(!t)throw Error("Token expired");try{return(await Mt.get("/api/tapes",{params:e,headers:t})).data}catch(n){throw n}})(a);r(i.tapes||[]),x(n=>({...n,total:i.total||0,totalPages:i.totalPages||0,page:e,limit:t}))}catch(a){401===a.response?.status?w():i.error("Không thể lấy danh sách tape")}finally{l(!1)}};e.useEffect(()=>{it.get("/api/locations").then(e=>k(e.data)).catch(()=>k([]))},[]);const S=[{title:"ID",dataIndex:"id",key:"id",width:"3%",className:"custom-header border-gray-200",render:e=>e,align:"center",defaultSortOrder:"ascend"},{title:"Barcode",dataIndex:"barcode",key:"barcode",width:"10%",className:"custom-header border-gray-200"},{title:"Nhãn Tape",dataIndex:"label",key:"label",width:"10%",className:"custom-header border-gray-200"},{title:"Dữ liệu",dataIndex:"dbname",key:"dbname",width:"10%",className:"custom-header border-gray-200"},{title:"Nơi lưu",dataIndex:"location",key:"location",width:"10%",className:"custom-header border-gray-200"},{title:"Ngày bắt đầu",dataIndex:"dateStart",key:"dateStart",width:"10%",className:"custom-header border-gray-200",render:e=>e?K(e).format("DD/MM/YYYY"):"-"},{title:"Ngày kết thúc",dataIndex:"dateEnd",key:"dateEnd",width:"10%",className:"custom-header border-gray-200",render:e=>e?K(e).format("DD/MM/YYYY"):"-"},{title:"Ngày cất",dataIndex:"dateTerminal",key:"dateTerminal",width:"10%",className:"custom-header border-gray-200",render:e=>e?K(e).format("DD/MM/YYYY"):"-"},{title:"Người cất",dataIndex:["User","fullname"],key:"user",width:"10%",className:"custom-header border-gray-200"}],N=(e,t)=>{let n=t;if("location"===e&&j.length>0){const e=j.find(e=>e.id===t||e.name===t);e&&(n=e.name)}v(t=>({...t,[e]:n})),x(e=>({...e,page:1}))};return e.useEffect(()=>{C(g.page,g.limit,y)},[g.page,g.limit,y]),Et.jsx("div",{className:"p-0",children:Et.jsxs(f,{children:[Et.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Et.jsx(os,{level:4,style:{color:"#003c71",margin:0},children:"Quản lý Tape"}),Et.jsx(p,{type:"primary",icon:Et.jsx(Z,{}),onClick:()=>d(!0),style:{backgroundColor:"#003c71",borderColor:"#003c71",color:"white"},children:"Tạo mới"})]}),Et.jsx(f,{style:{marginBottom:"24px"},children:Et.jsxs(X,{gutter:16,align:"middle",children:[Et.jsx(G,{children:Et.jsx(cs,{strong:!0,children:"Nơi lưu trữ:"})}),Et.jsx(G,{children:Et.jsxs(t,{style:{width:180},value:y.location,onChange:e=>N("location",e),children:[Et.jsx(t.Option,{value:"all",children:"Tất cả"}),j.map(e=>Et.jsx(t.Option,{value:e.name,children:e.name},e.id))]})}),Et.jsx(G,{children:Et.jsx(cs,{strong:!0,children:"Server:"})}),Et.jsx(G,{children:Et.jsxs(t,{style:{width:180},value:y.serverId,onChange:e=>N("serverId",e),children:[Et.jsx(t.Option,{value:"all",children:"Tất cả server"}),us.map(e=>Et.jsx(t.Option,{value:e.id,children:e.name},e.id))]})}),Et.jsx(G,{children:Et.jsx(cs,{strong:!0,children:"Thời gian tạo:"})}),Et.jsx(G,{children:Et.jsx(ds,{style:{width:300},onChange:e=>{v(t=>({...t,dateRange:e})),x(e=>({...e,page:1}))},value:y.dateRange,format:"DD/MM/YYYY",placeholder:["Từ ngày","Đến ngày"],allowClear:!0,showTime:!1,disabledDate:e=>e&&e>K()})})]})}),Et.jsx(H,{columns:S,dataSource:n,loading:s,rowKey:"id",pagination:{current:g.page,pageSize:g.limit,total:g.total,onChange:(e,t)=>{x(n=>({...n,page:e,limit:t}))},showSizeChanger:!0,pageSizeOptions:["15","20","50","100"],defaultPageSize:15,showTotal:e=>"Tổng số "+e,locale:{items_per_page:"/ Trang"}},bordered:!0,defaultSortOrder:"ascend"}),Et.jsx($,{className:"custom-modal",title:"Lưu tape export",maskClosable:!1,keyboard:!1,open:c,onCancel:()=>{d(!1),h.resetFields()},footer:null,width:1500,children:Et.jsxs(a,{form:h,layout:"vertical",onFinish:async e=>{const t=(e.tapes||[]).map(e=>e.barcode?.trim()).filter(Boolean);if(t.length!==new Set(t).size)return void i.error("Có barcode bị trùng trong danh sách tạo mới!");const n=(e.tapes||[]).map(e=>{let t=e.location;if(j.length>0){const n=j.find(t=>t.id===e.location||t.name===e.location);n&&(t=n.name)}return{...e,location:t,dateStart:e.dateStart?K(e.dateStart).toISOString():null,dateEnd:e.dateEnd?K(e.dateEnd).toISOString():null,dateTerminal:e.dateTerminal?K(e.dateTerminal).toISOString():null}});try{for(const e of n)await ls(e);i.success("Tạo tape thành công"),d(!1),h.resetFields(),C(g.page,g.limit)}catch(r){401===r.response?.status?w():i.error(r.response?.data?.error||"Không thể tạo tape")}},initialValues:{tapes:[{dateTerminal:K(),serverId:12}]},children:[Et.jsx("div",{style:{padding:10,backgroundColor:"#f0f0f0",borderRadius:10,overflow:"auto"},children:Et.jsx(a.List,{name:"tapes",children:(e,{add:n,remove:r})=>Et.jsxs(Et.Fragment,{children:[Et.jsxs(X,{gutter:8,style:{marginBottom:8},children:[Et.jsx(G,{flex:"auto",children:Et.jsx(p,{type:"dashed",onClick:()=>n({dateTerminal:K(),serverId:12}),icon:Et.jsx(Z,{}),children:"Thêm tape"})}),Et.jsx(G,{children:Et.jsx(p,{danger:!0,onClick:()=>{h.setFieldsValue({tapes:[]})},children:"Xóa tất cả"})})]}),Et.jsxs(X,{gutter:8,style:{marginBottom:4,fontWeight:500,color:"#003c71"},align:"middle",children:[Et.jsx(G,{span:3,children:Et.jsx("span",{style:{fontSize:14,color:"#003c71",marginLeft:5},children:"Server"})}),Et.jsx(G,{span:3,children:Et.jsx("span",{style:{fontSize:14,color:"#003c71",marginLeft:5},children:"Barcode"})}),Et.jsx(G,{span:4,children:Et.jsx("span",{style:{fontSize:14,color:"#003c71",marginLeft:5},children:"Nhãn tape"})}),Et.jsx(G,{span:4,children:Et.jsx("span",{style:{fontSize:14,color:"#003c71",marginLeft:5},children:"Dữ liệu"})}),Et.jsx(G,{span:3,children:Et.jsx("span",{style:{fontSize:14,color:"#003c71",marginLeft:5},children:"Nơi lưu"})}),Et.jsx(G,{span:2,children:Et.jsx("span",{style:{fontSize:14,color:"#003c71",marginLeft:5},children:"Bắt đầu"})}),Et.jsx(G,{span:2,children:Et.jsx("span",{style:{fontSize:14,color:"#003c71",marginLeft:5},children:"Kết thúc"})}),Et.jsx(G,{span:2,children:Et.jsx("span",{style:{fontSize:14,color:"#003c71",marginLeft:5},children:"Ngày nhập"})}),Et.jsx(G,{span:1,children:Et.jsx("span",{style:{fontSize:14,color:"#003c71",marginLeft:10}})})]}),e.map(({name:e,...n})=>Et.jsxs(X,{gutter:8,align:"middle",style:{minHeight:36,position:"relative"},children:[Et.jsx(G,{span:3,children:Et.jsx(a.Item,{...n,name:[e,"server"],rules:[{required:!0,message:"Chọn server"}],style:{marginBottom:0},children:Et.jsx(t,{size:"normal",placeholder:"Server",children:us.map(e=>Et.jsx(t.Option,{value:e.id,children:e.name},e.id))})})}),Et.jsx(G,{span:3,children:Et.jsx(a.Item,{...n,name:[e,"barcode"],rules:[{required:!0,message:"Nhập barcode"},{validator:async(e,t)=>t&&await(async e=>{if(!e)return!1;const t=ss();if(!t)throw Error("Token expired");try{return(await Mt.get("/api/tapes/check-barcode",{params:{barcode:e},headers:t})).data.exists}catch(n){throw n}})(t)?Promise.reject("Barcode đã tồn tại!"):Promise.resolve()}],style:{marginBottom:0},children:Et.jsx(o,{size:"normal",placeholder:"Barcode"})})}),Et.jsx(G,{span:4,children:Et.jsx(a.Item,{...n,name:[e,"label"],rules:[{required:!0,message:"Nhập label"}],style:{marginBottom:0},children:Et.jsx(t,{size:"normal",placeholder:"Label",children:Et.jsx(t.Option,{value:"DC-MA-02_ESL01_infinite",children:"DC-MA-02_ESL01_infinite"})})})}),Et.jsx(G,{span:4,children:Et.jsx(a.Item,{...n,name:[e,"dbname"],rules:[{required:!0,message:"Nhập DB"}],style:{marginBottom:0},children:Et.jsx(t,{size:"normal",placeholder:"Dữ liệu",children:Et.jsx(t.Option,{value:"DC-MA-02_ESL01_infinite",children:"DC-MA-02_ESL01_infinite"})})})}),Et.jsx(G,{span:3,children:Et.jsx(a.Item,{...n,name:[e,"location"],rules:[{required:!0,message:"Chọn nơi lưu"}],style:{marginBottom:0},children:Et.jsx(t,{size:"normal",placeholder:"Nơi lưu",children:j.map(e=>Et.jsx(t.Option,{value:e.name,children:e.name},e.id))})})}),Et.jsx(G,{span:2,children:Et.jsx(a.Item,{...n,name:[e,"dateStart"],style:{marginBottom:0},children:Et.jsx(u,{size:"normal",style:{width:"100%"},format:"DD/MM/YYYY",placeholder:"Bắt đầu"})})}),Et.jsx(G,{span:2,children:Et.jsx(a.Item,{...n,name:[e,"dateEnd"],style:{marginBottom:0},children:Et.jsx(u,{size:"normal",style:{width:"100%"},format:"DD/MM/YYYY",placeholder:"Kết thúc"})})}),Et.jsx(G,{span:2,children:Et.jsx(a.Item,{...n,name:[e,"dateTerminal"],style:{marginBottom:0},children:Et.jsx(u,{size:"normal",style:{width:"100%"},format:"DD/MM/YYYY",placeholder:"Ngày nhập"})})}),Et.jsx(G,{span:1,children:Et.jsx(p,{danger:!0,size:"small",onClick:()=>r(e),style:{padding:10,width:28,height:28,marginLeft:10,display:"flex",alignItems:"center",justifyContent:"center",lineHeight:1},icon:Et.jsx(J,{})})})]}))]})})}),Et.jsx(a.Item,{className:"mb-0 text-right",style:{padding:10},children:Et.jsxs(m,{children:[Et.jsx(p,{onClick:()=>{d(!1),h.resetFields()},children:"Hủy"}),Et.jsx(p,{type:"primary",htmlType:"submit",style:{backgroundColor:"#003c71",borderColor:"#003c71",color:"white"},children:"Tạo mới"})]})})]})})]})})},{TabPane:ms}=n,ps=()=>{const t=mt(),[r]=a.useForm(),[s,l]=e.useState(!1),[c,d]=e.useState([]),[u,h]=e.useState("1"),[m,g]=e.useState(null),[x,y]=e.useState(null);e.useEffect(()=>{if(!localStorage.getItem("token"))return i.error("Vui lòng đăng nhập để sử dụng chức năng này!"),void t("/login")},[t]);const v={name:"file",accept:".xlsx,.xls",beforeUpload:e=>"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type||"application/vnd.ms-excel"===e.type?(y(e),!1):(i.error("Chỉ chấp nhận file Excel!"),se.LIST_IGNORE),maxCount:1,onChange:e=>{"done"===e.file.status?i.success(e.file.name+" đã được chọn"):"error"===e.file.status&&i.error(e.file.name+" upload thất bại")},onRemove:()=>{y(null)}},b=()=>{const e={key:Date.now(),ip:"",exportPath:"",username:"",password:""};d([...c,e])},j=(e,t,n)=>{d(c.map(r=>r.key===e?{...r,[t]:n}:r))},k=[{title:"IP",dataIndex:"ip",key:"ip",render:(e,t)=>Et.jsx(o,{value:t.ip,onChange:e=>j(t.key,"ip",e.target.value),placeholder:"Nhập IP"})},{title:"Export Path",dataIndex:"exportPath",key:"exportPath",render:(e,t)=>Et.jsx(o,{value:t.exportPath,onChange:e=>j(t.key,"exportPath",e.target.value),placeholder:"Nhập đường dẫn export"})},{title:"Username",dataIndex:"username",key:"username",render:(e,t)=>Et.jsx(o,{value:t.username,onChange:e=>j(t.key,"username",e.target.value),placeholder:"Nhập username"})},{title:"Password",dataIndex:"password",key:"password",render:(e,t)=>Et.jsx(o.Password,{value:t.password,onChange:e=>j(t.key,"password",e.target.value),placeholder:"Nhập password"})},{title:"Thao tác",key:"action",render:(e,t)=>Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>{return e=t.key,void d(c.filter(t=>t.key!==e));var e}})}];return Et.jsxs("div",{style:{padding:"24px"},children:[Et.jsx("h1",{children:"Kiểm tra Export"}),Et.jsxs(n,{activeKey:u,onChange:h,children:[Et.jsx(ms,{tab:"Upload File Excel",children:Et.jsxs(a,{form:r,layout:"vertical",children:[Et.jsx(a.Item,{name:"file",label:"Chọn file Excel",rules:[{required:!0,message:"Vui lòng chọn file!"}],children:Et.jsx(se,{...v,children:Et.jsx(p,{icon:Et.jsx(le,{}),children:"Chọn file"})})}),Et.jsxs("div",{style:{marginTop:16},children:[Et.jsx("h3",{children:"Thông tin xác thực cho các IP"}),Et.jsx("div",{style:{marginBottom:16},children:Et.jsx(p,{type:"primary",icon:Et.jsx(Z,{}),onClick:b,children:"Thêm IP"})}),Et.jsx(H,{dataSource:c,columns:k,pagination:!1,rowKey:"key"})]})]})},"1"),Et.jsxs(ms,{tab:"Nhập trực tiếp",children:[Et.jsx("div",{style:{marginBottom:16},children:Et.jsx(p,{type:"primary",icon:Et.jsx(Z,{}),onClick:b,children:"Thêm dòng"})}),Et.jsx(H,{dataSource:c,columns:k,pagination:!1,rowKey:"key"})]},"2")]}),Et.jsx("div",{style:{marginTop:24,textAlign:"center"},children:Et.jsx(p,{type:"primary",onClick:async()=>{try{let n;l(!0),g(null);const r=localStorage.getItem("token");if(!r)return i.error("Phiên đăng nhập đã hết hạn. Vui lòng đăng nhập lại!"),void t("/login");if("1"===u){if(!x)return void i.error("Vui lòng chọn file Excel!");const t=new FormData;t.append("excel",x);const a={};c.forEach(e=>{e.ip&&e.username&&e.password&&(a[e.ip]={username:e.username,password:e.password})}),t.append("credentials",JSON.stringify(a));try{n=await it.post("http://192.168.1.12:3001/check-export",t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+r},maxContentLength:1/0,maxBodyLength:1/0,timeout:3e4})}catch(e){return void(e.response?.data?.message?i.error("Lỗi server: "+e.response.data.message):"ECONNABORTED"===e.code?i.error("Server không phản hồi. Vui lòng thử lại sau!"):i.error("Có lỗi xảy ra khi gửi file. Vui lòng thử lại!"))}}else{if(0===c.length)return void i.error("Vui lòng nhập ít nhất một dòng dữ liệu!");const t={};c.forEach(e=>{e.ip&&e.username&&e.password&&(t[e.ip]={username:e.username,password:e.password})});try{n=await it.post("http://192.168.1.12:3001/check-export",{credentials:JSON.stringify(t)},{headers:{"Content-Type":"application/json",Authorization:"Bearer "+r},timeout:3e4})}catch(e){return void(e.response?.data?.message?i.error("Lỗi server: "+e.response.data.message):i.error("Có lỗi xảy ra khi gửi dữ liệu. Vui lòng thử lại!"))}}if(n.data.file){g(n.data);const e=window.URL.createObjectURL(new Blob([n.data.file])),t=document.createElement("a");t.href=e,t.setAttribute("download","export_check_result.xlsx"),document.body.appendChild(t),t.click(),t.remove(),i.success("Đã tải file kết quả!")}else g(n.data),i.success("Kiểm tra hoàn tất!")}catch(e){401===e.response?.status?(i.error("Phiên đăng nhập đã hết hạn. Vui lòng đăng nhập lại!"),t("/login")):i.error("Có lỗi xảy ra: "+(e.response?.data?.message||e.message))}finally{l(!1)}},loading:s,size:"large",disabled:"1"===u&&!x,children:"Kiểm tra"})}),m?Et.jsxs(f,{title:"Kết quả kiểm tra",style:{marginTop:24},children:[Et.jsxs(Ce,{bordered:!0,children:[Et.jsx(Ce.Item,{label:"Tổng số",span:3,children:m.total||0}),Et.jsx(Ce.Item,{label:"Thành công",children:Et.jsx(W,{color:"success",children:m.success||0})}),Et.jsx(Ce.Item,{label:"Thất bại",children:Et.jsx(W,{color:"error",children:m.failed||0})}),Et.jsx(Ce.Item,{label:"Đang xử lý",children:Et.jsx(W,{color:"processing",children:m.processing||0})})]}),m.details&&Et.jsx(H,{dataSource:m.details,columns:[{title:"IP",dataIndex:"ip",key:"ip"},{title:"Export Path",dataIndex:"exportPath",key:"exportPath"},{title:"Trạng thái",dataIndex:"status",key:"status",render:e=>Et.jsx(W,{color:"success"===e?"success":"failed"===e?"error":"processing",children:"success"===e?"Thành công":"failed"===e?"Thất bại":"Đang xử lý"})},{title:"Thông báo",dataIndex:"message",key:"message"}],style:{marginTop:16}}),m.file&&Et.jsx("div",{style:{marginTop:16,textAlign:"center"},children:Et.jsx(p,{type:"primary",icon:Et.jsx(Te,{}),onClick:()=>{const e=window.URL.createObjectURL(new Blob([m.file])),t=document.createElement("a");t.href=e,t.setAttribute("download","export_check_result.xlsx"),document.body.appendChild(t),t.click(),t.remove()},children:"Tải lại file kết quả"})})]}):null]})},{Title:fs,Text:gs}=r,xs=({visible:t,onCancel:n,partner:r})=>{const[a,i]=e.useState(!1),[s,l]=e.useState([]),[o,d]=e.useState({current:1,pageSize:10,total:0}),[u,h]=e.useState({total:0,completed:0,inProgress:0,pending:0,cancelled:0}),p=async(e=1,t=10)=>{if(r?.id){i(!0);try{const n=await(async(e,{page:t=1,limit:n=10,status:r}={})=>{const a={Authorization:"Bearer "+localStorage.getItem("token")},i={page:t,limit:n,timestamp:Date.now()};return r&&(i.status=r),(await Mt.get(`/api/partners/${e}/tasks`,{params:i,headers:a})).data})(r.id,{page:e,limit:t});l(n.tasks||[]),d({current:n.currentPage||1,pageSize:t,total:n.total||0});const a={total:n.total||0,completed:0,inProgress:0,pending:0,cancelled:0};(n.tasks||[]).forEach(e=>{switch(e.status){case"completed":a.completed++;break;case"in_progress":a.inProgress++;break;case"pending":case"waiting":a.pending++;break;case"cancelled":a.cancelled++}}),h(a)}catch(n){}finally{i(!1)}}};e.useEffect(()=>{t&&r?.id&&p()},[t,r?.id]);const g=[{title:"ID",dataIndex:"id",key:"id",width:80,className:"custom-header border-gray-200",render:e=>Et.jsxs(gs,{code:!0,children:["#",e]})},{title:"Nội dung công việc",dataIndex:"taskTitle",key:"taskTitle",className:"custom-header border-gray-200",render:(e,t)=>Et.jsxs("div",{children:[Et.jsx("div",{style:{fontWeight:500},children:e||"Không có tiêu đề"}),t.taskDescription&&Et.jsx(gs,{type:"secondary",style:{fontSize:"12px"},children:t.taskDescription.length>50?t.taskDescription.substring(0,50)+"...":t.taskDescription})]})},{title:"Địa điểm",dataIndex:"location",key:"location",className:"custom-header border-gray-200",render:e=>Et.jsxs(m,{children:[Et.jsx(Pe,{}),Et.jsx(gs,{children:e||"Không xác định"})]})},{title:"Người tạo",dataIndex:"creator",key:"creator",className:"custom-header border-gray-200",render:e=>Et.jsxs(m,{children:[Et.jsx(c,{}),Et.jsx(gs,{children:e?.fullname||"Không xác định"})]})},{title:"Thời gian bắt đầu",dataIndex:"checkInTime",key:"checkInTime",className:"custom-header border-gray-200",render:e=>Et.jsxs(m,{children:[Et.jsx(N,{}),Et.jsx(gs,{children:e?ui(e):"-"})]})},{title:"Trạng thái",dataIndex:"status",key:"status",className:"custom-header border-gray-200",render:e=>{const t={completed:{color:"success",icon:Et.jsx(he,{}),text:"Hoàn thành"},in_progress:{color:"processing",icon:Et.jsx(ue,{}),text:"Đang thực hiện"},pending:{color:"warning",icon:Et.jsx(_,{}),text:"Chờ xử lý"},waiting:{color:"warning",icon:Et.jsx(_,{}),text:"Chờ xử lý"},cancelled:{color:"error",icon:Et.jsx(Ie,{}),text:"Đã hủy"}},n=t[e]||t.pending;return Et.jsx(W,{color:n.color,icon:n.icon,children:n.text})}}];return Et.jsxs($,{title:Et.jsxs("div",{children:[Et.jsx(fs,{level:4,style:{margin:0},children:"Danh sách công việc của đối tác"}),r&&Et.jsxs(gs,{type:"secondary",children:[r.fullname," - ",r.donVi]})]}),open:t,onCancel:n,footer:null,width:1200,destroyOnHidden:!0,children:[Et.jsx(f,{style:{marginBottom:16},children:Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:4,children:Et.jsx(me,{title:"Tổng số công việc",value:u.total,prefix:Et.jsx(ue,{})})}),Et.jsx(G,{span:4,children:Et.jsx(me,{title:"Đã hoàn thành",value:u.completed,valueStyle:{color:"#3f8600"},prefix:Et.jsx(he,{})})}),Et.jsx(G,{span:4,children:Et.jsx(me,{title:"Đang thực hiện",value:u.inProgress,valueStyle:{color:"#1890ff"},prefix:Et.jsx(ue,{})})}),Et.jsx(G,{span:4,children:Et.jsx(me,{title:"Chờ xử lý",value:u.pending,valueStyle:{color:"#faad14"},prefix:Et.jsx(_,{})})}),Et.jsx(G,{span:4,children:Et.jsx(me,{title:"Đã hủy",value:u.cancelled,valueStyle:{color:"#cf1322"},prefix:Et.jsx(Ie,{})})})]})}),Et.jsx(H,{columns:g,bordered:!0,dataSource:s,rowKey:"id",pagination:{...o,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`${t[0]}-${t[1]} của ${e} công việc`},onChange:e=>{p(e.current,e.pageSize)},loading:a,locale:{emptyText:Et.jsx(Fe,{description:"Không có công việc nào",image:Fe.PRESENTED_IMAGE_SIMPLE})},scroll:{x:1e3}})]})},{Title:ys,Text:vs}=r,{RangePicker:bs}=u,js=()=>{const[n,r]=e.useState([]),[s,l]=e.useState(!1),[u,h]=e.useState(!1),[g,x]=e.useState(!1),[y]=a.useForm(),[v,b]=e.useState(null),[j,w]=e.useState(""),[C,S]=e.useState("Tất cả"),[N,T]=e.useState(null),[I,_]=e.useState({page:1,limit:15,total:0,totalPages:0}),[D,E]=e.useState([]),[L,A]=e.useState(!1),[z,F]=e.useState(!1),P=mt(),M=()=>localStorage.getItem("token");e.useEffect(()=>{const e=M();e&&(it.defaults.headers.common.Authorization="Bearer "+e)},[]);const O=()=>{i.error("Phiên làm việc hết hạn. Vui lòng đăng nhập lại."),localStorage.removeItem("token"),P("/login")},R=async(e="",t="Tất cả",n=null,a=1,s=15)=>{try{l(!0);const i=M();if(!i)return void O();let o="/api/partners";const c=[];if(e&&e.trim()&&c.push("keyword="+encodeURIComponent(e.trim())),t&&"Tất cả"!==t&&c.push("donVi="+encodeURIComponent(t)),n&&n[0]&&n[1]){const e=K(n[0]).startOf("day").utc().toISOString(),t=K(n[1]).endOf("day").utc().toISOString();c.push("startDate="+e),c.push("endDate="+t)}c.push("page="+a),c.push("limit="+s),c.length>0&&(o+="?"+c.join("&"));const d=await it.get(o,{headers:{Authorization:"Bearer "+i}});r(d.data.partners||d.data||[]),_(e=>({...e,total:d.data.total||0,totalPages:d.data.totalPages||0,page:a,limit:s}))}catch(o){401===o.response?.status?O():i.error("Không thể lấy danh sách")}finally{l(!1)}},B=async()=>{try{const e=M();if(!e)return void O();const t=await it.get("/api/partners/donvi",{headers:{Authorization:"Bearer "+e}});E(t.data||[])}catch(e){}},V=e.useCallback(la(e=>{w(e),_(e=>({...e,page:1})),R(e,C,N,1,I.limit)},300),[C,N,I.limit]),U=e=>{b(e),y.setFieldsValue({fullname:e.fullname,donVi:e.donVi,email:e.email,phone:e.phone,cccd:e.cccd}),x(!0)},W=(e,t)=>{_(n=>({...n,page:e,limit:t})),R(j,C,N,e,t)},q=e=>{b(e),A(!0)},{currentUser:Y}=Kt(),Q="manager"===Y?.role?.toLowerCase();Y?.role?.toLowerCase();const J=e.useMemo(()=>[{title:"Mã",dataIndex:"id",key:"id",width:"3%",className:"custom-header border-gray-200",render:e=>""+e,align:"center",defaultSortOrder:"ascend"},{title:"Họ tên",dataIndex:"fullname",key:"fullname",width:"15%",className:"custom-header border-gray-200",render:e=>Et.jsxs("div",{className:"flex items-center",children:[Et.jsx(c,{className:"mr-2 text-blue-500"}),Et.jsx("span",{className:"font-medium",children:e})]})},{title:"Đơn vị",dataIndex:"donVi",key:"donVi",width:"15%",className:"custom-header border-gray-200",render:e=>Et.jsxs("div",{className:"flex items-center",children:[Et.jsx(Me,{className:"mr-2 text-green-500"}),Et.jsx("span",{children:e||"Chưa có"})]})},{title:"Số thẻ / CCCD",dataIndex:"cccd",key:"cccd",width:"12%",className:"custom-header border-gray-200",render:e=>Et.jsxs("div",{className:"flex items-center",children:[Et.jsx(Oe,{className:"mr-2 text-purple-500"}),Et.jsx("span",{children:e||"Chưa có"})]})},{title:"Email",dataIndex:"email",key:"email",width:"15%",className:"custom-header border-gray-200",render:e=>Et.jsxs("div",{className:"flex items-center",children:[Et.jsx(d,{className:"mr-2 text-orange-500"}),Et.jsx("span",{children:e||"Chưa có"})]})},{title:"Số điện thoại",dataIndex:"phone",key:"phone",width:"12%",className:"custom-header border-gray-200",render:e=>Et.jsxs("div",{className:"flex items-center",children:[Et.jsx(Re,{className:"mr-2 text-green-600"}),Et.jsx("span",{children:e||"Chưa có"})]})},{title:"Thao tác",key:"actions",width:"5%",align:"center",className:"custom-header border-gray-200",render:(e,t)=>Et.jsxs(m,{children:[Q&&Et.jsx(k,{title:"Xem danh sách công việc",children:Et.jsx(p,{type:"primary",size:"small",icon:Et.jsx(ke,{}),onClick:()=>q(t),style:{backgroundColor:"#1890ff",borderColor:"#1890ff"},children:"Công việc"})}),Et.jsx(k,{title:"Chỉnh sửa",children:Et.jsx(p,{onClick:()=>U(t),size:"small",type:"primary",icon:Et.jsx(ae,{}),style:{backgroundColor:"#1890ff",borderColor:"#1890ff"},children:"Sửa"})})]})}],[q,U,async e=>{try{const t=M();if(!t)return void O();await it.delete("/api/partners/"+e,{headers:{Authorization:"Bearer "+t}}),i.success("Xóa đối tác thành công"),R(j,C,N,I.page,I.limit)}catch(t){401===t.response?.status?O():i.error(t.response?.data?.message||"Không thể xóa đối tác")}}]),ee=e.useMemo(()=>({current:I.page,pageSize:I.limit,total:I.total,onChange:W,showSizeChanger:!0,pageSizeOptions:["15","20","50","100"],defaultPageSize:15,showTotal:e=>`Tổng số ${e} đối tác`,locale:{items_per_page:"/ Trang"}}),[I.page,I.limit,I.total,W]),te=e.useMemo(()=>[{value:"Tất cả",label:"Tất cả đơn vị"},...D.map(e=>({value:e,label:e}))],[D]);return e.useEffect(()=>{z||(F(!0),Promise.all([B(),R()]).catch(e=>{}))},[z]),Et.jsx("div",{className:"p-0",children:Et.jsxs(f,{children:[Et.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Et.jsx(ys,{level:4,style:{color:"#003c71",margin:0},children:"Quản lý nhân sự ra vào Trung Tâm Dữ Liệu"}),Et.jsx(p,{type:"primary",icon:Et.jsx(Z,{}),onClick:()=>h(!0),style:{backgroundColor:"#003c71",borderColor:"#003c71",color:"white"},children:"Tạo mới"})]}),Et.jsx(f,{style:{marginBottom:"24px"},children:Et.jsxs(X,{gutter:16,align:"middle",children:[Et.jsx(G,{children:Et.jsx(vs,{strong:!0,children:"Tìm kiếm:"})}),Et.jsx(G,{children:Et.jsx(o,{placeholder:"Nhập tên, email, số điện thoại...",prefix:Et.jsx(De,{}),style:{width:300},onChange:e=>{return t=e.target.value,void V(t);var t},allowClear:!0,onClear:()=>{w(""),R("",C,N,1,I.limit)}})}),Et.jsx(G,{children:Et.jsx(vs,{strong:!0,children:"Đơn vị:"})}),Et.jsx(G,{children:Et.jsx(t,{style:{width:200},value:C,onChange:e=>{S(e),_(e=>({...e,page:1})),R(j,e,N,1,I.limit)},placeholder:"Chọn đơn vị",allowClear:!0,children:te.map(e=>Et.jsx(t.Option,{value:e.value,children:e.label},e.value))})})]})}),Et.jsx(H,{columns:J,dataSource:n,loading:s,rowKey:"id",pagination:ee,bordered:!0,defaultSortOrder:"ascend"}),Et.jsx(_r,{visible:u,onCancel:()=>h(!1),onSuccess:()=>{h(!1),R(j,C,N,I.page,I.limit)},title:"Tạo nhân sự mới"}),Et.jsx($,{title:"Chỉnh sửa đối tác",open:g,onCancel:()=>{x(!1),y.resetFields()},footer:null,width:600,children:Et.jsxs(a,{form:y,layout:"vertical",onFinish:async e=>{try{const t=M();if(!t)return void O();const n={...e,fullname:e.fullname.trim(),donVi:e.donVi?.trim()||"",email:e.email?.trim()||"",phone:e.phone?.trim()||"",cccd:e.cccd?.trim()||""};await it.put("/api/partners/"+v.id,n,{headers:{Authorization:"Bearer "+t}}),i.success("Cập nhật thành công"),x(!1),y.resetFields(),b(null),R(j,C,N,I.page,I.limit)}catch(t){if(401===t.response?.status)O();else if(400===t.response?.status&&t.response?.data?.errors){const e=t.response.data.errors;Array.isArray(e)?i.error(e.join("\n")):i.error(e)}else 404===t.response?.status?i.error("Không tìm thấy đối tác để cập nhật"):500===t.response?.status?i.error("Lỗi hệ thống. Vui lòng thử lại sau."):i.error(t.response?.data?.message||"Không thể cập nhật đối tác")}},children:[Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"fullname",label:"Họ tên",rules:[{required:!0,message:"Vui lòng nhập họ tên"}],children:Et.jsx(o,{placeholder:"Nhập họ tên đối tác"})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"donVi",label:"Đơn vị",children:Et.jsx(o,{placeholder:"Nhập đơn vị"})})})]}),Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"email",label:"Email",rules:[{type:"email",message:"Email không đúng định dạng"}],children:Et.jsx(o,{placeholder:"Nhập email"})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"phone",label:"Số điện thoại",rules:[{pattern:/^[0-9+\-\s()]{10,15}$/,message:"Số điện thoại không đúng định dạng"}],children:Et.jsx(o,{placeholder:"Nhập số điện thoại"})})})]}),Et.jsx(a.Item,{name:"cccd",label:"Số thẻ / CCCD",rules:[{pattern:/^\d{1,12}$/,message:"Số thẻ / CCCD phải có 1 đến 12 chữ số"}],children:Et.jsx(o,{placeholder:"Nhập số thẻ / CCCD (1 đến 12 số)"})}),Et.jsx(a.Item,{className:"mb-0 text-right",children:Et.jsxs(m,{children:[Et.jsx(p,{onClick:()=>{x(!1),y.resetFields()},children:"Hủy"}),Et.jsx(p,{type:"primary",htmlType:"submit",style:{backgroundColor:"#003c71",borderColor:"#003c71",color:"white"},children:"Cập nhật"})]})})]})}),Et.jsx(xs,{visible:L,onCancel:()=>A(!1),partner:v})]})})},ks=({image:t,systemInfoId:n,style:r,onLoad:a,onError:i})=>{const[l,o]=e.useState(null),[c,d]=e.useState(!0),[u,h]=e.useState(!1);return e.useEffect(()=>{let e;return n&&t.filename&&(async()=>{try{d(!0),h(!1);const r=localStorage.getItem("token"),i=await fetch(`https://192.168.1.7/api/system-info/${n}/files/${encodeURIComponent(t.path||t.filename)}`,{headers:{Authorization:"Bearer "+r}});if(!i.ok)throw Error("Fetch image failed");const s=await i.blob();e=window.URL.createObjectURL(s),o(e),a&&a()}catch(r){h(!0),i&&i()}finally{d(!1)}})(),()=>{e&&window.URL.revokeObjectURL(e)}},[n,t.filename,a,i]),c?Et.jsx("div",{style:{...r,display:"flex",alignItems:"center",justifyContent:"center",background:"#f0f0f0",borderRadius:"4px"},children:Et.jsx(s,{size:"large"})}):u?Et.jsxs("div",{style:{...r,display:"flex",alignItems:"center",justifyContent:"center",background:"#f0f0f0",borderRadius:"4px",color:"#999",fontSize:"14px"},children:[Et.jsx(_,{style:{marginRight:8}}),"Lỗi tải ảnh"]}):Et.jsx("img",{src:l,alt:t.originalName,style:r})},ws={headerControls:{position:"absolute",top:16,left:16,right:16,zIndex:1e3,display:"flex",justifyContent:"space-between",alignItems:"center",background:"rgba(0, 0, 0, 0.8)",padding:"8px 16px",borderRadius:"8px",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.1)",transition:"all 0.3s ease"},bottomControls:{position:"absolute",bottom:16,left:16,right:16,zIndex:1e3,display:"flex",justifyContent:"center",alignItems:"center",gap:16,background:"rgba(0, 0, 0, 0.8)",padding:"12px 16px",borderRadius:"8px",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.1)",transition:"all 0.3s ease"},navigationButton:{position:"absolute",top:"50%",transform:"translateY(-50%)",background:"rgba(0, 0, 0, 0.8)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"#fff",zIndex:1e3,transition:"all 0.3s ease","&:hover":{background:"rgba(0, 0, 0, 0.9)",borderColor:"rgba(255, 255, 255, 0.4)",transform:"translateY(-50%) scale(1.1)"}},imageContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",position:"relative",overflow:"hidden",transition:"cursor 0.2s ease"},imageWrapper:{transition:"transform 0.2s ease-out",transformOrigin:"center center",willChange:"transform"},helpPanel:{position:"absolute",top:"50%",right:16,transform:"translateY(-50%)",background:"rgba(0, 0, 0, 0.9)",padding:"12px",borderRadius:"8px",color:"#fff",fontSize:"12px",lineHeight:"1.4",maxWidth:"200px",zIndex:1e3,border:"1px solid rgba(255, 255, 255, 0.1)",backdropFilter:"blur(10px)",opacity:.8,transition:"opacity 0.3s ease","&:hover":{opacity:1}}},Cs=({visible:t,images:n,title:r,index:a,onClose:i,onPrev:s,onNext:l,onDownload:o,onSetIndex:c,systemInfoId:d})=>{const[u,h]=e.useState(1),[f,g]=e.useState(0),[x,y]=e.useState(!1),[v,b]=e.useState({x:0,y:0}),[j,w]=e.useState(!1),[C,S]=e.useState({x:0,y:0}),[N,T]=e.useState(!1),[I,_]=e.useState(!1);e.useEffect(()=>{t&&(h(1),g(0),b({x:0,y:0}),y(!1),T(!1),_(!0))},[t,a]);const E=e.useCallback(e=>{if(t)switch(e.key){case"ArrowLeft":e.preventDefault(),s();break;case"ArrowRight":e.preventDefault(),l();break;case"Escape":e.preventDefault(),i();break;case"f":case"F":e.preventDefault(),y(!x);break;case"+":case"=":e.preventDefault(),h(e=>Math.min(e+.25,5));break;case"-":e.preventDefault(),h(e=>Math.max(e-.25,.25));break;case"0":e.preventDefault(),h(1),b({x:0,y:0});break;case"r":case"R":e.preventDefault(),g(e=>(e+90)%360);break;case"h":case"H":e.preventDefault(),T(!N)}},[t,x,N,s,l,i]),L=e.useCallback(e=>{if(!t)return;e.preventDefault();const n=e.deltaY>0?-.25:.25;h(e=>Math.max(.25,Math.min(5,e+n)))},[t]),A=e.useCallback(e=>{u>1&&(w(!0),S({x:e.clientX-v.x,y:e.clientY-v.y}))},[u,v]),z=e.useCallback(e=>{j&&u>1&&b({x:e.clientX-C.x,y:e.clientY-C.y})},[j,C,u]),F=e.useCallback(()=>{w(!1)},[]);if(e.useEffect(()=>{if(t)return document.addEventListener("keydown",E),document.addEventListener("wheel",L,{passive:!1}),document.addEventListener("mousemove",z),document.addEventListener("mouseup",F),()=>{document.removeEventListener("keydown",E),document.removeEventListener("wheel",L),document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",F)}},[t,E,L,z,F]),!t||!n||0===n.length)return null;const P=n[a];return Et.jsxs($,{open:t,footer:null,onCancel:i,width:x?"100vw":1e3,styles:{body:{padding:x?0:24,background:"#000",height:x?"100vh":"auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},mask:{background:"rgba(0, 0, 0, 0.95)"},wrapper:{zIndex:9999}},style:{top:x?0:void 0,padding:x?0:void 0,maxWidth:x?"100vw":"90vw"},children:[Et.jsxs("div",{style:ws.headerControls,children:[Et.jsx("div",{style:{color:"#fff",fontSize:"14px"},children:Ia(P)||r}),Et.jsxs(m,{children:[Et.jsx(k,{title:"Phím tắt: R",children:Et.jsx(p,{type:"text",icon:Et.jsx(Be,{}),onClick:()=>g(e=>(e-90)%360),style:{color:"#fff"}})}),Et.jsx(k,{title:"Phím tắt: H",children:Et.jsx(p,{type:"text",icon:Et.jsx(D,{}),onClick:()=>T(!N),style:{color:"#fff"}})}),Et.jsx(k,{title:"Phím tắt: F",children:Et.jsx(p,{type:"text",icon:x?Et.jsx(Ve,{}):Et.jsx(Ue,{}),onClick:()=>{y(!x)},style:{color:"#fff"}})}),Et.jsx(k,{title:"Phím tắt: ESC",children:Et.jsx(p,{type:"text",icon:Et.jsx($e,{}),onClick:i,style:{color:"#fff"}})})]})]}),Et.jsxs("div",{style:{...ws.imageContainer,cursor:u>1?"grab":"default"},onMouseDown:A,children:[n.length>1&&Et.jsxs(Et.Fragment,{children:[Et.jsx(k,{title:"Phím tắt: ←",children:Et.jsx(p,{type:"text",icon:Et.jsx(xe,{}),onClick:s,style:{...ws.navigationButton,left:16}})}),Et.jsx(k,{title:"Phím tắt: →",children:Et.jsx(p,{type:"text",icon:Et.jsx(ye,{}),onClick:l,style:{...ws.navigationButton,right:16}})})]}),Et.jsx("div",{style:{...ws.imageWrapper,transform:`translate(${v.x}px, ${v.y}px) scale(${u}) rotate(${f}deg)`,transition:j?"none":"transform 0.2s ease-out"},children:Et.jsx(ks,{image:P,systemInfoId:d,style:{maxWidth:x?"90vw":"80vw",maxHeight:x?"90vh":"70vh",objectFit:"contain",background:"#000",borderRadius:"4px"},onLoad:()=>_(!1),onError:()=>_(!1)})})]}),Et.jsxs("div",{style:ws.bottomControls,children:[Et.jsxs(m,{children:[Et.jsx(k,{title:"Phím tắt: -",children:Et.jsx(p,{type:"text",icon:Et.jsx(He,{}),onClick:()=>h(e=>Math.max(e-.25,.25)),disabled:.25>=u,style:{color:"#fff"}})}),Et.jsxs("div",{style:{color:"#fff",minWidth:"60px",textAlign:"center"},children:[Math.round(100*u),"%"]}),Et.jsx(k,{title:"Phím tắt: +",children:Et.jsx(p,{type:"text",icon:Et.jsx(We,{}),onClick:()=>h(e=>Math.min(e+.25,5)),disabled:u>=5,style:{color:"#fff"}})})]}),Et.jsx(qe,{min:.25,max:5,step:.25,value:u,onChange:h,style:{width:120,margin:"0 16px"},tooltip:{formatter:e=>Math.round(100*e)+"%"}}),Et.jsxs(m,{children:[Et.jsx(k,{title:"Reset view (Phím tắt: 0)",children:Et.jsx(p,{type:"text",onClick:()=>{h(1),g(0),b({x:0,y:0})},style:{color:"#fff"},children:"Reset"})}),Et.jsx(k,{title:"Tải xuống",children:Et.jsx(p,{type:"primary",icon:Et.jsx(Te,{}),onClick:()=>o(P),children:"Tải xuống"})})]}),n.length>1&&Et.jsxs("div",{style:{color:"#fff",fontSize:"14px",background:"rgba(0, 0, 0, 0.5)",padding:"4px 8px",borderRadius:"4px",border:"1px solid rgba(255, 255, 255, 0.2)"},children:[a+1," / ",n.length]})]}),N&&Et.jsxs("div",{style:ws.helpPanel,children:[Et.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px"},children:"Phím tắt:"}),Et.jsx("div",{children:"← → : Chuyển ảnh"}),Et.jsx("div",{children:"+ - : Zoom in/out"}),Et.jsx("div",{children:"0 : Reset view"}),Et.jsx("div",{children:"R : Xoay ảnh"}),Et.jsx("div",{children:"F : Fullscreen"}),Et.jsx("div",{children:"H : Ẩn/hiện help"}),Et.jsx("div",{children:"ESC : Đóng"}),Et.jsxs("div",{style:{marginTop:"8px",fontSize:"11px",opacity:.7},children:["Mouse wheel: Zoom",Et.jsx("br",{}),"Drag: Di chuyển ảnh"]})]})]})},{Title:Ss,Paragraph:Ns,Text:Ts}=r,Is={title:"Hệ thống UPS (Uninterruptible Power Supply)",subtitle:"Hệ thống cung cấp điện liên tục cho trung tâm dữ liệu",content:"# Hệ thống UPS (Uninterruptible Power Supply)\n\n## Mục đích\nHệ thống UPS đảm bảo cung cấp điện liên tục cho các thiết bị quan trọng trong trung tâm dữ liệu, bảo vệ khỏi các sự cố điện và đảm bảo hoạt động ổn định.\n\n- Cung cấp điện dự phòng khi mất điện lưới\n- Lọc và ổn định điện áp\n- Bảo vệ thiết bị khỏi sự cố điện\n- Đảm bảo thời gian chuyển đổi nhanh chóng\n\n## ... (bạn có thể bổ sung thêm nội dung mẫu ở đây) ..."},_s=({image:t,systemInfoId:n,style:r,onClick:a})=>{const[i,l]=e.useState(null),[o,c]=e.useState(!0),[d,u]=e.useState(!1);return e.useEffect(()=>{let e;return n&&t.filename&&(async()=>{try{c(!0),u(!1);const r=localStorage.getItem("token"),a=await fetch(`https://192.168.1.7/api/system-info/${n}/files/${t.filename}`,{headers:{Authorization:"Bearer "+r}});if(!a.ok)throw Error("Fetch image failed");const i=await a.blob();e=window.URL.createObjectURL(i),l(e)}catch(r){u(!0)}finally{c(!1)}})(),()=>{e&&window.URL.revokeObjectURL(e)}},[n,t.filename]),o?Et.jsx("div",{style:{...r,display:"flex",alignItems:"center",justifyContent:"center",background:"#f0f0f0",borderRadius:"4px"},children:Et.jsx(s,{size:"large"})}):d?Et.jsxs("div",{style:{...r,display:"flex",alignItems:"center",justifyContent:"center",background:"#f0f0f0",borderRadius:"4px",color:"#999",fontSize:"14px"},children:[Et.jsx(_,{style:{marginRight:8}}),"Lỗi tải ảnh"]}):Et.jsx("img",{src:i,alt:t.originalName,style:r,onClick:e=>{a&&a(e)}})},Ds=()=>{const[t,n]=e.useState(null),[r,a]=e.useState([]),[i,d]=e.useState(!0),[u,h]=e.useState(!1),[g,x]=e.useState(null),[y,v]=e.useState(""),{systemType:b}=gt(),{currentUser:j}=Kt(),k=mt(),[w,C]=e.useState(!1),[S,T]=e.useState(0),[I,_]=e.useState([]),[E,L]=e.useState(""),A=e=>{const t=(()=>{if(!j)return"/dc";const e=j.role?.toLowerCase();switch(e){case"manager":return"/manager";case"be":return"/be";default:return"/dc"}})();k(`${t}/system-info/${e}`)};e.useEffect(()=>{h(!1),b?(async()=>{d(!0),x(null),h(!1);try{const e=await Pn("/api/system-info/type/"+(b||"ups"));if(e.data.success&&e.data.data){const t=e.data.data;let r=t.content;if("string"==typeof r)try{r=JSON.parse(r)}catch{r={}}return r&&0!==Object.keys(r).length||(r={purpose:{description:t.purpose||"",items:[],files:[]},components:{items:[],files:[]},operation:{normal:{steps:[],files:[]},backup:{steps:[],files:[]}},procedures:{items:[],files:[]},troubleshooting:{description:t.troubleshooting||"",items:[],files:[]}}),n({...t,content:r}),void h(!0)}const t=await Pn("/api/system-info");if(t.data.success&&Array.isArray(t.data.data)){const e=t.data.data.find(e=>e.systemType?.toLowerCase()===b?.toLowerCase());if(e){let t=e.content;if("string"==typeof t)try{t=JSON.parse(t)}catch{t={}}return n({...e,content:t}),void h(!0)}}n(Is),h(!0)}catch(e){404===e.response?.status?(n(Is),h(!0)):x("Lỗi kết nối server. Vui lòng thử lại sau.")}finally{d(!1)}})():(async()=>{d(!0),x(null),h(!1);try{const e=await Pn("/api/system-info");e.data.success&&Array.isArray(e.data.data)?(a(e.data.data),h(!0)):x("Không lấy được danh sách hệ thống.")}catch{x("Lỗi kết nối server. Vui lòng thử lại sau.")}finally{d(!1)}})()},[b]);const z=t||Is,F=z.content&&"object"==typeof z.content?z.content.general?.files?z.content.general.files:z.content.general?.files||[]:[],P=e=>{const t=[],n=[];return e.forEach(e=>{let r=e;e.response&&(r=e.response),r.mimetype&&r.mimetype.startsWith("image/")?t.push(r):n.push(r)}),{images:t,documents:n}},M=P(F).images,O=P(F).documents;let R=null;function B(e){return Array.isArray(e)?e.filter(e=>null!=e):[]}z&&z.content&&"object"==typeof z.content&&(R=z.content),R&&(R.purpose&&Array.isArray(R.purpose.items)&&(R.purpose.items=B(R.purpose.items)),R.components&&Array.isArray(R.components.items)&&(R.components.items=B(R.components.items)),R.operation&&(R.operation.normal&&Array.isArray(R.operation.normal.steps)&&(R.operation.normal.steps=B(R.operation.normal.steps)),R.operation.backup&&Array.isArray(R.operation.backup.steps)&&(R.operation.backup.steps=B(R.operation.backup.steps))),R.procedures&&Array.isArray(R.procedures.items)&&(R.procedures.items=B(R.procedures.items)),R.troubleshooting&&Array.isArray(R.troubleshooting.items)&&(R.troubleshooting.items=B(R.troubleshooting.items)));const V=async e=>{try{if(!e.path)return;const n=await Pn(`/api/system-info/${t.id}/files/${encodeURIComponent(e.path)}`,{responseType:"blob"}),r=new Blob([n.data],{type:e.mimetype||"application/octet-stream"}),a=window.URL.createObjectURL(r),i=document.createElement("a");i.href=a,i.download=Ia(e),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(a)}catch(n){}},U=async e=>{try{if(!e.path)return;const n=await Pn(`/api/system-info/${t.id}/files/${encodeURIComponent(e.path)}`,{responseType:"blob"}),r=new Blob([n.data],{type:e.mimetype||"application/octet-stream"}),a=window.URL.createObjectURL(r),i=document.createElement("a");i.href=a,i.download=Ia(e),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(a)}catch(n){}},$=(e,t,n=0)=>{_(e),L(t),T(n),C(!0)};return b?i||!u?Et.jsxs("div",{style:{padding:"24px",textAlign:"center"},children:[Et.jsx(s,{size:"large"}),Et.jsx("div",{style:{marginTop:"16px"},children:"Đang tải thông tin hệ thống..."})]}):g&&!t?Et.jsxs("div",{style:{padding:"24px",textAlign:"center"},children:[Et.jsx(l,{message:"Lỗi",description:g,type:"error",showIcon:!0}),Et.jsx(p,{type:"primary",style:{marginTop:"16px"},onClick:()=>k(-1),children:"Quay lại"})]}):Et.jsxs("div",{style:{padding:"24px",maxWidth:"1200px",margin:"0 auto"},children:[void 0,Et.jsxs("div",{style:{textAlign:"center",marginBottom:"32px"},children:[Et.jsxs(Ss,{level:1,style:{color:"#1890ff",marginBottom:"8px"},children:[Et.jsx(Ke,{style:{marginRight:"12px"}}),z.title]}),Et.jsx(Ts,{type:"secondary",style:{fontSize:"16px"},children:z.subtitle}),(H=j?.username,["dce1","dopt"].includes(H?.toLowerCase())&&t&&t.id&&Et.jsx("div",{style:{marginTop:"16px"},children:Et.jsx(p,{type:"primary",icon:Et.jsx(ae,{}),style:{backgroundColor:"#003c71",borderColor:"#003c71"},onClick:()=>{let e="/dc";"manager"===j?.role?.toLowerCase()&&(e="/manager"),"be"===j?.role?.toLowerCase()&&(e="/be"),k(`${e}/system-info/edit/${t.id}`)},children:"Chỉnh sửa nội dung"})}))]}),R?Et.jsxs(Et.Fragment,{children:[R.purpose&&Et.jsxs(f,{title:"🎯 "+(R.purpose.title||"Mục đích"),style:{marginBottom:"24px"},children:[Et.jsx(Ns,{style:{fontSize:"16px",lineHeight:"1.6"},children:R.purpose.description}),R.purpose.items&&Et.jsx(Ne,{dataSource:R.purpose.items,renderItem:e=>Et.jsx(Ne.Item,{style:{border:"none",padding:"4px 0"},children:Et.jsxs(Ts,{children:["• ",e]})})})]}),R.components&&Et.jsx(f,{title:"🔧 "+(R.components.title||"Thành phần chính"),style:{marginBottom:"24px"},children:Et.jsx(X,{gutter:[16,16],children:R.components.items?.map((e,n)=>Et.jsx(G,{xs:24,md:12,children:Et.jsxs(f,{size:"small",title:e.name,style:{height:"100%"},children:[Et.jsxs(Ns,{children:[Et.jsx(Ts,{strong:!0,children:"Chức năng:"})," ",e.description]}),e.tag&&Et.jsx(W,{color:"blue",children:e.tag}),e.images&&e.images.filter(e=>e.filename).length>0&&Et.jsxs("div",{style:{marginTop:"16px"},children:[Et.jsx(Ts,{strong:!0,children:"Hình ảnh:"}),Et.jsx(X,{gutter:[8,8],style:{marginTop:"8px"},children:e.images.filter(e=>e.filename).map((n,r)=>Et.jsx(G,{span:8,children:Et.jsx(_s,{image:n,systemInfoId:t?.id,style:{width:"100%",height:"80px",objectFit:"cover",cursor:"pointer",borderRadius:"4px"},onClick:()=>{$(e.images.filter(e=>e.filename),e.name,r)}})},r))})]}),e.documents&&e.documents.filter(e=>e.filename).length>0&&Et.jsxs("div",{style:{marginTop:"16px"},children:[Et.jsx(Ts,{strong:!0,children:"Tài liệu:"}),Et.jsx(Ne,{size:"small",dataSource:e.documents.filter(e=>e.filename),renderItem:e=>Et.jsx(Ne.Item,{style:{padding:"4px 0"},children:Et.jsxs(m,{children:[Et.jsx(D,{}),Et.jsx(Ts,{children:Ia(e)}),Et.jsx(p,{type:"link",size:"small",icon:Et.jsx(Te,{}),onClick:()=>U(e),children:"Tải"})]})})})]})]})},n))})}),R.procedures&&Et.jsxs(f,{title:"📋 "+(R.procedures.title||"Quy trình vận hành"),style:{marginBottom:"24px"},children:[Et.jsx(Ns,{style:{fontSize:"16px",lineHeight:"1.6",marginBottom:"16px"},children:R.procedures.description}),Et.jsx(Ne,{dataSource:R.procedures.items,renderItem:e=>Et.jsx(Ne.Item,{children:Et.jsxs(f,{size:"small",title:e.title,style:{width:"100%"},children:[Et.jsx(Ne,{size:"small",dataSource:e.steps,renderItem:(e,t)=>Et.jsx(Ne.Item,{style:{border:"none",padding:"4px 0"},children:Et.jsxs(Ts,{children:[t+1,". ",e]})})}),e.images&&e.images.filter(e=>e.filename).length>0&&Et.jsxs("div",{style:{marginTop:"16px"},children:[Et.jsx(Ts,{strong:!0,children:"Hình ảnh:"}),Et.jsx(X,{gutter:[8,8],style:{marginTop:"8px"},children:e.images.filter(e=>e.filename).map((n,r)=>Et.jsx(G,{span:8,children:Et.jsx(_s,{image:n,systemInfoId:t?.id,style:{width:"100%",height:"80px",objectFit:"cover",cursor:"pointer",borderRadius:"4px"},onClick:()=>{$(e.images.filter(e=>e.filename),e.title,r)}})},r))})]}),e.documents&&e.documents.filter(e=>e.filename).length>0&&Et.jsxs("div",{style:{marginTop:"16px"},children:[Et.jsx(Ts,{strong:!0,children:"Tài liệu:"}),Et.jsx(Ne,{size:"small",dataSource:e.documents.filter(e=>e.filename),renderItem:e=>Et.jsx(Ne.Item,{style:{padding:"4px 0"},children:Et.jsxs(m,{children:[Et.jsx(D,{}),Et.jsx(Ts,{children:Ia(e)}),Et.jsx(p,{type:"link",size:"small",icon:Et.jsx(Te,{}),onClick:()=>U(e),children:"Tải"})]})})})]})]})})})]}),R.operation&&Et.jsxs(f,{title:"⚡ "+(R.operation.title||"Nguyên lý hoạt động"),style:{marginBottom:"24px"},children:[Et.jsx(Ns,{style:{fontSize:"16px",lineHeight:"1.6",marginBottom:"16px"},children:R.operation.description}),Et.jsx(X,{gutter:[24,16],children:R.operation.items&&R.operation.items.map((e,n)=>Et.jsx(G,{xs:24,md:12,children:Et.jsxs(f,{size:"small",title:e.title,style:{height:"100%"},children:[Et.jsx(Ns,{style:{marginBottom:"16px"},children:e.description}),Et.jsx(Ne,{size:"small",dataSource:e.steps,renderItem:(e,t)=>Et.jsx(Ne.Item,{style:{border:"none",padding:"4px 0"},children:Et.jsxs(Ts,{children:[t+1,". ",e]})})}),e.images&&e.images.filter(e=>e.filename).length>0&&Et.jsxs("div",{style:{marginTop:"16px"},children:[Et.jsx(Ts,{strong:!0,children:"Hình ảnh:"}),Et.jsx(X,{gutter:[8,8],style:{marginTop:"8px"},children:e.images.filter(e=>e.filename).map((n,r)=>Et.jsx(G,{span:8,children:Et.jsx(_s,{image:n,systemInfoId:t?.id,style:{width:"100%",height:"80px",objectFit:"cover",cursor:"pointer",borderRadius:"4px"},onClick:()=>{$(e.images.filter(e=>e.filename),e.title,r)}})},r))})]}),e.documents&&e.documents.filter(e=>e.filename).length>0&&Et.jsxs("div",{style:{marginTop:"16px"},children:[Et.jsx(Ts,{strong:!0,children:"Tài liệu:"}),Et.jsx(Ne,{size:"small",dataSource:e.documents.filter(e=>e.filename),renderItem:e=>Et.jsx(Ne.Item,{style:{padding:"4px 0"},children:Et.jsxs(m,{children:[Et.jsx(D,{}),Et.jsx(Ts,{children:Ia(e)}),Et.jsx(p,{type:"link",size:"small",icon:Et.jsx(Te,{}),onClick:()=>U(e),children:"Tải"})]})})})]})]})},n))})]})]}):Et.jsx(f,{title:"📄 Nội dung chi tiết",style:{marginBottom:"24px"},children:Et.jsx(p,{type:"primary",onClick:()=>{$([{filename:"test.jpg",originalName:"Test Image"}],"Test Image",0)},style:{marginBottom:16},children:"Test Modal Preview"})}),R&&R.troubleshooting&&Et.jsxs(f,{title:"⚠️ "+(R.troubleshooting.title||"Sự cố thường gặp"),style:{marginBottom:"24px"},children:[Et.jsx(Ns,{style:{fontSize:"16px",lineHeight:"1.6",marginBottom:"16px"},children:R.troubleshooting.description}),Et.jsx(l,{message:"Lưu ý: Luôn tuân thủ quy trình an toàn khi xử lý sự cố",type:"warning",showIcon:!0,style:{marginBottom:"16px"}}),Et.jsx(X,{gutter:[16,16],children:R.troubleshooting?.items?.map((e,n)=>Et.jsx(G,{xs:24,md:12,children:Et.jsxs(f,{size:"small",title:e.problem,style:{height:"100%"},children:[Et.jsxs(Ns,{children:[Et.jsx(Ts,{strong:!0,children:"Nguyên nhân:"})," ",e.cause]}),Et.jsxs(Ns,{children:[Et.jsx(Ts,{strong:!0,children:"Cách xử lý:"})," ",e.solution]}),void 0,e.images&&e.images.filter(e=>e.filename).length>0&&Et.jsxs("div",{style:{marginTop:"16px"},children:[Et.jsx(Ts,{strong:!0,children:"Hình ảnh liên quan:"}),Et.jsx(X,{gutter:[8,8],style:{marginTop:"8px"},children:e.images.filter(e=>e.filename).map((n,r)=>Et.jsx(G,{span:8,children:Et.jsx(_s,{image:n,systemInfoId:t?.id,style:{width:"100%",height:"80px",objectFit:"cover",cursor:"pointer",borderRadius:"4px"},onClick:()=>{$(e.images.filter(e=>e.filename),e.problem,r)}})},r))})]}),e.documents&&e.documents.filter(e=>e.filename).length>0&&Et.jsxs("div",{style:{marginTop:"16px"},children:[Et.jsx(Ts,{strong:!0,children:"Tài liệu liên quan:"}),Et.jsx(Ne,{size:"small",dataSource:e.documents.filter(e=>e.filename),renderItem:e=>Et.jsx(Ne.Item,{style:{padding:"4px 0"},children:Et.jsxs(m,{children:[Et.jsx(D,{}),Et.jsx(Ts,{children:Ia(e)}),Et.jsx(p,{type:"link",size:"small",icon:Et.jsx(Te,{}),onClick:()=>U(e),children:"Tải"})]})})})]})]})},n))})]}),O.length>0&&Et.jsx(f,{title:"📄 Tài liệu đính kèm",style:{marginBottom:"24px"},children:Et.jsx(Ne,{dataSource:O,renderItem:e=>Et.jsxs(Ne.Item,{style:{padding:"4px",border:"1px solid #f0f0f0",borderRadius:"8px",marginBottom:"8px",backgroundColor:"#fafafa",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Et.jsxs(m,{children:[Et.jsx(D,{style:{fontSize:"18px",color:"#1890ff"}}),Et.jsx(Ts,{strong:!0,style:{fontSize:"14px"},children:Ia(e)})]}),Et.jsx(p,{type:"primary",icon:Et.jsx(Te,{}),size:"small",onClick:()=>U(e),style:{backgroundColor:"#52c41a",borderColor:"#52c41a",borderRadius:"6px"},children:"Tải xuống"})]})})}),M.length>0&&Et.jsx(f,{title:"🖼️ Hình ảnh",style:{marginBottom:"24px"},children:Et.jsx(X,{gutter:[16,16],children:M.map((e,n)=>Et.jsx(G,{xs:24,md:8,children:Et.jsxs(f,{size:"small",hoverable:!0,children:[Et.jsx(_s,{image:e,systemInfoId:t?.id,style:{width:"100%",height:"200px",objectFit:"cover",cursor:"pointer"},onClick:()=>$(M,"Tài liệu chung",n)}),Et.jsxs("div",{style:{marginTop:"8px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Et.jsx(Ts,{type:"secondary",children:Ia(e)}),Et.jsx(p,{type:"link",icon:Et.jsx(Te,{}),onClick:()=>V(e),style:{marginLeft:8},children:"Download"})]})]})},"general-"+n))})}),void 0,void 0,void 0,void 0,void 0,Et.jsx(Cs,{visible:w,images:I,title:E,index:S,onClose:()=>C(!1),onPrev:()=>{T((S-1+I.length)%I.length)},onNext:()=>{T((S+1)%I.length)},onDownload:V,onSetIndex:T,systemInfoId:t?.id}),Et.jsx(f,{style:{background:"#fafafa"},children:Et.jsx(m,{direction:"vertical",size:"small",style:{width:"100%"},children:Et.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"16px"},children:[Et.jsxs(m,{children:[Et.jsx(N,{}),Et.jsxs(Ts,{type:"secondary",children:["Cập nhật lần cuối: ",z.updatedAt?new Date(z.updatedAt).toLocaleDateString("vi-VN"):"Chưa cập nhật"]})]}),Et.jsxs(m,{children:[Et.jsx(c,{}),Et.jsxs(Ts,{type:"secondary",children:["Người cập nhật: ",z.updater?.fullname||"Không xác định"]})]})]})})})]}):Et.jsxs("div",{style:{padding:"24px",maxWidth:"1200px",margin:"0 auto"},children:[Et.jsxs(Ss,{level:2,style:{color:"#1890ff",marginBottom:24},children:[Et.jsx(Ke,{style:{marginRight:12}}),"Danh sách hệ thống kỹ thuật trung tâm dữ liệu"]}),Et.jsx(o,{placeholder:"Tìm kiếm theo tên hệ thống...",prefix:Et.jsx(De,{}),style:{marginBottom:24,maxWidth:400},allowClear:!0,value:y,onChange:e=>v(e.target.value)}),i||!u?Et.jsx(s,{size:"large"}):g?Et.jsx(l,{message:"Lỗi",description:g,type:"error",showIcon:!0}):Et.jsxs(X,{gutter:[24,24],children:[Et.jsx(G,{xs:24,md:12,children:Et.jsx(f,{title:"Hệ thống chính (ID: 1-8)",style:{marginBottom:"16px"},children:r.filter(e=>e.id>=1&&8>=e.id).filter(e=>!y||e.title?.toLowerCase().includes(y.toLowerCase())||e.subtitle?.toLowerCase().includes(y.toLowerCase())).map((e,t)=>Et.jsx(f,{size:"small",title:""+e.title,extra:Et.jsx(p,{type:"link",icon:Et.jsx(ke,{}),onClick:()=>A(e.systemType),children:"Xem"}),style:{marginBottom:"12px"},hoverable:!0,children:Et.jsx(Ns,{type:"secondary",style:{marginBottom:"8px"},children:e.subtitle})},e.id||t))})}),Et.jsx(G,{xs:24,md:12,children:Et.jsx(f,{title:"Hệ thống phụ trợ (ID: 9-15)",style:{marginBottom:"16px"},children:r.filter(e=>e.id>=9&&15>=e.id).filter(e=>!y||e.title?.toLowerCase().includes(y.toLowerCase())||e.subtitle?.toLowerCase().includes(y.toLowerCase())).map((e,t)=>Et.jsx(f,{size:"small",title:`${e.id}. ${e.title}`,extra:Et.jsx(p,{type:"link",icon:Et.jsx(ke,{}),onClick:()=>A(e.systemType),children:"Xem"}),style:{marginBottom:"12px"},hoverable:!0,children:Et.jsx(Ns,{type:"secondary",style:{marginBottom:"8px"},children:e.subtitle})},e.id||t))})})]})]});var H},{Title:Es,Text:Ls}=r,{TextArea:As}=o,{Option:zs}=t,Fs=()=>{const[n,r]=e.useState([]),[s,c]=e.useState(!1),[d,u]=e.useState(!1),[g,x]=e.useState(null),[y]=a.useForm(),v=mt(),{currentUser:b}=Kt(),j=[{value:"UPS_DISTRIBUTION",label:"Hệ thống phân phối điện UPS"},{value:"UPS",label:"Hệ thống UPS"},{value:"COOLING",label:"Hệ thống làm mát"},{value:"VIDEO_SURVEILLANCE",label:"Hệ thống giám sát hình ảnh"},{value:"ACCESS_CONTROL",label:"Hệ thống kiểm soát truy cập"},{value:"FIRE_PROTECTION",label:"PCCC"},{value:"INFRASTRUCTURE_MONITORING",label:"Hệ thống giám sát hạ tầng TTDL"}],[k,w]=e.useState({purpose:{description:"",items:[],files:[]},components:{items:[],files:[]},operation:{normal:{steps:[],files:[]},backup:{steps:[],files:[]}},procedures:{items:[],files:[]},troubleshooting:{items:[],files:[]}}),C=async()=>{c(!0);try{const e=await Pn("/api/system-info/list");e.data.success&&r(e.data.data)}catch{i.error("Lỗi tải danh sách hệ thống")}finally{c(!1)}};e.useEffect(()=>{C()},[]);const S=async(e,t)=>{if(g)try{await Rn(`/api/system-info/${g.id}/files/${e}/${t}`),"images"===e&&w(e=>({...e,purpose:{...e.purpose,files:e.purpose.files.filter(e=>e.filename!==t)}})),"documents"===e&&w(e=>({...e,components:{...e.components,files:e.components.files.filter(e=>e.filename!==t)}})),i.success("Xóa file thành công")}catch{i.error("Xóa file thất bại")}},N=[{title:"Loại hệ thống",dataIndex:"systemType",key:"systemType",render:e=>{const t=j.find(t=>t.value===e);return Et.jsx(W,{color:"blue",children:t?.label||e})}},{title:"Tiêu đề",dataIndex:"title",key:"title",render:e=>Et.jsx(Ls,{strong:!0,children:e})},{title:"Mô tả",dataIndex:"subtitle",key:"subtitle",ellipsis:!0},{title:"Hình ảnh",dataIndex:"content",key:"images",render:e=>{let t=0;if(e)try{const n="string"==typeof e?JSON.parse(e):e;Object.values(n).forEach(e=>{e.files&&e.files.forEach(e=>{e.mimetype&&e.mimetype.startsWith("image/")&&t++})})}catch{t=0}return 0===t?Et.jsx(Ls,{type:"secondary",children:"Không có"}):Et.jsxs(m,{children:[Et.jsx(Qe,{}),Et.jsxs(Ls,{children:[t," hình"]})]})}},{title:"Tài liệu",dataIndex:"content",key:"documents",render:e=>{let t=0;if(e)try{const n="string"==typeof e?JSON.parse(e):e;Object.values(n).forEach(e=>{e.files&&e.files.forEach(e=>{e.mimetype&&e.mimetype.startsWith("image/")||t++})})}catch{t=0}return 0===t?Et.jsx(Ls,{type:"secondary",children:"Không có"}):Et.jsxs(m,{children:[Et.jsx(D,{}),Et.jsxs(Ls,{children:[t," tài liệu"]})]})}},{title:"Cập nhật bởi",dataIndex:["updater","fullname"],key:"updater"},{title:"Ngày cập nhật",dataIndex:"updatedAt",key:"updatedAt",render:e=>new Date(e).toLocaleDateString("vi-VN")},{title:"Thao tác",key:"actions",render:(e,t)=>Et.jsxs(m,{children:[Et.jsx(p,{type:"link",icon:Et.jsx(ae,{}),onClick:()=>(e=>{let t="/dc";"manager"===b?.role?.toLowerCase()&&(t="/manager"),"be"===b?.role?.toLowerCase()&&(t="/be"),v(`${t}/system-info/edit/${e.id}`)})(t),children:"Sửa"}),Et.jsx(te,{title:"Bạn có chắc muốn xóa hệ thống này?",onConfirm:()=>(async e=>{try{await Rn("/api/system-info/"+e),i.success("Xóa thành công"),C()}catch{i.error("Lỗi xóa hệ thống")}})(t.id),okText:"Có",cancelText:"Không",children:Et.jsx(p,{type:"link",danger:!0,icon:Et.jsx(J,{}),children:"Xóa"})})]})}];return Et.jsxs("div",{style:{padding:"24px"},children:[Et.jsxs(f,{children:[Et.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[Et.jsx(Es,{level:3,children:"Quản lý thông tin hệ thống kỹ thuật"}),Et.jsx(p,{type:"primary",icon:Et.jsx(Z,{}),onClick:()=>{x(null),y.resetFields(),w({purpose:{description:"",items:[],files:[]},components:{items:[],files:[]},operation:{normal:{steps:[],files:[]},backup:{steps:[],files:[]}},procedures:{items:[],files:[]},troubleshooting:{items:[],files:[]}}),u(!0)},children:"Tạo hệ thống mới"})]}),Et.jsx(l,{message:"Hướng dẫn sử dụng",description:"Tạo và quản lý thông tin chi tiết về các hệ thống kỹ thuật trong Trung tâm dữ liệu. Bạn có thể upload hình ảnh và tài liệu đính kèm.",type:"info",showIcon:!0,style:{marginBottom:"16px"}}),Et.jsx(H,{columns:N,dataSource:n,loading:s,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`${t[0]}-${t[1]} của ${e} hệ thống`}})]}),Et.jsx($,{title:g?"Chỉnh sửa hệ thống":"Tạo hệ thống mới",open:d,onCancel:()=>{u(!1),x(null),y.resetFields()},footer:null,width:800,children:Et.jsxs(a,{form:y,layout:"vertical",onFinish:async e=>{try{const t={...e,purpose:k.purpose.description,components:k.components.description,operation:k.operation.description,procedures:k.procedures.description,troubleshooting:k.troubleshooting.description,content:JSON.stringify(k)};g?(await On("/api/system-info/"+g.id,t),i.success("Cập nhật thành công")):(await Mn("/api/system-info",t),i.success("Tạo hệ thống thành công")),u(!1),y.resetFields(),x(null),w({purpose:{description:"",items:[],files:[]},components:{items:[],files:[]},operation:{normal:{steps:[],files:[]},backup:{steps:[],files:[]}},procedures:{items:[],files:[]},troubleshooting:{items:[],files:[]}}),C()}catch{i.error("Lỗi lưu hệ thống")}},initialValues:{content:""},children:[Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"systemType",label:"Loại hệ thống",rules:[{required:!0,message:"Vui lòng chọn loại hệ thống"}],children:Et.jsx(t,{placeholder:"Chọn loại hệ thống",children:j.map(e=>Et.jsx(zs,{value:e.value,children:e.label},e.value))})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"isActive",label:"Trạng thái",initialValue:!0,children:Et.jsxs(t,{children:[Et.jsx(zs,{value:!0,children:"Hoạt động"}),Et.jsx(zs,{value:!1,children:"Không hoạt động"})]})})})]}),Et.jsx(a.Item,{name:"title",label:"Tiêu đề hệ thống",rules:[{required:!0,message:"Vui lòng nhập tiêu đề"}],children:Et.jsx(o,{placeholder:"VD: Hệ thống UPS (Uninterruptible Power Supply)"})}),Et.jsx(a.Item,{name:"subtitle",label:"Mô tả ngắn",children:Et.jsx(o,{placeholder:"VD: Hệ thống cung cấp điện liên tục cho Trung tâm Dữ liệu"})}),Et.jsx(a.Item,{name:"content",label:"Nội dung chi tiết (Markdown)",rules:[{required:!0,message:"Vui lòng nhập nội dung chi tiết"}],children:Et.jsxs(Et.Fragment,{children:[Et.jsx(As,{rows:12,placeholder:"Nhập nội dung markdown...",value:k.purpose.description,onChange:e=>w(t=>({...t,purpose:{...t.purpose,description:e.target.value}}))}),Et.jsx(h,{orientation:"left",children:"Xem trước"})]})}),Et.jsxs(a.Item,{label:"Hình ảnh hệ thống",children:[Et.jsx(se,{customRequest:async({file:e})=>{if(!g)return;const t=new FormData;t.append("file",e);try{const e=await Mn(`/api/system-info/${g.id}/upload`,t);w(t=>({...t,purpose:{...t.purpose,files:e.data.images||[]}})),i.success("Upload ảnh thành công")}catch{i.error("Upload ảnh thất bại")}},showUploadList:!1,multiple:!1,accept:"image/*",disabled:!g,children:Et.jsx(p,{icon:Et.jsx(le,{}),disabled:!g,children:"Upload ảnh"})}),Et.jsx("div",{style:{marginTop:8},children:k.purpose.files&&k.purpose.files.length>0?k.purpose.files.map(e=>Et.jsxs(m,{style:{marginRight:8},children:[Et.jsx(Ye,{src:"/uploads/system-info/"+e.filename,width:60}),Et.jsx(p,{size:"small",danger:!0,onClick:()=>S("images",e.filename),children:"Xóa"})]},e.filename)):Et.jsx(Ls,{type:"secondary",children:"Chưa có ảnh"})})]}),Et.jsxs(a.Item,{label:"Tài liệu đính kèm",children:[Et.jsx(se,{customRequest:async({file:e})=>{if(!g)return;const t=new FormData;t.append("file",e);try{const e=await Mn(`/api/system-info/${g.id}/upload`,t);w(t=>({...t,components:{...t.components,files:e.data.documents||[]}})),i.success("Upload tài liệu thành công")}catch{i.error("Upload tài liệu thất bại")}},showUploadList:!1,multiple:!1,accept:".pdf,.doc,.docx,.xls,.xlsx,.txt",disabled:!g,children:Et.jsx(p,{icon:Et.jsx(le,{}),disabled:!g,children:"Upload tài liệu"})}),Et.jsx("div",{style:{marginTop:8},children:k.components.files&&k.components.files.length>0?k.components.files.map(e=>Et.jsxs(m,{style:{marginRight:8},children:[Et.jsx(D,{}),Et.jsx("a",{href:"/uploads/"+(e.path||"system-info/"+e.filename),target:"_blank",rel:"noopener noreferrer",children:e.originalName}),Et.jsx(p,{size:"small",danger:!0,onClick:()=>S("documents",e.path||e.filename),children:"Xóa"})]},e.path||e.filename)):Et.jsx(Ls,{type:"secondary",children:"Chưa có tài liệu"})})]}),Et.jsx(a.Item,{children:Et.jsxs(m,{children:[Et.jsx(p,{type:"primary",htmlType:"submit",children:g?"Cập nhật":"Tạo mới"}),Et.jsx(p,{onClick:()=>{u(!1),x(null),y.resetFields()},children:"Hủy"})]})})]})})]})},{Title:Ps,Text:Ms}=r,{TextArea:Os}=o,{Option:Rs}=t,Bs=({image:t,systemInfoId:n,style:r,onClick:a})=>{const[i,l]=e.useState(null),[o,c]=e.useState(!0),[d,u]=e.useState(!1);return e.useEffect(()=>{let e;return n&&t.filename&&(async()=>{try{c(!0),u(!1);const r=localStorage.getItem("token"),a=await fetch(`https://192.168.1.7/api/system-info/${n}/files/${t.filename}`,{headers:{Authorization:"Bearer "+r}});if(!a.ok)throw Error("Fetch image failed");const i=await a.blob();e=window.URL.createObjectURL(i),l(e)}catch(r){u(!0)}finally{c(!1)}})(),()=>{e&&window.URL.revokeObjectURL(e)}},[n,t.filename]),o?Et.jsx(s,{}):d?Et.jsx("div",{children:"Lỗi tải ảnh"}):Et.jsx("img",{src:i,alt:t.originalName,style:r,onClick:a})},Vs=({images:e,systemInfoId:t,title:n,onPreview:r})=>e&&0!==e.length?Et.jsxs("div",{style:{marginTop:"16px"},children:[Et.jsx(Ms,{strong:!0,children:"Hình ảnh:"}),Et.jsx(X,{gutter:[8,8],style:{marginTop:"8px"},children:e.map((a,i)=>Et.jsx(G,{span:8,children:Et.jsx("div",{style:{position:"relative"},children:Et.jsx(Bs,{image:a,systemInfoId:t,style:{width:"100%",height:"80px",objectFit:"cover",cursor:"pointer",borderRadius:"4px"},onClick:()=>r&&r(e,n,i)})})},i))})]}):null,Us=e.memo(()=>Et.jsx(a.List,{name:["purpose","items"],children:(e,{add:t,remove:n})=>Et.jsxs(Et.Fragment,{children:[e.map(({key:e,name:t,...r})=>Et.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[Et.jsx(a.Item,{...r,name:[t],style:{flex:1,marginBottom:0},children:Et.jsx(o,{placeholder:"Điểm "+(t+1)})}),Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>n(t),style:{marginLeft:8}})]},e)),Et.jsx(a.Item,{children:Et.jsx(p,{type:"dashed",onClick:()=>t(),block:!0,icon:Et.jsx(Z,{}),children:"Thêm điểm"})})]})})),$s=e.memo(({systemInfoId:e,onPreview:t,form:n,onUpload:r})=>Et.jsx(a.List,{name:["components","items"],children:(i,{add:s,remove:l})=>Et.jsxs(Et.Fragment,{children:[i.map(({key:i,name:s,...c})=>{const d=n.getFieldValue(["components","items",s,"images"])||[],u=n.getFieldValue(["components","items",s,"name"])||"Thành phần "+(s+1);return Et.jsxs(f,{size:"small",style:{marginBottom:16},children:[Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:6,children:Et.jsx(a.Item,{...c,name:[s,"name"],label:"Tên thành phần",children:Et.jsx(o,{})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{...c,name:[s,"description"],label:"Mô tả",children:Et.jsx(Os,{rows:2})})}),Et.jsx(G,{span:4,children:Et.jsx(a.Item,{...c,name:[s,"tag"],label:"Tag",children:Et.jsx(o,{})})}),Et.jsx(G,{span:2,children:Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>l(s)})})]}),Et.jsx(Vs,{images:d.filter(e=>e.filename),systemInfoId:e,title:u,onPreview:t}),Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:[s,"images"],label:"Ảnh minh họa",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e&&e.fileList,children:Et.jsx(se,{multiple:!0,accept:"image/*",beforeUpload:e=>qs(e,"image"),listType:"picture-card",onChange:e=>{e.fileList.filter(e=>e.originFileObj&&!e.filename).forEach(e=>{r(e.originFileObj,"components",s,"image")})},children:Et.jsx("div",{children:"Upload ảnh"})})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:[s,"documents"],label:"Tài liệu đính kèm",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e&&e.fileList,children:Et.jsx(se,{multiple:!0,accept:".pdf,.doc,.docx,.xls,.xlsx,.txt,.zip,.rar,.7z",beforeUpload:e=>qs(e,"document"),onChange:e=>{e.fileList.filter(e=>e.originFileObj&&!e.filename).forEach(e=>{r(e.originFileObj,"components",s,"document")})},children:Et.jsx(p,{icon:Et.jsx(le,{}),children:"Upload tài liệu"})})})})]})]},i)}),Et.jsx(a.Item,{children:Et.jsx(p,{type:"dashed",onClick:()=>s({name:"",description:"",tag:"",images:[],documents:[]}),block:!0,icon:Et.jsx(Z,{}),children:"Thêm thành phần"})})]})}));e.memo(({operationType:t,onUpload:n})=>Et.jsxs(Et.Fragment,{children:[Et.jsx(a.List,{name:["operation",t,"steps"],children:(t,{add:n,remove:r})=>Et.jsxs(Et.Fragment,{children:[t.map(({key:t,name:n,...r})=>e.createElement(a.Item,{...r,name:[n],key:t,style:{marginBottom:8}},Et.jsx(o,{placeholder:"Bước "+(n+1)}))),t.length>0&&Et.jsx(a.Item,{children:Et.jsx(p,{type:"text",danger:!0,onClick:()=>r(t.length-1),children:"Xóa bước cuối"})}),Et.jsx(a.Item,{children:Et.jsx(p,{type:"dashed",onClick:()=>n(),block:!0,icon:Et.jsx(Z,{}),children:"Thêm bước"})})]})}),Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:["operation",t,"images"],label:"Ảnh minh họa",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e&&e.fileList,children:Et.jsx(se,{multiple:!0,accept:"image/*",beforeUpload:e=>qs(e,"image"),listType:"picture-card",onChange:e=>{e.fileList.filter(e=>e.originFileObj&&!e.filename).forEach(e=>{n(e.originFileObj,"operation",t,"image")})},children:Et.jsx("div",{children:"Upload ảnh"})})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:["operation",t,"documents"],label:"Tài liệu đính kèm",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e&&e.fileList,children:Et.jsx(se,{multiple:!0,accept:".pdf,.doc,.docx,.xls,.xlsx,.txt,.zip,.rar,.7z",beforeUpload:e=>qs(e,"document"),onChange:e=>{e.fileList.filter(e=>e.originFileObj&&!e.filename).forEach(e=>{n(e.originFileObj,"operation",t,"document")})},children:Et.jsx(p,{icon:Et.jsx(le,{}),children:"Upload tài liệu"})})})})]})]}));const Hs=e.memo(({onUpload:e})=>Et.jsx(a.List,{name:["procedures","items"],children:(t,{add:n,remove:r})=>Et.jsxs(Et.Fragment,{children:[t.map(({key:t,name:n,...i})=>Et.jsxs(f,{size:"small",style:{marginBottom:16},children:[Et.jsx(a.Item,{...i,name:[n,"title"],label:"Tiêu đề quy trình",children:Et.jsx(o,{})}),Et.jsx(a.Item,{...i,name:[n,"items"],label:"Các bước thực hiện",children:Et.jsx(a.List,{name:[n,"items"],children:(e,{add:t,remove:n})=>Et.jsxs(Et.Fragment,{children:[e.map(({key:e,name:t,...r})=>Et.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[Et.jsx(a.Item,{...r,name:[t],style:{flex:1,marginBottom:0},children:Et.jsx(o,{placeholder:"Bước "+(t+1)})}),Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>n(t),style:{marginLeft:8}})]},e)),Et.jsx(a.Item,{children:Et.jsx(p,{type:"dashed",onClick:()=>t(),block:!0,icon:Et.jsx(Z,{}),children:"Thêm bước"})})]})})}),Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:[n,"images"],label:"Ảnh minh họa",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e&&e.fileList,children:Et.jsx(se,{multiple:!0,accept:"image/*",beforeUpload:e=>qs(e,"image"),listType:"picture-card",onChange:t=>{t.fileList.filter(e=>e.originFileObj&&!e.filename).forEach(t=>{e(t.originFileObj,"procedures",n,"image")})},children:Et.jsx("div",{children:"Upload ảnh"})})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:[n,"documents"],label:"Tài liệu đính kèm",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e&&e.fileList,children:Et.jsx(se,{multiple:!0,accept:".pdf,.doc,.docx,.xls,.xlsx,.txt,.zip,.rar,.7z",beforeUpload:e=>qs(e,"document"),onChange:t=>{t.fileList.filter(e=>e.originFileObj&&!e.filename).forEach(t=>{e(t.originFileObj,"procedures",n,"document")})},children:Et.jsx(p,{icon:Et.jsx(le,{}),children:"Upload tài liệu"})})})})]}),Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>r(n),children:"Xóa quy trình"})]},t)),Et.jsx(a.Item,{children:Et.jsx(p,{type:"dashed",onClick:()=>n({title:"",items:[],images:[],documents:[]}),block:!0,icon:Et.jsx(Z,{}),children:"Thêm quy trình"})})]})})),Ws=e.memo(({onUpload:e})=>Et.jsx(a.List,{name:["issues","items"],children:(t,{add:n,remove:r})=>Et.jsxs(Et.Fragment,{children:[t.map(({key:t,name:n,...i})=>Et.jsxs(f,{size:"small",style:{marginBottom:16},children:[Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:8,children:Et.jsx(a.Item,{...i,name:[n,"problem"],label:"Tiêu đề sự cố",children:Et.jsx(o,{})})}),Et.jsx(G,{span:8,children:Et.jsx(a.Item,{...i,name:[n,"cause"],label:"Nguyên nhân",children:Et.jsx(o,{})})}),Et.jsx(G,{span:8,children:Et.jsx(a.Item,{...i,name:[n,"solution"],label:"Cách xử lý",children:Et.jsx(o,{})})})]}),Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:[n,"images"],label:"Ảnh minh họa",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e&&e.fileList,children:Et.jsx(se,{multiple:!0,accept:"image/*",beforeUpload:e=>qs(e,"image"),listType:"picture-card",onChange:t=>{t.fileList.filter(e=>e.originFileObj&&!e.filename).forEach(t=>{e(t.originFileObj,"issues",n,"image")})},children:Et.jsx("div",{children:"Upload ảnh"})})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:[n,"documents"],label:"Tài liệu đính kèm",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e&&e.fileList,children:Et.jsx(se,{multiple:!0,accept:".pdf,.doc,.docx,.xls,.xlsx,.txt,.zip,.rar,.7z",beforeUpload:e=>qs(e,"document"),onChange:t=>{t.fileList.filter(e=>e.originFileObj&&!e.filename).forEach(t=>{e(t.originFileObj,"issues",n,"document")})},children:Et.jsx(p,{icon:Et.jsx(le,{}),children:"Upload tài liệu"})})})})]}),Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>r(n),children:"Xóa sự cố"})]},t)),Et.jsx(a.Item,{children:Et.jsx(p,{type:"dashed",onClick:()=>n({problem:"",cause:"",solution:"",images:[],documents:[]}),block:!0,icon:Et.jsx(Z,{}),children:"Thêm sự cố"})})]})})),qs=(e,t="image")=>"image"===t?e.type.startsWith("image/")?e.size/1024/1024>100&&(i.error("File phải nhỏ hơn 100MB!"),se.LIST_IGNORE):(i.error("Chỉ được upload file ảnh!"),se.LIST_IGNORE):["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain","application/zip","application/x-rar-compressed","application/x-7z-compressed"].includes(e.type)?e.size/1024/1024>100&&(i.error("File phải nhỏ hơn 100MB!"),se.LIST_IGNORE):(i.error("Loại file không được hỗ trợ!"),se.LIST_IGNORE),Ks=e.memo(()=>{const{id:n}=gt(),r=mt(),{currentUser:s}=Kt(),[l]=a.useForm(),[c,d]=e.useState(!1),[u,h]=e.useState(!1),[g,x]=e.useState(null),[y,v]=e.useState([]),[b,j]=e.useState([]),[k,w]=e.useState(!1),[C,S]=e.useState(""),[N,T]=e.useState(""),I=e.useCallback(()=>s?"manager"===s.role?.toLowerCase()?"/manager":"be"===s.role?.toLowerCase()?"/be":"/dc":"/dc",[s]),_=e.useCallback(async(e,t,r,a)=>{try{const s=new FormData;s.append("file",e),s.append("fieldName",t),s.append("itemIndex",r),s.append("fileType",a);const o=await Mn(`/api/system-info/${n}/upload-sub-item`,s);if(o.data.success){const n=o.data.data,s=(l.getFieldValue([t,"items",r,"image"===a?"images":"documents"])||[]).map(t=>t.originFileObj&&t.uid===e.uid?n:t);return l.setFieldValue([t,"items",r,"image"===a?"images":"documents"],s),i.success(`Upload ${"image"===a?"ảnh":"tài liệu"} thành công!`),n}throw Error(o.data.message||"Upload failed")}catch(s){throw i.error(`Lỗi upload ${"image"===a?"ảnh":"tài liệu"}!`),s}},[l,n]),E=e.useCallback(async(e,t,n,r)=>{try{await _(e,t,n,r)}catch{const a=(l.getFieldValue([t,"items",n,"image"===r?"images":"documents"])||[]).filter(t=>t.uid!==e.uid);l.setFieldValue([t,"items",n,"image"===r?"images":"documents"],a)}},[_,l]);e.useEffect(()=>{n&&L()},[n,s]);const L=e.useCallback(async()=>{d(!0);try{const e=await Pn("/api/system-info/"+n);if(e.data.success){const t=e.data.data;x(t);let n={};if(t.content)try{n="string"==typeof t.content?JSON.parse(t.content):t.content}catch{n={}}n.purpose&&!Array.isArray(n.purpose.items)&&(n.purpose.items=[]),n.components&&!Array.isArray(n.components.items)&&(n.components.items=[]),n.operation&&(n.operation.normal&&!Array.isArray(n.operation.normal.steps)&&(n.operation.normal.steps=[]),n.operation.backup&&!Array.isArray(n.operation.backup.steps)&&(n.operation.backup.steps=[])),n.procedures&&!Array.isArray(n.procedures.items)&&(n.procedures.items=[]),n.troubleshooting&&!Array.isArray(n.troubleshooting.items)&&(n.troubleshooting.items=[]);const r={systemType:t.systemType,title:t.title,subtitle:t.subtitle,isActive:t.isActive,purpose:n.purpose||{title:"Mục đích",description:t.purpose||"",items:[],files:[]},components:n.components||{title:"Thành phần chính",description:t.components||"",items:[],files:[]},operation:n.operation||{title:"Nguyên lý hoạt động",description:t.operation||"",items:[]},procedures:n.procedures||{title:"Quy trình vận hành",description:t.procedures||"",items:[],files:[]},issues:n.troubleshooting||{title:"Sự cố thường gặp",description:t.troubleshooting||"",items:[],files:[]}},a=[];n.general?.files&&Array.isArray(n.general.files)&&n.general.files.forEach(e=>{const t={...e,uid:e.uid||e.filename||`file-${Date.now()}-${Math.random()}`,name:e.name||e.originalName,status:"done"};e.response?(t.response=e.response,e.response.mimetype&&(t.mimetype=e.response.mimetype)):t.response=e,a.push(t)});const i=a.filter(e=>e.mimetype&&e.mimetype.startsWith("image/")),s=a.filter(e=>!e.mimetype||!e.mimetype.startsWith("image/"));r.images=i,r.documents=s,l.setFieldsValue(r)}}catch(e){i.error("Lỗi tải dữ liệu hệ thống")}finally{d(!1)}},[n,l]),A=e.useCallback(e=>{const t=e.filename||e.response?.filename;if(e.url||e.response||t){const n=e.response||e;n&&(n.filename||t)&&v(e=>e.some(e=>e&&(e.filename===n.filename||e.filename===t))?e:[...e,n])}const n=(l.getFieldValue("images")||[]).filter(t=>t.uid!==e.uid);return l.setFieldsValue({images:n}),!0},[l]),z=e.useCallback(e=>{const t=e.filename||e.response?.filename;if(e.url||e.response||t){const n=e.response||e;n&&(n.filename||t)&&j(e=>e.some(e=>e&&(e.filename===n.filename||e.filename===t))?e:[...e,n])}const n=(l.getFieldValue("documents")||[]).filter(t=>t.uid!==e.uid);return l.setFieldsValue({documents:n}),!0},[l]),F=async e=>{if(e.response||e.filename||e.path){const r=localStorage.getItem("token"),a=e.response?.path||e.path||e.response?.filename||e.filename;try{const t=await fetch(`https://192.168.1.7/api/system-info/${n}/files/${encodeURIComponent(a)}`,{headers:{Authorization:"Bearer "+r}});if(t.ok){const n=await t.blob(),r=window.URL.createObjectURL(n);S(r),w(!0),T(Ia(e)||"")}}catch(t){i.error("Lỗi tải ảnh preview")}}else S(e.url||e.thumbUrl),w(!0),T(Ia(e)||"")},P=e.useCallback(()=>{r(I()+"/system-info")},[r,I]);return c?Et.jsx("div",{children:"Đang tải..."}):g?Et.jsxs("div",{style:{padding:"24px"},children:[Et.jsxs(f,{children:[Et.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[Et.jsxs(m,{children:[Et.jsx(p,{icon:Et.jsx(Se,{}),onClick:P,children:"Quay lại"}),Et.jsxs(Ps,{level:3,style:{margin:0},children:["Chỉnh sửa: ",g.title]})]}),Et.jsx(p,{type:"primary",icon:Et.jsx(Le,{}),loading:u,onClick:()=>l.submit(),style:{backgroundColor:"#1890ff",borderColor:"#1890ff",color:"white",fontWeight:"bold",padding:"8px 16px",height:"auto"},children:"Lưu thay đổi"})]}),Et.jsxs(a,{form:l,layout:"vertical",onFinish:async e=>{h(!0);try{const t={systemType:e.systemType,title:e.title,subtitle:e.subtitle,isActive:e.isActive,purpose:e.purpose?.description||"",components:e.components?.description||"",operation:e.operation?.description||"",procedures:e.procedures?.description||"",troubleshooting:e.issues?.description||"",content:JSON.stringify({purpose:e.purpose||{title:"Mục đích",description:"",items:[],files:[]},components:e.components||{title:"Thành phần chính",description:"",items:[],files:[]},operation:e.operation||{title:"Nguyên lý hoạt động",description:"",items:[]},procedures:e.procedures||{title:"Quy trình vận hành",description:"",items:[],files:[]},troubleshooting:e.issues||{title:"Sự cố thường gặp",description:"",items:[],files:[]},general:{title:"Tài liệu chung",description:"",files:[...(e.images||[]).filter(e=>e.filename||e.response?.filename),...(e.documents||[]).filter(e=>e.filename||e.response?.filename)]}})},a=await On("/api/system-info/"+n,t);if(!a.data.success)throw Error(a.data.message||"Save failed");{if(i.success("Lưu thành công!"),y.length>0||b.length>0){const e=[];y.forEach(t=>{t.filename&&e.push(Rn(`/api/system-info/${n}/files/${t.filename}`).catch(e=>{}))}),b.forEach(t=>{t.filename&&e.push(Rn(`/api/system-info/${n}/files/${t.filename}`).catch(e=>{}))}),await Promise.all(e)}v([]),j([]);const t=e.systemType.toLowerCase().replace(/_/g,"-");r(`${I()}/system-info/${t}`)}}catch(t){i.error("Lỗi lưu dữ liệu!")}finally{h(!1)}},children:[Et.jsxs(f,{title:"Thông tin cơ bản",style:{marginBottom:"24px"},children:[Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"systemType",label:"Loại hệ thống",rules:[{required:!0,message:"Vui lòng chọn loại hệ thống"}],children:Et.jsxs(t,{children:[Et.jsx(Rs,{value:"UPS_DISTRIBUTION",children:"Hệ thống phân phối điện UPS"}),Et.jsx(Rs,{value:"UPS",children:"Hệ thống UPS"}),Et.jsx(Rs,{value:"COOLING",children:"Hệ thống làm mát"}),Et.jsx(Rs,{value:"VIDEO_SURVEILLANCE",children:"Hệ thống giám sát hình ảnh"}),Et.jsx(Rs,{value:"ACCESS_CONTROL",children:"Hệ thống kiểm soát truy cập"}),Et.jsx(Rs,{value:"FIRE_PROTECTION",children:"PCCC"}),Et.jsx(Rs,{value:"INFRASTRUCTURE_MONITORING",children:"Hệ thống giám sát hạ tầng TTDL"})]})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"isActive",label:"Trạng thái",children:Et.jsxs(t,{children:[Et.jsx(Rs,{value:!0,children:"Hoạt động"}),Et.jsx(Rs,{value:!1,children:"Không hoạt động"})]})})})]}),Et.jsx(a.Item,{name:"title",label:"Tiêu đề hệ thống",rules:[{required:!0,message:"Vui lòng nhập tiêu đề"}],children:Et.jsx(o,{})}),Et.jsx(a.Item,{name:"subtitle",label:"Mô tả ngắn",children:Et.jsx(o,{})})]}),Et.jsxs(f,{title:Et.jsx(a.Item,{name:["purpose","title"],style:{margin:0},children:Et.jsx(o,{placeholder:"Nhập tên mục đích...",style:{fontSize:"16px",fontWeight:"bold",border:"none",backgroundColor:"transparent",padding:0}})}),style:{marginBottom:"24px"},children:[Et.jsx(a.Item,{name:["purpose","description"],label:"Mô tả mục đích",children:Et.jsx(Os,{rows:3,placeholder:"Mô tả mục đích của hệ thống..."})}),Et.jsx(a.Item,{name:["purpose","items"],label:"Các điểm chính",children:Et.jsx(Us,{})})]}),Et.jsxs(f,{title:Et.jsx(a.Item,{name:["components","title"],style:{margin:0},children:Et.jsx(o,{placeholder:"Nhập tên thành phần...",style:{fontSize:"16px",fontWeight:"bold",border:"none",backgroundColor:"transparent",padding:0}})}),style:{marginBottom:"24px"},children:[Et.jsx(a.Item,{name:["components","description"],label:"Mô tả chung",children:Et.jsx(Os,{rows:2,placeholder:"Mô tả chung về các thành phần..."})}),Et.jsx(a.Item,{name:["components","items"],label:"Danh sách thành phần",children:Et.jsx($s,{systemInfoId:n,form:l,onPreview:(e,t,r=0)=>{if(e&&e.length>0){const a=e[r];if(a.response){const e=localStorage.getItem("token");fetch(`https://192.168.1.7/api/system-info/${n}/files/${a.response.filename}`,{headers:{Authorization:"Bearer "+e}}).then(e=>{if(e.ok)return e.blob();throw Error("Fetch failed")}).then(e=>{const n=window.URL.createObjectURL(e);S(n),w(!0),T(`${t} - ${Ia(a)}`)}).catch(e=>{i.error("Lỗi tải ảnh preview")})}}},onUpload:E})})]}),Et.jsxs(f,{title:Et.jsx(a.Item,{name:["operation","title"],style:{margin:0},children:Et.jsx(o,{placeholder:"Nhập tên nguyên lý hoạt động...",style:{fontSize:"16px",fontWeight:"bold",border:"none",backgroundColor:"transparent",padding:0}})}),style:{marginBottom:"24px"},children:[Et.jsx(a.Item,{name:["operation","description"],label:"Mô tả chung",children:Et.jsx(Os,{rows:2,placeholder:"Mô tả chung về nguyên lý hoạt động..."})}),Et.jsx(a.Item,{name:["operation","items"],label:"Danh sách nguyên lý hoạt động",children:Et.jsx(a.List,{name:["operation","items"],children:(e,{add:t,remove:n})=>Et.jsxs(Et.Fragment,{children:[e.map(({key:e,name:t,...r})=>Et.jsxs(f,{size:"small",style:{marginBottom:16},children:[Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:20,children:Et.jsx(a.Item,{...r,name:[t,"title"],label:"Tên nguyên lý",children:Et.jsx(o,{placeholder:"Nhập tên nguyên lý hoạt động..."})})}),Et.jsx(G,{span:4,children:Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>n(t),style:{marginTop:32},children:"Xóa"})})]}),Et.jsx(a.Item,{...r,name:[t,"description"],label:"Mô tả",children:Et.jsx(Os,{rows:2,placeholder:"Mô tả nguyên lý hoạt động..."})}),Et.jsx(a.Item,{...r,name:[t,"steps"],label:"Các bước thực hiện",children:Et.jsx(a.List,{name:[t,"steps"],children:(e,{add:t,remove:n})=>Et.jsxs(Et.Fragment,{children:[e.map(({key:e,name:t,...r})=>Et.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[Et.jsx(a.Item,{...r,name:[t],style:{flex:1,marginBottom:0},children:Et.jsx(o,{placeholder:"Bước "+(t+1)})}),Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>n(t),style:{marginLeft:8}})]},e)),Et.jsx(a.Item,{children:Et.jsx(p,{type:"dashed",onClick:()=>t(),block:!0,icon:Et.jsx(Z,{}),children:"Thêm bước"})})]})})}),Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:[t,"images"],label:"Ảnh minh họa",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e&&e.fileList,children:Et.jsx(se,{multiple:!0,accept:"image/*",beforeUpload:e=>qs(e,"image"),listType:"picture-card",onChange:e=>{e.fileList.filter(e=>e.originFileObj&&!e.filename).forEach(e=>{E(e.originFileObj,"operation",t,"image")})},children:Et.jsx("div",{children:"Upload ảnh"})})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:[t,"documents"],label:"Tài liệu đính kèm",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e&&e.fileList,children:Et.jsx(se,{multiple:!0,accept:".pdf,.doc,.docx,.xls,.xlsx,.txt,.zip,.rar,.7z",beforeUpload:e=>qs(e,"document"),onChange:e=>{e.fileList.filter(e=>e.originFileObj&&!e.filename).forEach(e=>{E(e.originFileObj,"operation",t,"document")})},children:Et.jsx(p,{icon:Et.jsx(le,{}),children:"Upload tài liệu"})})})})]})]},e)),Et.jsx(a.Item,{children:Et.jsx(p,{type:"dashed",onClick:()=>t({title:"",description:"",steps:[],images:[],documents:[]}),block:!0,icon:Et.jsx(Z,{}),children:"Thêm nguyên lý hoạt động"})})]})})})]}),Et.jsxs(f,{title:Et.jsx(a.Item,{name:["procedures","title"],style:{margin:0},children:Et.jsx(o,{placeholder:"Nhập tên quy trình vận hành...",style:{fontSize:"16px",fontWeight:"bold",border:"none",backgroundColor:"transparent",padding:0}})}),style:{marginBottom:"24px"},children:[Et.jsx(a.Item,{name:["procedures","description"],label:"Mô tả chung",children:Et.jsx(Os,{rows:2,placeholder:"Mô tả chung về quy trình vận hành..."})}),Et.jsx(a.Item,{name:["procedures","items"],label:"Danh sách quy trình",children:Et.jsx(Hs,{onUpload:E})})]}),Et.jsxs(f,{title:Et.jsx(a.Item,{name:["issues","title"],style:{margin:0},children:Et.jsx(o,{placeholder:"Nhập tên sự cố thường gặp...",style:{fontSize:"16px",fontWeight:"bold",border:"none",backgroundColor:"transparent",padding:0}})}),style:{marginBottom:"24px"},children:[Et.jsx(a.Item,{name:["issues","description"],label:"Mô tả chung",children:Et.jsx(Os,{rows:2,placeholder:"Mô tả chung về các sự cố..."})}),Et.jsx(a.Item,{name:["issues","items"],label:"Danh sách sự cố",children:Et.jsx(Ws,{onUpload:E})})]}),Et.jsx(f,{title:"Hình ảnh và tài liệu",style:{marginBottom:"24px"},children:Et.jsxs(X,{gutter:16,children:[Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"images",label:"Hình ảnh hệ thống",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e?.fileList,children:Et.jsx(se,{multiple:!0,maxCount:10,listType:"picture-card",showUploadList:{showDownloadIcon:!0,showRemoveIcon:!0,removeIcon:Et.jsx(J,{style:{color:"#ff4d4f"}})},customRequest:async({file:e,onSuccess:t,onError:r,onProgress:a})=>{try{if(!e.type.startsWith("image/"))return void r(Error("Chỉ được upload file ảnh!"));if(e.size/1024/1024>=100)return void r(Error("File phải nhỏ hơn 100MB!"));const a=new FormData;a.append("file",e),a.append("fileType","image"),a.append("section","general");const i=await Mn(`/api/system-info/${n}/upload`,a);i.data.success?t(i.data.data.uploadedFiles[0]):r(Error(i.data.message||"Upload failed"))}catch(i){r(i)}},accept:"image/*",onRemove:A,itemRender:(e,t)=>{if(t.response||t.filename){const e=t.response||t;return Et.jsxs("div",{style:{position:"relative"},children:[Et.jsx(Bs,{image:e,systemInfoId:n,style:{width:80,height:80,objectFit:"cover",cursor:"pointer"},onClick:()=>F(t)}),Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>A(t),style:{position:"absolute",top:0,right:0}}),Et.jsx(p,{type:"text",icon:Et.jsx(Te,{}),onClick:()=>(async e=>{try{const t=e.path||e.filename,r=await Pn(`/api/system-info/${n}/files/${encodeURIComponent(t)}`,{responseType:"blob"}),a=new Blob([r.data],{type:e.mimetype||"application/octet-stream"}),i=window.URL.createObjectURL(a),s=document.createElement("a");s.href=i,s.download=Ia(e),document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(i)}catch(t){}})(e),style:{position:"absolute",bottom:0,right:0}})]})}return e},onPreview:F,children:Et.jsxs("div",{children:[Et.jsx(Z,{}),Et.jsx("div",{style:{marginTop:8},children:"Upload ảnh"})]})})})}),Et.jsx(G,{span:12,children:Et.jsx(a.Item,{name:"documents",label:"Tài liệu đính kèm",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:e?.fileList,children:Et.jsx(se,{multiple:!0,maxCount:10,listType:"text",showUploadList:{showDownloadIcon:!0,showRemoveIcon:!0,removeIcon:Et.jsx(J,{style:{color:"#ff4d4f"}})},customRequest:async({file:e,onSuccess:t,onError:r,onProgress:a})=>{try{if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain","application/zip","application/x-rar-compressed","application/x-7z-compressed"].includes(e.type))return void r(Error("Loại file không được hỗ trợ!"));if(e.size/1024/1024>=100)return void r(Error("File phải nhỏ hơn 100MB!"));const a=new FormData;a.append("file",e),a.append("fileType","document"),a.append("section","general");const i=await Mn(`/api/system-info/${n}/upload`,a);i.data.success?t(i.data.data.uploadedFiles[0]):r(Error(i.data.message||"Upload failed"))}catch(i){r(i)}},accept:".pdf,.doc,.docx,.xls,.xlsx,.txt,.zip,.rar,.7z",onRemove:z,itemRender:(e,t)=>{let r="Unknown file";return r=t.name?t.name:t.response?.originalName?t.response.originalName:t.originalName?t.originalName:Ia(t)||"Unknown file","error"===t.status?Et.jsxs("div",{className:"flex items-center justify-between w-full",children:[Et.jsxs(W,{color:"red",className:"flex-grow",children:[Et.jsx(Ie,{})," ",r]}),Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>z(t)})]}):"uploading"===t.status?Et.jsxs("div",{className:"flex items-center justify-between w-full",children:[Et.jsxs(W,{color:"processing",className:"flex-grow",children:[Et.jsx(q,{})," ",r]}),Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>z(t)})]}):Et.jsxs("div",{className:"flex items-center justify-between w-full",children:[Et.jsxs(W,{color:"blue",className:"flex-grow",children:[Et.jsx(D,{})," ",r]}),Et.jsxs(m,{children:[(t.url||t.filename||t.response?.filename)&&Et.jsx(p,{type:"text",icon:Et.jsx(Te,{}),onClick:()=>{const e=t.response||t;e.path||e.filename?(async e=>{try{const t=e.path||e.filename||e.response?.path||e.response?.filename;if(!t)return void i.error("Không tìm thấy đường dẫn file");const r=await Pn(`/api/system-info/${n}/files/${encodeURIComponent(t)}`,{responseType:"blob"});let a="document";a=e.name?e.name:e.response?.originalName?e.response.originalName:e.originalName?e.originalName:Ia(e);const s=new Blob([r.data],{type:e.mimetype||e.response?.mimetype||"application/octet-stream"}),l=window.URL.createObjectURL(s),o=document.createElement("a");o.href=l,o.download=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(l)}catch(t){i.error("Lỗi tải tài liệu")}})(e):window.open(t.url,"_blank")}}),Et.jsx(p,{type:"text",danger:!0,icon:Et.jsx(J,{}),onClick:()=>z(t)})]})]})},children:Et.jsx(p,{icon:Et.jsx(le,{}),children:"Upload tài liệu"})})})})]})})]}),Et.jsx("div",{style:{textAlign:"center",marginTop:"24px",padding:"16px",borderTop:"1px solid #f0f0f0",backgroundColor:"#fafafa"},children:Et.jsxs(m,{children:[Et.jsx(p,{onClick:P,style:{padding:"8px 16px"},children:"Hủy"}),Et.jsx(p,{type:"primary",icon:Et.jsx(Le,{}),loading:u,onClick:()=>l.submit(),style:{backgroundColor:"#1890ff",borderColor:"#1890ff",color:"white",fontWeight:"bold",padding:"8px 24px",height:"auto",fontSize:"16px"},children:"Lưu thay đổi"})]})})]}),Et.jsx($,{open:k,title:N,footer:null,onCancel:()=>w(!1),children:Et.jsx("img",{alt:N,style:{width:"100%"},src:C})})]}):Et.jsx("div",{children:"Không tìm thấy dữ liệu"})}),{Title:Ys,Paragraph:Qs,Text:Xs}=r,Gs=[{question:"Quy trình giao nhận ca như thế nào?",answer:Et.jsxs(Et.Fragment,{children:[Et.jsxs(Qs,{children:[Et.jsx("b",{children:"Bước 1: Nhận ca"}),Et.jsx("br",{}),"- Chọn ca làm việc trên giao diện ",Et.jsx(Xs,{code:!0,children:"/dc/shifts"}),".",Et.jsx("br",{}),"- Xác nhận nhận ca, hệ thống tạo WorkSession và chuyển trạng thái ca thành ",Et.jsx(Xs,{code:!0,children:"doing"}),".",Et.jsx("br",{}),"- Nếu ca trước có biên bản bàn giao ở trạng thái ",Et.jsx(Xs,{code:!0,children:"pending"}),", bạn phải xác nhận hoặc từ chối biên bản trước khi làm việc.",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/ca_nhan_ca.png",alt:"Nhận ca",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"Bước 2: Làm việc trong ca"}),Et.jsx("br",{}),"- Thực hiện các công việc, kiểm tra thiết bị, cập nhật thông tin liên quan trong ca.",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/ca_lam_viec.png",alt:"Làm việc trong ca",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"Bước 3: Bàn giao ca"}),Et.jsx("br",{}),"- Khi kết thúc ca, người dùng (hoặc trưởng ca) tạo biên bản bàn giao (trạng thái ",Et.jsx(Xs,{code:!0,children:"draft"}),").",Et.jsx("br",{}),"- Có thể chỉnh sửa, bổ sung thông tin, đính kèm file.",Et.jsx("br",{}),"- Khi hoàn tất, gửi biên bản để chuyển sang trạng thái ",Et.jsx(Xs,{code:!0,children:"pending"}),".",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/ca_ban_giao.png",alt:"Bàn giao ca",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"Bước 4: Xác nhận nhận ca (ca sau)"}),Et.jsx("br",{}),"- Người nhận ca tiếp theo xem biên bản bàn giao ở trạng thái ",Et.jsx(Xs,{code:!0,children:"pending"}),".",Et.jsx("br",{}),"- Có thể xác nhận (biên bản sang ",Et.jsx(Xs,{code:!0,children:"completed"}),", ca trước chuyển ",Et.jsx(Xs,{code:!0,children:"done"}),", ca sau chuyển ",Et.jsx(Xs,{code:!0,children:"doing"}),") hoặc từ chối (biên bản về ",Et.jsx(Xs,{code:!0,children:"draft"}),", ca trước quay lại ",Et.jsx(Xs,{code:!0,children:"doing"}),").",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/ca_xac_nhan.png",alt:"Xác nhận nhận ca",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"Bước 5: Kết thúc ca"}),Et.jsx("br",{}),"- Khi tất cả biên bản đã được xác nhận, ca trước có thể kết thúc (trạng thái ",Et.jsx(Xs,{code:!0,children:"done"})," hoặc ",Et.jsx(Xs,{code:!0,children:"closed"}),").",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/ca_ket_thuc.png",alt:"Kết thúc ca",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"Lưu ý:"}),Et.jsx("br",{}),"- Một ca chỉ được nhận khi ca trước đã bàn giao và biên bản được xác nhận.",Et.jsx("br",{}),"- Nếu biên bản bị từ chối, ca trước phải chỉnh sửa và gửi lại.",Et.jsx("br",{}),"- Mỗi người chỉ được nhận một ca/ngày.",Et.jsx("br",{})]})]})},{question:"Các chức năng quản lý công việc (Task) gồm những gì?",answer:Et.jsxs(Et.Fragment,{children:[Et.jsxs(Qs,{children:[Et.jsx("b",{children:"1. Xem danh sách công việc"}),Et.jsx("br",{}),"- Hiển thị tất cả công việc liên quan đến trung tâm dữ liệu.",Et.jsx("br",{}),"- Lọc theo trạng thái, vị trí, ngày, từ khóa.",Et.jsx("br",{}),"- Hỗ trợ phân trang, sắp xếp.",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/task_danhsach.png",alt:"Danh sách công việc",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"2. Tạo mới công việc"}),Et.jsx("br",{}),"- Nhấn nút ",Et.jsx("b",{children:"Tạo mới"})," để mở form nhập thông tin.",Et.jsx("br",{}),"- Nhập tiêu đề, mô tả, chọn vị trí, trạng thái, đính kèm file.",Et.jsx("br",{}),"- Có thể gán người thực hiện.",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/task_taomoi.png",alt:"Tạo mới công việc",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"3. Nhân sự thực hiện công việc (Partner)"}),Et.jsx("br",{}),"- Khi tạo hoặc sửa công việc, có thể chọn một hoặc nhiều nhân sự (partner) thực hiện từ danh sách đối tác.",Et.jsx("br",{}),"- Quy trình chi tiết:",Et.jsxs("ul",{style:{marginLeft:24},children:[Et.jsxs("li",{children:[Et.jsx("b",{children:"Bước 1:"})," Chọn đối tác/nhân sự từ danh sách partner khi tạo/sửa Task."]}),Et.jsxs("li",{children:[Et.jsx("b",{children:"Bước 2:"})," Sau khi lưu, nhân sự được gán sẽ nhận thông báo và xuất hiện trong danh sách công việc của họ."]}),Et.jsxs("li",{children:[Et.jsx("b",{children:"Bước 3:"})," Nhân sự (partner) có thể xác nhận, cập nhật trạng thái, đính kèm file, ghi chú tiến độ công việc."]}),Et.jsxs("li",{children:[Et.jsx("b",{children:"Bước 4:"})," Người tạo Task hoặc quản trị viên có thể thay đổi, bổ sung hoặc loại bỏ nhân sự thực hiện khi cần thiết."]}),Et.jsxs("li",{children:[Et.jsx("b",{children:"Bước 5:"})," Mọi thay đổi về nhân sự, trạng thái đều được lưu lại lịch sử (audit)."]})]}),"- Nhân sự thực hiện chính là các đối tác (partner) đã được quản lý trong chức năng ",Et.jsx(Xs,{code:!0,children:"/dc/partners"}),".",Et.jsx("br",{}),"- Có thể xem, tìm kiếm, chỉnh sửa thông tin partner trong trang quản lý đối tác.",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/task_nhansu.png",alt:"Nhân sự thực hiện công việc (partner)",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"3. Xem chi tiết công việc"}),Et.jsx("br",{}),"- Nhấn vào công việc để xem chi tiết: mô tả, file đính kèm, lịch sử thay đổi.",Et.jsx("br",{}),"- Xem trạng thái, người thực hiện, ghi chú.",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/task_chitiet.png",alt:"Chi tiết công việc",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"4. Sửa công việc"}),Et.jsx("br",{}),"- Nhấn ",Et.jsx("b",{children:"Chỉnh sửa"})," để cập nhật nội dung, trạng thái, file, người thực hiện.",Et.jsx("br",{}),"- Chỉ người tạo hoặc người được phân quyền mới được sửa.",Et.jsx("br",{})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"5. Xóa công việc"}),Et.jsx("br",{}),"- Nhấn ",Et.jsx("b",{children:"Xóa"})," để xóa công việc (cần xác nhận).",Et.jsx("br",{}),"- Chỉ người tạo hoặc quản trị viên mới được xóa.",Et.jsx("br",{})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"6. Đổi trạng thái công việc"}),Et.jsx("br",{}),"- Chuyển trạng thái: chờ xử lý → đang thực hiện → hoàn thành, hoặc tạm dừng, hủy.",Et.jsx("br",{}),"- Khi đổi trạng thái, hệ thống yêu cầu nhập lý do.",Et.jsx("br",{}),"- Lịch sử trạng thái được lưu lại.",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/task_doitrangthai.png",alt:"Đổi trạng thái công việc",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"7. Đính kèm & tải file"}),Et.jsx("br",{}),"- Đính kèm nhiều file cho mỗi công việc.",Et.jsx("br",{}),"- File có thể tải về hoặc xóa (nếu có quyền).",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/task_dinhkem.png",alt:"Đính kèm file công việc",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"8. Lịch sử thay đổi (Audit)"}),Et.jsx("br",{}),"- Mỗi lần chỉnh sửa, đổi trạng thái, xóa đều lưu lại lịch sử.",Et.jsx("br",{}),"- Xem chi tiết ai đã thay đổi gì, khi nào, lý do.",Et.jsx("br",{})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"9. Phân quyền & bảo mật"}),Et.jsx("br",{}),"- Chỉ người tạo, người được giao việc hoặc quản trị viên mới được sửa/xóa.",Et.jsx("br",{}),"- Người dùng khác chỉ được xem.",Et.jsx("br",{})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"10. Tìm kiếm & lọc nâng cao"}),Et.jsx("br",{}),"- Tìm kiếm theo từ khóa tiêu đề, mô tả.",Et.jsx("br",{}),"- Lọc theo trạng thái, vị trí, ngày tạo, người thực hiện.",Et.jsx("br",{})]})]})},{question:"Làm thế nào để quản lý thiết bị và lỗi thiết bị?",answer:Et.jsxs(Et.Fragment,{children:[Et.jsxs(Qs,{children:[Et.jsx("b",{children:"1. Xem danh sách thiết bị & lỗi thiết bị"}),Et.jsx("br",{}),"- Vào trang ",Et.jsx(Xs,{code:!0,children:"/dc/devices"})," để xem toàn bộ thiết bị và các lỗi liên quan.",Et.jsx("br",{}),"- Danh sách lỗi hiển thị các thông tin: thiết bị, số serial, mã lỗi, nguyên nhân, giải pháp, trạng thái xử lý, thời gian tạo, v.v.",Et.jsx("br",{}),"- Có thể xem chi tiết từng lỗi, lịch sử xử lý lỗi.",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/device_danhsach.png",alt:"Danh sách thiết bị & lỗi",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"2. Lọc, tìm kiếm lỗi thiết bị"}),Et.jsx("br",{}),"- Lọc lỗi theo: thiết bị, trạng thái xử lý, địa điểm, khoảng thời gian tạo lỗi.",Et.jsx("br",{}),"- Có thể kết hợp nhiều bộ lọc cùng lúc, hoặc reset tất cả về mặc định.",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/device_loc.png",alt:"Bộ lọc lỗi thiết bị",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"3. Tạo mới lỗi thiết bị"}),Et.jsx("br",{}),"- Nhấn nút ",Et.jsx("b",{children:"Tạo mới"})," để mở form nhập thông tin lỗi.",Et.jsx("br",{}),"- Chọn thiết bị, nhập địa điểm, tên thiết bị, số serial, mã lỗi, nguyên nhân, giải pháp, trạng thái xử lý.",Et.jsx("br",{}),"- Sau khi lưu, lỗi sẽ xuất hiện trong danh sách và có thể chỉnh sửa, cập nhật tiếp.",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/device_taomoi.png",alt:"Tạo mới lỗi thiết bị",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"4. Cập nhật trạng thái & xử lý lỗi"}),Et.jsx("br",{}),"- Nhấn vào nút ",Et.jsx("b",{children:"Chi tiết"})," để xem và cập nhật trạng thái xử lý, ghi chú, giải pháp cho từng lỗi.",Et.jsx("br",{}),'- Có thể chuyển trạng thái từ "Chưa xử lý" sang "Đã xử lý", nhập thời gian xử lý, người xử lý, ghi chú giải pháp.',Et.jsx("br",{}),"- Mọi thay đổi đều được lưu lại lịch sử.",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/device_chitiet.png",alt:"Chi tiết & cập nhật lỗi",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"5. Xem lịch sử lỗi thiết bị"}),Et.jsx("br",{}),"- Mỗi lỗi đều có thể xem lịch sử thay đổi, quá trình xử lý, ai đã cập nhật, khi nào.",Et.jsx("br",{}),"- Lịch sử giúp truy vết toàn bộ quá trình xử lý sự cố.",Et.jsx("br",{}),Et.jsx(Ye,{src:"/faq/device_history.png",alt:"Lịch sử xử lý lỗi",width:600,style:{margin:"16px 0"}})]}),Et.jsxs(Qs,{children:[Et.jsx("b",{children:"6. Phân quyền & bảo mật"}),Et.jsx("br",{}),"- Chỉ người có quyền (DataCenter, quản trị viên) mới được tạo mới, cập nhật, xử lý lỗi thiết bị.",Et.jsx("br",{}),"- Người dùng khác chỉ có thể xem, không được chỉnh sửa.",Et.jsx("br",{})]})]})}],Js=()=>Et.jsxs("div",{style:{padding:24,maxWidth:900,margin:"0 auto"},children:[Et.jsx(Ys,{level:2,style:{color:"#003c71"},children:"FAQ - Hướng dẫn sử dụng cho DataCenter"}),Et.jsx(h,{}),Gs.map((e,t)=>Et.jsxs(f,{style:{marginBottom:32},children:[Et.jsx(Ys,{level:4,children:e.question}),Et.jsx("div",{children:e.answer})]},t))]}),Zs=({importFunc:t,fallback:n=null,placeholder:r=null,threshold:a=.1,rootMargin:i="100px",onLoad:l=null,forceLoad:o=!1})=>{const[c,d]=e.useState(!1),[u,h]=e.useState(null),[m,p]=e.useState(!1),[f,g]=e.useState(null),[x,y]=((t={})=>{const[n,r]=e.useState(!1),[a,i]=e.useState(!1),s=e.useRef(null),{threshold:l=.1,rootMargin:o="50px",root:c=null,triggerOnce:d=!0}=t,u=e.useCallback(e=>{const[t]=e;t.isIntersecting?(r(!0),d&&i(!0)):d||r(!1)},[d]);return e.useEffect(()=>{const e=s.current;if(!e)return;const t=new IntersectionObserver(u,{threshold:l,rootMargin:o,root:c});return t.observe(e),()=>{e&&t.unobserve(e)}},[u,l,o,c]),[s,n,a]})({threshold:a,rootMargin:i,triggerOnce:!0});b.useEffect(()=>{!y&&!o||c||(d(!0),p(!0),setTimeout(()=>{t().then(e=>{h(()=>e.default),p(!1),l&&l()}).catch(e=>{g(e),p(!1)})},o?0:100))},[y,c,t,o]);const v=Et.jsxs("div",{className:"lazy-section-loading",style:{padding:"40px",textAlign:"center",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",border:"2px dashed #d9d9d9",borderRadius:"12px",margin:"20px 0",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer"},onClick:()=>{c||(d(!0),p(!0),t().then(e=>{h(()=>e.default),p(!1),l&&l()}).catch(e=>{g(e),p(!1)}))},children:[Et.jsx("div",{style:{fontSize:"48px",color:"#1890ff",marginBottom:"16px",animation:"pulse 2s ease-in-out infinite"},children:"⏳"}),Et.jsx("h3",{style:{color:"#1890ff",marginBottom:"12px",fontSize:"18px",fontWeight:"600"},children:"Cuộn xuống để tải nội dung"}),Et.jsx("p",{style:{color:"#666",fontSize:"14px",margin:0},children:"Click để tải ngay"})]});return m?Et.jsxs("div",{style:{padding:"40px",textAlign:"center",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",border:"2px dashed #d9d9d9",borderRadius:"12px",margin:"20px 0"},children:[Et.jsx(s,{size:"large"}),Et.jsx("div",{style:{marginTop:"16px",color:"#1890ff",fontSize:"16px",fontWeight:"600"},children:"Đang tải nội dung..."})]}):f?Et.jsxs("div",{style:{padding:"40px",textAlign:"center",background:"#fff2f0",border:"2px dashed #ff4d4f",borderRadius:"12px",margin:"20px 0"},children:[Et.jsx("div",{style:{fontSize:"48px",color:"#ff4d4f",marginBottom:"16px"},children:"❌"}),Et.jsx("h3",{style:{color:"#ff4d4f",marginBottom:"12px",fontSize:"18px",fontWeight:"600"},children:"Lỗi tải nội dung"}),Et.jsx("p",{style:{color:"#666",fontSize:"14px",margin:0},children:"Vui lòng thử lại sau"}),Et.jsx("button",{onClick:()=>{g(null),d(!1),h(null)},style:{marginTop:"16px",padding:"8px 16px",background:"#ff4d4f",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Thử lại"})]}):Et.jsx("div",{ref:x,children:u?Et.jsx(e.Suspense,{fallback:Et.jsxs("div",{style:{padding:"40px",textAlign:"center",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",border:"2px dashed #d9d9d9",borderRadius:"12px",margin:"20px 0"},children:[Et.jsx(s,{size:"large"}),Et.jsx("div",{style:{marginTop:"16px",color:"#1890ff",fontSize:"16px",fontWeight:"600"},children:"Đang tải nội dung..."})]}),children:Et.jsx(u,{})}):r||v})},el=(e="#0072BC")=>({backgroundColor:e,color:"#fff",padding:"8px",borderRadius:"8px",margin:"8px",textAlign:"center"}),tl=(e="#0072BC")=>({margin:"0",fontSize:"20px",fontWeight:"bold",textAlign:"center",color:"#fff",backgroundColor:e}),{Sider:nl,Content:rl}=g,al=({menuItems:t,children:n,title:r="Hệ thống tài liệu kỹ thuật",headerBgColor:a="#0072BC",layoutClassName:i="",contentClassName:s="",defaultOpenKeys:l=["1","2","3","4"],selectedKey:o="1",onMenuClick:c})=>{const[d,u]=e.useState(o);return Et.jsxs(g,{className:"system-layout "+i,children:[Et.jsx("div",{className:"menu-container",children:Et.jsxs(nl,{width:380,className:"system-sider",theme:"dark",children:[Et.jsx("div",{className:"menu-header",style:el(a),children:Et.jsx("h3",{style:tl(a),children:r})}),Et.jsx(j,{mode:"inline",theme:"dark",selectedKeys:[d],defaultOpenKeys:l,items:t,onClick:e=>{c?c(e):(({key:e},t)=>{t(e);let n=document.getElementById("section-"+e);if(n||(n=document.getElementById(e)),!n&&e.includes(".")){const t=e.split(".")[0];n=document.getElementById("section-"+t)}if(n){const e=document.querySelector(".system-content, .cooling-system-content");if(e){const t=n.getBoundingClientRect(),r=e.getBoundingClientRect(),a=e.scrollTop,i=t.top-r.top+a;e.scrollTo({top:i-20,behavior:"smooth"})}}else{const e=document.querySelector(".system-content, .cooling-system-content");e&&e.scrollTo({top:0,behavior:"smooth"})}})(e,u)},className:"system-menu",expandIcon:null})]})}),Et.jsx(g,{children:Et.jsx(rl,{className:"system-content "+s,children:Et.jsx("div",{className:"content-wrapper",children:n})})})]})},il={},sl=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),a=n?.nonce||n?.getAttribute("nonce");r=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in il)return;il[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,a&&r.setAttribute("nonce",a),document.head.appendChild(r),t?new Promise((t,n)=>{r.addEventListener("load",t),r.addEventListener("error",()=>n(Error("Unable to preload CSS for "+e)))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})},ll=()=>{const{sidebarReady:t,isAnimating:n}=on(),[r,a]=e.useState(0),[i,l]=e.useState(!1),o=[{id:"1",name:"Giới thiệu chung",importFunc:()=>sl(()=>import("./IntroductionSection-CV6Zfowm.js"),__vite__mapDeps([0,1,2,3,4,5])),priority:"high",preload:!0},{id:"2",name:"Hướng dẫn thiết bị",importFunc:()=>sl(()=>import("./DeviceGuideSection-Mo29vtQe.js"),__vite__mapDeps([6,1,2,3,4,5])),priority:"high",preload:!1},{id:"3",name:"Vị trí hệ thống",importFunc:()=>sl(()=>import("./LocationSection-PLcYMTOU.js"),__vite__mapDeps([7,1,2,3,4,5])),priority:"medium",preload:!1},{id:"4",name:"Ứng dụng",importFunc:()=>sl(()=>import("./ApplicationSection-Bzv8YyNq.js"),__vite__mapDeps([8,1,2,9,3,4,5])),priority:"medium",preload:!1},{id:"5",name:"Liên hệ",importFunc:()=>sl(()=>import("./ContactSection-DyJm2yT1.js"),__vite__mapDeps([10,1,2,3,4,5])),priority:"low",preload:!1},{id:"6",name:"Tài liệu",importFunc:()=>sl(()=>import("./DocumentationSection-DvP2zZeJ.js"),__vite__mapDeps([11,1,2,3,4,5])),priority:"low",preload:!1}];e.useEffect(()=>{if(t&&!n){const e=o.find(e=>e.preload);e&&e.importFunc().then(()=>{a(1)})}},[t,n]),e.useEffect(()=>{if(t&&!n){const e=setTimeout(()=>{l(!0)},200);return()=>clearTimeout(e)}},[t,n]);const c=()=>{a(e=>e+1)},d=Math.round(r/o.length*100);return n||!t?Et.jsx("div",{className:"cooling-content",children:Et.jsx("div",{className:"loading-container",children:Et.jsxs("div",{style:{textAlign:"center"},children:[Et.jsx(s,{size:"large"}),Et.jsx("p",{className:"loading-text",children:"Đang tải tài liệu hệ thống làm mát TTDL Hòa Lạc..."})]})})}):Et.jsxs("div",{className:"cooling-content",children:[r<o.length&&Et.jsxs("div",{className:"progress-indicator",children:[Et.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[Et.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[Et.jsx("div",{style:{fontSize:"24px",animation:"pulse 2s ease-in-out infinite"},children:"📚"}),Et.jsxs("div",{children:[Et.jsx("h4",{style:{margin:0,color:"#1890ff",fontSize:"16px",fontWeight:"600"},children:"Đang tải nội dung"}),Et.jsxs("p",{style:{margin:0,color:"#666",fontSize:"12px"},children:[r,"/",o.length," phần đã sẵn sàng"]})]})]}),Et.jsxs("div",{style:{fontSize:"14px",fontWeight:"600",color:"#1890ff"},children:[d,"%"]})]}),Et.jsx(pe,{percent:d,strokeColor:{"0%":"#1890ff","100%":"#0072BC"},trailColor:"#e8e8e8",size:[8,8],showInfo:!1,style:{margin:0}})]}),o.map((e,t)=>Et.jsx("div",{id:"section-"+e.id,style:{scrollMarginTop:"20px"},children:Et.jsx(Zs,{importFunc:e.importFunc,forceLoad:i,placeholder:Et.jsxs("div",{style:{padding:"30px",textAlign:"center",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",border:"2px dashed #d9d9d9",borderRadius:"12px",margin:"20px 0",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer"},className:"lazy-section-placeholder",children:[Et.jsx("div",{style:{fontSize:"36px",color:"#1890ff",marginBottom:"12px",animation:"pulse 2s ease-in-out infinite"},children:"⏳"}),Et.jsx("h3",{style:{color:"#1890ff",marginBottom:"8px",fontSize:"16px",fontWeight:"600"},children:e.name}),Et.jsx("p",{style:{color:"#666",fontSize:"12px",margin:0},children:"Cuộn xuống để tải nội dung"})]}),threshold:.1,rootMargin:"100px",onLoad:c})},t)),r===o.length&&Et.jsxs("div",{style:{textAlign:"center",padding:"20px",background:"linear-gradient(135deg, #f6ffed 0%, #e6f7ff 100%)",border:"1px solid #b7eb8f",borderRadius:"8px",margin:"20px 0"},children:[Et.jsx("div",{style:{fontSize:"24px",marginBottom:"8px"},children:"✅"}),Et.jsx("p",{style:{margin:0,color:"#52c41a",fontWeight:"600"},children:"Tất cả nội dung đã được tải xong!"})]})]})},ol=()=>{const[t,n]=e.useState("1"),r=[{key:"1",icon:Et.jsx(Y,{}),label:"1. GIỚI THIỆU CHUNG",children:[{key:"1a",label:"1.1 Thông số kỹ thuật"},{key:"1b",label:"1.2 Cấu trúc đặt tên của các model thuộc TTDL Hòa Lạc"},{key:"1c",label:"1.3 Nguyên lý hoạt động của hệ thống làm mát Trung tâm dữ liệu Hòa Lạc"}]},{key:"2",icon:Et.jsx(M,{}),label:"2. HƯỚNG DẪN CHI TIẾT TỪNG THIẾT BỊ",children:[{key:"2.1",label:"2.1. TDAV1321A - UNIFLAIR",children:[{key:"2.1.1",label:"2.1.1. Thông tin chung"},{key:"2.1.2",label:"2.1.2. Hướng dẫn lắp đặt"},{key:"2.1.3",label:"2.1.3. Hướng dẫn vận hành và kiểm tra hàng ngày"},{key:"2.1.4",label:"2.1.4. Hướng dẫn xác định nguyên nhân lỗi"},{key:"2.1.5",label:"2.1.5. Quy trình và chu kỳ bảo trì"}]},{key:"2.2",label:"2.2. TDAV2242A - UNIFLAIR",children:[{key:"2.2.1",label:"2.2.1. Thông tin chung"},{key:"2.2.2",label:"2.2.2. Hướng dẫn lắp đặt"},{key:"2.2.3",label:"2.2.3. Hướng dẫn vận hành và kiểm tra hàng ngày"},{key:"2.2.4",label:"2.2.4. Hướng dẫn xác định nguyên nhân lỗi"},{key:"2.2.5",label:"2.2.5. Quy trình và chu kỳ bảo trì"}]},{key:"2.3",label:"2.3. TDAV2842A - UNIFLAIR",children:[{key:"2.3.1",label:"2.3.1. Thông tin chung"},{key:"2.3.2",label:"2.3.2. Hướng dẫn lắp đặt"},{key:"2.3.3",label:"2.3.3. Hướng dẫn vận hành và kiểm tra hàng ngày"},{key:"2.3.4",label:"2.3.4. Hướng dẫn xác định nguyên nhân lỗi"},{key:"2.3.5",label:"2.3.5. Quy trình và chu kỳ bảo trì"}]},{key:"2.4",label:"2.4. FM40H-AGB-ESD-APC",children:[{key:"2.4.1",label:"2.4.1. Thông tin chung"},{key:"2.4.2",label:"2.4.2. Hướng dẫn cài đặt và cấu hình ban đầu"},{key:"2.4.3",label:"2.4.3. Hướng dẫn vận hành và kiểm tra hàng ngày"},{key:"2.4.4",label:"2.4.4. Hướng dẫn xác định nguyên nhân lỗi"},{key:"2.4.5",label:"2.4.5. Quy định và chu kỳ bảo trì"},{key:"2.4.6",label:"2.4.6. Hướng dẫn bảo trì từng thành phần"}]},{key:"2.5",label:"2.5. ACRP102 - APC",children:[{key:"2.5.1",label:"2.5.1. Thông tin chung"},{key:"2.5.2",label:"2.5.2. Hướng dẫn cài đặt và cấu hình ban đầu"},{key:"2.5.3",label:"2.5.3. Hướng dẫn vận hành và kiểm tra hàng ngày"},{key:"2.5.4",label:"2.5.4. Hướng dẫn xác định nguyên nhân lỗi"},{key:"2.5.5",label:"2.5.5. Quy định và chu kỳ bảo trì"},{key:"2.5.6",label:"2.5.6. Hướng dẫn bảo trì từng thành phần"}]},{key:"2.6",label:"2.6. Quạt sàn AFM4500B",children:[{key:"2.6.1",label:"2.6.1. Thông tin chung"},{key:"2.6.2",label:"2.6.2. Hướng dẫn lắp đặt"},{key:"2.6.3",label:"2.6.3. Hướng dẫn vận hành"},{key:"2.6.4",label:"2.6.4. Cách xác nhận lỗi"}]}]},{key:"3",icon:Et.jsx(Pe,{}),label:"3. DÀN NÓNG VÀ ÁT ĐIỆN ĐIỀU HÒA",children:[{key:"3.1",label:"3.1 Vị trí dàn nóng"},{key:"3.2",label:"3.2 Vị trí át điện điều hòa"}]},{key:"4",icon:Et.jsx(Xe,{}),label:"4. ỨNG DỤNG",style:{fontWeight:"bold"},children:[{key:"4.1",label:"4.1. Quy trình vận hành hàng ngày chung của hệ thống làm mát"},{key:"4.2",label:"4.2. Tổng hợp mã lỗi, nguyên nhân và cách giải quyết"},{key:"4.3",label:"4.3. Vị trí, Seri, IP, hợp đồng bảo trì liên quan cụ thể"},{key:"4.4",label:"4.4. Xem và thiết lập thông số của các điều hòa qua Website"}]},{key:"5",icon:Et.jsx(Re,{}),label:"5. LIÊN HỆ",style:{fontWeight:"bold"}},{key:"6",icon:Et.jsx(D,{}),label:"6. TÀI LIỆU",style:{fontWeight:"bold"}}];return Et.jsx(al,{menuItems:r,title:"Hệ thống làm mát TTDL Hòa Lạc",headerBgColor:"#0072BC",selectedKey:t,children:Et.jsx(ll,{})})},cl=()=>{const{sidebarReady:t,isAnimating:n}=on(),[r,a]=e.useState(0),[i,l]=e.useState(!1),o=[{id:"1",name:"Giới thiệu chung",importFunc:()=>sl(()=>import("./IntroductionSection-DYbmWYeZ.js"),__vite__mapDeps([12,1,2,3,4,5])),priority:"high",preload:!0},{id:"2",name:"Hướng dẫn thiết bị",importFunc:()=>sl(()=>import("./DeviceGuideSection-DGg3WCBZ.js"),__vite__mapDeps([13,1,2,3,4,5])),priority:"high",preload:!1},{id:"3",name:"Vị trí hệ thống",importFunc:()=>sl(()=>import("./LocationSection-DN3Lxmmc.js"),__vite__mapDeps([14,1,2,3,4,5])),priority:"medium",preload:!1},{id:"4",name:"Ứng dụng",importFunc:()=>sl(()=>import("./ApplicationSection-DVElrqRQ.js"),__vite__mapDeps([15,1,2,3,4,5])),priority:"medium",preload:!1},{id:"5",name:"Liên hệ",importFunc:()=>sl(()=>import("./ContactSection-D9KhdNcp.js"),__vite__mapDeps([16,1,2,3,4,5])),priority:"low",preload:!1},{id:"6",name:"Tài liệu",importFunc:()=>sl(()=>import("./DocumentationSection-yphxmiRi.js"),__vite__mapDeps([17,1,2,3,4,5])),priority:"low",preload:!1}];e.useEffect(()=>{if(t&&!n){const e=o.find(e=>e.preload);e&&e.importFunc().then(()=>{a(1)})}},[t,n]),e.useEffect(()=>{if(t&&!n){const e=setTimeout(()=>{l(!0)},200);return()=>clearTimeout(e)}},[t,n]);const c=()=>{a(e=>e+1)},d=Math.round(r/o.length*100);return n||!t?Et.jsx("div",{className:"cooling-content",children:Et.jsx("div",{className:"loading-container",children:Et.jsxs("div",{style:{textAlign:"center"},children:[Et.jsx(s,{size:"large"}),Et.jsx("p",{className:"loading-text",children:"Đang tải tài liệu hệ thống làm mát TTDL Vân Canh..."})]})})}):Et.jsxs("div",{className:"cooling-content",children:[r<o.length&&Et.jsxs("div",{className:"progress-indicator",children:[Et.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[Et.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[Et.jsx("div",{style:{fontSize:"24px",animation:"pulse 2s ease-in-out infinite"},children:"📚"}),Et.jsxs("div",{children:[Et.jsx("h4",{style:{margin:0,color:"#1890ff",fontSize:"16px",fontWeight:"600"},children:"Đang tải nội dung"}),Et.jsxs("p",{style:{margin:0,color:"#666",fontSize:"12px"},children:[r,"/",o.length," phần đã sẵn sàng"]})]})]}),Et.jsxs("div",{style:{fontSize:"14px",fontWeight:"600",color:"#1890ff"},children:[d,"%"]})]}),Et.jsx(pe,{percent:d,strokeColor:{"0%":"#1890ff","100%":"#0072BC"},trailColor:"#e8e8e8",size:[8,8],showInfo:!1,style:{margin:0}})]}),o.map((e,t)=>Et.jsxs("div",{id:"section-"+e.id,style:{scrollMarginTop:"20px"},children:[Et.jsx(Zs,{importFunc:e.importFunc,forceLoad:i,placeholder:Et.jsxs("div",{style:{padding:"30px",textAlign:"center",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",border:"2px dashed #d9d9d9",borderRadius:"12px",margin:"20px 0",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer"},className:"lazy-section-placeholder",children:[Et.jsx("div",{style:{fontSize:"36px",color:"#1890ff",marginBottom:"12px",animation:"pulse 2s ease-in-out infinite"},children:"⏳"}),Et.jsx("h3",{style:{color:"#1890ff",marginBottom:"8px",fontSize:"16px",fontWeight:"600"},children:e.name}),Et.jsx("p",{style:{color:"#666",fontSize:"12px",margin:0},children:"Cuộn xuống để tải nội dung"})]}),threshold:.1,rootMargin:"100px",onLoad:c}),t<o.length-1&&Et.jsx(h,{style:{margin:"32px 0",borderColor:"#e8e8e8",opacity:.6}})]},t)),r===o.length&&Et.jsxs("div",{style:{textAlign:"center",padding:"20px",background:"linear-gradient(135deg, #f6ffed 0%, #e6f7ff 100%)",border:"1px solid #b7eb8f",borderRadius:"8px",margin:"20px 0"},children:[Et.jsx("div",{style:{fontSize:"24px",marginBottom:"8px"},children:"✅"}),Et.jsx("p",{style:{margin:0,color:"#52c41a",fontWeight:"600"},children:"Tất cả nội dung đã được tải xong!"})]})]})},dl=()=>{const[t,n]=e.useState("1"),r=[{key:"1",icon:Et.jsx(Y,{}),label:"1. GIỚI THIỆU CHUNG",children:[{key:"1a",label:"1.1 Thông số kỹ thuật"},{key:"1b",label:"1.2 Cấu trúc đặt tên của các model thuộc TTDL Vân Canh"},{key:"1c",label:"1.3 Nguyên lý hoạt động của hệ thống làm mát Trung tâm dữ liệu Vân Canh"}]},{key:"2",icon:Et.jsx(M,{}),label:"2. HƯỚNG DẪN CHI TIẾT TỪNG THIẾT BỊ",children:[{key:"2.1",label:"2.1. Chiller SMARDT AE Series",children:[{key:"2.1.1",label:"2.1.1. Thông tin chung"},{key:"2.1.2",label:"2.1.2. Hướng dẫn lắp đặt"},{key:"2.1.3",label:"2.1.3. Hướng dẫn vận hành và kiểm tra hàng ngày"},{key:"2.1.4",label:"2.1.4. Hướng dẫn xác định nguyên nhân lỗi"},{key:"2.1.5",label:"2.1.5. Quy trình và chu kỳ bảo trì"}]},{key:"2.2",label:"2.2. PAC UNIFLAIR SDCV Series",children:[{key:"2.2.1",label:"2.2.1. Thông tin chung"},{key:"2.2.2",label:"2.2.2. Hướng dẫn lắp đặt"},{key:"2.2.3",label:"2.2.3. Hướng dẫn vận hành và kiểm tra hàng ngày"},{key:"2.2.4",label:"2.2.4. Hướng dẫn xác định nguyên nhân lỗi"},{key:"2.2.5",label:"2.2.5. Quy trình và chu kỳ bảo trì"}]},{key:"2.3",label:"2.3. PAC UNIFLAIR LDCV Series",children:[{key:"2.3.1",label:"2.3.1. Thông tin chung"},{key:"2.3.2",label:"2.3.2. Hướng dẫn lắp đặt"},{key:"2.3.3",label:"2.3.3. Hướng dẫn vận hành và kiểm tra hàng ngày"},{key:"2.3.4",label:"2.3.4. Hướng dẫn xác định nguyên nhân lỗi"},{key:"2.3.5",label:"2.3.5. Quy trình và chu kỳ bảo trì"}]},{key:"2.4",label:"2.4. Easy InRow CW Series",children:[{key:"2.4.1",label:"2.4.1. Thông tin chung"},{key:"2.4.2",label:"2.4.2. Hướng dẫn cài đặt và cấu hình ban đầu"},{key:"2.4.3",label:"2.4.3. Hướng dẫn vận hành và kiểm tra hàng ngày"},{key:"2.4.4",label:"2.4.4. Hướng dẫn xác định nguyên nhân lỗi"},{key:"2.4.5",label:"2.4.5. Quy định và chu kỳ bảo trì"},{key:"2.4.6",label:"2.4.6. Hướng dẫn bảo trì từng thành phần"}]},{key:"2.5",label:"2.5. Hệ thống BMS Chiller",children:[{key:"2.5.1",label:"2.5.1. Thông tin chung"},{key:"2.5.2",label:"2.5.2. Hướng dẫn cài đặt và cấu hình ban đầu"},{key:"2.5.3",label:"2.5.3. Hướng dẫn vận hành và kiểm tra hàng ngày"},{key:"2.5.4",label:"2.5.4. Hướng dẫn xác định nguyên nhân lỗi"},{key:"2.5.5",label:"2.5.5. Quy định và chu kỳ bảo trì"},{key:"2.5.6",label:"2.5.6. Hướng dẫn bảo trì từng thành phần"}]},{key:"2.6",label:"2.6. Hệ thống bơm nước và thiết bị phụ trợ",children:[{key:"2.6.1",label:"2.6.1. Bơm tuần hoàn 3D 40-200"},{key:"2.6.2",label:"2.6.2. Tank duy trì áp suất SHC"},{key:"2.6.3",label:"2.6.3. Bình giãn nở màng ExpanSion"},{key:"2.6.4",label:"2.6.4. Bộ tách khí tự động KVS-870"},{key:"2.6.5",label:"2.6.5. Cụm nạp hóa chất DPD-30"},{key:"2.6.6",label:"2.6.6. Dosing Pot 22L"},{key:"2.6.7",label:"2.6.7. BTU Meter F-1000"},{key:"2.6.8",label:"2.6.8. BTU System-10 Dry-Tap"},{key:"2.6.9",label:"2.6.9. Đồng hồ lưu lượng LXLC"},{key:"2.6.10",label:"2.6.10. TES Tank BTD-360"},{key:"2.6.11",label:"2.6.11. Van cân bằng Herz 4006"},{key:"2.6.12",label:"2.6.12. Van PICV Herz 4206"},{key:"2.6.13",label:"2.6.13. Lưu ý vận hành hệ thống bơm"}]}]},{key:"3",icon:Et.jsx(Pe,{}),label:"3. VỊ TRÍ HỆ THỐNG",children:[{key:"3.1",label:"3.1 Sơ đồ bố trí tổng thể"},{key:"3.2",label:"3.2 Vị trí các thiết bị chính"},{key:"3.3",label:"3.3 Đường ống và hệ thống phân phối"}]},{key:"4",icon:Et.jsx(Xe,{}),label:"4. ỨNG DỤNG",style:{fontWeight:"bold"},children:[{key:"4.1",label:"4.1. Quy trình vận hành hàng ngày chung của hệ thống làm mát"},{key:"4.2",label:"4.2. Tổng hợp mã lỗi, nguyên nhân và cách giải quyết"},{key:"4.3",label:"4.3. Vị trí, Seri, IP, hợp đồng bảo trì liên quan cụ thể"},{key:"4.4",label:"4.4. Xem và thiết lập thông số của các điều hòa qua Website"},{key:"4.5",label:"4.5. Biểu đồ hiệu suất và phân tích kỹ thuật"}]},{key:"5",icon:Et.jsx(Re,{}),label:"5. LIÊN HỆ",style:{fontWeight:"bold"}},{key:"6",icon:Et.jsx(D,{}),label:"6. TÀI LIỆU",style:{fontWeight:"bold"}}];return Et.jsx(al,{menuItems:r,title:"Hệ thống làm mát TTDL Vân Canh",headerBgColor:"#1890ff",selectedKey:t,children:Et.jsx(cl,{})})},{Title:ul,Text:hl}=r,{Content:ml}=g,pl=()=>{const e=mt(),t=[{key:"cooling",title:"Hệ thống làm mát",icon:Et.jsx(O,{}),description:"Quản lý và vận hành hệ thống điều hòa",route:"/dc/system-info/COOLING",color:"#1890ff",gradient:"linear-gradient(135deg, #1890ff 0%, #096dd9 100%)"},{key:"electrical",title:"Hệ thống điện",icon:Et.jsx(Ke,{}),description:"UPS, ATS, tủ điện phân phối",route:"/dc/system-info/ELECTRICAL",color:"#52c41a",gradient:"linear-gradient(135deg, #52c41a 0%, #389e0d 100%)"},{key:"fire",title:"Hệ thống PCCC",icon:Et.jsx(Ge,{}),description:"Báo cháy, chữa cháy tự động",route:"/dc/system-info/FIRE",color:"#fa541c",gradient:"linear-gradient(135deg, #fa541c 0%, #d4380d 100%)"},{key:"monitoring",title:"Giám sát hệ thống",icon:Et.jsx(M,{}),description:"DCIM, cảm biến, cảnh báo",route:"/dc/system-info/MONITORING",color:"#eb2f96",gradient:"linear-gradient(135deg, #eb2f96 0%, #c41d7f 100%)"}],n=[{key:"cooling",title:"Hệ thống làm mát",icon:Et.jsx(O,{}),description:"Quản lý và vận hành hệ thống điều hòa",route:"/dc/system-info/COOLING",color:"#1890ff",gradient:"linear-gradient(135deg, #1890ff 0%, #096dd9 100%)"},{key:"electrical",title:"Hệ thống điện",icon:Et.jsx(Ke,{}),description:"UPS, ATS, tủ điện phân phối",route:"/dc/system-info/ELECTRICAL",color:"#52c41a",gradient:"linear-gradient(135deg, #52c41a 0%, #389e0d 100%)"}],r=(t,n,r)=>Et.jsxs("div",{style:{marginBottom:"40px"},children:[Et.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"20px",padding:"16px 20px",background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",borderRadius:"12px",border:"1px solid #e2e8f0"},children:[Et.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[Et.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, #1890ff 0%, #096dd9 100%)",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"12px",color:"white",fontSize:"20px"},children:r}),Et.jsxs("div",{children:[Et.jsx(ul,{level:4,style:{margin:0,color:"#1a1a1a",fontWeight:"600",fontSize:"20px"},children:t}),Et.jsx(hl,{style:{color:"#666",fontSize:"13px"},children:"Tài liệu hệ thống và hướng dẫn vận hành"})]})]}),Et.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"6px 12px",background:"rgba(24, 144, 255, 0.1)",borderRadius:"16px",border:"1px solid rgba(24, 144, 255, 0.2)"},children:[Et.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:"#1890ff"}}),Et.jsxs(hl,{style:{fontSize:"11px",color:"#1890ff",fontWeight:"600"},children:[n.length," hệ thống"]})]})]}),Et.jsx(X,{gutter:[16,16],children:n.map(n=>Et.jsx(G,{xs:24,sm:12,children:Et.jsx(f,{hoverable:!0,className:"system-menu-card",style:{height:"120px",backgroundColor:"#ffffff",border:"1px solid #f0f0f0",borderRadius:"16px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",cursor:"pointer",overflow:"hidden",position:"relative","--card-gradient":n.gradient},styles:{body:{padding:"18px",height:"100%"}},onClick:()=>((t,n)=>{const r=window.location.pathname.split("/")[1]||"dc";e("/dc/system-info/COOLING"===t?"hoalac"===n?`/${r}/cooling-system`:"vancanh"===n?`/${r}/cooling-system-vancanh`:`/${r}/cooling-system`:`/${r}/shifts`)})(n.route,"TTDL Hòa Lạc"===t?"hoalac":"vancanh"),children:Et.jsxs("div",{className:"card-content",children:[Et.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[Et.jsx("div",{style:{fontSize:"26px",color:n.color,marginRight:"14px",transition:"all 0.3s ease",display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",borderRadius:"10px",background:n.color+"10"},children:n.icon}),Et.jsx(ul,{level:5,style:{margin:0,color:"#1a1a1a",fontSize:"16px",fontWeight:"600",lineHeight:"1.3",flex:1},children:n.title})]}),Et.jsx(hl,{style:{fontSize:"13px",color:"#666",lineHeight:"1.4",display:"block"},children:n.description}),Et.jsx("div",{className:"card-arrow",style:{position:"absolute",top:"16px",right:"16px",color:n.color,fontSize:"14px",opacity:"0.6",transition:"all 0.3s ease"},children:Et.jsx(ye,{})})]})})},n.key))})]});return Et.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",padding:"20px"},children:Et.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:[Et.jsxs("div",{style:{textAlign:"center",marginBottom:"32px",padding:"40px 30px",background:"linear-gradient(135deg, #1890ff 0%, #096dd9 30%, #0050b3 70%, #003a8c 100%)",borderRadius:"24px",boxShadow:"0 12px 40px rgba(24, 144, 255, 0.25), 0 4px 20px rgba(0, 0, 0, 0.1)",border:"1px solid rgba(24, 144, 255, 0.2)",position:"relative",overflow:"hidden"},children:[Et.jsx("div",{style:{position:"absolute",top:"-50%",left:"-50%",width:"200%",height:"200%",background:"radial-gradient(circle at 30% 20%, rgba(255,255,255,0.15) 0%, transparent 40%), radial-gradient(circle at 70% 80%, rgba(255,255,255,0.1) 0%, transparent 40%), radial-gradient(circle at 90% 10%, rgba(255,255,255,0.08) 0%, transparent 30%)",animation:"float 6s ease-in-out infinite",pointerEvents:"none"}}),Et.jsx("div",{style:{position:"absolute",top:"20%",left:"15%",width:"8px",height:"8px",background:"rgba(255,255,255,0.6)",borderRadius:"50%",animation:"pulse 3s ease-in-out infinite"}}),Et.jsx("div",{style:{position:"absolute",top:"60%",right:"20%",width:"6px",height:"6px",background:"rgba(255,255,255,0.4)",borderRadius:"50%",animation:"pulse 4s ease-in-out infinite 1s"}}),Et.jsx("div",{style:{position:"absolute",top:"30%",right:"10%",width:"4px",height:"4px",background:"rgba(255,255,255,0.5)",borderRadius:"50%",animation:"pulse 5s ease-in-out infinite 2s"}}),Et.jsxs("div",{style:{position:"relative",zIndex:2},children:[Et.jsxs("div",{style:{width:"70px",height:"70px",borderRadius:"18px",background:"linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px",color:"#1890ff",fontSize:"32px",boxShadow:"0 8px 32px rgba(0,0,0,0.15), 0 0 0 1px rgba(255,255,255,0.1)",position:"relative",animation:"float 4s ease-in-out infinite"},children:[Et.jsx(Pe,{}),Et.jsx("div",{style:{position:"absolute",top:"-8px",left:"-8px",right:"-8px",bottom:"-8px",background:"radial-gradient(circle, rgba(24, 144, 255, 0.3) 0%, transparent 70%)",borderRadius:"26px",filter:"blur(6px)",zIndex:-1}})]}),Et.jsx(ul,{level:1,style:{margin:"0 0 12px 0",fontWeight:"800",fontSize:"32px",color:"#ffffff",textShadow:"0 4px 8px rgba(0,0,0,0.3), 0 2px 4px rgba(0,0,0,0.2)",letterSpacing:"-0.5px",lineHeight:"1.2"},children:"Tài liệu các hệ thống Trung Tâm Dữ Liệu"}),Et.jsx("div",{style:{display:"inline-block",padding:"8px 20px",background:"rgba(255,255,255,0.15)",borderRadius:"16px",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,0.2)",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"},children:Et.jsx(hl,{style:{fontSize:"14px",color:"#ffffff",fontWeight:"500",textShadow:"0 1px 2px rgba(0,0,0,0.2)",margin:0},children:"🚀 Tổng hợp tài liệu hướng dẫn và quy trình vận hành 🚀"})})]})]}),Et.jsx("div",{style:{background:"#ffffff",borderRadius:"20px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",padding:"24px",border:"1px solid #e2e8f0"},children:Et.jsxs(X,{gutter:[24,24],children:[Et.jsx(G,{xs:24,lg:12,children:r("TTDL Hòa Lạc",t,Et.jsx(Pe,{}))}),Et.jsx(G,{xs:24,lg:12,children:r("TTDL Vân Canh",n,Et.jsx(Pe,{}))})]})})]})})},{Title:fl,Text:gl}=r,xl=()=>{const[t,n]=e.useState([]),[r,a]=e.useState(!1),[i,s]=e.useState(!1),[l,o]=e.useState(null),c=[{id:1,name:"Phòng Datacenter 1",code:"DC1",description:"Phòng datacenter chính",staffCount:15,status:"active"},{id:2,name:"Phòng Datacenter 2",code:"DC2",description:"Phòng datacenter phụ",staffCount:12,status:"active"},{id:3,name:"Phòng Backup",code:"BACKUP",description:"Phòng backup dữ liệu",staffCount:8,status:"active"}];e.useEffect(()=>{d()},[]);const d=async()=>{a(!0);try{n(c)}catch(e){}finally{a(!1)}};return Et.jsxs("div",{children:[Et.jsxs(f,{children:[Et.jsx(X,{gutter:[16,16],style:{marginBottom:16},children:Et.jsx(G,{span:24,children:Et.jsxs(m,{direction:"vertical",size:"small",children:[Et.jsxs(fl,{level:3,children:[Et.jsx(P,{})," Danh Sách Phòng Datacenter"]}),Et.jsx(gl,{type:"secondary",children:"Chọn phòng để xem lịch trực chi tiết"})]})})}),Et.jsx(Ne,{loading:r,dataSource:t,renderItem:e=>Et.jsx(Ne.Item,{actions:[Et.jsx(p,{type:"primary",icon:Et.jsx(ke,{}),onClick:()=>(e=>{o(e),s(!0)})(e),children:"Xem Lịch Trực"},"view")],children:Et.jsx(Ne.Item.Meta,{avatar:Et.jsx(y,{icon:Et.jsx(P,{}),style:{backgroundColor:"#1890ff"}}),title:Et.jsxs(m,{children:[Et.jsx(gl,{strong:!0,children:e.name}),Et.jsx(gl,{code:!0,children:e.code})]}),description:Et.jsxs(m,{direction:"vertical",size:"small",children:[Et.jsx(gl,{children:e.description}),Et.jsxs(gl,{type:"secondary",children:["Số nhân viên: ",e.staffCount," người"]})]})})})})]}),Et.jsx($n,{visible:i,onCancel:()=>{s(!1),o(null)},locationId:l?.id})]})},yl=()=>Et.jsxs("div",{style:{padding:"24px"},children:[Et.jsx(Je,{items:[{title:Et.jsx(Ze,{})},{title:"Quản lý"},{title:Et.jsx(N,{})},{title:"Lịch Trực Datacenter"}],style:{marginBottom:"16px"}}),Et.jsxs(m,{direction:"vertical",size:"large",style:{width:"100%"},children:[Et.jsx(ShiftScheduleTest,{}),Et.jsx(xl,{})]})]}),{Title:vl}=r,bl=()=>Et.jsx("div",{style:{padding:"24px"},children:Et.jsxs(f,{children:[Et.jsxs("div",{style:{marginBottom:"24px"},children:[Et.jsxs(vl,{level:2,children:[Et.jsx(N,{})," Demo Lịch Trực Datacenter"]}),Et.jsx("p",{children:"Đây là demo component hiển thị lịch trực datacenter dựa theo form ảnh bạn cung cấp."})]}),Et.jsx(xl,{})]})}),jl=({children:e})=>{const t=localStorage.getItem("token"),n=localStorage.getItem("user");if(!t||!n)return localStorage.clear(),Et.jsx(bt,{to:"/login"});try{const t=JSON.parse(n),r=window.location.pathname,a=t.role.toLowerCase();return r.startsWith("/manager")&&"manager"!==a&&"admin"!==a||r.startsWith("/dc")&&"datacenter"!==a||r.startsWith("/be")&&"be"!==a?Et.jsx(bt,{to:"/login"}):e}catch(r){return localStorage.clear(),Et.jsx(bt,{to:"/login"})}};function kl(){return Et.jsx(qt,{children:Et.jsx(et,{children:Et.jsx(xt,{children:Et.jsx(cn,{children:Et.jsxs(yt,{children:[Et.jsx(vt,{path:"/login",element:Et.jsx(Zt,{})}),Et.jsxs(vt,{path:"/",element:Et.jsx(jl,{children:Et.jsx(yn,{})}),children:[Et.jsx(vt,{index:!0,element:Et.jsx(bt,{to:"/dc/shifts"})}),Et.jsxs(vt,{path:"dc",children:[Et.jsx(vt,{path:"shifts",element:Et.jsx(er,{})}),Et.jsx(vt,{path:"handover",element:Et.jsx(ci,{})}),Et.jsx(vt,{path:"handover/create",element:Et.jsx(Vi,{})}),Et.jsx(vt,{path:"handover/edit/:id",element:Et.jsx(Vi,{})}),Et.jsx(vt,{path:"handover/:id",element:Et.jsx(Fi,{})}),Et.jsx(vt,{path:"devices",element:Et.jsx(is,{})}),Et.jsx(vt,{path:"tasks",element:Et.jsx(Xa,{})}),Et.jsx(vt,{path:"partners",element:Et.jsx(js,{})}),Et.jsx(vt,{path:"my-shifts",element:Et.jsx(Ki,{})}),Et.jsx(vt,{path:"my-shifts/create",element:Et.jsx($i,{})}),Et.jsx(vt,{path:"my-shifts/:id",element:Et.jsx($i,{})}),Et.jsx(vt,{path:"my-shifts/edit/:id",element:Et.jsx($i,{})}),Et.jsx(vt,{path:"tape",element:Et.jsx(hs,{})}),Et.jsx(vt,{path:"export-check",element:Et.jsx(ps,{})}),Et.jsx(vt,{path:"system-info",element:Et.jsx(Ds,{})}),Et.jsx(vt,{path:"system-info/:systemType",element:Et.jsx(Ds,{})}),Et.jsx(vt,{path:"system-info-manager",element:Et.jsx(Fs,{})}),Et.jsx(vt,{path:"system-info/edit/:id",element:Et.jsx(Ks,{})}),Et.jsx(vt,{path:"faq",element:Et.jsx(Js,{})}),Et.jsx(vt,{path:"cooling-system",element:Et.jsx(ol,{})}),Et.jsx(vt,{path:"cooling-system-vancanh",element:Et.jsx(dl,{})}),Et.jsx(vt,{path:"datacenter-menu",element:Et.jsx(pl,{})}),Et.jsx(vt,{path:"shift-schedule",element:Et.jsx(yl,{})})]}),Et.jsxs(vt,{path:"manager",children:[Et.jsx(vt,{path:"overview",element:Et.jsx(ei,{})}),Et.jsx(vt,{path:"shifts",element:Et.jsx(er,{})}),Et.jsx(vt,{path:"handovers",element:Et.jsx(ci,{})}),Et.jsx(vt,{path:"handovers/:id",element:Et.jsx(Fi,{})}),Et.jsx(vt,{path:"users",element:Et.jsx(Qi,{})}),Et.jsx(vt,{path:"settings",element:Et.jsx(ts,{})}),Et.jsx(vt,{path:"tasks",element:Et.jsx(Xa,{})}),Et.jsx(vt,{path:"devices",element:Et.jsx(is,{})}),Et.jsx(vt,{path:"partners",element:Et.jsx(js,{})}),Et.jsx(vt,{path:"tape",element:Et.jsx(hs,{})}),Et.jsx(vt,{path:"system-info",element:Et.jsx(Ds,{})}),Et.jsx(vt,{path:"system-info/:systemType",element:Et.jsx(Ds,{})}),Et.jsx(vt,{path:"system-info-manager",element:Et.jsx(Fs,{})}),Et.jsx(vt,{path:"system-info/edit/:id",element:Et.jsx(Ks,{})}),Et.jsx(vt,{path:"cooling-system",element:Et.jsx(ol,{})}),Et.jsx(vt,{path:"cooling-system-vancanh",element:Et.jsx(dl,{})}),Et.jsx(vt,{path:"datacenter-menu",element:Et.jsx(pl,{})}),Et.jsx(vt,{path:"shift-schedule",element:Et.jsx(yl,{})})]}),Et.jsxs(vt,{path:"be",children:[Et.jsx(vt,{path:"shifts",element:Et.jsx(er,{})}),Et.jsx(vt,{path:"my-shifts",element:Et.jsx(Ki,{})}),Et.jsx(vt,{path:"handover",element:Et.jsx(ci,{})}),Et.jsx(vt,{path:"partners",element:Et.jsx(js,{})}),Et.jsx(vt,{path:"system-info",element:Et.jsx(Ds,{})}),Et.jsx(vt,{path:"system-info/:systemType",element:Et.jsx(Ds,{})}),Et.jsx(vt,{path:"system-info-manager",element:Et.jsx(Fs,{})}),Et.jsx(vt,{path:"system-info/edit/:id",element:Et.jsx(Ks,{})}),Et.jsx(vt,{path:"cooling-system",element:Et.jsx(ol,{})}),Et.jsx(vt,{path:"cooling-system-vancanh",element:Et.jsx(dl,{})}),Et.jsx(vt,{path:"datacenter-menu",element:Et.jsx(pl,{})}),Et.jsx(vt,{path:"shift-schedule",element:Et.jsx(yl,{})})]}),Et.jsx(vt,{path:"profile",element:Et.jsx(an,{})})]}),Et.jsx(vt,{path:"demo/shift-schedule",element:Et.jsx(bl,{})}),Et.jsx(vt,{path:"*",element:Et.jsx(bt,{to:"/login"})})]})})})})})}tt(function(e,t){t._reactRoot||(t._reactRoot=Pt.createRoot(t));var n=t._reactRoot;return n.render(e),function(){return new Promise(function(e){setTimeout(function(){n.unmount(),e()},0)})}}),Pt.createRoot(document.getElementById("root")).render(Et.jsx(e.StrictMode,{children:Et.jsx(kl,{})}));export{sl as _,Et as j};
